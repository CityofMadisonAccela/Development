01^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
`^
AAA;ServiceRequest!Traffic Engineering!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (getShortNotes(capId) == "") {
	include("CMN;AddAssetIDtoShortNotes");
	}
`^
AAWA;ServiceRequest!Traffic Engineering!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;AddAssetIDtoShortNotes");
`^
ACAAFTER^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("ACAA;" + cmnGroup + "!~!~!~");
include("ACAA;" + cmnGroup + "!" + cmnType + "!~!~");
include("ACAA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("ACAA;" + appTypeString);
`^
ACAAPOAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CPA;" + cmnGroup + "!~!~!~");
include("CPA;" + cmnGroup + "!" + cmnType + "!~!~");
include("CPA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CPA;" + appTypeString);
`^
ACAAPOBefore^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CPB;" + cmnGroup + "!~!~!~");
include("CPB;" + cmnGroup + "!" + cmnType + "!~!~");
include("CPB;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CPB;" + appTypeString);
`^
ACAAPOOnload^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CPO;" + cmnGroup + "!~!~!~");
include("CPO;" + cmnGroup + "!" + cmnType + "!~!~");
include("CPO;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CPO;" + appTypeString);
`^
ACAASIAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CAA;" + cmnGroup + "!~!~!~");
include("CAA;" + cmnGroup + "!" + cmnType + "!~!~");
include("CAA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CAA;" + appTypeString);
`^
ACAASIAfter2^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CAA2;" + cmnGroup + "!~!~!~");
include("CAA2;" + cmnGroup + "!" + cmnType + "!~!~");
include("CAA2;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CAA2;" + appTypeString);
`^
ACAASIBefore^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CAB;" + cmnGroup + "!~!~!~");
include("CAB;" + cmnGroup + "!" + cmnType + "!~!~");
include("CAB;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CAB;" + appTypeString);
`^
ACAASIBefore2^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CAB2;" + cmnGroup + "!~!~!~");
include("CAB2;" + cmnGroup + "!" + cmnType + "!~!~");
include("CAB2;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CAB2;" + appTypeString);
`^
ACAASIBefore3^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CAB3;" + cmnGroup + "!~!~!~");
include("CAB3;" + cmnGroup + "!" + cmnType + "!~!~");
include("CAB3;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CAB3;" + appTypeString);
`^
ACAASIBefore4^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CAB4;" + cmnGroup + "!~!~!~");
include("CAB4;" + cmnGroup + "!" + cmnType + "!~!~");
include("CAB4;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CAB4;" + appTypeString);
`^
ACAASIBefore5^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CAB5;" + cmnGroup + "!~!~!~");
include("CAB5;" + cmnGroup + "!" + cmnType + "!~!~");
include("CAB5;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CAB5;" + appTypeString);
`^
ACAASIBefore6^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CAB6;" + cmnGroup + "!~!~!~");
include("CAB6;" + cmnGroup + "!" + cmnType + "!~!~");
include("CAB6;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CAB6;" + appTypeString);
`^
ACAASIBefore7^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CAB7;" + cmnGroup + "!~!~!~");
include("CAB7;" + cmnGroup + "!" + cmnType + "!~!~");
include("CAB7;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CAB7;" + appTypeString);
`^
ACAASIOnload^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CAO;" + cmnGroup + "!~!~!~");
include("CAO;" + cmnGroup + "!" + cmnType + "!~!~");
include("CAO;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CAO;" + appTypeString);
`^
ACAASIOnload2^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CAO2;" + cmnGroup + "!~!~!~");
include("CAO2;" + cmnGroup + "!" + cmnType + "!~!~");
include("CAO2;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CAO2;" + appTypeString);
`^
ACAASIOnload3^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CAO3;" + cmnGroup + "!~!~!~");
include("CAO3;" + cmnGroup + "!" + cmnType + "!~!~");
include("CAO3;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CAO3;" + appTypeString);
`^
ACAASIOnload4^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CAO4;" + cmnGroup + "!~!~!~");
include("CAO4;" + cmnGroup + "!" + cmnType + "!~!~");
include("CAO4;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CAO4;" + appTypeString);
`^
ACAASIOnload5^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CAO5;" + cmnGroup + "!~!~!~");
include("CAO5;" + cmnGroup + "!" + cmnType + "!~!~");
include("CAO5;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CAO5;" + appTypeString);
`^
ACAASIOnload6^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CAO6;" + cmnGroup + "!~!~!~");
include("CAO6;" + cmnGroup + "!" + cmnType + "!~!~");
include("CAO6;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CAO6;" + appTypeString);
`^
ACAASIOnload7^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CAO7;" + cmnGroup + "!~!~!~");
include("CAO7;" + cmnGroup + "!" + cmnType + "!~!~");
include("CAO7;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CAO7;" + appTypeString);
`^
ACAASIOnload8^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CAO8;" + cmnGroup + "!~!~!~");
include("CAO8;" + cmnGroup + "!" + cmnType + "!~!~");
include("CAO8;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CAO8;" + appTypeString);
`^
ACAB;Licenses!Building Inspection!Landlord Registration!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
neighbor = "City of Madison";
addrMod = cap.getAddressModel();
neighbor = addrMod.getNeighborhood();
if (neighbor != "City of Madison") {
	cancel = true;
	showMessage = true;
	comment("The address you selected is not within the City of Madison. This registration is only for City of Madison addresses.");
	neighbor != "City of Madison";
	} else {
	cancel = true;
	showMessage = true;
	comment("The address you selected is not within the City of Madison. This registration is only for City of Madison addresses.");
	}
`^
ACAB;Permitting!Parking!Residential Parking!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;ValidateResParkAreaNum");
`^
ACAB;Permitting!Parking!Residential Parking!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;ValidateResParkAreaNum");
`^
ACABEFORE^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("ACAB;" + cmnGroup + "!~!~!~");
include("ACAB;" + cmnGroup + "!" + cmnType + "!~!~");
include("ACAB;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("ACAB;" + appTypeString);
`^
ACADocumentAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CDA;" + cmnGroup + "!~!~!~");
include("CDA;" + cmnGroup + "!" + cmnType + "!~!~");
include("CDA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CDA;" + appTypeString);
`^
ACADocumentBefore^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CDB;" + cmnGroup + "!~!~!~");
include("CDB;" + cmnGroup + "!" + cmnType + "!~!~");
include("CDB;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CDB;" + appTypeString);
`^
ACADocumentOnload^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CDO;" + cmnGroup + "!~!~!~");
include("CDO;" + cmnGroup + "!" + cmnType + "!~!~");
include("CDO;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CDO;" + appTypeString);
`^
ACALicenseProfessionalAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CLA;" + cmnGroup + "!~!~!~");
include("CLA;" + cmnGroup + "!" + cmnType + "!~!~");
include("CLA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CLA;" + appTypeString);
`^
ACALicenseProfessionalBefore^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CLB;" + cmnGroup + "!~!~!~");
include("CLB;" + cmnGroup + "!" + cmnType + "!~!~");
include("CLB;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CLB;" + appTypeString);
`^
ACALicenseProfessionalOnload^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CLO;" + cmnGroup + "!~!~!~");
include("CLO;" + cmnGroup + "!" + cmnType + "!~!~");
include("CLO;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CLO;" + appTypeString);
`^
ACAO;Permitting!Engineering!Erosion Control!Inspection^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
parentCapId = null;
parentCapIdString = "" + cap.getParentCapID();
if (parentCapIdString) {
	pca = parentCapIdString.split("-");
	parentCapId = aa.cap.getCapID(pca[0],pca[1],pca[2]).getOutput();
	}

if (parentCapId) {
	parentCap = aa.cap.getCapViewBySingle4ACA(parentCapId);
	}

if (parentCap) {
	n_refAddr = parentCap.getAppSpecificTableGroupModel();
	cap.setAppSpecificTableGroupModel(n_refAddr);
	aa.env.setValue("CapModel",cap);
	}
`^
ACAO;Permitting!Health!POWTS!Holding Tank^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
vField = "nothing";
capSuccess = false;
addSuccess = false;
copySuccess = false;
curASI= cap.getAppSpecificInfoGroups();
curASIi = curASI.iterator();
asiFields = curASIi.next();
asiField = asiFields.getFields();
asiFieldi = asiField.iterator();
while (asiFieldi.hasNext()) include("CMN;Permitting!Health!POWTS!TAM;GetASIFields");
if (vField != "nothing") {
	sanitaryCap = aa.cap.getCapID(vField);
	capSuccess = sanitaryCap.getSuccess();
	} else {
	cancel = true;
	showMessage = true;
	comment("Sanitary Permit needs a value");
	}

if (capSuccess == true) {
	sanitaryCap = sanitaryCap.getOutput();
	pCapAdd = aa.address.getAddressByCapId(sanitaryCap);
	addSuccess = pCapAdd.getSuccess();
	} else {
	cancel = true;
	showMessage = true;
	comment("Please enter a valid Sanitary Permit Number");
	}

if (addSuccess == true) {
	copyAdd = pCapAdd.getOutput();
	if(copyAdd[0] == undefined) copySuccess = false;
	if(copyAdd[0] != undefined) copySuccess = true;
	}

if (capSuccess == true && copySuccess == false) {
	cancel = true;
	showMessage = true;
	comment("There is no address associated with the Sanitary Permit Number " + vField + ". Please continue without adding an address.");
	} else {
	toAdd = cap.getAddressModel();
	}

if (copySuccess == true) {
	toAdd.setHouseNumberStart(copyAdd[0].getHouseNumberStart());
	toAdd.setStreetDirection(copyAdd[0].getStreetDirection());
	}

if (copySuccess == true) {
	toAdd.setStreetName(copyAdd[0].getStreetName());
	toAdd.setStreetSuffix(copyAdd[0].getStreetSuffix());
	toAdd.setUnitStart(copyAdd[0].getUnitStart());
	}

if (copySuccess == true) {
	toAdd.setCity(copyAdd[0].getCity());
	toAdd.setState(copyAdd[0].getState());
	toAdd.setZip(copyAdd[0].getZip());
	}
`^
ACAO;Permitting!Health!POWTS!TAM^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
vField = "nothing";
capSuccess = false;
addSuccess = false;
copySuccess = false;
curASI= cap.getAppSpecificInfoGroups();
curASIi = curASI.iterator();
asiFields = curASIi.next();
asiField = asiFields.getFields();
asiFieldi = asiField.iterator();
while (asiFieldi.hasNext()) include("CMN;Permitting!Health!POWTS!TAM;GetASIFields");
if (vField != "nothing") {
	sanitaryCap = aa.cap.getCapID(vField);
	capSuccess = sanitaryCap.getSuccess();
	} else {
	cancel = true;
	showMessage = true;
	comment("Sanitary Permit needs a value");
	}

if (capSuccess == true) {
	sanitaryCap = sanitaryCap.getOutput();
	pCapAdd = aa.address.getAddressByCapId(sanitaryCap);
	addSuccess = pCapAdd.getSuccess();
	} else {
	cancel = true;
	showMessage = true;
	comment("Please enter a valid Sanitary Permit Number");
	}

if (addSuccess == true) {
	copyAdd = pCapAdd.getOutput();
	if(copyAdd[0] == undefined) copySuccess = false;
	if(copyAdd[0] != undefined) copySuccess = true;
	}

if (capSuccess == true && copySuccess == false) {
	cancel = true;
	showMessage = true;
	comment("There is no address associated with the Sanitary Permit Number " + vField + ".  Please continue without adding an address.");
	} else {
	toAdd = cap.getAddressModel();
	}

if (copySuccess == true) {
	toAdd.setHouseNumberStart(copyAdd[0].getHouseNumberStart());
	toAdd.setStreetDirection(copyAdd[0].getStreetDirection());
	}

if (copySuccess == true) {
	toAdd.setStreetName(copyAdd[0].getStreetName());
	toAdd.setStreetSuffix(copyAdd[0].getStreetSuffix());
	toAdd.setUnitStart(copyAdd[0].getUnitStart());
	}

if (copySuccess == true) {
	toAdd.setCity(copyAdd[0].getCity());
	toAdd.setState(copyAdd[0].getState());
	toAdd.setZip(copyAdd[0].getZip());
	}
`^
ACAONLOAD^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("ACAO;" + cmnGroup + "!~!~!~");
include("ACAO;" + cmnGroup + "!" + cmnType + "!~!~");
include("ACAO;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("ACAO;" + appTypeString);
`^
ADUA;AMS!Engineering Facility Maint!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
holdId = capId;
include("CMN;AMS!Engineering Facility Maint!Email Assigned");
`^
ADUA;Land!Land Use!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;TrackAssignments");
`^
ADUA;ServiceRequest!Information Technology!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;TrackAssignments");
`^
ADUA;ServiceRequest!Traffic Engineering!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;ServiceRequest!Traffic Engineering;TrackAssignments");
`^
ADUA;ServiceRequest!Traffic Engineering!Study!Crash Study^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("EML;ServiceRequest!TrafficEngineering!~!~;StudyCreated");
`^
ADUA;ServiceRequest!Traffic Engineering!Study!Field Check^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("EML;ServiceRequest!TrafficEngineering!~!~;StudyCreated");
`^
ADUA;ServiceRequest!Traffic Engineering!Study!Previous Study^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("EML;ServiceRequest!TrafficEngineering!~!~;StudyCreated");
`^
AffirmativeActionEmailsBody^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (Dear EEO!AA Officer;) {
	}

if (Please be advised that this department has reviewed and approved (until 3!1!19) your Affirmative Action (AA) Plan submitted in an effort to comply with Madison General Ordinance (MGO) Section 39.02. Please retain this letter for reference, and calendar your next deadline date before which any new AA Plan must be submitted in order to continue business with the city. Submissions provided after your expiration date may be delayed in processing, and cause your compliance status to lapse. This approval is contingent upon your firm's continued demonstration of good faith efforts to achieve and maintain a balanced workforce in accordance with the stated AA plan goals.) {
	}

if (We reserve the right to conduct an audit and!or on-site compliance review of your organization’s good faith efforts to implement this affirmative action plan. As such, your organization is required to maintain accurate records in accordance with your plan.) {
	}

if (Compliance with MGO 39.02 includes contacting this department with notices for all job openings in Dane County by the opening date of advertisement with sufficient time for the City to notify candidates and make a timely referral. The notice must include a job description, classification, qualifications and application procedures and deadlines. We operate a Job Skills Bank and may refer qualified applicants to assist you in meeting your target workforce goals. All Dane County Job notices or requests for assistance should be sent to (608) 266-6514, (fax) ATTN; Job Skills Bank, or aajobs@cityofmadison.com. MGO 39.02(9)(c) also states; "The Contractor agrees to interview and consider candidates referred by the Department of Affirmative Action if the candidate meets the minimum qualification standards established by the contractor, and if the referral is timely. A referral is timely if it is received by the contractor on or before the date stated in the notice.") {
	}

if (Finally, please recall that all firms doing business with the City of Madison are required not to discriminate against any employee or applicant because of sex, age, race, color, religion, marital or student status, disability!handicap, national origin or ancestry, income level or source of income, arrest or conviction record, less than honorable military discharge, gender identity, physical appearance, sexual orientation, or political beliefs.) {
	}

if (The Affirmative Action Division has reviewed and approved the Individual Developer Affirmative Action Plan submitted to the City of Madison by your company in an effort to comply with the City of Madison’s Affirmative Action Ordinance requirements. This communication serves as your official notice of approval. This Affirmative Action Plan expires two years from the date of this letter. At that point in time, you are required to notify this department and comply with Section 39.02 of the Madison General Ordinance by filing an AA Plan.) {
	}

if (Please be aware that you will be required to submit a new AA Plan application prior to the expiration date of your current AA Plan if you wish to remain in compliance. Please file this letter with your records and make note of your current AA Plan’s expiration date in order to ensure timely resubmission of your new AA Plan.) {
	}

if (We reserve the right to conduct an audit and!or on-site compliance review of your organization’s good faith efforts to implement this Affirmative Action Plan. As such, your organization is required to maintain accurate records in accordance with your Plan.) {
	}

if (Compliance with MGO 39.02(9)(e)2 requires you to include the Articles of Agreement in all contracts with your general contractor(s) and subcontractor(s).) {
	}

if (All firms doing business with the City of Madison, regardless of their exempt status, are required not to discriminate against any employee or applicant because of sex, age, race, color, religion, marital or student status, disability!handicap, national origin or ancestry, income level or source of income, arrest or conviction record, less than honorable discharge, gender identity, physical appearance, sexual orientation, or political beliefs.) {
	}

if (The Affirmative Action Division has reviewed your Request for Exemption and has exempted your company from filing an Affirmative Action Plan in accordance with the City of Madison’s Affirmative Action Ordinance requirements. This communication serves as your official notice of approval. This exemption expires in one calendar year on December 31st and is contingent on your company receiving a value of less than $25,000 in total City of Madison contracts in one calendar year. Should your company receive or contract for $25,000 or more at any time prior to this expiration date, this exemption is rescinded. At that point in time, you are required to notify this department and comply with Section 39.02 of the Madison General Ordinance by filing an AA Plan.) {
	}

if (Please be aware that you will be required to submit a new AA Plan application prior to the expiration date of your current AA Plan if you wish to remain in compliance. Please file this letter with your records and make note of your current AA Plan’s expiration date in order to ensure timely resubmission of your new AA Plan.) {
	}

if (All firms doing business with the City of Madison, regardless of their exempt status, are required not to discriminate against any employee or applicant because of sex, age, race, color, religion, marital or student status, disability!handicap, national origin or ancestry, income level or source of income, arrest or conviction record, less than honorable discharge, gender identity, physical appearance, sexual orientation, or political beliefs.) {
	}

if (The Affirmative Action Division has reviewed your Request for Exemption and has exempted your company from filing an Affirmative Action Plan in accordance with the City of Madison’s Affirmative Action Ordinance requirements. This communication serves as your official notice of approval. This exemption expires two years from the date of this letter and is contingent on your company employing fewer than fifteen (15) employees. Should your company employ fifteen (15) or more persons at any time prior to this expiration date, this exemption is rescinded. At that point in time, you are required to notify this department and comply with Section 39.02 of the Madison General Ordinance by filing an AA Plan.) {
	}

if (Please be aware that you will be required to submit a new AA Plan application prior to the expiration date of your current AA Plan if you wish to remain in compliance. Please file this letter with your records and make note of your current AA Plan’s expiration date in order to ensure timely resubmission of your new AA Plan.) {
	}

if (All firms doing business with the City of Madison, regardless of their exempt status, are required not to discriminate against any employee or applicant because of sex, age, race, color, religion, marital or student status, disability!handicap, national origin or ancestry, income level or source of income, arrest or conviction record, less than honorable discharge, gender identity, physical appearance, sexual orientation, or political beliefs.) {
	}

if (The Affirmative Action Division has received the new Affirmative Action (AA) Plan application for Community-Based Organizations submitted by your organization in an effort to fulfill the requirements of Section 39.02 of the Madison General Ordinances (MGO). Upon reviewing your submission, we have determined that it remains incomplete. Please correct, completing all the items requested below, per the following sections.) {
	}

if (The Affirmative Action Division has received the new Public Works Affirmative Action (AA) Plan application submitted by your firm in an effort to fulfill the requirements of Section 39.02 of the Madison General Ordinances (MGO). Upon reviewing your submission, we have determined that it remains incomplete. Please correct, completing all the items requested below, per the following sections.) {
	}

if (The Affirmative Action Division has received the new Affirmative Action (AA) Plan application for Vendors and Suppliers submitted by your firm in an effort to fulfill the requirements of Section 39.02 of the Madison General Ordinances (MGO). Upon reviewing your submission, we have determined that it remains incomplete. Please correct, completing all the items requested below, per the following sections.) {
	}

if (Note that until such time as we receive the necessary corrections and approve your AA Plan, your firm will remain unqualified for bid opening, future payment and!or working on City of Madison projects.  Please reply to this email with any specific questions regarding the above that you may have, such that our Division may provide you with technical assistance.) {
	}

if (The Affirmative Action Division has reviewed your Request for Exemption and has exempted you from filing an Affirmative Action Plan in accordance with the City of Madison’s Affirmative Action Ordinance requirements. This communication serves as your official notice of approval. Please file this letter with your records.) {
	}

if (All entities doing business with the City of Madison, regardless of their exempt status, are required not to discriminate against any business entity or person because of sex, age, race, color, religion, marital or student status, disability!handicap, national origin or ancestry, income level or source of income, arrest or conviction record, less than honorable discharge, gender identity, physical appearance, sexual orientation, or political beliefs.) {
	}

if (Dear Applicant;) {
	}

if (Thank you.<br><br>Best regards,<br><br>Martha White<br>Professional Assistant<br>Department of Civil Rights<br>Affirmative Action Division<br>City-County Building, Room 523<br>210 Martin Luther King, Jr. Blvd.<br>Madison, Wisconsin 53703<br>Direct Telephone; 608-267-1141<br>Department Telephone; 608-266-4910<br>Department Fax; 608-266-6514<br>Email; mewhite@cityofmadison.com<br>www.cityofmadison.com!dcr!aaForms.cfm) {
	}
`^
ApplicationDetailUpdateAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("ADUA;" + appTypeString);
`^
APPLICATIONSPECIFICINFOBEFORE^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("ASIUB;" + cmnGroup + "!~!~!~");
include("ASIUB;" + cmnGroup + "!" + cmnType + "!~!~");
include("ASIUB;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("ASIUB;" + appTypeString);
`^
ApplicationSpecificInfoUpdateAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("ASIUA;" + cmnGroup + "!~!~!~");
include("ASIUA;" + cmnGroup + "!" + cmnType + "!~!~");
include("ASIUA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("ASIUA;" + appTypeString);
`^
ApplicationSpecificInfoUpdateBefore^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("ASIUB;" + cmnGroup + "!~!~!~");
include("ASIUB;" + cmnGroup + "!" + cmnType + "!~!~");
include("ASIUB;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("ASIUB;" + appTypeString);
`^
ApplicationStatusUpdateAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showMessage = false;
showDebug = false;
if (capStatus == "Void") {
	taskCloseAllExcept("Void","Void");
	}

if (capStatus == "Referred") {
	taskCloseAllExcept("Referred","Referred");
	}

if (capStatus == "Closed") {
	taskCloseAllNotComplete("Closed","Closed");
	}

include("CMN;~!~!~!~;GET_APP_PARTS");
include("ASU;" + cmnGroup + "!~!~!~");
include("ASU;" + cmnGroup + "!" + cmnType + "!~!~");
include("ASU;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("ASU;" + appTypeString);
`^
ApplicationStatusUpdateBefore^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showMessage = false;
showDebug = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("ASUB;" + cmnGroup + "!~!~!~");
include("ASUB;" + cmnGroup + "!" + cmnType + "!~!~");
include("ASUB;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("ASUB;" + appTypeString);
`^
ApplicationSubmitAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
copyParcelGisObjects();
getOwnerfromParcel();
include("CMN;~!~!~!~;GET_APP_PARTS");
include("ASA;" + cmnGroup + "!" + cmnType + "!~!~");
include("ASA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("ASA;" + appTypeString);
if ((cap.isCreatedByACA())) {
	updateTask("Intake Review","OnlineSubmittal","Online Submittal Pending","");
	}

if (appMatch("Permitting!Zoning!~!~") || appMatch("Permitting!Building!~!~")) {
	include("CMN;LOCALHISTDISTRICT");
	include("CMN;CAPITOLFIREDISTRICT");
	include("CMN;URBANDESIGNDISTRICT");
	include("Proximity Alert; Adjacency to Landmarks");
	include("CMN;DEPTHOLD");
	}
`^
ApplicationSubmitBefore^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("ASB;" + cmnGroup + "!~!~!~");
include("ASB;" + cmnGroup + "!" + cmnType + "!~!~");
include("ASB;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("ASB;" + appTypeString);
`^
ASA;AMS!Engineering Facility Maint!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var territory = 999;
assets = aa.asset.getAssetListByWorkOrder(capId,null).getOutput();
if (assets) {
	for (asset in assets) assetDataModel = assets[asset].getAssetDataModel();
	}

if (assetDataModel) {
	assetSeq = assetDataModel.getAssetMaster().getG1AssetSequenceNumber();
	}

selectString = "DECLARE @AssetSeq varchar(250);
SET @AssetSeq = '" + assetSeq + "';
SELECT G1_Attribute_value FROM GASSET_attribute where serv_prov_code = 'MADISON' and g1_attribute_name = 'Territory' and G1_asset_seq_nbr = @AssetSeq";
var initialContext = aa.proxyInvoker.newInstance("javax.naming.InitialContext").getOutput();
var ds = initialContext.lookup("java;!AA");
var conn = ds.getConnection();
var sStmt = conn.prepareStatement(selectString);
var rSet = sStmt.executeQuery();
if (rSet && rSet.next()) {
	var territory = rSet.getString("G1_Attribute_value");
	rSet.close();
	conn.close();
	} else {
	conn.close();
	}

if (territory && territory != 999) {
	assigned = lookup("Facility Territory",territory);
	}

if (territory && territory != 999 && assigned) {
	cd = aa.cap.getCapDetail(capId).getOutput().getCapDetailModel();
	}

if (territory && territory != 999 && assigned && cd) {
	cd.setAsgnDept(assigned);
	aa.cap.editCapDetail(cd);
	}

include("CMN;AMS!Engineering Facility Maint!Email Assigned");
editAppName("No");
showDebug = true;
`^
ASA;AMS!Engineering Storm!Mowing!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
strName = "";
AssetList = aa.asset.getAssetListByWorkOrder(capId,null);
if (AssetList.getSuccess()) {
	AssetList = AssetList.getOutput();
	for (x in AssetList) include("CMN;AMS!Engineering Storm!Mowing!~;addAssetInfo");
	}

if (strName != null) {
	updateShortNotes(strName.substring(0, 200));
	}

if (cmnCategory == "Weeds") {
	include("EML;AMS!Engineering Storm!Mowing!Weeds;Submitted");
	}
`^
ASA;AMS!Equipment!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;AMS!Vehicle;AddID");
`^
ASA;AMS!Facility!Maintenance!AED^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
emailText = "";
assetID = "";
emailList = "";
AssetList = null;
workDesc = "Check AED(s) battery operation and pad condition";
emailSubject =  "Work Order# " + capId.getCustomID() + " assigned to you.";
var strName = "";
AssetList = aa.asset.getAssetListByWorkOrder(capId,null);
if (AssetList.getSuccess()) {
	AssetList = AssetList.getOutput();
	}

if (AssetList) {
	for (x in AssetList) include("CMN;GetAssetContactEmail");
	}

if (AssetList) {
	for (x in AssetList) logDebug("Asset is;"+debugObject(AssetList[x].getDataAttributes()));
	}

emailText += "Work Order <a href=" + "" + "https;!!avdev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=AMS&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capId.getCustomID() + "<!a> Assigned to you. <BR><BR>" + workDesc + "; <BR>";
if (AssetList) {
	for (x in AssetList) include("CMN;GetAEDAssetDetails");
	}

updateWorkDesc(workDesc, capId);
aa.sendEmail("noreply@cityofmadison.com", emailList,"",  emailSubject, emailText, "");
`^
ASA;AMS!Forestry!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
loadAddressAttributes(AInfo);
updateShortNotes(AInfo['AddressAttribute.FORESTRY DISTRICT']);
`^
ASA;AMS!Information Technology!Cameras!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;AddAssetIDtoShortNotes");
`^
ASA;AMS!Parks!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;UpdateParksAssets");
`^
ASA;AMS!Streets!Graffiti Removal!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;AMS!Streets!Graffiti Removal!NA");
`^
ASA;AMS!Vehicle!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;AMS!Vehicle;AddID");
`^
ASA;AnimalServices!~!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
cd = aa.cap.getCapDetail(capId).getOutput().getCapDetailModel();
capAsgnStaff = cd.getAsgnStaff();
if (!capAsgnStaff) {
	assignCap(currentUserID);
	}

editScheduledDate(fileDate);
`^
ASA;AnimalServices!Bite!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;AnimalServices!Bite!NA!NA");
`^
ASA;AnimalServices!General!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;AnimalServices!General!NA!NA");
`^
ASA;AnimalServices!Rabies Exposure!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;AnimalServices!Rabies Exposure!NA!NA");
`^
ASA;AnimalServices!Welfare!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;AnimalServices!Welfare!NA!NA");
`^
ASA;AnimalServices!Wildlife!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;AnimalServices!Wildlife!NA!NA");
`^
ASA;DaneCounty!Zoning!Conditional Use!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;DaneCounty!Zoning!Conditional Use!NA;Fee");
`^
ASA;DaneCounty!Zoning!Request for Service!Water Determination^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;DaneCounty!Zoning!Request for Service!Water Determination;Fee");
`^
ASA;DaneCounty!Zoning!Rezone!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;DaneCounty!Zoning!Rezone!NA;MainFee");
include("CMN;DaneCounty!Zoning!Rezone!NA;MainTownFee");
`^
ASA;DaneCounty!Zoning!Zoning Permit!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;DaneCounty!Zoning!Zoning Permit!NA;Fee");
`^
ASA;Enforcement!Building Inspection!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
var varInsp = undefined;
var sCreatedByUserID = null;
refAdd = null;
refAddress = null;
if (validateGisObjects()) {
	varInsp = getGISInfo("agis_madison", "Property Maint Dist", "ACES_User_ID");
	logDebug(varInsp);
	} else {
	include("EML;NoGISObject");
	}

add = aa.address.getAddressByCapId(cap.getCapID()).getOutput();
if (add[0].getRefAddressId() == null) {
	include("CMN;AddReferenceAddressAndOwner");
	}

cd = aa.cap.getCapDetail(capId).getOutput().getCapDetailModel();
if (cd.createBy != undefined && cd.createBy != null) {
	sCreatedByUserID = cd.createBy;
	logDebug("Record was created by UserID " + sCreatedByUserID);
	}

if (cmnSubType != "Property Maintenance") {
	scheduleInspection("Initial Inspection", 0, capDetail.getAsgnStaff(), null, workDescGet(capId));
	}

if (cmnSubType == "Property Maintenance" && sCreatedByUserID  != "BINMR" && varInsp != undefined && cmnCategory != "Erosion Control 1 and 2 Family") {
	assignCap(varInsp.toUpperCase());
	scheduleInspection("Initial Inspection", 0, varInsp, null, workDescGet(capId));
	}

if (cmnSubType == "Property Maintenance" && cmnCategory == "Erosion Control 1 and 2 Family") {
	assignCap("BINMR");
	scheduleInspection("Initial Inspection", 0, "BINMR", null, workDescGet(capId));
	}
`^
ASA;Enforcement!Building Inspection!Construction!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;LOCALHISTDISTRICTENFORCEMENT");
include("CMN;LOCALLANDMARKENFORCEMENT");
include("CMN;LOCALURBANDESIGNENFORCEMENT");
`^
ASA;Enforcement!Building Inspection!Housing!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
include("CMN;LOCALHISTDISTRICTENFORCEMENT");
include("CMN;LOCALLANDMARKENFORCEMENT");
include("CMN;LOCALURBANDESIGNENFORCEMENT");
`^
ASA;Enforcement!Building Inspection!Rent Abatement!Eligible^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
parentCapId = getParent();
var caseDes = false;
if (parentCapId != false) {
	caseDes = getAppSpecific("CASE INFORMATION.Case Description",parentCapId);
	}

if (caseDes != false) {
	editAppSpecific("CASE INFORMATION.Case Description",caseDes);
	}
`^
ASA;Enforcement!Engineering!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
scheduleInspection("Initial Inspection",0,null,null,workDescGet(capId));
autoAssignInspection(getScheduledInspId("Initial Inspection"));
`^
ASA;Enforcement!Fire!Prevention!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
cd = aa.cap.getCapDetail(capId).getOutput().getCapDetailModel();
capAsgnStaff = cd.getAsgnStaff();
capAsgnDept = cd.getAsgnDept();
if (AInfo['APPLICATION INFORMATION.Type of Code Enforcement Case'] == "Special") {
	scheduleInspectDateGroup("FIRCODERI",AInfo['APPLICATION INFORMATION.Type of Code Enforcement Case'],dateAdd(null,0),capAsgnStaff);
	closeTask("Intake","Inspection Required","Immediate Inspection","Immediate Inspection");
	}

if (AInfo['APPLICATION INFORMATION.Type of Code Enforcement Case'] == "Outdoor Place of Assembly") {
	scheduleInspectDateGroup("FIRCODERI",AInfo['APPLICATION INFORMATION.Type of Code Enforcement Case'],dateAdd(null,0),capAsgnStaff);
	closeTask("Intake","Inspection Required","Immediate Inspection","Immediate Inspection");
	}

if (AInfo['APPLICATION INFORMATION.Type of Code Enforcement Case'] == "MFD Station Equipment") {
	scheduleInspectDateGroup("FIRCODERI",AInfo['APPLICATION INFORMATION.Type of Code Enforcement Case'],dateAdd(null,0),capAsgnStaff);
	closeTask("Intake","Inspection Required","Immediate Inspection","Immediate Inspection");
	}

if (AInfo['APPLICATION INFORMATION.Type of Code Enforcement Case'] == "Event") {
	scheduleInspectDateGroup("FIRCODERI",AInfo['APPLICATION INFORMATION.Type of Code Enforcement Case'],dateAdd(null,0),capAsgnStaff);
	closeTask("Intake","Inspection Required","Immediate Inspection","Immediate Inspection");
	}

if (AInfo['APPLICATION INFORMATION.Type of Code Enforcement Case'] == "Place of Assembly") {
	scheduleInspectDateGroup("FIRCODERI",AInfo['APPLICATION INFORMATION.Type of Code Enforcement Case'],dateAdd(null,0),capAsgnStaff);
	closeTask("Intake","Inspection Required","Immediate Inspection","Immediate Inspection");
	}
`^
ASA;Enforcement!Traffic Engineering!Street Occupancy!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
scheduleInspection("Initial Inspection", 0, capDetail.getAsgnStaff(), null, workDescGet(capId));
`^
ASA;Land!Land Use!Conditional Use Demo!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Land!Land Use!Conditional Use Demo!NA;Fee");
`^
ASA;Land!Land Use!Conditional Use!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Land!Land Use!Conditional Use!NA;Fee");
`^
ASA;Land!Land Use!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
landVal = 0;
improvementVal = 0;
landImproveVal = 0;
var paArray = new Array();
loadParcelAttributes(paArray, capId);
logDebug("land val; " + paArray["ParcelAttribute.LandValue"]);
if (paArray["ParcelAttribute.LandValue"]) {
	landVal = paArray["ParcelAttribute.LandValue"];
	}

if (paArray["ParcelAttribute.ImprovedValue"]) {
	improvementVal = paArray["ParcelAttribute.ImprovedValue"];
	}

editAppSpecific("DECLARATION OF INTENT.Current property value", Number(landVal)+Number(improvementVal));
addASITable("ARCHITECTURAL REVIEW", new Array());
`^
ASA;Land!Non-PUD Rezoning!NonPUD Cond Use Demo!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Land!Non-PUD Rezoning!NonPUD Cond Use Demo!NA;Fee");
`^
ASA;Land!Non-PUD Rezoning!NonPUD Cond Use!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Land!Non-PUD Rezoning!NonPUD Cond Use!NA;Fee");
`^
ASA;Land!Non-PUD Rezoning!NonPUD Demo!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Land!Non-PUD Rezoning!NonPUD Demo!NA;Fee");
`^
ASA;Land!Non-PUD Rezoning!NonPUD!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Land!Non-PUD Rezoning!NonPUD!NA;Fee");
`^
ASA;Land!PUD Rezoning!PUD Cond Use Demo!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Land!PUD Rezoning!PUD Cond Use Demo!NA;Fee");
`^
ASA;Land!PUD Rezoning!PUD Cond Use!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Land!PUD Rezoning!PUD Cond Use!NA;Fee");
`^
ASA;Land!PUD Rezoning!PUD Demo!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Land!PUD Rezoning!PUD Demo!NA;Fee");
`^
ASA;Land!PUD Rezoning!PUD!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Land!PUD Rezoning!PUD!NA;Fee");
`^
ASA;Land!Rezoning!Rezoning!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Land!Rezoning!Rezoning!NA;Fee");
`^
ASA;Land!Subdivision!Certified Survey Map!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Land!Subdivision!Certified Survey Map!NA;Fee");
parcelNum = null;
include("CMN;Land!Subdivision!Certified Survey Map!NA;AddParcelCondition");
`^
ASA;Land!Subdivision!Subdivision Plat!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Land!Subdivision!Subdivision Plat!NA;Fee");
`^
ASA;Land!Urban Design Commission!General Application!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Land!Urban Design Commission!General Application!NA;Fee");
`^
ASA;Licenses!Building Inspection!Foreclosure Registration!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
include("CMN;Licenses!Building Inspection!Foreclosure Registration!NA;Fee");
closeTask("Intake","Submitted","Task automatically updated & closed by ASA script","");
`^
ASA;Licenses!Building Inspection!Landlord Registration!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (publicUser == false) {
	include("CMN;Licenses!Building Inspection!Landlord Registration!NA;Fee");
	}

closeTask("Intake","Submitted","","");
if (getParent()) {
	aa.cap.createAppHierarchy(getParent(),capId);
	}

if (getParent()) {
	if(aa.cap.getCap(getParent()).getOutput().getCapStatus() != "Payment Pending") updateTask("Intake","Payment Pending","","","",getParent());
	}

if (getParent()) {
	aa.cap.removeAppHierarchy(getParent(), capId);
	}
`^
ASA;Licenses!Building Inspection!Landlord Registration!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
parentCapId = null;
var parentCapString = "" + aa.env.getValue("ParentCapID");
parentArray = parentCapString.split("-");
parentCapId =  aa.cap.getCapID(parentArray[0],parentArray[1],parentArray[2]).getOutput();
aa.cap.createRenewalCap(parentCapId, capId, !cap.isCompleteCap());
copyContactsByType(parentCapId, capId, "Property Mgmt. Company");
if (AInfo['EMERGENCY CONTACT.Contact Name'] == null) {
	copyASIFields(parentCapId, capId, "Municipality");
	copyAddresses(parentCapId, capId);
	include("CMN;GetAPOAddress");
	}

if (AInfo['EMERGENCY CONTACT.Contact Name'] == null) {
	holdCapId = capId;
	capId = getParentLicenseCapID(holdCapId);
	rsEXPStatus = "Pending";
	include("CMN;GENERIC;ExpDec31");
	updateAppStatus("Payment Pending");
	capId = holdCapId;
	}

if (publicUser == false && feeExists("LICLR") == false) {
	updateFee("LICLR","LICLR","FINAL",1,"Y","Y");
	}
`^
ASA;Licenses!Civil Rights!AA Plan!CBO^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var capContactResult = aa.people.getCapContactByCapID(capId);
refContactNbr = 0;
if (capContactResult.getSuccess()) {
	Contacts = capContactResult.getOutput();
	}

if (capContactResult.getSuccess()) {
	for(yy in Contacts) include("cmn;FindContractor");
	}

if (refContactNbr > 0) {
	contactSetPrimary(refContactNbr);
	}

updateAppStatus("Online Submittal", "Madison Licenses & Permits Updates Complete.", capId);
`^
ASA;Licenses!Civil Rights!AA Plan!Public Works^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var capContactResult = aa.people.getCapContactByCapID(capId);
refContactNbr = 0;
if (capContactResult.getSuccess()) {
	Contacts = capContactResult.getOutput();
	}

if (capContactResult.getSuccess()) {
	for(yy in Contacts) include("cmn;FindContractor");
	}

if (refContactNbr > 0) {
	contactSetPrimary(refContactNbr);
	}

updateAppStatus("Online Submittal", "Madison Licenses & Permits Updates Complete.", capId);
`^
ASA;Licenses!Civil Rights!AA Plan!Vendors and Suppliers^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var capContactResult = aa.people.getCapContactByCapID(capId);
refContactNbr = 0;
if (capContactResult.getSuccess()) {
	Contacts = capContactResult.getOutput();
	}

if (capContactResult.getSuccess()) {
	for(yy in Contacts) include("cmn;FindContractor");
	}

if (refContactNbr > 0) {
	contactSetPrimary(refContactNbr);
	}

updateAppStatus("Online Submittal", "Madison Licenses & Permits Updates Complete.", capId);
`^
ASA;Licenses!Clerk!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
var LicHoldSeqNum = null;
oContacts = aa.people.getCapContactByCapID(capId);
if (oContacts.getSuccess()) {
	ca = oContacts.getOutput();
	}

if (ca.length > 0) {
	for(rec in ca) if (ca[rec].getPeople().contactType == "License Holder") LicHoldSeqNum = ca[rec].getPeople().contactSeqNumber;
	logDebug("LicHolder Seq Num = " + LicHoldSeqNum);
	}

if (LicHoldSeqNum != null && LicHoldSeqNum != "") {
	contactSetPrimary(LicHoldSeqNum);
	} else {
	logDebug("License Holder NOT updated to primary contact");
	}

if ((cmnSubType != "Operator")) {
	include("EML;NewLicenseApp");
	}

if (currentUserID == "ITJBS") {
	showDebug = true;
	}
`^
ASA;Licenses!Clerk!AmusementDevice!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licenses!Clerk!AmusementDevice!NA;Fee");
`^
ASA;Licenses!Clerk!ClassABeerLiquor!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licensing!Clerk!Class A Beer Liquor!~;Fee");
include("CMN;Licensing!Clerk!Beer Liquor!~;Email");
`^
ASA;Licenses!Clerk!ClassBBeerLiquor!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licensing!Clerk!Class B Beer Liquor!~;Fee");
include("CMN;Licensing!Clerk!Beer Liquor!~;Email");
`^
ASA;Licenses!Clerk!HorseDrawnOrPedalCab!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licenses!Clerk!HorseDrawnOrPedalCab!NA;Fee");
`^
ASA;Licenses!Clerk!MallSecondHandDealer!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;Licenses!Clerk!MallSecondHandDealer!NA;Fee");
`^
ASA;Licenses!Clerk!Operator!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;MakeContactPrimary");
if (getAppSpecific("ADDITIONAL APPLICANT INFO.Do you need a provisional license") == "Yes") {
	provDate = dateAdd(null,60);
	editAppSpecific("OFFICE USE ONLY.Provisional Expiration Date", provDate);
	}

if (AInfo['OFFICE USE ONLY.Provisional Expiration Date'] != null) {
	editAppSpecific("ADDITIONAL APPLICANT INFO.Do you need a provisional license", "Yes");
	}

if (cap.isCreatedByACA() && getAppSpecific("ADDITIONAL APPLICANT INFO.Employer Paying Fees") == "No") {
	include("CMN;Licenses!Clerk!Operator!NA;Fee");
	}

if (!cap.isCreatedByACA()) {
	include("CMN;Licenses!Clerk!Operator!NA;Fee");
	}
`^
ASA;Licenses!Clerk!Operator!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
asiGroupArray = new Array("ATTESTATION", "OFFICE USE ONLY", "ARREST AND CONVICTION RECORD");
asiFieldArray = new Array("ADDITIONAL APPLICANT INFO.Citizenship", "ADDITIONAL APPLICANT INFO.If Temporary Resident, Employment Number", "ADDITIONAL APPLICANT INFO.Type of Qualification", "ADDITIONAL APPLICANT INFO.Beverage Server Training Completion Date", "ADDITIONAL APPLICANT INFO.Municipality", "ADDITIONAL APPLICANT INFO.Do you need a provisional license", "ADDITIONAL APPLICANT INFO.Birth Place (City and State)", "ADDITIONAL APPLICANT INFO.Sex", "ADDITIONAL APPLICANT INFO.Employer Paying Fees", "ADDITIONAL APPLICANT INFO.Employer Email", "ADDITIONAL APPLICANT INFO.Other names, aliases or birthdates ever used");
asiTableArray = new Array("PENDING TICKETS OR CONVICTIONS", "TICKETS OR CONVICTIONS");
if (AInfo['ADDITIONAL APPLICANT INFO.Date of Birth'] == null) {
	copyContacts(parentCapId, capId);
	}

if (AInfo['ADDITIONAL APPLICANT INFO.Date of Birth'] == null) {
	copyASIFieldsExcept(parentCapId, capId, asiGroupArray, asiFieldArray);
	}

if (AInfo['ADDITIONAL APPLICANT INFO.Date of Birth'] == null) {
	copyASITables(parentCapId, capId, asiTableArray);
	}

if (AInfo['ADDITIONAL APPLICANT INFO.Date of Birth'] == null) {
	aa.cap.createRenewalCap(parentCapId, capId, !cap.isCompleteCap());
	}

if (AInfo['ADDITIONAL APPLICANT INFO.Date of Birth'] == null) {
	aa.cap.updateAccessByACA(capId, "N");
	}

if (AInfo['ADDITIONAL APPLICANT INFO.Date of Birth'] != null && AInfo['ADDITIONAL APPLICANT INFO.Employer Paying Fees'] == "No") {
	include("CMN;Licenses!Clerk!Operator!Renewal;Fee");
	}
`^
ASA;Licenses!Clerk!Scrap-Recycling!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licenses!Clerk!Scrap-Recycling!NA;Fee");
`^
ASA;Licenses!Clerk!SecondHandDealer!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("cmn;Licenses!Clerk!SecondHandDealer!NA;Fee");
`^
ASA;Licenses!Clerk!Theatre!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licenses!Clerk!Theatre!NA;Fee");
`^
ASA;Licenses!Engineering!Prequalified Contractor!Na^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var catA = getAppSpecific("CATEGORIES.A");
if (catA == "CHECKED") {
	include("CMN;Licenses!Engineering!Prequalified Contractor!Na;Fee");
	}

updateAppStatus("Online Submittal", "Madison Licenses & Permits Updates Complete.", capId);
`^
ASA;Licenses!Engineering!Prequalified Contractor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
emptyRenewal = false;
var catA = getAppSpecific("CATEGORIES.A");
var catB = getAppSpecific("CATEGORIES.B");
var catC = getAppSpecific("CATEGORIES.C");
if (catA == null && catB == null && catC == null) {
	emptyRenewal = true;
	}

if (emptyRenewal) {
	copyContacts(parentCapId, capId);
	}

if (emptyRenewal) {
	copyASIFields(parentCapId, capId);
	}

if (emptyRenewal) {
	aa.cap.createRenewalCap(parentCapId, capId, !cap.isCompleteCap());
	}

if ((!publicUser || !emptyRenewal)) {
	pCapID = aa.cap.getProjectByChildCapID(capId, "Renewal", "Incomplete").getOutput();
	parentCapId = pCapID[0].getProjectID();
	tempCapId = capId;
	capId = parentCapId;
	licEditExpInfo("Pending", null);
	capId = tempCapId;
	}

if ((!publicUser || !emptyRenewal)) {
	updateAppStatus("Online Submittal", "Renewal Complete", parentCapId);
	logDebug("Before; " + AInfo['CATEGORIES.COI']);
	}

if (catA == "CHECKED") {
	include("CMN;Licenses!Engineering!Prequalified Contractor!Na;Fee");
	}

if (!emptyRenewal) {
	pConArray = getContactArray(parentCapId);
	}

if (!emptyRenewal) {
	for (pC in pConArray) include("CMN;Licenses!Engineering!Prequalified Contractor!Renewal;ContactRemove");
	}

if (!emptyRenewal) {
	copyContacts(capId, parentCapId);
	}

if (!emptyRenewal) {
	copyASIFields(capId, parentCapId);
	}

if (!emptyRenewal) {
	result = aa.cap.copyRenewCapDocument(capId, parentCapId, currentUserID);
	}
`^
ASA;Licenses!Fire!HazardousMaterials!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("EML;NewLicenseApp");
`^
ASA;Licenses!Fire!SpecialHazards!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licenses!Fire!SpecialHazards!NA;Fee");
include("EML;NewLicenseApp");
`^
ASA;Licenses!Fire!SpecialOccupancy!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licenses!Fire!SpecialOccupancy!NA;Fee");
include("EML;NewLicenseApp");
`^
ASA;Licenses!Health!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var LicHoldSeqNum = null;
checkSanitary = true;
include("CMN;UpdateDBA");
if (cmnSubType != "Temp Food Establishment") {
	include("EML;HEIntake");
	}

oContacts = aa.people.getCapContactByCapID(capId);
if (oContacts.getSuccess()) {
	ca = oContacts.getOutput();
	}

if (ca.length > 0) {
	for(rec in ca) if (ca[rec].getPeople().contactType == "License Holder") LicHoldSeqNum = ca[rec].getPeople().contactSeqNumber;
	debugObject(ca[rec]);
	}

if (LicHoldSeqNum != null && LicHoldSeqNum != "") {
	contactSetPrimary(LicHoldSeqNum);
	} else {
	logDebug("License Holder NOT updated to primary contact");
	}

if ((cmnSubType == "Beach" || cmnSubType == "BedAndBreakfast" || cmnSubType == "Campgrounds" || cmnSubType == "DischofNonStrmwtr" || cmnSubType == "FoodandDrink" || cmnSubType == "HotelMotelTRH" || cmnSubType == "MobileHomePark" || cmnSubType == "Outdoor Wood Boiler" || cmnSubType == "RecreationEducationCamps" || cmnSubType == "School" || cmnSubType == "SwimmingPool" || cmnSubType == "TattooAndOrBodyPiercing")) {
	include("EML;NewLicenseApp");
	}

if (appTypeString == "Licenses!Health!DischofNonStrmwtr!Madison") {
	checkSanitary = false;
	}

if (checkSanitary) {
	include("CMN;Permitting!Health;SanitaryHealthLicense");
	}

include("CMN;LicenseHolderUpdateFullNameWBusName");
include("CMN;ApplicantOrContactUpdateAppNameWDBAName");
`^
ASA;Licenses!Health!Campgrounds!DaneCounty^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licenses!Health!Campgrounds!DaneCounty;Fee");
`^
ASA;Licenses!Health!DischofNonStrmwtr!Madison^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licenses!Health!DischofNonStrmwtr!Madison;Fee");
`^
ASA;Licenses!Health!FoodandDrink!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licensing!Health!Food and Drink!~;LicenseFee");
`^
ASA;Licenses!Health!HotelMotelTRH!DaneCounty^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licenses!Health!HotelMotelTRH!DaneCounty;Fee");
`^
ASA;Licenses!Health!MobileHomePark!DaneCounty^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licenses!Health!MobileHomePark!DaneCounty;Fee");
`^
ASA;Licenses!Health!RecreationEducationCamps!DaneCounty^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licenses!Health!RecreationEducationCamps!DaneCounty;Fee");
`^
ASA;Licenses!Health!School!DaneCounty^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licensing!Health!School!Dane County;LicenseFee");
`^
ASA;Licenses!Health!School!Madison^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licensing!Health!School!Madison;LicenseFee");
`^
ASA;Licenses!Health!SwimmingPool!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licensing!Health!Swimming Pool!~;LicenseFee");
include("EML;HESwimmingPool");
`^
ASA;Licenses!Health!SwimmingPool!DaneCounty^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licenses!Health!SwimmingPool!DaneCounty;Fee");
`^
ASA;Licenses!Health!TattooAndOrBodyPiercing!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licensing!Health!Tattoo and Body Piercing!~;LicenseFee");
`^
ASA;Licenses!Health!Temp Food Establishment!DaneCounty^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licenses!Health!Temp Food Establishment!DaneCounty;Fees");
if (!publicUser) {
	include("EML;HEIntake");
	}

if (currentUserID == "ITJBS") {
	showDebug = true;
	}
`^
ASA;Licenses!Police!Taxi Driver!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licensing!Police!Taxi Driver!NA;Fee");
`^
ASA;Licenses!Treasurer!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
var bHasCitation = false;
if (cmnSubType.toString().slice(0,3) == "Cat" && AInfo['ANIMAL DETAILS.I have received a citation for failure to license my cat within the last 45 days'] == "CHECKED") {
	bHasCitation = true;
	}

if (cmnSubType.toString().slice(0,3) == "Dog" && AInfo['ANIMAL DETAILS.I have received a citation for failure to license my dog within the last 45 days'] == "CHECKED") {
	bHasCitation = true;
	}

if (!publicUser && cmnCategory != "Renewal" && currentUserID !="TRMRA" && (cmnSubType == "Dog Registration" || cmnSubType == "Cat Registration" || cmnSubType == "Chicken Owner" )) {
	aa.set.add("PETLIC",capId);
	}

if (!publicUser && cmnCategory != "Renewal" && currentUserID =="TRMRA" && (cmnSubType == "Dog Registration" || cmnSubType == "Cat Registration" || cmnSubType == "Chicken Owner" )) {
	aa.set.add("PETLIC2",capId);
	}

if (!publicUser && bHasCitation && (cmnSubType == "Cat Registration" || cmnSubType == "Dog Registration")) {
	include("EML;Licenses!Treasurer!~!~;PetLicCitation");
	}

if (!publicUser && cmnCategory != "Renewal") {
	include("CMN;LICENSE;ExpDec31");
	}
`^
ASA;Licenses!Treasurer!Cat Registration!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licenses!Treasurer!Cat Registration!NA;Fee");
`^
ASA;Licenses!Treasurer!Cat Registration!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
age = 0;
if (AInfo['ANIMAL DETAILS.Name of Cat'] == null) {
	copyContacts(parentCapId, capId);
	}

if (AInfo['ANIMAL DETAILS.Name of Cat'] == null) {
	copyASIFields(parentCapId, capId, "OFFICE USE ONLY");
	}

if (AInfo['ANIMAL DETAILS.Name of Cat'] == null) {
	copyAddresses(parentCapId, capId);
	}

if (AInfo['ANIMAL DETAILS.Name of Cat'] == null) {
	aa.cap.createRenewalCap(parentCapId, capId, !cap.isCompleteCap());
	}

if (AInfo['ANIMAL DETAILS.Name of Cat'] == null) {
	editAppSpecific("ANIMAL DETAILS.License Number", "", capId);
	}

if (AInfo['ANIMAL DETAILS.Name of Cat'] == null) {
	age = getAppSpecific("ANIMAL DETAILS.Age in Years", parentCapId);
	}

if ((age == null || age == "")) {
	age = 0;
	age = parseInt(age) + 1;
	} else {
	age = parseInt(age) + 1;
	}

if (AInfo['ANIMAL DETAILS.Name of Cat'] == null) {
	editAppSpecific("ANIMAL DETAILS.Age in Years", age, capId);
	}

if (AInfo['ANIMAL DETAILS.Name of Cat'] == null) {
	editAppSpecific("ANIMAL DETAILS.Cat is 5 Months Old or Less", "", capId);
	}

if (AInfo['ANIMAL DETAILS.Name of Cat'] == null) {
	editAppSpecific("ANIMAL DETAILS.I have had my cat in the City of Madison for 30 days or less", "", capId);
	}

if (AInfo['ANIMAL DETAILS.Name of Cat'] == null) {
	editAppSpecific("ANIMAL DETAILS.I have received a citation for failure to license my cat within the last 45 days", "", capId);
	}

if (publicUser == true &&  AInfo['ANIMAL DETAILS.Name of Cat'] != null) {
	include("CMN;Licenses!Treasurer!Cat Registration!NA;Fee");
	}
`^
ASA;Licenses!Treasurer!Chicken Owner!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licenses!Treasurer!Chicken Owner!NA;Fee");
`^
ASA;Licenses!Treasurer!Chicken Owner!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['LICENSE DETAILS.Livestock Premises Registration Number'] == null) {
	copyContacts(parentCapId, capId);
	}

if (AInfo['LICENSE DETAILS.Livestock Premises Registration Number'] == null) {
	copyASIFields(parentCapId, capId, "REGISTRANT AGREEMENTS");
	}

if (AInfo['LICENSE DETAILS.Livestock Premises Registration Number'] == null) {
	copyAddresses(parentCapId, capId);
	}

if (AInfo['LICENSE DETAILS.Livestock Premises Registration Number'] == null) {
	copyOwner(parentCapId, capId);
	}

if (AInfo['LICENSE DETAILS.Livestock Premises Registration Number'] == null) {
	aa.cap.createRenewalCap(parentCapId, capId, !cap.isCompleteCap());
	}

if (AInfo['LICENSE DETAILS.Livestock Premises Registration Number'] == null) {
	editAppSpecific("LICENSE DETAILS.License Number", "", capId);
	}

if (publicUser == true && AInfo['LICENSE DETAILS.Livestock Premises Registration Number'] != null) {
	include("CMN;Licenses!Treasurer!Chicken Owner!NA;Fee");
	}
`^
ASA;Licenses!Treasurer!Dog Registration!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licenses!Treasurer!Dog Registration!NA;Fee");
`^
ASA;Licenses!Treasurer!Dog Registration!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
age = 0;
asiGroupArray = new Array("OFFICE USE ONLY", "DOG PARK PERMIT REQUEST");
asiFieldArray = new Array("ANIMAL DETAILS.License Number", "ANIMAL DETAILS.Age in Years", "ANIMAL DETAILS.Dog is 5 Months Old or Less", "ANIMAL DETAILS.I have had my dog in the City of Madison for 30 days or less", "ANIMAL DETAILS.I have received a citation for failure to license my dog within the last 45 days");
if (AInfo['ANIMAL DETAILS.Name of Dog'] == null) {
	copyContacts(parentCapId, capId);
	}

if (AInfo['ANIMAL DETAILS.Name of Dog'] == null) {
	copyASIFieldsExcept(parentCapId, capId, asiGroupArray, asiFieldArray);
	}

if (AInfo['ANIMAL DETAILS.Name of Dog'] == null) {
	copyAddresses(parentCapId, capId);
	}

if (AInfo['ANIMAL DETAILS.Name of Dog'] == null) {
	aa.cap.createRenewalCap(parentCapId, capId, !cap.isCompleteCap());
	}

if (AInfo['ANIMAL DETAILS.Name of Dog'] == null) {
	age = getAppSpecific("ANIMAL DETAILS.Age in Years", parentCapId);
	}

if ((age == null || age == "")) {
	age = 0;
	age = parseInt(age) + 1;
	} else {
	age = parseInt(age) + 1;
	}

if (AInfo['ANIMAL DETAILS.Name of Dog'] == null) {
	editAppSpecific("ANIMAL DETAILS.Age in Years", age, capId);
	}

if (AInfo['ANIMAL DETAILS.Name of Dog'] == null) {
	editAppSpecific("DOG PARK PERMIT REQUEST.Number of Replacements Requested - Annual Permits Only", 0, capId);
	}

if (AInfo['ANIMAL DETAILS.Name of Dog'] == null) {
	editAppSpecific("DOG PARK PERMIT REQUEST.Number of Senior or Disabled Annual Permits Requested for This Dog", 0, capId);
	}

if (publicUser == true &&  AInfo['ANIMAL DETAILS.Name of Dog'] != null) {
	include("CMN;Licenses!Treasurer!Dog Registration!NA;Fee");
	}
`^
ASA;Licenses!Treasurer!Kennel!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['KENNEL SPECIFIC DETAILS.Number of Dogs in Kennel'] == null) {
	copyContacts(parentCapId, capId);
	}

if (AInfo['KENNEL SPECIFIC DETAILS.Number of Dogs in Kennel'] == null) {
	copyASIFields(parentCapId, capId, "OFFICE USE ONLY");
	}

if (AInfo['KENNEL SPECIFIC DETAILS.Number of Dogs in Kennel'] == null) {
	copyAddresses(parentCapId, capId);
	}

if (AInfo['KENNEL SPECIFIC DETAILS.Number of Dogs in Kennel'] == null) {
	aa.cap.createRenewalCap(parentCapId, capId, !cap.isCompleteCap());
	}
`^
ASA;Licenses!Vending!HighDensityVending!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (publicUser == false) {
	include("CMN;Licenses!Vending!~!~;ExpirationDate");
	}

if (publicUser == false) {
	streetVendorCap = aa.cap.getCapID(AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number']);
	}

if (publicUser == false && streetVendorCap.getSuccess()) {
	addParent(AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number']);
	}

if (publicUser == false) {
	reportName ="Vending Application";
	include("EML;Licenses!Vending!~!~;AppSubmitted");
	}

if (publicUser == false) {
	licEditExpInfo("Pending", null);
	}
`^
ASA;Licenses!Vending!HighDensityVending!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] == null) {
	copyContacts(parentCapId, capId);
	}

if (AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] == null) {
	copyASIFields(parentCapId, capId, "OFFICE USE ONLY", "Site Awarded");
	}

if (AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] == null) {
	copyASITables(parentCapId, capId);
	}

if (AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] == null) {
	aa.cap.createRenewalCap(parentCapId, capId, !cap.isCompleteCap());
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] != null)) {
	aa.cap.updateAccessByACA(capId, "N");
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] != null)) {
	pCapID = aa.cap.getProjectByChildCapID(capId, "Renewal", "Incomplete").getOutput();
	parentCapId = pCapID[0].getProjectID();
	tempCapId = capId;
	capId = parentCapId;
	licEditExpInfo("Pending", null);
	capId = tempCapId;
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] != null)) {
	updateAppStatus("Online Submittal", "Renewal Complete", parentCapId);
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] != null)) {
	aa.workflow.deleteAndAssignWorkflow(parentCapId, "LICVEN", false);
	}
`^
ASA;Licenses!Vending!LateNightVendor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (publicUser == false) {
	include("CMN;Licenses!Vending!~!~;ExpirationDate");
	}

if (publicUser == false) {
	streetVendorCap = aa.cap.getCapID(AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number']);
	}

if (publicUser == false && streetVendorCap.getSuccess()) {
	addParent(AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number']);
	}

if (publicUser == false) {
	reportName ="Vending Application";
	include("EML;Licenses!Vending!~!~;AppSubmitted");
	}

if (publicUser == false) {
	licEditExpInfo("Pending", null);
	}
`^
ASA;Licenses!Vending!LateNightVendor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] == null) {
	copyContacts(parentCapId, capId);
	}

if (AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] == null) {
	copyASIFields(parentCapId, capId, "OFFICE USE ONLY", "ATTESTATION");
	}

if (AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] == null) {
	copyASITables(parentCapId, capId);
	}

if (AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] == null) {
	aa.cap.createRenewalCap(parentCapId, capId, !cap.isCompleteCap());
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] != null)) {
	aa.cap.updateAccessByACA(capId, "N");
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] != null)) {
	pCapID = aa.cap.getProjectByChildCapID(capId, "Renewal", "Incomplete").getOutput();
	parentCapId = pCapID[0].getProjectID();
	tempCapId = capId;
	capId = parentCapId;
	licEditExpInfo("Pending", null);
	capId = tempCapId;
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] != null)) {
	updateAppStatus("Online Submittal", "Renewal Complete", parentCapId);
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] != null)) {
	aa.workflow.deleteAndAssignWorkflow(parentCapId, "LICVEN", false);
	}
`^
ASA;Licenses!Vending!MallCraftVendor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (publicUser == false) {
	include("CMN;Licenses!Vending!~!~;ExpirationDate");
	}

if (publicUser == false) {
	streetVendorCap = aa.cap.getCapID(AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number']);
	}

if (publicUser == false && streetVendorCap.getSuccess()) {
	addParent(AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number']);
	}

if (publicUser == false) {
	reportName ="Vending Application";
	include("EML;Licenses!Vending!~!~;AppSubmitted");
	}

if (publicUser == false) {
	licEditExpInfo("Pending", null);
	}
`^
ASA;Licenses!Vending!MallCraftVendor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] == null) {
	copyContacts(parentCapId, capId);
	}

if (AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] == null) {
	copyASIFields(parentCapId, capId, "OFFICE USE ONLY", "ATTESTATION");
	}

if (AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] == null) {
	copyASITables(parentCapId, capId);
	}

if (AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] == null) {
	aa.cap.createRenewalCap(parentCapId, capId, !cap.isCompleteCap());
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] != null)) {
	aa.cap.updateAccessByACA(capId, "N");
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] != null)) {
	pCapID = aa.cap.getProjectByChildCapID(capId, "Renewal", "Incomplete").getOutput();
	parentCapId = pCapID[0].getProjectID();
	tempCapId = capId;
	capId = parentCapId;
	licEditExpInfo("Pending", null);
	capId = tempCapId;
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] != null)) {
	updateAppStatus("Online Submittal", "Renewal Complete", parentCapId);
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] != null)) {
	aa.workflow.deleteAndAssignWorkflow(parentCapId, "LICVEN", false);
	}
`^
ASA;Licenses!Vending!MallFoodVendor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (publicUser == false) {
	include("CMN;Licenses!Vending!~!~;ExpirationDate");
	}

if (publicUser == false) {
	streetVendorCap = aa.cap.getCapID(AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number']);
	}

if (publicUser == false && streetVendorCap.getSuccess()) {
	addParent(AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number']);
	}

if (publicUser == false) {
	reportName ="Vending Application";
	include("EML;Licenses!Vending!~!~;AppSubmitted");
	}

if (publicUser == false) {
	licEditExpInfo("Pending", null);
	}
`^
ASA;Licenses!Vending!MallFoodVendor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] == null) {
	copyContacts(parentCapId, capId);
	}

if (AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] == null) {
	copyASIFields(parentCapId, capId, "OFFICE USE ONLY", "ATTESTATION");
	}

if (AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] == null) {
	copyASITables(parentCapId, capId);
	}

if (AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] == null) {
	aa.cap.createRenewalCap(parentCapId, capId, !cap.isCompleteCap());
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] != null)) {
	aa.cap.updateAccessByACA(capId, "N");
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] != null)) {
	pCapID = aa.cap.getProjectByChildCapID(capId, "Renewal", "Incomplete").getOutput();
	parentCapId = pCapID[0].getProjectID();
	tempCapId = capId;
	capId = parentCapId;
	licEditExpInfo("Pending", null);
	capId = tempCapId;
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] != null)) {
	updateAppStatus("Online Submittal", "Renewal Complete", parentCapId);
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] != null)) {
	aa.workflow.deleteAndAssignWorkflow(parentCapId, "LICVEN", false);
	}
`^
ASA;Licenses!Vending!MerchantVendor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['MANAGEMENT INFORMATION.Name of Manager'] == null) {
	copyContacts(parentCapId, capId);
	}

if (AInfo['MANAGEMENT INFORMATION.Name of Manager'] == null) {
	copyASIFields(parentCapId, capId, "ATTESTATION", "Statements made in application are true to the best of my knowledge. I will abide by MGO 9.13.");
	}

if (AInfo['MANAGEMENT INFORMATION.Name of Manager'] == null) {
	aa.cap.createRenewalCap(parentCapId, capId, !cap.isCompleteCap());
	}

if ((publicUser == false || AInfo['MANAGEMENT INFORMATION.Name of Manager'] != null)) {
	aa.cap.updateAccessByACA(capId, "N");
	}

if ((publicUser == false || AInfo['MANAGEMENT INFORMATION.Name of Manager'] != null)) {
	pCapID = aa.cap.getProjectByChildCapID(capId, "Renewal", "Incomplete").getOutput();
	parentCapId = pCapID[0].getProjectID();
	tempCapId = capId;
	capId = parentCapId;
	licEditExpInfo("Pending", null);
	capId = tempCapId;
	}

if ((publicUser == false || AInfo['MANAGEMENT INFORMATION.Name of Manager'] != null)) {
	updateAppStatus("Online Submittal", "Renewal Complete", parentCapId);
	}

if ((publicUser == false || AInfo['MANAGEMENT INFORMATION.Name of Manager'] != null)) {
	aa.workflow.deleteAndAssignWorkflow(parentCapId, "LICVEN", false);
	}
`^
ASA;Licenses!Vending!SidewalkCafe!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (publicUser == false) {
	include("CMN;Licenses!Vending!~!~;ExpirationDate");
	}

if (publicUser == false) {
	reportName ="Vending Application";
	include("EML;Licenses!Vending!~!~;AppSubmitted");
	}

if (publicUser == false) {
	licEditExpInfo("Pending", null);
	}
`^
ASA;Licenses!Vending!SidewalkCafe!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['APPLICANT INFORMATION.Wisconsin Seller's Permit Number'] == null) {
	copyContacts(parentCapId, capId);
	}

if (AInfo['APPLICANT INFORMATION.Wisconsin Seller's Permit Number'] == null) {
	copyASIFields(parentCapId, capId, "ATTESTATION", "Statements made in application are true to the best of my knowledge. I will abide by MGO 9.13.");
	}

if (AInfo['APPLICANT INFORMATION.Wisconsin Seller's Permit Number'] == null) {
	aa.cap.createRenewalCap(parentCapId, capId, !cap.isCompleteCap());
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.Wisconsin Seller's Permit Number'] != null)) {
	aa.cap.updateAccessByACA(capId, "N");
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.Wisconsin Seller's Permit Number'] != null)) {
	pCapID = aa.cap.getProjectByChildCapID(capId, "Renewal", "Incomplete").getOutput();
	parentCapId = pCapID[0].getProjectID();
	tempCapId = capId;
	capId = parentCapId;
	licEditExpInfo("Pending", null);
	capId = tempCapId;
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.Wisconsin Seller's Permit Number'] != null)) {
	updateAppStatus("Online Submittal", "Renewal Complete", parentCapId);
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.Wisconsin Seller's Permit Number'] != null)) {
	aa.workflow.deleteAndAssignWorkflow(parentCapId, "LICVEN", false);
	}
`^
ASA;Licenses!Vending!SoutheastCampusVending!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (publicUser == false) {
	include("CMN;Licenses!Vending!~!~;ExpirationDate");
	}

if (publicUser == false) {
	streetVendorCap = aa.cap.getCapID(AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number']);
	}

if (publicUser == false && streetVendorCap.getSuccess()) {
	addParent(AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number']);
	}

if (publicUser == false) {
	reportName ="Vending Application";
	include("EML;Licenses!Vending!~!~;AppSubmitted");
	}

if (publicUser == false) {
	licEditExpInfo("Pending", null);
	}
`^
ASA;Licenses!Vending!SoutheastCampusVending!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] == null) {
	copyContacts(parentCapId, capId);
	}

if (AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] == null) {
	copyASIFields(parentCapId, capId, "ATTESTATION", "OFFICE USE ONLY");
	}

if (AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] == null) {
	copyASITables(parentCapId, capId);
	}

if (AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] == null) {
	aa.cap.createRenewalCap(parentCapId, capId, !cap.isCompleteCap());
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] != null)) {
	aa.cap.updateAccessByACA(capId, "N");
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] != null)) {
	pCapID = aa.cap.getProjectByChildCapID(capId, "Renewal", "Incomplete").getOutput();
	parentCapId = pCapID[0].getProjectID();
	tempCapId = capId;
	capId = parentCapId;
	licEditExpInfo("Pending", null);
	capId = tempCapId;
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] != null)) {
	updateAppStatus("Online Submittal", "Renewal Complete", parentCapId);
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number'] != null)) {
	aa.workflow.deleteAndAssignWorkflow(parentCapId, "LICVEN", false);
	}
`^
ASA;Licenses!Vending!StreetVendor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (publicUser == false) {
	include("CMN;Licenses!Vending!~!~;ExpirationDate");
	}

if (publicUser == false) {
	reportName ="Vending Application";
	include("EML;Licenses!Vending!~!~;AppSubmitted");
	}

if (publicUser == false) {
	licEditExpInfo("Pending", null);
	}
`^
ASA;Licenses!Vending!StreetVendor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['APPLICANT INFORMATION.Wisconsin Seller's Permit Number'] == null) {
	copyContacts(parentCapId, capId);
	}

if (AInfo['APPLICANT INFORMATION.Wisconsin Seller's Permit Number'] == null) {
	copyASIFields(parentCapId, capId, "ATTESTATION");
	}

if (AInfo['APPLICANT INFORMATION.Wisconsin Seller's Permit Number'] == null) {
	aa.cap.createRenewalCap(parentCapId, capId, !cap.isCompleteCap());
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.Wisconsin Seller's Permit Number']) != null) {
	aa.cap.updateAccessByACA(capId, "N");
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.Wisconsin Seller's Permit Number']) != null) {
	pCapID = aa.cap.getProjectByChildCapID(capId, "Renewal", "Incomplete").getOutput();
	parentCapId = pCapID[0].getProjectID();
	tempCapId = capId;
	capId = parentCapId;
	licEditExpInfo("Pending", null);
	capId = tempCapId;
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.Wisconsin Seller's Permit Number']) != null) {
	updateAppStatus("Online Submittal", "Renewal Complete", parentCapId);
	}

if ((publicUser == false || AInfo['APPLICANT INFORMATION.Wisconsin Seller's Permit Number']) != null) {
	aa.workflow.deleteAndAssignWorkflow(parentCapId, "LICVEN", false);
	}
`^
ASA;Licenses!Vending!TOSVOD!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = true;
`^
ASA;Permitting!Building!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;CheckGISNoticeCondition");
`^
ASA;Permitting!Building!Commercial!Construction^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Building!Commercial!Construction;Fee");
`^
ASA;Permitting!Building!Commercial!New Electrical^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Commercial!New Electrical;Fee");
`^
ASA;Permitting!Building!Commercial!New HVAC^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Commercial!New HVAC;Fee");
`^
ASA;Permitting!Building!Commercial!New Plumbing^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Commercial!New Plumbing;Fee");
include("CMN;Permitting!Building!Commercial!New Plumbing;ASITotal");
`^
ASA;Permitting!Building!Commercial!Raze^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Commercial!Raze;Fee");
`^
ASA;Permitting!Building!Industrial!Construction^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Industrial!Construction;Fee");
`^
ASA;Permitting!Building!Industrial!New Electrical^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Industrial!New Electrical;Fee");
`^
ASA;Permitting!Building!Industrial!New HVAC^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Industrial!New HVAC;Fee");
`^
ASA;Permitting!Building!Industrial!New Plumbing^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Industrial!New Plumbing;Fee");
include("CMN;Permitting!Building!Industrial!New Plumbing;ASITotal");
`^
ASA;Permitting!Building!Industrial!Raze^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Industrial!Raze;Fee");
`^
ASA;Permitting!Building!Moving!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Moving!NA;Fee");
`^
ASA;Permitting!Building!RepairReplace!Construction^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;LOCALLANDMARK");
if (publicUser == false) {
	include("CMN;Permitting!Building!RepairReplace!Construction;Fee");
	} else {
	include("CMN;Permitting!Building!RepairReplace!Construction;FeeACA");
	}
`^
ASA;Permitting!Building!RepairReplace!Electrical^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (publicUser) {
	include("CMN;AddParcelAndOwner");
	}

include("CMN;Permitting!Building!RepairReplace!Electrical;Fee");
`^
ASA;Permitting!Building!RepairReplace!HVAC^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (publicUser) {
	include("CMN;AddParcelAndOwner");
	}

include("cmn;Permitting!Building!RepairReplace!HVAC;Fee");
`^
ASA;Permitting!Building!RepairReplace!Plumbing^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (publicUser) {
	include("CMN;AddParcelAndOwner");
	}

include("CMN;Permitting!Building!RepairReplace!Plumbing;Fee");
`^
ASA;Permitting!Building!Residential!Construction^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;LOCALLANDMARK");
if (publicUser == false) {
	include("CMN;Permitting!Building!Residential!Construction;Fee");
	} else {
	include("CMN;Permitting!Building!Residential!Construction;FeeACA");
	}
`^
ASA;Permitting!Building!Residential!New Electrical^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Residential!New Electrical;Fee");
`^
ASA;Permitting!Building!Residential!New HVAC^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Residential!New HVAC;Fee");
`^
ASA;Permitting!Building!Residential!New Plumbing^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Residential!New Plumbing;Fee");
`^
ASA;Permitting!Building!Residential!Raze^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Residential!Raze;Fee");
`^
ASA;Permitting!Building!Variance!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Variance!NA;Fee");
`^
ASA;Permitting!Clerk!AnimalTrapping!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
addFeeSubmitted = false;
if (isTaskActive("Intake") && feeExists("TRAPSTD") == false) {
	addFeeSubmitted = true;
	}

if (addFeeSubmitted) {
	addFee("TRAPSTD","PERTRAP","FINAL",1,"Y");
	}
`^
ASA;Permitting!Clerk!Close Out Sale!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Clerk!Close Out Sale!NA;Fee");
`^
ASA;Permitting!Clerk!Picnic Beer!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Clerk!Picnic Beer!NA;Fee");
`^
ASA;Permitting!Clerk!Solicitor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Clerk!Solicitor!NA;Fee");
`^
ASA;Permitting!Engineering!Erosion Control!100LfDitchSwaleChannel^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!Erosion Control!100LfDitchSwaleChannel;Fee");
`^
ASA;Permitting!Engineering!Erosion Control!125LfNewPubPrivRoadDrive^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!Erosion Control!125LfNewPubPrivRoadDrive;Fee");
`^
ASA;Permitting!Engineering!Erosion Control!12PercentSlope^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!Erosion Control!12PercentSlope;Fee");
`^
ASA;Permitting!Engineering!Erosion Control!300LfUtilityInstall^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!Erosion Control!300LfUtilityInstall;Fee");
`^
ASA;Permitting!Engineering!Erosion Control!4000 Disturbed^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!Erosion Control!4000 Disturbed;Fee");
`^
ASA;Permitting!Engineering!Erosion Control!400CyCutFill^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!Erosion Control!400CyCutFill;Fee");
`^
ASA;Permitting!Engineering!Erosion Control!HighRiskPerAdminAuth^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!Erosion Control!HighRiskPerAdminAuth;Fee");
`^
ASA;Permitting!Engineering!Erosion Control!Inspection^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
rsClone = false;
tblErosionPermit = loadASITable("EROSION");
if (tblErosionPermit[0] == undefined && publicUser == false) {
	rsClone = true;
	}

if (rsClone && publicUser == false) {
	include("CMN;Permitting!Engineering!Erosion Control!Inspection;Clone");
	}

if (rsClone == false && publicUser == false) {
	include("CMN;Permitting!Engineering!Erosion Control!Inspection;BMPFail");
	include("CMN;Permitting!Engineering!Erosion Control!Inspection;UpdateParent");
	}

if (currentUserID == "ITJBS") {
	showDebug = true;
	}
`^
ASA;Permitting!Engineering!Erosion Control!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!Erosion Control!NA;Fee");
ErosionPermitASIT = new Array();
ErosionPermitASITField = new Array();
if (capIDString != null) {
	ErosionPermitASITField["PermitNumber"] = "" + capIDString;
	ErosionPermitASIT.push(ErosionPermitASITField);
	addASITable("EROSION",ErosionPermitASIT);
	}
`^
ASA;Permitting!Engineering!Erosion Control!PublicSRHConstReconst^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!Erosion Control!PublicSRHConstReconst;Fee");
`^
ASA;Permitting!Engineering!Erosion Control!SubdivisionPlatCSM^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!Erosion Control!SubdivisionPlatCSM;Fee");
`^
ASA;Permitting!Engineering!ROW!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = true;
var ApplicantSeqNum = null;
isFeeExempt = "N";
if (!publicUser) {
	closeTask("Intake", "Submitted","Closed by Script","");
	}

include("CMN;Permitting!Engineering!ROW!NA;GetFeeExempt");
if (isFeeExempt == "Y") {
	removeAllFees(capId);
	}

oContacts = aa.people.getCapContactByCapID(capId);
if (oContacts.getSuccess()) {
	ca = oContacts.getOutput();
	}

if (ca.length > 0) {
	for(rec in ca) if (ca[rec].getPeople().contactType == "Applicant") ApplicantSeqNum = ca[rec].getPeople().contactSeqNumber;
	logDebug("Applicant Seq Num = " + ApplicantSeqNum);
	}

if (ApplicantSeqNum != null && ApplicantSeqNum != "") {
	contactSetPrimary(ApplicantSeqNum);
	} else {
	logDebug("Applicant NOT updated to primary contact");
	}
`^
ASA;Permitting!Engineering!Sewer Addition Meter!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!~!NA;CalculateExpireDate");
include("CMN;Permitting!Engineering!Sewer Addition Meter!NA;CreateFees");
`^
ASA;Permitting!Engineering!Sewer Deduct Meter!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!~!NA;CalculateExpireDate");
include("CMN;Permitting!Engineering!Sewer Deduct Meter!NA;CreateFees");
`^
ASA;Permitting!Engineering!Sewer Plug!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (!publicUser && AInfo['OFFICE USE ONLY.Application Incomplete'] == "CHECKED") {
	updateTask("Intake", "Additional Info Required", "This task was automatically set to Additional info Required because the application is not complete and it was entered internally.", "");
	} else {
	closeTask("Intake", "Application Accepted", "This task was automatically closed because the application is complete and it was entered internally.", "");
	}
`^
ASA;Permitting!Engineering!StormWaterManagement!AcreDistLess20kImpvsArea^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!StormWaterManagement!AcreDistLess20kImpvsArea;Fee");
`^
ASA;Permitting!Engineering!StormWaterManagement!Addn20kImperviousArea^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!StormWaterManagement!Addn20kImperviousArea;Fee");
`^
ASA;Permitting!Engineering!StormWaterManagement!HighRskExcCapPerAdmAuth^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!StormWaterManagement!HighRskExcCapPerAdmAuth;Fee");
`^
ASA;Permitting!Engineering!StormWaterManagement!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!StormWaterManagement!NA");
`^
ASA;Permitting!Engineering!StormWaterManagement!NewSt20kImpvsNoPlatCSM^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!StormWaterManagement!NewSt20kImpvsNoPlatCSM;Fee");
`^
ASA;Permitting!Engineering!StormWaterManagement!Redevelopment^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!StormWaterManagement!Redevelopment;Fee");
`^
ASA;Permitting!Engineering!StormWaterManagement!SubdivisionPlatCSM^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!StormWaterManagement!SubdivisionPlatCSM;Fee");
`^
ASA;Permitting!Engineering!Street Occupancy!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!Street Occupancy!NA;Fee");
if (AInfo['GENERAL INFORMATION.Excavation Will Take Place Within 5 Ft. of Terrace Tree'] == "CHECKED") {
	include("CMN;Permitting!Engineering!Street Occupancy!NA;ForestryEmail");
	}

if (AInfo['REVIEWERS COMMENTS.Illuminated covered walkways are required'] == "CHECKED") {
	include("CMN;Permitting!Engineering!Street Occupancy!NA;BiEmail");
	}

if (AInfo['REVIEWERS COMMENTS.Erosion control plan is required'] == "CHECKED") {
	include("CMN;Permitting!Engineering!Street Occupancy!NA;ErocEmail");
	}
`^
ASA;Permitting!Engineering!Street Terrace!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
genAppFee = true;
include("CMN;Permitting!Engineering!Street Terrace!NA;Fee");
`^
ASA;Permitting!Fire!AccessControlEgress!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Fire!AccessControlEgress!NA;Fee");
`^
ASA;Permitting!Fire!Alarm!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
bFireCondFlag = false;
if (publicUser == false) {
	include("CMN;Permitting!Fire!Alarm!NA;Fee");
	}

if (publicUser == true) {
	include("CMN;PermFireAddParcelACA");
	}

if (publicUser == false) {
	iCnt = 0;
	valDescr = "";
	bFireCondFlag = false;
	}

if (publicUser == false && valDescr != undefined) {
	include("CMN;LoadFireASITConditions");
	}

if (bFireCondFlag == true && publicUser == false) {
	logDebug("~~~ Flag is true;
	file CMN;LoadFireASITConditions is available.");
	} else {
	logDebug("~~~ Flag is false;
	file CMN;LoadFireASITConditions is NOT available.");
	}

if (bFireCondFlag == true && publicUser == false) {
	while (valDescr != undefined && iCnt < 21) include("CMN;LoadFireASITConditions");
	}

logDebug("While loop has completed.");
if (currentUserID == "ITJBS") {
	showDebug = true;
	}
`^
ASA;Permitting!Fire!AltFireSuppression!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
bFireCondFlag = false;
if (publicUser == false) {
	include("CMN;Permitting!Fire!AltFireSuppression!NA;Fee");
	}

if (publicUser == true) {
	include("CMN;PermFireAddParcelACA");
	}

if (publicUser == false) {
	iCnt = 0;
	valDescr = "";
	bFireCondFlag = false;
	}

logDebug("IMPORTANT; branch script MUST be enabled, or else this script will be caught in infinite loop.");
if (publicUser == false && valDescr != undefined) {
	include("CMN;LoadFireASITConditions");
	}

if (bFireCondFlag == true) {
	logDebug("~~~ Flag is true;
	file CMN;LoadFireASITConditions is available.");
	} else {
	logDebug("~~~ Flag is false;
	file CMN;LoadFireASITConditions is NOT available.");
	}

if (bFireCondFlag == true && publicUser == false) {
	while (valDescr != undefined && iCnt < 21) include("CMN;LoadFireASITConditions");
	}
`^
ASA;Permitting!Fire!ControlledEgress!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
bFireCondFlag = false;
if (publicUser == false) {
	include("CMN;Permitting!Fire!ControlledEgress!NA;Fee");
	}

if (publicUser == true) {
	include("CMN;PermFireAddParcelACA");
	}

if (publicUser == false) {
	iCnt = 0;
	valDescr = "";
	bFireCondFlag = false;
	}

logDebug("IMPORTANT; branch script MUST be enabled, or else this script will be caught in infinite loop.");
if (publicUser == false && valDescr != undefined) {
	include("CMN;LoadFireASITConditions");
	}

if (bFireCondFlag == true) {
	logDebug("~~~ Flag is true;
	file CMN;LoadFireASITConditions is available.");
	} else {
	logDebug("~~~ Flag is false;
	file CMN;LoadFireASITConditions is NOT available.");
	}

if (bFireCondFlag == true && publicUser == false) {
	while (valDescr != undefined && iCnt < 21) include("CMN;LoadFireASITConditions");
	}
`^
ASA;Permitting!Fire!CoveredMall!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Fire!CoveredMall!NA;Fee");
`^
ASA;Permitting!Fire!DelayedEgress!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Fire!DelayedEgress!NA;Fee");
`^
ASA;Permitting!Fire!Elevator!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Fire!Elevator!~;Conveyance");
`^
ASA;Permitting!Fire!FireCommandCenter!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Fire!FireCommandCenter!NA;Fee");
`^
ASA;Permitting!Fire!HighPiledStorage!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Fire!HighPiledStorage!NA;Fee");
`^
ASA;Permitting!Fire!KitchenHood!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
bFireCondFlag = false;
if (publicUser == false) {
	include("CMN;Permitting!Fire!KitchenHood!NA;Fee");
	}

if (publicUser == true) {
	include("CMN;PermFireAddParcelACA");
	}

if (publicUser == false) {
	iCnt = 0;
	valDescr = "";
	bFireCondFlag = false;
	}

logDebug("IMPORTANT; branch script MUST be enabled, or else this script will be caught in infinite loop.");
if (publicUser == false && valDescr != undefined) {
	include("CMN;LoadFireASITConditions");
	}

if (bFireCondFlag == true) {
	logDebug("~~~ Flag is true;
	file CMN;LoadFireASITConditions is available.");
	} else {
	logDebug("~~~ Flag is false;
	file CMN;LoadFireASITConditions is NOT available.");
	}

if (bFireCondFlag == true && publicUser == false) {
	while (valDescr != undefined && iCnt < 21) include("CMN;LoadFireASITConditions");
	}
`^
ASA;Permitting!Fire!SmokeControlPanels!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Fire!SmokeControlPanels!NA;Fee");
`^
ASA;Permitting!Fire!SmokeHeatVents!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Fire!SmokeHeatVents!NA;Fee");
`^
ASA;Permitting!Fire!Sprinkler!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
bFireCondFlag = false;
if (publicUser == false) {
	include("CMN;Permitting!Fire!Sprinkler!NA;Fee");
	}

if (publicUser == true) {
	include("CMN;PermFireAddParcelACA");
	}

if (publicUser == false) {
	iCnt = 0;
	valDescr = "";
	}

logDebug("IMPORTANT; branch script MUST be enabled, or else this script will be caught in infinite loop.");
if (publicUser == false && valDescr != undefined) {
	include("CMN;LoadFireASITConditions");
	}

if (bFireCondFlag == true) {
	logDebug("~~~ Flag is true;
	file CMN;LoadFireASITConditions is available.");
	} else {
	logDebug("~~~ Flag is false;
	file CMN;LoadFireASITConditions is NOT available.");
	}

if (bFireCondFlag == true && publicUser == false) {
	while (valDescr != undefined && iCnt < 21) include("CMN;LoadFireASITConditions");
	}

if (currentUserID == "ITJBS") {
	showDebug = true;
	}
`^
ASA;Permitting!Fire!Standpipe!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Fire!Standpipe!NA;Fee");
`^
ASA;Permitting!Fire!Tank!Install^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Fire!Tank!Install;Fee");
`^
ASA;Permitting!Fire!Tank!Removal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Fire!Tank!Removal;Fee");
`^
ASA;Permitting!Health!POWTS!Holding Tank^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (publicUser == false) {
	sanitaryCap = aa.cap.getCapID(AInfo['INSPECTION RESULTS.Sanitary Permit Number']);
	}

if (publicUser == false && sanitaryCap.getSuccess()) {
	addParent(AInfo['INSPECTION RESULTS.Sanitary Permit Number']);
	}

if (publicUser == false && sanitaryCap.getSuccess()) {
	copyAddresses(getParent(), capId);
	copyParcels(getParent(), capId);
	include("CMN;GetAPOAddress");
	updateShortNotes(APOAddress);
	}

if (publicUser == false && sanitaryCap.getSuccess()) {
	include("CMN;Permitting!Health!POWTS!Holding Tank;UpdateLastServiceDate");
	}
`^
ASA;Permitting!Health!POWTS!Old Sanitary^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var sTAMDueDate = null;
var reportName = "Exisiting Septic Letter";
branchTask("Intake", "Existing System", "Updated by script", "");
sTAMDueDate = dateAddMonths(null,1);
editAppSpecific("OFFICE USE ONLY.Date TAM Due", sTAMDueDate);
reportViewAttachEmail(true, false, reportName, "", "", "", "", "", false, "");
include("CMN;Permitting!Health!POWTS!Sanitary;UpdateCAPDetail");
showDebug = false;
showMessage = false;
`^
ASA;Permitting!Health!POWTS!Old Soil Study^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (isTaskActive("Intake")) {
	deactivateTask("Intake");
	}

activateTask("Closed");
closeTask("Closed","Closed","Closed by script","");
include("CMN;AssignCapBlank");
`^
ASA;Permitting!Health!POWTS!Sanitary^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Health!POWTS!Sanitary;PermitFee");
include("CMN;Permitting!Health!POWTS!Sanitary;UpdateCAPDetail");
if (currentUserID == "ITJBS") {
	showDebug = true;
	}
`^
ASA;Permitting!Health!POWTS!TAM^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (publicUser == false) {
	sanitaryCap = aa.cap.getCapID(AInfo['INSPECTION RESULTS.Sanitary Permit Number']);
	}

if (publicUser == false && sanitaryCap.getSuccess()) {
	addParent(AInfo['INSPECTION RESULTS.Sanitary Permit Number']);
	}

if (publicUser == false && sanitaryCap.getSuccess()) {
	copyAddresses(getParent(), capId);
	copyParcels(getParent(), capId);
	include("CMN;GetAPOAddress");
	updateShortNotes(APOAddress);
	}

if (publicUser == false && sanitaryCap.getSuccess()) {
	parentCapId = getParent();
	}

if (parentCapId != false) {
	holdID = capId;
	capId = parentCapId;
	}

if (isTaskActive("Operational","PERPOWTS") && isTaskStatus("Operational","Referral to Corp Counsel","PERPOWTS")) {
	bStatusIsCorpCounsel = true;
	}
`^
ASA;Permitting!Health!Temp Tattoo And Or Piercing!Dane County^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Health!Temp Tattoo And Or Piercing!Dane County;Fee");
include("EML;HEIntake");
`^
ASA;Permitting!Health!Temporary Restaurant!Dane County Retail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Health!Temporary Restaurant!Dane County Retail;Fee");
`^
ASA;Permitting!Health!Well!Old Well^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
updateTask("Intake","Closed","Task closed by ASA script","");
deactivateTask("Intake");
activateTask("Operational");
`^
ASA;Permitting!Land Management!Privilege In Streets!Privilege In Streets^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Land Management!Privilege In Streets!Privilege In Streets;Fee");
`^
ASA;Permitting!Miscellaneous!Edible Landscape!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (publicUser == false) {
	include("CMN;Permitting!Miscellaneous!Edible Landscape!NA;SetWorkflow");
	}

if (currentUserID == "ITJBS") {
	showDebug = true;
	}
`^
ASA;Permitting!Parking!Residential Parking!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
cbACA = true;
if (cap.isCreatedByACA() == false) {
	cbACA = false;
	!!Not sure why this line is disabled in test & prod???;
	}

include("CMN;Permitting!Parking!Residential Parking!NA;Fee");
if (!publicUser) {
	include("CMN;SetResParkPermitYear");
	}

if (AInfo['OFFICE USE ONLY.Permit Number Issued'] != null && AInfo['OFFICE USE ONLY.Permit Number Issued'] != "") {
	aa.set.add ("PARKINGISSUANCE",capId);
	}

if (AInfo['OFFICE USE ONLY.Permit Number Issued'] != null && AInfo['OFFICE USE ONLY.Permit Number Issued'] != "") {
	updateAppStatus("In Process" ,"Updated because a permit number was assigned.", capId);
	} else {
	if (cbACA) updateAppStatus("Online Submittal", "Updated because a permit number was not assigned.", capId);
	if (!cbACA) updateAppStatus("Open", "Updated because a permit number was not assigned.", capId);
	}

if (!publicUser) {
	include("CMN;RP3Dist");
	}

if (currentUserID == "ITJBS") {
	showDebug = true;
	}
`^
ASA;Permitting!Parking!Residential Parking!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
area = "";
cbACA = true;
if (cap.isCreatedByACA() == false) {
	cbACA = false;
	}

if (AInfo['APPLICANT INFORMATION.Driver's License No.'] == null) {
	copyContacts(parentCapId, capId);
	}

if (AInfo['APPLICANT INFORMATION.Driver's License No.'] == null) {
	copyASIFields(parentCapId, capId, "APPLICANT CERTIFICATION", "OFFICE USE ONLY");
	}

if (AInfo['APPLICANT INFORMATION.Driver's License No.'] == null) {
	copyAddresses(parentCapId, capId);
	}

if (AInfo['APPLICANT INFORMATION.Driver's License No.'] == null) {
	copyParcels(parentCapId, capId);
	copyParcelGisObjects();
	}

if (AInfo['APPLICANT INFORMATION.Driver's License No.'] == null) {
	copyOwner(parentCapId, capId);
	}

if (AInfo['APPLICANT INFORMATION.Driver's License No.'] == null) {
	aa.cap.createRenewalCap(parentCapId, capId, !cap.isCompleteCap());
	}

if (AInfo['APPLICANT INFORMATION.Driver's License No.'] == null) {
	editAppSpecific("APPLICANT INFORMATION.Type of Application", "Renewal", capId);
	}

if (AInfo['APPLICANT INFORMATION.Driver's License No.'] == null) {
	area = getAppSpecific("OFFICE USE ONLY.Area Number", parentCapId);
	}

if (AInfo['APPLICANT INFORMATION.Driver's License No.'] == null) {
	editAppSpecific("OFFICE USE ONLY.Area Number", area, capId);
	}

if (AInfo['APPLICANT INFORMATION.Driver's License No.'] == null) {
	editAppSpecific("APPLICANT INFORMATION.Lease Term (enter date range)", "", capId);
	}

if (AInfo['APPLICANT INFORMATION.Driver's License No.'] == null) {
	include("CMN;SetResParkPermitYear");
	}

if (AInfo['APPLICANT INFORMATION.Driver's License No.'] != null) {
	include("CMN;Permitting!Parking!Residential Parking!NA;Fee");
	}
`^
ASA;Permitting!Parks!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
eventName = "";
if (!publicUser && (appMatch("Permitting!Parks!SkiTrail!~") || appMatch("Permitting!Parks!Lake Access!~") || appMatch("Permitting!Parks!DiscGolf!~"))) {
	closeTask("Application Review", "Application Received","Closed by payment script","");
	closeTask("Issuance","Sent","Closed by payment script","");
	closeTask("Closed","Closed","Closed by submit script","");
	}

if (!publicUser && appMatch("Permitting!Parks!DogPark!~")) {
	closeTask("Application Review", "Application Received","Closed by payment script","");
	closeTask("License Check","Valid License");
	closeTask("Issuance","Sent","Closed by payment script","");
	closeTask("Closed","Closed","Closed by submit script","");
	}

if (!publicUser && appMatch("Permitting!Parks!Lake Access Daily!NA")) {
	closeTask("Active","Closed","Closed by submit script","");
	closeTask("Done","Closed","Closed by submit script","");
	}
`^
ASA;Permitting!Parks!Block Party!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (!feeExists("ONEDAY", "INVOICED")) {
	include("CMN;Permitting!Parks!Block Party!NA;Fee");
	}

updateAppStatus("Online Submittal", "Madison Licenses & Permits Updates Complete.", capId);
`^
ASA;Permitting!Parks!Dailies!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Parks!Dailies!NA;Fee");
`^
ASA;Permitting!Parks!DiscGolf!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Parks!DiscGolf!NA;Fee");
`^
ASA;Permitting!Parks!DogPark!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Parks!DogPark!NA;Fee");
`^
ASA;Permitting!Parks!Electrical Amplification!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Parks!Electrical Amplification!NA;Fee");
if (!publicUser) {
	include("CMN;Permitting!Parks!~!~;CreateContactfromASI");
	}
`^
ASA;Permitting!Parks!Farmers Market Electric!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Parks!Farmers Market Electric!NA;Fee");
if (!publicUser) {
	include("CMN;Permitting!Parks!~!~;CreateContactfromASI");
	}
`^
ASA;Permitting!Parks!Lake Access!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = true;
include("CMN;Permitting!Parks!Lake Access!NA;Fee");
`^
ASA;Permitting!Parks!SkiTrail!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Parks!SkiTrail!NA;Fee");
`^
ASA;Permitting!Parks!Special Event!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Parks!Special Event!NA;Fee");
`^
ASA;Permitting!Parks!Street Use!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var processFees = true;
if (feeExists("SEREVENT", "INVOICED")) {
	processFees = false;
	}

if (feeExists("MULTDAYEVENT", "INVOICED")) {
	processFees = false;
	}

if (feeExists("DMPSTR", "INVOICED")) {
	processFees = false;
	}

if (feeExists("TRSHBRLS", "INVOICED")) {
	processFees = false;
	}

if (feeExists("RECBRLS", "INVOICED")) {
	processFees = false;
	}

if (feeExists("PUBAMP", "INVOICED")) {
	processFees = false;
	}

if (feeExists("ELECADAPT", "INVOICED")) {
	processFees = false;
	}

if (feeExists("UMBVEND", "INVOICED")) {
	processFees = false;
	}

if (feeExists("26UMBVEND", "INVOICED")) {
	processFees = false;
	}

if (feeExists("101UMBVEND", "INVOICED")) {
	processFees = false;
	}

if (feeExists("301UMBVEND", "INVOICED")) {
	processFees = false;
	}

if (processFees) {
	include("CMN;Permitting!Parks!Street Use!NA;Fee");
	}

updateAppStatus("Online Submittal", "Madison Licenses & Permits Updates Complete.", capId);
`^
ASA;Permitting!Parks!Temporary Structure!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Parks!Temporary Structure!NA;Fee");
`^
ASA;Permitting!Parks!Vending!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Parks!Vending!NA;Fee");
`^
ASA;Permitting!Traffic Engineering!Bicycle Registration!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['OFFICE USE ONLY.History Update'] == "CHECKED") {
	historyUpdate = true;
	} else {
	historyUpdate = false;
	}

if (historyUpdate == false) {
	include("CMN;Permitting!Traffic Engineering!Bicycle Registration!NA;Fee");
	}

if (!publicUser) {
	include("CMN;Permitting!Traffic Engineering!Bicycle Registration!NA;ASIToCAPDetail");
	}

if (AInfo['DECAL INFORMATION.Vendor ID'] == "0200" && historyUpdate == false) {
	aa.set.add("BIKEREGMAIL",capId);
	}

if (!publicUser && historyUpdate == false && AInfo['DECAL INFORMATION.Vendor ID'] != "0200" && AInfo['DECAL INFORMATION.Vendor ID'] != "0400") {
	aa.set.add("BIKEREGDEALERS",capId);
	}

if (historyUpdate) {
	include("CMN;Permitting!Traffic Engineering!Bicycle Registration!NA;HistoryUpdate");
	}
`^
ASA;Permitting!Traffic Engineering!Bicycle Registration!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
decal = "";
if (AInfo['DECAL INFORMATION.Vendor ID'] == null) {
	copyContacts(parentCapId, capId);
	}

if (AInfo['DECAL INFORMATION.Vendor ID'] == null) {
	copyASIFields(parentCapId, capId);
	}

if (AInfo['DECAL INFORMATION.Vendor ID'] == null) {
	editAppSpecific("DECAL INFORMATION.If two other bicycles currently registered in household, check this box", "", capId);
	}

if (AInfo['DECAL INFORMATION.Vendor ID'] == null) {
	decal = getAppSpecific("DECAL INFORMATION.Decal Number", parentCapId);
	}

if (AInfo['DECAL INFORMATION.Vendor ID'] == null) {
	editAppSpecific("DECAL INFORMATION.If Renewing Decal, List Expiring Decal Number", decal, capId);
	}

if (AInfo['DECAL INFORMATION.Vendor ID'] == null) {
	editAppSpecific("DECAL INFORMATION.Decal Number", "", capId);
	}

if (AInfo['DECAL INFORMATION.Vendor ID'] == null) {
	aa.cap.createRenewalCap(parentCapId, capId, !cap.isCompleteCap());
	}

if (AInfo['DECAL INFORMATION.Vendor ID'] != null && publicUser == true) {
	include("CMN;Permitting!Traffic Engineering!Bicycle Registration!Renewal;Fee");
	}

include("CMN;Permitting!Traffic Engineering!Bicycle Registration!~;UpdateB1Expiration");
`^
ASA;Permitting!Traffic Engineering!Driveway!Commercial^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
assignedSigning = true;
isTaskCompleteFlag = isTaskComplete("Intake");
if (isTaskCompleteFlag == undefined) {
	isTaskCompleteFlag = false;
	}

if ((isTaskCompleteFlag == false) && (AInfo['OFFICE USE ONLY.Intake Complete'] == "CHECKED")) {
	closeTask("Intake","Application Accepted","Intake has been completed.","Automated process");
	intakeComplete = true;
	include("CMN;Permitting!Traffic Engineering!Driveway!Commercial;SetReviews");
	}

include("CMN;Permitting!Traffic Engineering!Driveway!Commercial;Fee");
`^
ASA;Permitting!Traffic Engineering!Street Occupancy!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['REVIEWERS COMMENTS.Illuminated covered walkways are required'] == "CHECKED") {
	include("CMN;Permitting!Traffic Engineering!Street Occupancy!NA;BiEmail");
	}

include("CMN;AddParcelAndOwner");
`^
ASA;Permitting!Vending!TEM!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
`^
ASA;Permitting!Water!New Meter!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Water!New Meter!NA;Fee");
`^
ASA;Permitting!Water!NEW WATER SERVICE!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Water!NEW WATER SERVICE!~;TapSleeveSize");
`^
ASA;Permitting!Zoning!Sign!Ground^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Zoning!Sign!Ground;Fee");
`^
ASA;Permitting!Zoning!Sign!NonGround^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Zoning!Sign!NonGround;Fee");
`^
ASA;Postings!Civil Rights!Job Posting Form!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (!publicUser) {
	include("CMN;Postings!Civil Rights!Job Posting Form!NA;UpdateShortNotes");
	}
`^
ASA;ServiceRequest!Engineering - Facility!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
user = aa.person.getUser(currentUserID);
user = user.getOutput();
var userEmail= user.getEmail();
if (userEmail) {
	peopleResult = aa.people.getPeopleByOthers("Facility User","", user.getFirstName(), "",user.getLastName(),"","","","",null);
	}

if (peopleResult) {
	peopleList = peopleResult.getOutput();
	}

if (peopleList) {
	aa.people.createCapContactWithRefPeopleModel(capId, peopleList[0].getPeopleModel());
	}

include("CMN;ServiceRequest!Engineering - Facility!NA!NA");
include("EML;ServiceRequestReceived!Engineering!Facility!~");
editAppSpecific("SR - ENGINEERING MAINTENANCE.New", "No", capId);
tblName = "ADDTL INFO";
include("CMN;ServiceRequest!Engineering - Facility!NA!NA;GetTable");
`^
ASA;ServiceRequest!Engineering!Dead Animal Collection!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
debug=false;
message=false;
include("EML;ServiceRequest!Engineering!Dead Animal Collection!NA;Internal");
email("rsjachrani@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
if (ca != null) {
	;
	} else {
	email(ca[0]["email"],"noreply@cityofmadisonDEV.com",emailSubject,emailText);
	}
`^
ASA;ServiceRequest!Information Technology!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if ((cmnSubType != "Tech Serv Project" && cmnSubType != "Database")) {
	include("EML;ServiceRequest!Information Technology!Accela Change Request!NA;CreationEmail");
	}
`^
ASA;ServiceRequest!Information Technology!Accela Change Request!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;TrackAssignments");
`^
ASA;ServiceRequest!Information Technology!Accela Issue!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;SR-IT_GetApproverRoles");
assignTask("Customer Test", reportByUID, "SERVICE REQUEST - IT ISSUE");
include("CMN;TrackAssignments");
`^
ASA;ServiceRequest!Information Technology!Tech Serv Project!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
tableName = "";
rowCount = 0;
xType = "New";
tableName = "TASKS";
totalAdjustedWeight = 0;
totalWeight = 0;
totalPercent = 0;
if (tableName != "") {
	include("CMN;ServiceRequest!Information Technology!Tech Serv Project!NA;ProcessTable");
	}

if (tableName != "") {
	totalPercent = (totalAdjustedWeight ! totalWeight) ~ 100;
	totalPercent = aa.util.round(totalPercent, 0);
	}

if (tableName != "") {
	editAppSpecific("WORK.Percent Complete", parseInt(totalPercent));
	}

closeTask("Intake", "Accepted", "Updated by ASA script","");
`^
ASA;ServiceRequest!Traffic Engineering!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;ServiceRequest!Traffic Engineering;TrackAssignments");
if (getShortNotes(capId) == "") {
	include("CMN;AddAssetIDtoShortNotes");
	}
`^
ASA;ServiceRequest!Traffic Engineering!Request!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (getShortNotes(capId) == "") {
	include("CMN;AddAssetIDtoShortNotes");
	}

if (AInfo['OFFICE USE ONLY.Jump to'] == "Office Review") {
	closeTask("Intake","Proceed with Request");
	}

if (AInfo['OFFICE USE ONLY.Jump to'] == "Work Order Review") {
	closeTask("Intake","Proceed with Request");
	closeTask("Office Review","Proceed with Work Orders");
	}

if (AInfo['OFFICE USE ONLY.Jump to'] == "Closed") {
	taskCloseAllNotComplete("Closed","Closed");
	}
`^
ASA;ServiceRequest!Water!Problem!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("EML;ServiceRequest!Water!Problem!~;Internal");
email("rsjachrani@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
if (ca != null) {
	;
	} else {
	email(ca[0]["email"],"noreply@cityofmadisonDEV.com",emailSubject,emailText);
	}
`^
ASA;WeightsMeasures!Licensing!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;WeightsMeasures!Licensing!NA!NA;ProcessDeviceFees");
include("CMN;AddParcelAndOwner");
`^
ASB;Enforcement!Building Inspection!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = true;
bypass = "";
showDebug = true;
showMessage = true;
cancel = true;
`^
ASB;Land!Land Use!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
`^
ASB;Licenses!Building Inspection!Foreclosure Registration!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;AssignCapCurrentUser");
`^
ASB;Licenses!Building Inspection!Landlord Registration!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licenses!Building Inspection!Landlord Registration!NA;ASIValidation");
`^
ASB;Licenses!Health!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (cmnCategory == "Madison") {
	var infoMsg = "If you are creating a new health license, please use the Dane County license type.";
	}

if (cmnCategory == "Madison" && cmnSubType != "DischofNonStrmwtr") {
	cancel = true;
	showMessage = true;
	comment(infoMsg);
	}
`^
ASB;Licenses!Treasurer!Cat Registration!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
neighbor = "City of Madison";
refAddr = aa.address.getRefAddressByPK(AddressValidatedNumber);
if (refAddr.getSuccess()) {
	refAdd = refAddr.getOutput();
	neighbor = refAdd.getNeighborhood();
	} else {
	cancel = true;
	showMessage = true;
	comment("The address you entered could not be validated.  Please use the address search feature to select a City of Madison address.");
	}

if (neighbor != "City of Madison") {
	cancel = true;
	showMessage = true;
	comment("The address you selected is not within the City of Madison.  It is not necessary for you to obtain a Pet License for the City of Madison.");
	}

callType = "ASBCRCB";
include("CMN;Licenses!Treasurer!~!~;DuplicateLicCheck");
`^
ASB;Licenses!Treasurer!Chicken Owner!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
neighbor = "City of Madison";
disclaimercount = 0;
if (AInfo['I am the owner and resident of this address'] == "No") {
	disclaimercount =+ 1;
	}

if (AInfo['I do not own the premises and have notified the owner'] == "No") {
	disclaimercount =+ 1;
	}

if (AInfo['I do not own the premises and have notified all occupants'] == "No") {
	disclaimercount =+ 1;
	}

if (AInfo['I have read, understand, and agree to abide by the conditions specified on the previous page'] == "No") {
	disclaimercount =+ 1;
	}

if (AInfo['I understand the Zoning Administrator may revoke this license as specified on the previous page'] == "No") {
	disclaimercount =+ 1;
	}

refAddr = aa.address.getRefAddressByPK(AddressValidatedNumber);
if (refAddr.getSuccess()) {
	refAdd = refAddr.getOutput();
	neighbor = refAdd.getNeighborhood();
	} else {
	cancel = true;
	showMessage = true;
	comment("The address you entered could not be validated.  Please use the address search feature to select a City of Madison address.");
	}

if (neighbor != "City of Madison") {
	cancel = true;
	showMessage = true;
	comment("The address you selected is not within the City of Madison.  It is not necessary for you to obtain a Pet License for the City of Madison.");
	}

callType = "ASBCRCB";
include("CMN;Licenses!Treasurer!~!~;DuplicateLicCheck");
`^
ASB;Licenses!Treasurer!Dog Registration!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
neighbor = "City of Madison";
refAddr = aa.address.getRefAddressByPK(AddressValidatedNumber);
if (refAddr.getSuccess()) {
	refAdd = refAddr.getOutput();
	neighbor = refAdd.getNeighborhood();
	} else {
	cancel = true;
	showMessage = true;
	comment("The address you entered could not be validated.  Please use the address search feature to select a City of Madison address.");
	}

if (neighbor != "City of Madison") {
	cancel = true;
	showMessage = true;
	comment("The address you selected is not within the City of Madison.  It is not necessary for you to obtain a Pet License for the City of Madison.");
	}

callType = "ASBCRCB";
include("CMN;Licenses!Treasurer!~!~;DuplicateLicCheck");
`^
ASB;Licenses!Treasurer!Kennel!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
neighbor = "City of Madison";
refAddr = aa.address.getRefAddressByPK(AddressValidatedNumber);
if (refAddr.getSuccess()) {
	refAdd = refAddr.getOutput();
	neighbor = refAdd.getNeighborhood();
	} else {
	cancel = true;
	showMessage = true;
	comment("The address you entered could not be validated.  Please use the address search feature to select a City of Madison address.");
	}

if (neighbor != "City of Madison") {
	cancel = true;
	showMessage = true;
	comment("The address you selected is not within the City of Madison.  It is not necessary for you to obtain a Pet License for the City of Madison.");
	}
`^
ASB;Licenses!Vending!HighDensityVending!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
msg = 0;
if (true) {
	streetVendorCap = aa.cap.getCapID(AInfo['City of Madison Street Vendor License Number']);
	}

if (streetVendorCap.getSuccess() != true) {
	msg = 2;
	cancel = true;
	showMessage = true;
	comment("<br>The Street Vendor License Number you entered doesn't exist.  Please enter a valid Street Vendor License Number.");
	}

if (msg == 2) {
	comment("Click Step 2 - License Information and type your Street Vendor License Number in the City of Madison Street Vendor License Number box.  Thank you.");
	}

if (streetVendorCap.getSuccess()) {
	include("CMN;!Licenses!Vending!~!~;GetExpirationDate");
	}
`^
ASB;Licenses!Vending!LateNightVendor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
msg = 0;
streetVendorCap = aa.cap.getCapID(AInfo['City of Madison Street Vendor License Number']);
if (!streetVendorCap.getSuccess()) {
	msg = 2;
	cancel = true;
	showMessage = true;
	comment("<br>The Street Vendor License Number you entered doesn't exist.  Please enter a valid Street Vendor License Number.");
	}

if (msg == 2) {
	comment("Click Step 2 - License Information and type your Street Vendor License Number in the City of Madison Street Vendor License Number box.  Thank you.");
	}

if (streetVendorCap.getSuccess()) {
	include("CMN;!Licenses!Vending!~!~;GetExpirationDate");
	}
`^
ASB;Licenses!Vending!MallCraftVendor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
msg = 0;
totRecs = 0;
streetVendorCap = aa.cap.getCapID(AInfo['City of Madison Street Vendor License Number']);
if (!streetVendorCap.getSuccess()) {
	msg = 2;
	cancel = true;
	showMessage = true;
	comment("The Street Vendor License Number you entered doesn't exist.  Please enter a valid Street Vendor License Number.");
	}

if (publicUser == true && msg == 2) {
	comment("Click Step 2 - License Information and type your Street Vendor License Number in the City of Madison Street Vendor License Number box.  Thank you.");
	}

if (streetVendorCap.getSuccess()) {
	include("CMN;!Licenses!Vending!~!~;GetExpirationDate");
	}
`^
ASB;Licenses!Vending!MallFoodVendor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
msg = 0;
streetVendorCap = aa.cap.getCapID(AInfo['City of Madison Street Vendor License Number']);
if (streetVendorCap.getSuccess()) {
	include("CMN;!Licenses!Vending!~!~;GetExpirationDate");
	}
`^
ASB;Licenses!Vending!SoutheastCampusVending!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
msg = 0;
streetVendorCap = aa.cap.getCapID(AInfo['City of Madison Street Vendor License Number']);
if (!streetVendorCap.getSuccess()) {
	msg = 2;
	cancel = true;
	showMessage = true;
	comment("<br>The Street Vendor License Number you entered doesn't exist.  Please enter a valid Street Vendor License Number.");
	}

if (msg == 2) {
	comment("Click Step 2 - License Information and type your Street Vendor License Number in the City of Madison Street Vendor License Number box.  Thank you.");
	}

if (streetVendorCap.getSuccess()) {
	include("CMN;!Licenses!Vending!~!~;GetExpirationDate");
	}
`^
ASB;Permitting!Building!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
neighbor = "City of Madison";
var dtBondEndDate = new Date();
var dtToday = new Date();
LicProfType = "";
heatElec = false;
LicProfType = aa.env.getValue("CAELienseType").toUpperCase();
if (AInfo['CAEAttribute.BOND END DATE'] != undefined && AInfo['CAEAttribute.BOND END DATE'] != null) {
	dtBondEndDate = new Date(AInfo['CAEAttribute.BOND END DATE']);
	}

if (LicProfType != "" && LicProfType != null) {
	if(LicProfType.substring(0,3) == "HTG" || LicProfType.substring(0,4) == "ELEC") heatElec = true;
	}

if (heatElec && dtToday > dtBondEndDate) {
	message = "The Licensed Professional you selected has an expired bond.";
	showMessage = true;
	cancel = true;
	}

refAddr = aa.address.getRefAddressByPK(AddressValidatedNumber);
if (refAddr.getSuccess()) {
	refAdd = refAddr.getOutput();
	neighbor = refAdd.getNeighborhood();
	} else {
	cancel = true;
	showMessage = true;
	comment("The address you entered could not be validated.  Please use the address search feature to select a City of Madison address.");
	}

if (neighbor != "City of Madison") {
	cancel = true;
	showMessage = true;
	comment("The address you selected is not within the City of Madison. Please check your local jurisdiction to see if a permit is required.");
	}
`^
ASB;Permitting!Building!RepairReplace!Construction^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (!publicUser && aa.env.getValue("CAELienseType").toUpperCase() == "GENERAL") {
	include("CMN;CheckGenLicProfExpDates");
	}
`^
ASB;Permitting!Building!Residential!Construction^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (!publicUser && aa.env.getValue("CAELienseType").toUpperCase() == "GENERAL") {
	include("CMN;CheckGenLicProfExpDates");
	}
`^
ASB;Permitting!Health!POWTS!Holding Tank^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
bIsSanRec = false;
if (publicUser == false) {
	include("CMN;Permitting!Health!POWTS!~;SanitaryPermitExistsCheck");
	}

if (publicUser == false && bIsSanRec == true) {
	include("CMN;Permitting!Health!POWTS!~;SanPermitHoldingTankCheck");
	}
`^
ASB;Permitting!Health!POWTS!TAM^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
bIsSanRec = false;
if (publicUser == false) {
	include("CMN;Permitting!Health!POWTS!~;SanitaryPermitExistsCheck");
	}
`^
ASB;Permitting!Health!Temp Food Establishment!Dane County Restaurant^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
primrest = AInfo['Primarily Restaurant'];
primret = AInfo['Primarily Retail Food'];
if ((primrest == undefined || primrest != "CHECKED") && (primret == undefined || primret != "CHECKED")) {
	cancel = true;
	showMessage = true;
	comment("Must select Primarily Restaurant or Primarily Retail Food.");
	}

if (primrest == "CHECKED" && primret == "CHECKED") {
	cancel = true;
	showMessage = true;
	comment("Must select Primarily Restaurant or Primarily Retail Food not both.");
	}
`^
ASB;Permitting!Parking!Residential Parking!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var bCertifyAppNo = false;
var bReadAgreeNo = false;
var infoMsg = "";
if (AInfo['I certify that the information on this <BR> application is true and correct.'] == "No") {
	bCertifyAppNo = true;
	}

if (AInfo['I have read and agree to the Residential Parking<BR>Permit Program Regulations.'] == "No") {
	bReadAgreeNo = true;
	}

if (bCertifyAppNo) {
	infoMsg = "You must certify that your application is true and correct.<BR>";
	}

if (bReadAgreeNo) {
	infoMsg  = infoMsg + "You must certify that you have read and agree to the Residential Parking Permit Regulations.<BR>";
	}

if ((bCertifyAppNo || bReadAgreeNo)) {
	infoMsg = infoMsg + "Click the 'Edit' button on the right side of the 'Additional Information' bar below to make changes.<BR>Then click the 'Save' button when done to keep your changes (or click 'Cancel' to ignore changes).";
	cancel = true;
	showMessage = true;
	comment(infoMsg);
	}
`^
ASB;Permitting!Parks!DiscGolf!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
callEvent = "ASB";
if (!publicUser) {
	include("CMN;Permitting!Parks!DiscGolf!NA;ASITotalInternal");
	}
`^
ASB;Permitting!Parks!DogPark!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
callEvent = "ASB";
if (!publicUser) {
	include("CMN;Permitting!Parks!DogPark!NA;PermitQtyValidation");
	}
`^
ASB;Permitting!Parks!Lake Access!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
callEvent = "ASB";
if (!publicUser) {
	include("CMN;Permitting!Parks!Lake Access!NA;LicPlateValid");
	}
`^
ASB;Permitting!Parks!SkiTrail!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
callEvent = "ASB";
if (!publicUser) {
	include("CMN;Permitting!Parks!SkiTrail!NA;InternalPermitValid");
	}
`^
ASB;Permitting!Traffic Engineering!Bicycle Registration!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
var bFoundLPrec = false;
var refLic = getRefLicenseProf(AInfo['Vendor ID']);
if (refLic != null) {
	bFoundLPrec = true;
	}

if (bFoundLPrec == true && refLic.licenseType == "BIKE REG. VENDOR") {
	logDebug("LP record found for VendorID =" + AInfo['Vendor ID']);
	}

if (!publicUser && bFoundLPrec == false) {
	cancel = true;
	showMessage = true;
	comment("No associated bicycle vendor found for Vendor ID = " + AInfo['Vendor ID'] + ". Please enter a valid Bicycle Registration Vendor ID.");
	}

if (!publicUser) {
	callType = "ASBCRCB";
	include("CMN;Permitting!Traffic Engineering!Bicycle Registration!~DcalDuplicateCheck");
	}
`^
ASB;ServiceRequest!Engineering - Facility!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
numMatch = 0;
var superUser;
user = aa.person.getUser(currentUserID);
user = user.getOutput();
if (user) {
	peopleResult = aa.people.getPeopleByOthers("Facility User","", user.getFirstName(), "",user.getLastName(),"","","","",null);
	}

if (peopleResult) {
	peopleList = peopleResult.getOutput();
	}

if (peopleList) {
	refContactId = peopleList[0].contactSeqNumber;
	}

if (peopleList) {
	facilityDesc = AInfo['Facility'];
	}

if (peopleList) {
	var numMatch = checkIfFacilityUserForFacility(refContactId, facilityDesc);
	}

if (numMatch == 0) {
	superUser = lookup("Facility Super Users", currentUserID);
	}

if (numMatch == 0 && superUser != undefined) {
	numMatch = 1;
	}

if (numMatch == 0) {
	cancel = true;
	message = "Please contact Kelsey Stone at 266-5927 or kstone@cityofmadison.com, if you need to be able to create service requests for this building.";
	}
`^
ASIUA;AMS!Engineering Facility Maint!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var status;
var comment;
var preStatus;
var preComment;
appStatus = "";
statusComment = "";
preStatus = getAppSpecific("WORK ORDER INFO.Previous Status");
preComment = getAppSpecific("WORK ORDER INFO.Previous Comment");
status = getAppSpecific("WORK ORDER INFO.Status");
comment = getAppSpecific("WORK ORDER INFO.Comments");
if (preStatus == null) {
	preStatus = "";
	}

if (preComment == null) {
	preComment = "";
	}

if (status != "" && (preStatus != status || preComment != comment)) {
	appStatus = status;
	statusComment = comment;
	}

if (status != "" && status != "Completed" && preStatus != status && preComment != comment) {
	updateTask("Open", status, comment, "");
	}

if (status != "" && status == "Completed" && preStatus != status && preComment != comment) {
	closeTask("Open", status, comment, "");
	}

if (status != "" && (preStatus != status || preComment != comment)) {
	editAppSpecific("WORK ORDER INFO.Previous Status", status);
	editAppSpecific("WORK ORDER INFO.Previous Comment", comment);
	}

if (status == "Completed" || status == "Closed") {
	editAppName("Yes");
	} else {
	if(status == "In Progress" || status == "Open") editAppName("No");
	}

if (status == "In Progress" && (capStatus == "Completed" || capStatus == "Closed")) {
	updateAppStatus("Open","Updated due to ASI set to In Progress");
	}

include("EML;AMS!Engineering Facility Maint!~!~");
`^
ASIUA;AMS!Engineering Storm!Mowing!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
strName = "";
AssetList = aa.asset.getAssetListByWorkOrder(capId,null);
if (AssetList.getSuccess()) {
	AssetList = AssetList.getOutput();
	for (x in AssetList) include("CMN;AMS!Engineering Storm!Mowing!~;addAssetInfo");
	}
`^
ASIUA;AMS!Engineering!Sewer Meter Inspection!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
asiStatus = getAppSpecific("DETAILS","Status");
holdId = capId;
if (asiStatus == "Completed") {
	capId = getParent();
	}

if (asiStatus == "Completed") {
	closeTask("Inspection","Completed", "Updated by work order", "", "ENGSMT");
	}

capId = holdId;
`^
ASIUA;DaneCounty!Zoning!Conditional Use!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;DaneCounty!Zoning!Conditional Use!NA;Fee");
`^
ASIUA;DaneCounty!Zoning!Request for Service!Water Determination^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;DaneCounty!Zoning!Request for Service!Water Determination;Fee");
`^
ASIUA;DaneCounty!Zoning!Rezone!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;DaneCounty!Zoning!Rezone!NA;MainFee");
include("CMN;DaneCounty!Zoning!Rezone!NA;MainTownFee");
`^
ASIUA;DaneCounty!Zoning!Zoning Permit!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (if(feeExists("NEWSINGLE") == true) removeFee("NEWSINGLE","FINAL");if(feeExists("DUPLEXES") == true) removeFee("DUPLEXES","FINAL");if(feeExists("COMMERCIAL") == true) removeFee("COMMERCIAL","FINAL");if(feeExists("RESADDITION") == true) removeFee("RESADDITION","FINAL");if(feeExists("AGRICULTURE") == true) removeFee("AGRICULTURE","FINAL");) {
	}

include("CMN;DaneCounty!Zoning!Zoning Permit!NA;Fee");
`^
ASIUA;Enforcement!Building Inspection!Construction!No Permit^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
refAdd = null;
refAddress = null;
add = aa.address.getAddressByCapId(cap.getCapID()).getOutput();
if (add[0].getRefAddressId() == null) {
	include("CMN;AddReferenceAddressAndOwner");
	}
`^
ASIUA;Land!Land Use!Conditional Use Demo!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Land!Land Use!Conditional Use Demo!NA;Fee");
`^
ASIUA;Land!Land Use!Conditional Use!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Land!Land Use!Conditional Use!NA;Fee");
`^
ASIUA;Land!Land Use!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
tableName = "ARCHITECTURAL REVIEW";
include("CMN;NUMBER_ASIT");
tableName = "ARCHITECTURAL VERIFICATION";
include("CMN;NUMBER_ASIT");
tableName = "ASSESSOR REVIEW";
include("CMN;NUMBER_ASIT");
tableName = "ASSESSOR VERIFICATION";
include("CMN;NUMBER_ASIT");
tableName = "ENG MAPPING REVIEW";
include("CMN;NUMBER_ASIT");
tableName = "ENG MAPPING VERIFICATION";
include("CMN;NUMBER_ASIT");
tableName = "ENGINEERING REVIEW";
include("CMN;NUMBER_ASIT");
tableName = "ENGINEERING VERIFICATION";
include("CMN;NUMBER_ASIT");
tableName = "FIRE REVIEW";
include("CMN;NUMBER_ASIT");
tableName = "FIRE VERIFICATION";
include("CMN;NUMBER_ASIT");
tableName = "LANDMARKS REVIEW";
include("CMN;NUMBER_ASIT");
tableName = "LANDMARKS VERIFICATION";
include("CMN;NUMBER_ASIT");
tableName = "LIGHTING REVIEW";
include("CMN;NUMBER_ASIT");
tableName = "LIGHTING VERIFICATION";
include("CMN;NUMBER_ASIT");
tableName = "METRO REVIEW";
include("CMN;NUMBER_ASIT");
tableName = "METRO VERIFICATION";
include("CMN;NUMBER_ASIT");
tableName = "PARKS FORESTRY REVIEW";
include("CMN;NUMBER_ASIT");
tableName = "PARKS FORESTRY VERIFICATION";
include("CMN;NUMBER_ASIT");
tableName = "PLAN DIRECTOR REVIEW";
include("CMN;NUMBER_ASIT");
tableName = "PLAN DIRECTOR VERIFICATION";
include("CMN;NUMBER_ASIT");
tableName = "PLANNING REVIEW";
include("CMN;NUMBER_ASIT");
tableName = "PLANNING VERIFICATION";
include("CMN;NUMBER_ASIT");
tableName = "POLICE REVIEW";
include("CMN;NUMBER_ASIT");
tableName = "POLICE VERIFICATION";
include("CMN;NUMBER_ASIT");
tableName = "REAL ESTATE REVIEW";
include("CMN;NUMBER_ASIT");
tableName = "REAL ESTATE VERIFICATION";
include("CMN;NUMBER_ASIT");
tableName = "RECYCLING REVIEW";
include("CMN;NUMBER_ASIT");
tableName = "RECYCLING VERIFICATION";
include("CMN;NUMBER_ASIT");
tableName = "TE REVIEW";
include("CMN;NUMBER_ASIT");
tableName = "TE VERIFICATION";
include("CMN;NUMBER_ASIT");
tableName = "URBAN DESIGN REVIEW";
include("CMN;NUMBER_ASIT");
tableName = "URBAN DESIGN VERIFICATION";
include("CMN;NUMBER_ASIT");
tableName = "WATER UTILITY REVIEW";
include("CMN;NUMBER_ASIT");
tableName = "WATER UTILITY VERIFICATION";
include("CMN;NUMBER_ASIT");
tableName = "ZONING REVIEW";
include("CMN;NUMBER_ASIT");
tableName = "ZONING VERIFICATION";
include("CMN;NUMBER_ASIT");
include("CMN;Land!Land Use!NA!NA;SaveProjectRevision");
if (AInfo['PROJECT INFORMATION.Plan Commission'] != "") {
	showDebug=true;
	dtDueDate=dateAdd(AInfo['PROJECT INFORMATION.Plan Commission'],0);
	include("CMN;LAND;SetLMAgencyReviewDueDate");
	}
`^
ASIUA;Land!Non-PUD Rezoning!NonPUD Cond Use Demo!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Land!Non-PUD Rezoning!NonPUD Cond Use Demo!NA;Fee");
`^
ASIUA;Land!Non-PUD Rezoning!NonPUD Cond Use!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Land!Non-PUD Rezoning!NonPUD Cond Use!NA;Fee");
`^
ASIUA;Land!Non-PUD Rezoning!NonPUD Demo!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Land!Non-PUD Rezoning!NonPUD Demo!NA;Fee");
`^
ASIUA;Land!Non-PUD Rezoning!NonPUD!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Land!Non-PUD Rezoning!NonPUD!NA;Fee");
`^
ASIUA;Land!Permitted Use!Site Plan Review!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var oChildCapID = null;
var holdId = null;
var aryTasks = null;
oTraffEng = null;
bSuppAccept = false;
var bIsPermitIssued = false;
var CapDtlObj = null;
oCapDetail = null;
oChildCapID = childGetByCapType("Permitting!Traffic Engineering!DRIVEWAY!Commercial", capId);
if (oChildCapID) {
	oTraffEng = loadASITable("TRAFFIC ENGINEERING", capId);
	}

if (oTraffEng) {
	for(x in oTraffEng) include("CMN;Land!Permitted Use!Site Plan Review!NA;TrafficEngASITLoop");
	}

logDebug("bSuppAccept = " + bSuppAccept);
if (oChildCapID) {
	holdId = capId;
	capId = oChildCapID;
	logDebug("Switching capId to child TE Commercial Driveway record " + capId.getCustomID());
	}

if (bSuppAccept) {
	aryTasks = aa.workflow.getTasks(capId).getOutput();
	}

if (bSuppAccept && isTaskActive("Issuance") && isTaskStatus("Issuance","Issued")) {
	bIsPermitIssued = true;
	}

if (bSuppAccept && aryTasks != null) {
	for(x in aryTasks) if(aryTasks[x].activeFlag == "Y" && aryTasks[x].taskDescription != "Issuance") setTask(aryTasks[x].taskDescription,"N","Y");
	}

if (bSuppAccept && bIsPermitIssued == false) {
	activateTask("Issuance");
	updateTask("Issuance","Issued","Updated by script","");
	editAppSpecific("OFFICE USE ONLY.Permit Expiration Date", dateAddMonths(null,12));
	include("EML;Permitting!Traffic Engineering!Driveway!Commercial;Issued");
	}

if (bSuppAccept && oChildCapID) {
	CapDtlObj = aa.cap.getCapDetail(capId);
	}

if (bSuppAccept && CapDtlObj != null) {
	if(CapDtlObj.getSuccess()) oCapDetail = CapDtlObj.getOutput();
	}

if (bSuppAccept && oCapDetail) {
	logDebug("Total Invoiced Fees = " + oCapDetail.getTotalFee());
	logDebug("Total Balance = " + oCapDetail.getBalance());
	}

if (bSuppAccept && oCapDetail) {
	if(oCapDetail.getTotalFee() > 0 && oCapDetail.getBalance() > 0) include("CMN;Permitting!Traffic Engineering!Driveway!Commercial;MakePayment");
	}

if (oChildCapID) {
	capId = holdId;
	logDebug("Switching capId back to parent Land!Permitted User!Site Plan Review record " + capId.getCustomID());
	}

if (currentUserID == "ITJBS") {
	showDebug = true;
	}
`^
ASIUA;Land!PUD Rezoning!PUD Cond Use Demo!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Land!PUD Rezoning!PUD Cond Use Demo!NA;Fee");
`^
ASIUA;Land!PUD Rezoning!PUD Cond Use!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Land!PUD Rezoning!PUD Cond Use!NA;Fee");
`^
ASIUA;Land!PUD Rezoning!PUD Demo!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Land!PUD Rezoning!PUD Demo!NA;Fee");
`^
ASIUA;Land!PUD Rezoning!PUD!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Land!PUD Rezoning!PUD!NA;Fee");
`^
ASIUA;Land!Rezoning!Rezoning!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Land!Rezoning!Rezoning!NA;Fee");
`^
ASIUA;Land!Subdivision!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (AInfo['OFFICE USE ONLY.Meeting Date - Plan Commission'] != "") {
	dtDueDate=dateAdd(AInfo['OFFICE USE ONLY.Meeting Date - Plan Commission'],0);
	include("CMN;LAND;SetLMAgencyReviewDueDate");
	}
`^
ASIUA;Land!Subdivision!Certified Survey Map!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Land!Subdivision!Certified Survey Map!NA;Fee");
parcelNum = "070924206018";
include("CMN;Land!Subdivision!Certified Survey Map!NA;RemoveParcelCondition");
`^
ASIUA;Land!Subdivision!Subdivision Plat!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Land!Subdivision!Subdivision Plat!NA;Fee");
`^
ASIUA;Land!Urban Design Commission!General Application!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Land!Urban Design Commission!General Application!NA;Fee");
`^
ASIUA;Licenses!~!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
`^
ASIUA;Licenses!Building Inspection!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if ((isTaskStatus("License Issuance","Issued") || isTaskStatus("License Status","Active") || isTaskStatus("License Status","Inactive") )) {
	include("CMN;Licenses!Building Inspection!~;UpdateRefProfessional");
	}
`^
ASIUA;Licenses!Building Inspection!Foreclosure Registration!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;Licenses!Building Inspection!Foreclosure Registration!NA;Fee");
`^
ASIUA;Licenses!Building Inspection!Landlord Registration!Bundle^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug=false;
include("CMN;Licenses!Building Inspection!Landlord Registration!Bundle;RenewalInfo");
`^
ASIUA;Licenses!Clerk!AmusementDevice!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licenses!Clerk!AmusementDevice!NA;Fee");
`^
ASIUA;Licenses!Clerk!ClassABeerLiquor!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = true;
include("CMN;Licensing!Clerk!Class A Beer Liquor!~;Fee");
`^
ASIUA;Licenses!Clerk!ClassBBeerLiquor!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licensing!Clerk!Class B Beer Liquor!~;Fee");
`^
ASIUA;Licenses!Clerk!HorseDrawnOrPedalCab!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licenses!Clerk!HorseDrawnOrPedalCab!NA;Fee");
`^
ASIUA;Licenses!Clerk!MallSecondHandDealer!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;Licenses!Clerk!MallSecondHandDealer!NA;Fee");
`^
ASIUA;Licenses!Clerk!Operator!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
invoiceFees = "N";
var capContactResult = aa.people.getCapContactByCapID(capId);
refContactNbr = 0;
if (capContactResult.getSuccess()) {
	Contacts = capContactResult.getOutput();
	}

if (capContactResult.getSuccess()) {
	for(yy in Contacts) include("cmn;FindNewLicenseHolder");
	}

if (refContactNbr > 0) {
	contactSetPrimary(refContactNbr);
	}

if (AInfo['OFFICE USE ONLY.Provisional Expiration Date'] != null) {
	editAppSpecific("ADDITIONAL APPLICANT INFO.Do you need a provisional license", "Yes");
	}

if (AInfo['OFFICE USE ONLY.Provisional Expiration Date'] == null && cap.isCreatedByACA() && getAppSpecific("ADDITIONAL APPLICANT INFO.Do you need a provisional license") == "Yes") {
	provDate = dateAdd(null,60);
	editAppSpecific("OFFICE USE ONLY.Provisional Expiration Date", provDate);
	}

include("CMN;Licenses!Clerk!Operator!NA;Fee");
`^
ASIUA;Licenses!Clerk!ParaTransitOperating!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (capStatus == "Active") {
	include("CMN;Licenses!Clerk!ParaTransitOperating!~;UpdateRefProfessional");
	}
`^
ASIUA;Licenses!Clerk!Scrap-Recycling!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = true;
include("CMN;Licenses!Clerk!Scrap-Recycling!NA;Fee");
`^
ASIUA;Licenses!Clerk!SecondHandDealer!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("cmn;Licenses!Clerk!SecondHandDealer!NA;Fee");
`^
ASIUA;Licenses!Clerk!Theatre!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licenses!Clerk!Theatre!NA;Fee");
`^
ASIUA;Licenses!Engineering!Prequalified Contractor!Na^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
setAAPlanStatus = true;
var catA = getAppSpecific("CATEGORIES.A");
var catB = getAppSpecific("CATEGORIES.B");
var catC = getAppSpecific("CATEGORIES.C");
include("CMN;PREQUAL");
if (catA == "CHECKED") {
	include("CMN;TERLPCARD");
	}

if (catA == "CHECKED") {
	include("CMN;Licenses!Engineering!Prequalified Contractor!Na;Fee");
	}

if (isTaskStatus("Affirmative Action Review", "Not Required", "LIC_PREQUAL")) {
	setAAPlanStatus = false;
	}

if (isTaskStatus("Affirmative Action Review", "Approved", "LIC_PREQUAL")) {
	setAAPlanStatus = false;
	}

if (isTaskStatus("Affirmative Action Review", "Denied", "LIC_PREQUAL")) {
	setAAPlanStatus = false;
	}

if (catB == "CHECKED" && setAAPlanStatus) {
	include("CMN;Licenses!Engineering!Prequalified Contractor!Na;GetAAPlanStatus");
	}

if (catC == "CHECKED") {
	include("CMN;ROWLPCARD");
	}
`^
ASIUA;Licenses!Fire!SpecialHazards!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licenses!Fire!SpecialHazards!NA;Fee");
`^
ASIUA;Licenses!Fire!SpecialOccupancy!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licenses!Fire!SpecialOccupancy!NA;Fee");
`^
ASIUA;Licenses!Health!Campgrounds!DaneCounty^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licenses!Health!Campgrounds!DaneCounty;RenewalFee");
`^
ASIUA;Licenses!Health!Campgrounds!Madison^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licenses!Health!Campgrounds!DaneCounty;RenewalFee");
`^
ASIUA;Licenses!Health!DischofNonStrmwtr!Madison^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licenses!Health!DischofNonStrmwtr!Madison;Fee");
`^
ASIUA;Licenses!Health!FoodandDrink!DaneCounty^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
include("CMN;Licensing!Health!Food and Drink!~;LicenseRenewalFee");
if (currentUserID =="ITJBS") {
	showDebug = true;
	}
`^
ASIUA;Licenses!Health!FoodandDrink!Madison^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
include("CMN;Licensing!Health!Food and Drink!~;LicenseRenewalFee");
`^
ASIUA;Licenses!Health!HotelMotelTRH!DaneCounty^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licenses!Health!HotelMotelTRH!DaneCounty;Fee");
`^
ASIUA;Licenses!Health!HotelMotelTRH!Madison^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licenses!Health!HotelMotelTRH!Madison;Fee");
`^
ASIUA;Licenses!Health!MobileHomePark!DaneCounty^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licenses!Health!MobileHomePark!DaneCounty;Fee");
`^
ASIUA;Licenses!Health!MobileHomePark!Madison^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licenses!Health!MobileHomePark!Madison;Fee");
include("CMN;LicenseHolderUpdateFullNameWBusName");
`^
ASIUA;Licenses!Health!RecreationEducationCamps!DaneCounty^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licenses!Health!RecreationEducationCamps!DaneCounty;Fee");
`^
ASIUA;Licenses!Health!RecreationEducationCamps!Madison^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licenses!Health!RecreationEducationCamps!Madison;Fee");
`^
ASIUA;Licenses!Health!School!DaneCounty^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licensing!Health!School!Dane County;LicenseFee");
`^
ASIUA;Licenses!Health!School!Madison^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licensing!Health!School!Madison;LicenseFee");
`^
ASIUA;Licenses!Health!SwimmingPool!DaneCounty^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licenses!Health!SwimmingPool!DaneCounty;Fee");
`^
ASIUA;Licenses!Health!SwimmingPool!Madison^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Licenses!Health!SwimmingPool!Madison;Fee");
`^
ASIUA;Licenses!Health!TattooAndOrBodyPiercing!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licensing!Health!Tattoo and Body Piercing!~;LicenseFee");
`^
ASIUA;Licenses!Health!Temp Food Establishment!DaneCounty^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licenses!Health!Temp Food Establishment!DaneCounty;Fees");
`^
ASIUA;Licenses!Police!Taxi Driver!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licensing!Police!Taxi Driver!NA;Fee");
`^
ASIUA;Licenses!Treasurer!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if ((capStatus == "Online Submittal" || capStatus == "Additional Info Required") && (cmnSubType == "Dog Registration" || cmnSubType == "Cat Registration") && (AInfo['HEALTH STATUS.Rabies Shot Expiration Date'] != null || AInfo['ANIMAL DETAILS.License Number'] != null)) {
	aa.set.add("PETLICACA",capId);
	updateAppStatus("Online Submittal - Reviewed","Processed via ASIUA Script");
	}

if ((capStatus == "Online Submittal" || capStatus == "Additional Info Required") && cmnSubType == "Chicken Owner" && AInfo['LICENSE DETAILS.License Number'] != null) {
	aa.set.add("PETLICACA",capId);
	updateAppStatus("Online Submittal - Reviewed","Processed via ASIUA Script");
	}
`^
ASIUA;Licenses!Treasurer!Cat Registration!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licenses!Treasurer!Cat Registration!NA;Fee");
`^
ASIUA;Licenses!Treasurer!Cat Registration!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licenses!Treasurer!Cat Registration!NA;Fee");
`^
ASIUA;Licenses!Treasurer!Chicken Owner!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licenses!Treasurer!Chicken Owner!NA;Fee");
`^
ASIUA;Licenses!Treasurer!Dog Registration!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licenses!Treasurer!Dog Registration!NA;Fee");
`^
ASIUA;Licenses!Treasurer!Dog Registration!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licenses!Treasurer!Dog Registration!NA;Fee");
`^
ASIUA;Permitting!Building!Commercial!Construction^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (isTaskComplete("Permit Issuance")) {
	showMessage = false;
	} else {
	include("CMN;Permitting!Building!Commercial!Construction;Fee");
	}
`^
ASIUA;Permitting!Building!Commercial!New Electrical^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Commercial!New Electrical;Fee");
`^
ASIUA;Permitting!Building!Commercial!New HVAC^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Commercial!New HVAC;Fee");
`^
ASIUA;Permitting!Building!Commercial!New Plumbing^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Commercial!New Plumbing;Fee");
include("CMN;Permitting!Building!Commercial!New Plumbing;ASITotal");
`^
ASIUA;Permitting!Building!Commercial!Raze^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Commercial!Raze;Fee");
`^
ASIUA;Permitting!Building!Industrial!Construction^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (isTaskComplete("Permit Issuance")) {
	showMessage = false;
	} else {
	include("CMN;Permitting!Building!Industrial!Construction;Fee");
	}
`^
ASIUA;Permitting!Building!Industrial!New Electrical^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Industrial!New Electrical;Fee");
`^
ASIUA;Permitting!Building!Industrial!New HVAC^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Industrial!New HVAC;Fee");
`^
ASIUA;Permitting!Building!Industrial!New Plumbing^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Industrial!New Plumbing;Fee");
include("CMN;Permitting!Building!Industrial!New Plumbing;ASITotal");
`^
ASIUA;Permitting!Building!Industrial!Raze^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Industrial!Raze;Fee");
`^
ASIUA;Permitting!Building!Moving!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Moving!NA;Fee");
`^
ASIUA;Permitting!Building!Nonconforming!Construction^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = true;
var edmsServiceURL = "http;!!172.22.2.124;3080!av-biz-ws-0.9!services!GovXMLService";
!! Works ok;
var edmsUsername = "licuser";
var edmsPassword = "2tall4u!";
var xmlout = '';
xmlout += '<?xml version="1.0" encoding="utf-8"?>';
xmlout += '<GovXML xmlns;xsd="http;!!www.w3.org!2001!XMLSchema" xmlns;xsi="http;!!www.w3.org!2001!XMLSchema-instance" xmlns="http;!!www.accela.com!schema!AccelaOpenSystemInterfaceXML">';
xmlout += '  <AuthenticateUser>';
xmlout += '     <System>';
xmlout += '        <XMLVersion>GovXML-7.2.0<!XMLVersion>';
xmlout += '        <ServiceProviderCode>LICENSING<!ServiceProviderCode>';
xmlout += '     <!System>';
xmlout +=  '     <Username>'+edmsUsername+'<!Username>';
xmlout += '      <Password>'+edmsPassword+'<!Password>';
xmlout += '  <!AuthenticateUser>';
xmlout += '<!GovXML>';
networkUser = "city\Bizcash";
networkPwd = "4u2loginbts1!";
var parameter = 'xmlin='+xmlout;
var postresp = aa.util.httpPostToSoapWebService(edmsServiceURL, "", "", "", "");
!! RETURNS TEXT NO ERRORS!;
comment("edms w!s error message; " + postresp.getErrorMessage());
comment("edms w!s resp; " + postresp.getOutput());
`^
ASIUA;Permitting!Building!RepairReplace!Electrical^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!RepairReplace!Electrical;Fee");
`^
ASIUA;Permitting!Building!RepairReplace!HVAC^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("cmn;Permitting!Building!RepairReplace!HVAC;Fee");
`^
ASIUA;Permitting!Building!RepairReplace!Plumbing^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!RepairReplace!Plumbing;Fee");
`^
ASIUA;Permitting!Building!RepairReplace!Repair^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!RepairReplace!Repair;Fee");
`^
ASIUA;Permitting!Building!Residential!Construction^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (isTaskComplete("Permit Issuance")) {
	showMessage = false;
	} else {
	include("CMN;Permitting!Building!Residential!Construction;Fee");
	}
`^
ASIUA;Permitting!Building!Residential!New Electrical^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Residential!New Electrical;Fee");
`^
ASIUA;Permitting!Building!Residential!New HVAC^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Residential!New HVAC;Fee");
`^
ASIUA;Permitting!Building!Residential!New Plumbing^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Residential!New Plumbing;Fee");
`^
ASIUA;Permitting!Building!Residential!Raze^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Residential!Raze;Fee");
`^
ASIUA;Permitting!Building!Variance!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Building!Variance!NA;Fee");
`^
ASIUA;Permitting!Clerk!Close Out Sale!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Clerk!Close Out Sale!NA;Fee");
`^
ASIUA;Permitting!Clerk!Picnic Beer!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Clerk!Picnic Beer!NA;Fee");
`^
ASIUA;Permitting!Clerk!Solicitor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Clerk!Solicitor!NA;Fee");
`^
ASIUA;Permitting!Engineering!Erosion Control!100LfDitchSwaleChannel^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!Erosion Control!100LfDitchSwaleChannel;Fee");
`^
ASIUA;Permitting!Engineering!Erosion Control!125LfNewPubPrivRoadDrive^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!Erosion Control!125LfNewPubPrivRoadDrive;Fee");
`^
ASIUA;Permitting!Engineering!Erosion Control!12PercentSlope^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!Erosion Control!12PercentSlope;Fee");
`^
ASIUA;Permitting!Engineering!Erosion Control!300LfUtilityInstall^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!Erosion Control!300LfUtilityInstall;Fee");
`^
ASIUA;Permitting!Engineering!Erosion Control!4000 Disturbed^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!Erosion Control!4000 Disturbed;Fee");
`^
ASIUA;Permitting!Engineering!Erosion Control!400CyCutFill^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!Erosion Control!400CyCutFill;Fee");
`^
ASIUA;Permitting!Engineering!Erosion Control!HighRiskPerAdminAuth^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!Erosion Control!HighRiskPerAdminAuth;Fee");
`^
ASIUA;Permitting!Engineering!Erosion Control!Inspection^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;Permitting!Engineering!Erosion Control!Inspection;BMPFail");
include("CMN;Permitting!Engineering!Erosion Control!Inspection;UpdateParent");
`^
ASIUA;Permitting!Engineering!Erosion Control!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!Erosion Control!NA;Fee");
`^
ASIUA;Permitting!Engineering!Erosion Control!PublicSRHConstReconst^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!Erosion Control!PublicSRHConstReconst;Fee");
`^
ASIUA;Permitting!Engineering!Erosion Control!SubdivisionPlatCSM^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!Erosion Control!SubdivisionPlatCSM;Fee");
`^
ASIUA;Permitting!Engineering!ROW!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = true;
var cityOwned = "No";
var cityProject = "No";
isFeeExempt = "N";
cityOwned = getAppSpecific("FEE SELECTION.City Owned Utilities Only");
cityProject = getAppSpecific("FEE SELECTION.Needed For City Project");
include("CMN;Permitting!Engineering!ROW!NA;GetFeeExempt");
comment("ASIUA feeExmpt is " + isFeeExempt + "  cityOwn is " + cityOwned + "  cityProj is " + cityProject);
showComment = true;
if (isFeeExempt == "Y" || (cityOwned == "Yes" &&  cityProject == "No")) {
	removeAllFees(capId);
	}

if (isFeeExempt != "Y" && cityOwned == "No" &&  cityProject == "No") {
	include("CMN;Permitting!Engineering!ROW!NA;Fee");
	}

if (isFeeExempt != "Y" && cityOwned == "No" &&  cityProject == "Yes") {
	removeAllFees(capId);
	updateFee("ROWAPFE","ENGROW","FINAL",1,"N");
	}

if (isFeeExempt != "Y" && cityOwned == "Yes" &&  cityProject == "Yes") {
	removeAllFees(capId);
	updateFee("ROWAPFE","ENGROW","FINAL",1,"N");
	}
`^
ASIUA;Permitting!Engineering!Sewer Addition Meter!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!~!NA;CalculateExpireDate");
`^
ASIUA;Permitting!Engineering!Sewer Deduct Meter!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!~!NA;CalculateExpireDate");
`^
ASIUA;Permitting!Engineering!StormWaterManagement!AcreDistLess20kImpvsArea^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!StormWaterManagement!AcreDistLess20kImpvsArea;Fee");
`^
ASIUA;Permitting!Engineering!StormWaterManagement!Addn20kImperviousArea^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!StormWaterManagement!Addn20kImperviousArea;Fee");
`^
ASIUA;Permitting!Engineering!StormWaterManagement!HighRskExcCapPerAdmAuth^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!StormWaterManagement!HighRskExcCapPerAdmAuth;Fee");
`^
ASIUA;Permitting!Engineering!StormWaterManagement!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!StormWaterManagement!NA");
`^
ASIUA;Permitting!Engineering!StormWaterManagement!NewSt20kImpvsNoPlatCSM^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!StormWaterManagement!NewSt20kImpvsNoPlatCSM;Fee");
`^
ASIUA;Permitting!Engineering!StormWaterManagement!Redevelopment^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!StormWaterManagement!Redevelopment;Fee");
`^
ASIUA;Permitting!Engineering!StormWaterManagement!SubdivisionPlatCSM^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!StormWaterManagement!SubdivisionPlatCSM;Fee");
`^
ASIUA;Permitting!Engineering!Street Occupancy!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!Street Occupancy!NA;Fee");
if (AInfo['GENERAL INFORMATION.Excavation Will Take Place Within 5 Ft. of Terrace Tree'] == "CHECKED") {
	include("CMN;Permitting!Engineering!Street Occupancy!NA;ForestryEmail");
	}

if (AInfo['REVIEWERS COMMENTS.Illuminated covered walkways are required'] == "CHECKED") {
	include("CMN;Permitting!Engineering!Street Occupancy!NA;BiEmail");
	}

if (AInfo['REVIEWERS COMMENTS.Erosion control plan is required'] == "CHECKED") {
	include("CMN;Permitting!Engineering!Street Occupancy!NA;ErocEmail");
	}
`^
ASIUA;Permitting!Engineering!Street Terrace!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
genAppFee = false;
currFileKey = 0;
localURL = "";
include("CMN;Permitting!Engineering!Street Terrace!NA;Fee");
!!AInfo['PROJECT INFORMATION.Has work started without taking out a permit?'] == "Yes" && feeExists("PENALTY", "NEW", "INVOICED") == false;
documentCategory = "Building Plans";
fromNotification = "noreply@cityofmadison.com";
toNotification = "kgrittner@cityofmadison.com";
templateName = "STREETTERRACEWTUA";
include("CMN;SendACADocumentNotification");
documentCategory = "Building Plans";
localURL = "";
include("CMN;GetAADocumentLink");
`^
ASIUA;Permitting!Fire!AccessControlEgress!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Fire!AccessControlEgress!NA;Fee");
`^
ASIUA;Permitting!Fire!Alarm!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Fire!Alarm!NA;Fee");
`^
ASIUA;Permitting!Fire!AltFireSuppression!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = true;
include("CMN;Permitting!Fire!AltFireSuppression!NA;Fee");
`^
ASIUA;Permitting!Fire!ControlledEgress!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;Permitting!Fire!ControlledEgress!NA;Fee");
`^
ASIUA;Permitting!Fire!CoveredMall!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Fire!CoveredMall!NA;Fee");
`^
ASIUA;Permitting!Fire!DelayedEgress!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Fire!DelayedEgress!NA;Fee");
`^
ASIUA;Permitting!Fire!FireCommandCenter!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Fire!FireCommandCenter!NA;Fee");
`^
ASIUA;Permitting!Fire!HighPiledStorage!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Fire!HighPiledStorage!NA;Fee");
`^
ASIUA;Permitting!Fire!KitchenHood!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Fire!KitchenHood!NA;Fee");
`^
ASIUA;Permitting!Fire!SmokeControlPanels!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Fire!SmokeControlPanels!NA;Fee");
`^
ASIUA;Permitting!Fire!SmokeHeatVents!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Fire!SmokeHeatVents!NA;Fee");
`^
ASIUA;Permitting!Fire!Sprinkler!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Fire!Sprinkler!NA;Fee");
`^
ASIUA;Permitting!Fire!Standpipe!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Fire!Standpipe!NA;Fee");
`^
ASIUA;Permitting!Fire!Tank!Install^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Fire!Tank!Install;Fee");
`^
ASIUA;Permitting!Fire!Tank!Removal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Fire!Tank!Removal;Fee");
`^
ASIUA;Permitting!Health!POWTS!Old Sanitary^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Health!POWTS!Sanitary;UpdateCAPDetail");
`^
ASIUA;Permitting!Health!POWTS!Sanitary^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Health!POWTS!Sanitary;PermitFee");
include("CMN;Permitting!Health!POWTS!Sanitary;UpdateCAPDetail");
if (currentUserID == "ITJBS") {
	showDebug = true;
	}
`^
ASIUA;Permitting!Health!Temp Food Establishment!Dane County Restaurant^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Health!Temp Food Establishment!Dane County Restaurant;Fee");
include("CMN;Permitting!Health!Temp Food Establishment!~;UpdateCAPDetail");
`^
ASIUA;Permitting!Health!Temp Tattoo And Or Piercing!Dane County^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Health!Temp Tattoo And Or Piercing!Dane County;Fee");
`^
ASIUA;Permitting!Health!Temporary Restaurant!Dane County Retail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Health!Temporary Restaurant!Dane County Retail;Fee");
`^
ASIUA;Permitting!Land Management!Privilege In Streets!Privilege In Streets^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Land Management!Privilege In Streets!Privilege In Streets;Fee");
`^
ASIUA;Permitting!Parking!Residential Parking!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Parking!Residential Parking!NA;Fee");
include("CMN;RP3Dist");
if (AInfo['OFFICE USE ONLY.Permit Number Issued'] != null && AInfo['OFFICE USE ONLY.Permit Number Issued'] != "") {
	include("CMN;Permitting!Parking!ParkingReadyToIssue");
	}

if (AInfo['OFFICE USE ONLY.Permit Expiration Date'] != null && AInfo['OFFICE USE ONLY.Permit Expiration Date'] != "") {
	licEditExpInfo(null,AInfo['OFFICE USE ONLY.Permit Expiration Date']);
	}

if (currentUserID == "ITJBS") {
	showDebug = true;
	}
`^
ASIUA;Permitting!Parking!Residential Parking!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Parking!Residential Parking!NA;Fee");
include("CMN;RP3Dist");
if (AInfo['OFFICE USE ONLY.Permit Number Issued'] != null && AInfo['OFFICE USE ONLY.Permit Number Issued'] != "") {
	include("CMN;Permitting!Parking!ParkingReadyToIssue");
	}

if (AInfo['OFFICE USE ONLY.Permit Expiration Date'] != null && AInfo['OFFICE USE ONLY.Permit Expiration Date'] != "") {
	licEditExpInfo(null,AInfo['OFFICE USE ONLY.Permit Expiration Date']);
	}

if (currentUserID == "ITJBS") {
	showDebug = true;
	}
`^
ASIUA;Permitting!Parks!Dailies!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Parks!Dailies!NA;Fee");
`^
ASIUA;Permitting!Parks!DiscGolf!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Parks!DiscGolf!NA;Fee");
`^
ASIUA;Permitting!Parks!DogPark!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Parks!DogPark!NA;Fee");
`^
ASIUA;Permitting!Parks!Lake Access!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Parks!Lake Access!NA;Fee");
`^
ASIUA;Permitting!Parks!SkiTrail!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Parks!SkiTrail!NA;Fee");
`^
ASIUA;Permitting!Parks!Special Event!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Parks!Special Event!NA;Fee");
`^
ASIUA;Permitting!Parks!Temporary Structure!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Parks!Temporary Structure!NA;Fee");
`^
ASIUA;Permitting!Parks!Vending!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Parks!Vending!NA;Fee");
`^
ASIUA;Permitting!Traffic Engineering!Bicycle Registration!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Traffic Engineering!Bicycle Registration!NA;ASIToCAPDetail");
if (AInfo['OFFICE USE ONLY.History Update'] == "CHECKED") {
	historyUpdate = true;
	} else {
	historyUpdate = false;
	}

if (historyUpdate == false) {
	include("CMN;Permitting!Traffic Engineering!Bicycle Registration!NA;Fee");
	}

if (cap.isCreatedByACA() && historyUpdate == false && AInfo['DECAL INFORMATION.Vendor ID'] == "0400" && AInfo['DECAL INFORMATION.Decal Number'] != null && AInfo['DECAL INFORMATION.Decal Number'] != "") {
	aa.set.add("BIKEREGACA",capId);
	}

if (historyUpdate) {
	include("CMN;Permitting!Traffic Engineering!Bicycle Registration!NA;HistoryUpdate");
	}

include("CMN;Permitting!Traffic Engineering!Bicycle Registration!~;UpdateB1Expiration");
`^
ASIUA;Permitting!Traffic Engineering!Bicycle Registration!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
proj1 = aa.cap.getProjectByChildCapID(capId, "Renewal", "Review");
projSuccess1 = proj1.getSuccess();
if (projSuccess1 == true) {
	proj1 = proj1.getOutput();
	parentCapId = proj1[0].getProjectID();
	}

bicycleDecal = getAppSpecific("DECAL INFORMATION.Decal Number");
bicycleSerial = getAppSpecific("BICYCLE INFORMATION.Serial Number");
updateShortNotes(bicycleDecal);
editAppName(bicycleSerial);
include("CMN;Permitting!Traffic Engineering!Bicycle Registration!Renewal;Fee");
include("CMN;Permitting!Traffic Engineering!Bicycle Registration!~;UpdateB1Expiration");
`^
ASIUA;Permitting!Traffic Engineering!Driveway!Commercial^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
assignedSigning = true;
isTaskCompleteFlag = isTaskComplete("Intake");
if (isTaskCompleteFlag == undefined) {
	isTaskCompleteFlag = false;
	}

if ((isTaskCompleteFlag == false) && (AInfo['OFFICE USE ONLY.Intake Complete'] == "CHECKED")) {
	closeTask("Intake","Application Accepted","Intake has been completed.","Automated process");
	intakeComplete = true;
	include("CMN;Permitting!Traffic Engineering!Driveway!Commercial;SetReviews");
	}

include("CMN;Permitting!Traffic Engineering!Driveway!Commercial;Fee");
`^
ASIUA;Permitting!Traffic Engineering!Street Occupancy!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (isTaskActive("Traffic Engineering Review")) {
	invoiceFees = "N";
	include("CMN;Permitting!Traffic Engineering!Street Occupancy!NA;Fee");
	}
`^
ASIUA;Permitting!Vending!TEM!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
`^
ASIUA;Permitting!Water!New Meter!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Water!New Meter!NA;Fee");
`^
ASIUA;Permitting!Zoning!Sign!Ground^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Zoning!Sign!Ground;Fee");
`^
ASIUA;Permitting!Zoning!Sign!NonGround^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Zoning!Sign!NonGround;Fee");
`^
ASIUA;ServiceRequest!Engineering - Facility!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
editAppSpecific("SR - ENGINEERING MAINTENANCE.New", "No", capId);
addlInfos = "";
tblName = "ADDTL INFO";
include("CMN;ServiceRequest!Engineering - Facility!NA!NA;GetTable");
include("CMN;ServiceRequest!Engineering - Facility!NA!NA");
if (currentUserID != "ENKMS") {
	callType = "ASIUA";
	include("EML;ServiceRequestReceived!Engineering!Facility!~;Update");
	}
`^
ASIUA;ServiceRequest!Information Technology!Accela Change Request!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (true) {
	assignTask("Deployment", getAppSpecific("REQUEST DETAILS.Developer", capId) , "SERVICE REQUEST - IT CHANGE REQUEST");
	assignTask("IT Action", getAppSpecific("REQUEST DETAILS.Developer", capId) , "SERVICE REQUEST - IT CHANGE REQUEST");
	}
`^
ASIUA;ServiceRequest!Information Technology!Accela Issue!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (getAppSpecific("ISSUE DETAILS.Developer", capId) != null) {
	assignTask("Deployment", getAppSpecific("ISSUE DETAILS.Developer", capId) , "SERVICE REQUEST - IT ISSUE");
	assignTask("IT Action", getAppSpecific("ISSUE DETAILS.Developer", capId) , "SERVICE REQUEST - IT ISSUE");
	}
`^
ASIUA;ServiceRequest!Information Technology!Tech Serv Project!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
tableName = "";
rowCount = 0;
xType = "Update";
tableName = "TASKS";
totalAdjustedWeight = 0;
totalWeight = 0;
totalPercent = 0;
if (tableName != "") {
	include("CMN;ServiceRequest!Information Technology!Tech Serv Project!NA;ProcessTable");
	}

if (tableName != "") {
	totalPercent = (totalAdjustedWeight ! totalWeight) ~ 100;
	totalPercent = aa.util.round(totalPercent, 0);
	}

if (tableName != "") {
	editAppSpecific("WORK.Percent Complete", parseInt(totalPercent));
	}
`^
ASIUA;ServiceRequest!Traffic Engineering!Request!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
include("CreateChileTrafficElectricalWO");
`^
ASIUA;WeightsMeasures!Licensing!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;WeightsMeasures!Licensing!NA!NA;ProcessDeviceFees");
`^
ASIUB;Licenses!Treasurer!Cat Registration!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
callType = "ASIUB";
include("CMN;Licenses!Treasurer!~!~;DuplicateLicCheck");
`^
ASIUB;Licenses!Treasurer!Cat Registration!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
callType = "ASIUB";
include("CMN;Licenses!Treasurer!~!~;DuplicateLicCheck");
`^
ASIUB;Licenses!Treasurer!Chicken Owner!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
callType = "ASIUB";
include("CMN;Licenses!Treasurer!~!~;DuplicateLicCheck");
`^
ASIUB;Licenses!Treasurer!Chicken Owner!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
callType = "ASIUB";
include("CMN;Licenses!Treasurer!~!~;DuplicateLicCheck");
`^
ASIUB;Licenses!Treasurer!Dog Registration!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
callType = "ASIUB";
include("CMN;Licenses!Treasurer!~!~;DuplicateLicCheck");
`^
ASIUB;Licenses!Treasurer!Dog Registration!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
callType = "ASIUB";
include("CMN;Licenses!Treasurer!~!~;DuplicateLicCheck");
`^
ASIUB;Permitting!Engineering!Erosion Control!Inspection^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
callType = "ASIUB";
checkType = "TYPE OF PERMIT";
checkDesc = "Project Description";
asiValue = AInfo['TYPE OF PERMIT.Permit Type'];
bDate =  "1!1!" + startDate.getFullYear();
eDate =  "12!31!" + startDate.getFullYear();
check = findDuplicateASIValues(callType, checkType, checkDesc, asiValue, 'File', bDate, eDate, false);
comment(check);
`^
ASIUB;Permitting!Health!Temp Food Establishment!Dane County Restaurant^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
primrest = AInfo['FOOD SERVICE.Primarily Restaurant'];
primret = AInfo['FOOD SERVICE.Primarily Retail Food'];
if ((primrest == undefined || primrest != "CHECKED") && (primret == undefined || primret != "CHECKED")) {
	cancel = true;
	showMessage = true;
	comment("Must select Primarily Restaurant or Primarily Retail Food.");
	}

if (primrest == "CHECKED" && primret == "CHECKED") {
	cancel = true;
	showMessage = true;
	comment("Must select Primarily Restaurant or Primarily Retail Food not both.");
	}
`^
ASIUB;Permitting!Parking!Residential Parking!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if ((currentUserGroup != "PermTeSuper" && currentUserGroup != "PerParkingAdmin" && currentUserGroup != "PermittingAdmin") && (capStatus == "About to Expire" || capStatus == "Active" || capStatus == "Expired" || capStatus == "Permit Issued" || capStatus == "Revoked" || capStatus == "Surrendered" || capStatus == "Closed")) {
	message = "You are not authorized to update a CAP once the permit has been issued. Please contact your supervisor for more information.";
	showMessage = true;
	cancel = true;
	}
`^
ASIUB;Permitting!Parking!Residential Parking!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if ((currentUserGroup != "PermTeSuper" && currentUserGroup != "PerParkingAdmin" && currentUserGroup != "PermittingAdmin") && (capStatus == "About to Expire" || capStatus == "Active" || capStatus == "Expired" || capStatus == "Permit Issued" || capStatus == "Revoked" || capStatus == "Surrendered" || capStatus == "Closed")) {
	message = "You are not authorized to update a CAP once the permit has been issued. Please contact your supervisor for more information.";
	showMessage = true;
	cancel = true;
	}
`^
ASIUB;Permitting!Parks!DiscGolf!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
callEvent = "ASIUB";
if (!publicUser) {
	include("CMN;Permitting!Parks!DiscGolf!NA;ASITotalInternal");
	}
`^
ASIUB;Permitting!Parks!DogPark!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
callEvent = "ASIUB";
if (!publicUser) {
	include("CMN;Permitting!Parks!DogPark!NA;PermitQtyValidation");
	}
`^
ASIUB;Permitting!Parks!Lake Access!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
callEvent = "ASIUB;
if (!publicUser) {
	include("CMN;Permitting!Parks!Lake Access!NA;LicPlateValid");
	}
`^
ASIUB;Permitting!Parks!SkiTrail!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
callEvent = "ASIUB";
if (!publicUser) {
	include("CMN;Permitting!Parks!SkiTrail!NA;InternalPermitValid");
	}
`^
ASIUB;Permitting!Traffic Engineering!Bicycle Registration!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
callType = "ASIUB";
include("CMN;Permitting!Traffic Engineering!Bicycle Registration!~DcalDuplicateCheck");
`^
ASIUB;Permitting!Traffic Engineering!Bicycle Registration!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
callType = "ASIUB";
include("CMN;Permitting!Traffic Engineering!Bicycle Registration!~DcalDuplicateCheck");
`^
ASIUB;Permitting!Vending!Banner!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Vending!Banner!NA;ASITEval");
`^
AssetUpdateBefore^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("SUB;" + cmnGroup + "!~!~!~");
include("SUB;" + cmnGroup + "!" + cmnType + "!~!~");
include("SUB;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("SUB;" + appTypeString);
`^
AssociateAssetAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
logDebug("ASSOCIATING ASSET!!!!");
include("CMN;~!~!~!~;GET_APP_PARTS");
include("AAA;" + cmnGroup + "!~!~!~");
include("AAA;" + cmnGroup + "!" + cmnType + "!~!~");
include("AAA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("AAA;" + appTypeString);
include("AAA;" + cmnGroup + "!" + cmnType + "!~" + "!" + cmnCategory);
`^
AssociateAssetToWorkOrderAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("AAWA;" + cmnGroup + "!~!~!~");
include("AAWA;" + cmnGroup + "!" + cmnType + "!~!~");
include("AAWA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("AAWA;" + appTypeString);
`^
ASU;AMS!~!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
`^
ASU;AMS!Engineering Facility Maint!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("EML;AMS!Engineering Facility Maint!~!~");
if (capStatus== "Completed" || capStatus == "Closed") {
	editAppName("Yes");
	}

if (capStatus == "Closed") {
	include("CMN;CloseAndCloseParent");
	} else {
	if(capStatus == "In Progress" || capStatus == "Open") editAppName("No");
	}
`^
ASU;AMS!Engineering Storm!Mowing!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;WorkOrderStandard StatusUpdates");
if (cmnCategory == "Weeds" && capStatus == "Additional Info Requested") {
	include("EML;AMS!Engineering Storm!Mowing!Weeds;AddlInfoRequested");
	}
`^
ASU;AMS!Equipment!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;WorkOrderStandard StatusUpdates");
`^
ASU;AMS!Vehicle!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;WorkOrderStandard StatusUpdates");
`^
ASU;AnimalServices!Bite!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;AnimalServices!Bite!NA!NA");
`^
ASU;AnimalServices!General!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;AnimalServices!General!NA!NA");
`^
ASU;AnimalServices!Rabies Exposure!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;AnimalServices!Rabies Exposure!NA!NA");
`^
ASU;AnimalServices!Welfare!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;AnimalServices!Welfare!NA!NA");
`^
ASU;AnimalServices!Wildlife!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;AnimalServices!Wildlife!NA!NA");
`^
ASU;Enforcement!~!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
capClosed = false;
hasExpire = null;
if ((capStatus == "Void" || capStatus == "Business Dissolved" || capStatus == "Closed" || capStatus == "Inactive")) {
	capClosed = true;
	}

result = aa.expiration.isExpiredLicenses(capId);
hasExpire = result.getErrorMessage();
if (capClosed && hasExpire != null) {
	licEditExpInfo("Inactive", null);
	}

if (capClosed) {
	include("CMN;AssignCapBlank");
	}

if (capClosed) {
	inspCancelAll();
	}
`^
ASU;Land!Land Use!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("EML;ServiceRequest!~!~!~;UpdateAssignedBy");
`^
ASU;Licenses!~!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
capClosed = false;
hasExpire = false;
if (capStatus == "Active" && !appMatch("Licenses!Engineering!Prequalified Contractor!Na") && !appMatch("Licenses!Clerk!Operator!~") && !appMatch("Licenses!Treasurer!~!~")) {
	include("CMN;LICENSE;ExpJune30");
	}

if ((capStatus == "Active" || capStatus == "Inactive") && cmnType == "Building Inspection") {
	include("CMN;Licenses!Building Inspection!~;UpdateRefProfessional");
	}

if (capStatus == "Inactive" || capStatus == "Audited") {
	updateTask("License Status",capStatus,"Updated by Application Status","");
	}

if (appMatch("Licenses!Clerk!Operator!NA") && capStatus == "Active" && isTaskActive("Common Council Hearing")) {
	closeTask("Common Council Hearing","Approved","Approved through Common Council Hearing","Approved through Common Council Hearing");
	editTaskSpecific("Common Council Hearing","Enter Date of Common Council Action",dateAdd(null, 0));
	closeTask("License Issuance","Issued","License Issued","License Issued");
	updateTask("License Status","Active","License Status is Active","License Status is Active");
	}

if ((capStatus == "Void" || capStatus == "Business Dissolved" || capStatus == "Closed" || capStatus == "Inactive")) {
	capClosed = true;
	}

result = aa.expiration.isExpiredLicenses(capId);
hasExpire = result.getErrorMessage();
if (capClosed && hasExpire != null) {
	licEditExpInfo("Inactive", null);
	}

if (capClosed) {
	include("CMN;AssignCapBlank");
	}

if (capClosed) {
	inspCancelAll();
	}
`^
ASU;Licenses!Building Inspection!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if ((capStatus == "Active" ||capStatus == "Business Dissolved" || capStatus == "Inactive" || capStatus == "Expired")) {
	capStatus = cap.getCapStatus();
	lp = getRefLicenseProf(capIDString);
	}

if ((capStatus == "Business Dissolved" || capStatus == "Inactive" || capStatus == "Expired")) {
	logDebug("Setting audit status inactive" );
	lp.setAuditStatus("I");
	lp.setAuditDate(sysDate);
	lp.setAuditID(currentUserID);
	aa.licenseScript.editRefLicenseProf(lp);
	}

if ((capStatus == "Active")) {
	logDebug("Setting audit status active" );
	lp.setAuditStatus("A");
	lp.setAuditDate(sysDate);
	lp.setAuditID(currentUserID);
	aa.licenseScript.editRefLicenseProf(lp);
	}
`^
ASU;Licenses!Clerk!Operator!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (capStatus == "Active" && isTaskActive("Common Council Hearing") == true) {
	closeTask("Common Council Hearing","Approved","Processed via ASU Script","");
	closeTask("License Issuance","Issued","Processed via ASU Script","");
	}

if (capStatus == "Active" && isTaskActive("License Issuance")) {
	closeTask("License Issuance","Issued","Processed via ASU Script","");
	}

if (capStatus == "Active" && isTaskActive("License Status") && isTaskStatus("License Status", "Active") == false) {
	updateTask("License Status","Active","Processed via ASU Script","");
	}

if (capStatus == "Active") {
	include("CMN;LICENSE;2YrExpJune30");
	aa.set.add("CL LIC DAILY",capId);
	}
`^
ASU;Licenses!Treasurer!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (cmnCategory != "Renewal" && capStatus == "Active" && isTaskActive("Intake") == true) {
	closeTask("Intake","Approved","Processed via ASU Script","");
	}

if (cmnCategory != "Renewal" && capStatus == "Active" && isTaskActive("License Status") && isTaskStatus("License Status", "Active") == false) {
	updateTask("License Status","Active","Processed via ASU Script","");
	include("CMN;LICENSE;ExpDec31");
	}

if (cmnCategory != "Renewal" && capStatus == "Active") {
	licEditExpInfo("Active", null);
	}

if (cmnCategory == "Renewal" && capStatus == "Active") {
	updateAppStatus("Closed", "Set to Active by renewal process.", capId);
	}

include("CMN;Licenses!Treasurer!~!~;SetRenewalInfo");
`^
ASU;Licenses!Treasurer!Cat Registration!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
proj = aa.cap.getProjectByChildCapID(capId, "Renewal", "Review");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	parentCapId = proj[0].getProjectID();
	}

if (capStatus == "Active" && projSuccess == true) {
	pConArray = getContactArray(parentCapId);
	}

if (capStatus == "Active" && projSuccess == true && pConArray != null) {
	for (pC in pConArray) include("CMN;Licenses!Treasurer!~!~;ContactCompare");
	}

if (capStatus == "Active" && projSuccess == true) {
	copyContacts(capId, parentCapId);
	}

if (capStatus == "Active" && projSuccess == true) {
	copyASIFields(capId, parentCapId);
	}

if (capStatus == "Active" && projSuccess == true) {
	ad = aa.address.getAddressByCapId(parentCapId).getOutput();
	}

if (capStatus == "Active" && projSuccess == true) {
	for (a in ad) aa.address.removeAddress(parentCapId, ad[a].getAddressId());
	}

if (capStatus == "Active" && projSuccess == true) {
	copyAddresses(capId, parentCapId);
	}

if (capStatus == "Active" && projSuccess == true) {
	aa.cap.copyRenewCapDocument(capId, parentCapId, currentUserID);
	}

if (capStatus == "Active" && projSuccess == true) {
	updateAppStatus("Active", "Set to Active by renewal process.", parentCapId);
	}

if (capStatus == "Active" && projSuccess == true) {
	tempCapId = capId;
	capId = parentCapId;
	licEditExpInfo("Active", null);
	capId = tempCapId;
	}

if (capStatus == "Active" && projSuccess == true) {
	tempCapId = capId;
	capId = parentCapId;
	include("CMN;LICENSE;ExpDec31");
	capId = tempCapId;
	}

if (capStatus == "Active" && projSuccess == true) {
	proj[0].setStatus("Complete");
	aa.cap.updateProject(proj[0]);
	}
`^
ASU;Licenses!Treasurer!Chicken Owner!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
proj = aa.cap.getProjectByChildCapID(capId, "Renewal", "Review");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	parentCapId = proj[0].getProjectID();
	}

if (capStatus == "Active" && projSuccess == true) {
	pConArray = getContactArray(parentCapId);
	}

if (capStatus == "Active" && projSuccess == true && pConArray != null) {
	for (pC in pConArray) include("CMN;Licenses!Treasurer!~!~;ContactCompare");
	}

if (capStatus == "Active" && projSuccess == true) {
	copyContacts(capId, parentCapId);
	}

if (capStatus == "Active" && projSuccess == true) {
	copyASIFields(capId, parentCapId);
	}

if (capStatus == "Active" && projSuccess == true) {
	ad = aa.address.getAddressByCapId(parentCapId).getOutput();
	}

if (capStatus == "Active" && projSuccess == true) {
	for (a in ad) aa.address.removeAddress(parentCapId, ad[a].getAddressId());
	}

if (capStatus == "Active" && projSuccess == true) {
	copyAddresses(capId, parentCapId);
	}

if (capStatus == "Active" && projSuccess == true) {
	copyOwner(capId, parentCapId);
	}

if (capStatus == "Active" && projSuccess == true) {
	aa.cap.copyRenewCapDocument(capId, parentCapId, currentUserID);
	}

if (capStatus == "Active" && projSuccess == true) {
	updateAppStatus("Active", "Set to Active by renewal process.", parentCapId);
	}

if (capStatus == "Active" && projSuccess == true) {
	tempCapId = capId;
	capId = parentCapId;
	licEditExpInfo("Active", null);
	capId = tempCapId;
	}

if (capStatus == "Active" && projSuccess == true) {
	tempCapId = capId;
	capId = parentCapId;
	include("CMN;LICENSE;ExpDec31");
	capId = tempCapId;
	}

if (capStatus == "Active" && projSuccess == true) {
	proj[0].setStatus("Complete");
	aa.cap.updateProject(proj[0]);
	}
`^
ASU;Licenses!Treasurer!Dog Registration!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
proj = aa.cap.getProjectByChildCapID(capId, "Renewal", "Review");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	parentCapId = proj[0].getProjectID();
	}

if (capStatus == "Active" && projSuccess == true) {
	pConArray = getContactArray(parentCapId);
	}

if (capStatus == "Active" && projSuccess == true && pConArray != null) {
	for (pC in pConArray) include("CMN;Licenses!Treasurer!~!~;ContactCompare");
	}

if (capStatus == "Active" && projSuccess == true) {
	copyContacts(capId, parentCapId);
	}

if (capStatus == "Active" && projSuccess == true) {
	copyASIFields(capId, parentCapId);
	}

if (capStatus == "Active" && projSuccess == true) {
	ad = aa.address.getAddressByCapId(parentCapId).getOutput();
	}

if (capStatus == "Active" && projSuccess == true) {
	for (a in ad) aa.address.removeAddress(parentCapId, ad[a].getAddressId());
	}

if (capStatus == "Active" && projSuccess == true) {
	copyAddresses(capId, parentCapId);
	}

if (capStatus == "Active" && projSuccess == true) {
	aa.appSpecificTableScript.removeAppSpecificTableInfos("PERMITS", parentCapId, currentUserID);
	}

if (capStatus == "Active" && projSuccess == true) {
	copyASITables(capId, parentCapId);
	}

if (capStatus == "Active" && projSuccess == true) {
	aa.cap.copyRenewCapDocument(capId, parentCapId, currentUserID);
	}

if (capStatus == "Active" && projSuccess == true) {
	updateAppStatus("Active", "Set to Active by renewal process.", parentCapId);
	}

if (capStatus == "Active" && projSuccess == true) {
	tempCapId = capId;
	capId = parentCapId;
	licEditExpInfo("Active", null);
	capId = tempCapId;
	}

if (capStatus == "Active" && projSuccess == true) {
	tempCapId = capId;
	capId = parentCapId;
	include("CMN;LICENSE;ExpDec31");
	capId = tempCapId;
	}

if (capStatus == "Active" && projSuccess == true) {
	proj[0].setStatus("Complete");
	aa.cap.updateProject(proj[0]);
	}
`^
ASU;Licenses!Treasurer!Kennel!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
proj = aa.cap.getProjectByChildCapID(capId, "Renewal", "Review");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	parentCapId = proj[0].getProjectID();
	}

if (capStatus == "Active" && projSuccess == true) {
	pConArray = getContactArray(parentCapId);
	}

if (capStatus == "Active" && projSuccess == true && pConArray != null) {
	for (pC in pConArray) include("CMN;Licenses!Treasurer!~!~;ContactCompare");
	}

if (capStatus == "Active" && projSuccess == true) {
	copyContacts(capId, parentCapId);
	}

if (capStatus == "Active" && projSuccess == true) {
	copyASIFields(capId, parentCapId);
	}

if (capStatus == "Active" && projSuccess == true) {
	ad = aa.address.getAddressByCapId(parentCapId).getOutput();
	}

if (capStatus == "Active" && projSuccess == true) {
	for (a in ad) aa.address.removeAddress(parentCapId, ad[a].getAddressId());
	}

if (capStatus == "Active" && projSuccess == true) {
	copyAddresses(capId, parentCapId);
	}

if (capStatus == "Active" && projSuccess == true) {
	aa.cap.copyRenewCapDocument(capId, parentCapId, currentUserID);
	}

if (capStatus == "Active" && projSuccess == true) {
	updateAppStatus("Active", "Set to Active by renewal process.", parentCapId);
	}

if (capStatus == "Active" && projSuccess == true) {
	tempCapId = capId;
	capId = parentCapId;
	licEditExpInfo("Active", null);
	capId = tempCapId;
	}

if (capStatus == "Active" && projSuccess == true) {
	tempCapId = capId;
	capId = parentCapId;
	include("CMN;LICENSE;ExpDec31");
	capId = tempCapId;
	}

if (capStatus == "Active" && projSuccess == true) {
	proj[0].setStatus("Complete");
	aa.cap.updateProject(proj[0]);
	}
`^
ASU;Permitting!~!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
capClosed = false;
hasExpire = null;
if ((capStatus == "Void" || capStatus == "Business Dissolved" || capStatus == "Closed" || capStatus == "Inactive")) {
	capClosed = true;
	}

result = aa.expiration.isExpiredLicenses(capId);
hasExpire = result.getErrorMessage();
if (capClosed && hasExpire != null) {
	licEditExpInfo("Inactive", null);
	}

if (capClosed) {
	include("CMN;AssignCapBlank");
	}

if (capClosed) {
	inspCancelAll();
	}
`^
ASU;Permitting!Building!RepairReplace!Construction^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (capStatus == "Issued") {
	branchTask("Intake","No Zoning or Plan Review","Auto Issuance","Auto Issuance");
	closeTask("Permit Issuance","Issued","Auto Issuance","Auto Issuance");
	include("CMN;AssignBldgInsp");
	}
`^
ASU;Permitting!Engineering!ROW!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (currentUserID=="ITPTO") {
	getOwnerfromParcel();
	copyParcelGisObjects();
	}
`^
ASU;Permitting!Parking!Residential Parking!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
wfTask = "Issuance";
wfStatus = "Issued";
include("CMN;Permitting!Parking!Residential Parking!~;SetRenewalInfo");
if (capStatus == "Permit Issued") {
	closeTask("Intake", "Approved","Updated by Application Status update");
	closeTask("Issuance","Issued","Updated by Application Status update");
	include("EML;Permitting!Parking!Residential Parking!NA;ACA");
	}

if (capStatus == "Active" && isTaskActive("License Status") == true) {
	licEditExpInfo("Active", null);
	}
`^
ASU;Permitting!Parking!Residential Parking!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (capStatus == "Active" && isTaskActive("Intake") == true && (isTaskStatus("Issuance", "Temporary") == false || isTaskStatus("License Status", "Temporary Permit Active") == false)) {
	closeTask("Intake","Approved","Processed via ASU Script","");
	closeTask("Issuance","Issued","Processed via ASU Script","");
	updateTask("License Status","Active","Processed via ASU Script","");
	licEditExpInfo("Active", null);
	}

if (capStatus == "Active" && ((isTaskActive("Issuance") == true && isTaskStatus("Issuance", "Temporary") == true) || (isTaskActive("License Status") == true && isTaskStatus("License Status", "Temporary Permit Active") == true))) {
	updateAppStatus("Temporary Permit Active","Updated vis ASU script");
	licEditExpInfo("Active", null);
	}

if (capStatus == "Active" && isTaskActive("Closed") == true && isTaskStatus("License Status", "Expired") == true) {
	updateAppStatus("Expired","Updated vis ASU script");
	}

if (capStatus == "Active" && isTaskActive("Closed") == true && isTaskStatus("License Status", "Revoked") == true) {
	updateAppStatus("Revoked","Updated vis ASU script");
	}

if (capStatus == "Active" && isTaskActive("Closed") == true && isTaskStatus("License Status", "Surrendered") == true) {
	updateAppStatus("Surrendered","Updated vis ASU script");
	}

if (capStatus == "Active" && countActiveTasks("TUPRPP") == 0 && isTaskStatus("License Status", "Void")) {
	updateAppStatus("Void","Updated vis ASU script");
	}

if (capStatus == "Withdrawn") {
	taskCloseAllExcept("Withdrawn","Updated by ASU script");
	}

if (capStatus == "Active" && isTaskActive("License Status") == true) {
	licEditExpInfo("Active", null);
	}
`^
ASU;Permitting!Parking!Residential Parking!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (capStatus == "Active" && isTaskActive("Intake") == true && (isTaskStatus("Issuance", "Temporary") == false || isTaskStatus("License Status", "Temporary Permit Active") == false)) {
	closeTask("Intake","Approved","Processed via ASU Script","");
	closeTask("Issuance","Issued","Processed via ASU Script","");
	updateTask("License Status","Active","Processed via ASU Script","");
	licEditExpInfo("Active", null);
	}

if (capStatus == "Active" && ((isTaskActive("Issuance") == true && isTaskStatus("Issuance", "Temporary") == true) || (isTaskActive("License Status") == true && isTaskStatus("License Status", "Temporary Permit Active") == true))) {
	updateAppStatus("Temporary Permit Active","Updated vis ASU script");
	licEditExpInfo("Active", null);
	}

if (capStatus == "Active") {
	proj1 = aa.cap.getProjectByChildCapID(capId, "Renewal", "Review");
	projSuccess1 = proj1.getSuccess();
	}

if (capStatus == "Active" && projSuccess1 == true) {
	proj1 = proj1.getOutput();
	parentCapId = proj1[0].getProjectID();
	}

if (capStatus == "Active" && projSuccess1 == true) {
	proj1[0].setStatus("Complete");
	aa.cap.updateProject(proj1[0]);
	}

if (capStatus == "Active" && projSuccess1 == true) {
	licEditExpInfo("Active", null);
	}

if (capStatus == "Active" && isTaskActive("Closed") == true && isTaskStatus("License Status", "Expired") == true) {
	updateAppStatus("Expired","Updated vis ASU script");
	}

if (capStatus == "Active" && isTaskActive("Closed") == true && isTaskStatus("License Status", "Revoked") == true) {
	updateAppStatus("Revoked","Updated vis ASU script");
	}

if (capStatus == "Active" && isTaskActive("Closed") == true && isTaskStatus("License Status", "Surrendered") == true) {
	updateAppStatus("Surrendered","Updated vis ASU script");
	}

if (capStatus == "Active" && countActiveTasks("TUPRPP") == 0 && isTaskStatus("License Status", "Void")) {
	updateAppStatus("Void","Updated vis ASU script");
	}

if (capStatus == "Withdrawn") {
	taskCloseAllExcept("Withdrawn","Updated by ASU script");
	}
`^
ASU;ServiceRequest!Information Technology!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("EML;ServiceRequest!~!~!~;UpdateAssignedBy");
`^
ASU;ServiceRequest!Traffic Engineering!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("EML;ServiceRequest!~!~!~;UpdateAssignedBy");
`^
ASU;WeightsMeasures!~!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
capClosed = false;
hasExpire = null;
if ((capStatus == "About to Expire" || capStatus == "Expired") && isTaskActive("Intake")) {
	deactivateTask("Intake");
	activateTask("License Status");
	}

if ((capStatus == "About to Expire" || capStatus == "Expired") && isTaskActive("Issuance")) {
	deactivateTask("Issuance");
	activateTask("License Status");
	}

if ((capStatus == "About to Expire" || capStatus == "Expired") && isTaskActive("License Status")) {
	updateTask("License Status",capStatus,"Updated by script.","");
	licEditExpInfo(capStatus, null);
	}

if (capStatus == "Inactive" && isTaskActive("Intake")) {
	deactivateTask("Intake");
	activateTask("License Status");
	}

if (capStatus == "Inactive" && isTaskActive("Issuance")) {
	deactivateTask("Issuance");
	activateTask("License Status");
	}

if (capStatus == "Inactive" &&  isTaskActive("License Status")) {
	closeTask("License Status",capStatus,"Closed by script.","");
	}

if (capStatus == "Reinstate" && isTaskActive("Intake") != true && isTaskActive("Issuance") != true && isTaskActive("License Status") != true) {
	activateTask("Intake");
	licEditExpInfo("Pending", null);
	}

if ((capStatus == "Void" || capStatus == "Closed" || capStatus == "Inactive")) {
	capClosed = true;
	}

include("CMN;CloseRecord");
`^
ASUB;Licenses!Clerk!ClassABeerLiquor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (appStatus == "Audited") {
	message = "You must upload the Audited Renewal Paperwork to update the Audited status";
	showMessage = true;
	cancel = true;
	}
`^
ASUB;Licenses!Clerk!ClassBBeerLiquor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (appStatus == "Audited") {
	message = "You must upload the Audited Renewal Paperwork to update the Audited status";
	showMessage = true;
	cancel = true;
	}
`^
ASUB;WeightsMeasures!~!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (appStatus == "Reinstate" && (isTaskActive("Intake") || isTaskActive("Issuance") || isTaskActive("License Status"))) {
	cancel = true;
	showMessage = true;
	comment("Workflow is not closed, so no need to Reinstate, as not applicable to this record.");
	}
`^
CAA;Licenses!Civil Rights!AA Plan!CBO^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
rowCount = 0;
totF = 0;
totM = 0;
totR = 0;
totRow = 0;
totW = 0;
totB = 0;
totH = 0;
totA = 0;
bTot = false;
bDis = false;
bR= false;
bF = false;
bM = false;
bRow = false;
bW = false;
bB = false;
totN = 0;
tot2 = 0;
totOff = 0;
totPro = 0;
totTech = 0;
totSales = 0;
totClerk = 0;
totCraft = 0;
totOper = 0;
totLab = 0;
totSer = 0;
totDis = 0;
totEmp = 0;
totOffR = 0;
totProR = 0;
totTechR = 0;
totSalesR = 0;
totClerkR = 0;
totCraftR = 0;
totOperR = 0;
totLabR = 0;
totSerR = 0;
totOffW = 0;
totProW = 0;
totTechW = 0;
totSalesW = 0;
totClerkW = 0;
totCraftW = 0;
totOperW = 0;
totLabW = 0;
totSerW = 0;
totOffD = 0;
totProD = 0;
totTechD = 0;
totSalesD = 0;
totClerkD = 0;
totCraftD = 0;
totOperD = 0;
totLabD = 0;
totSerD = 0;
emailText = "";
gender = "";
disabled = "";
jobCat = "";
perW = 0;
perR = 0;
bH = false;
bA = false;
bN = false;
b2 = false;
bOff = false;
bLab = false;
bPro = false;
bTech = false;
bSales = false;
bClerk = false;
bCraft = false;
bOper = false;
bSer = false;
bDis = false;
bEmp = false;
bOffR = false;
bProR = false;
bTechR = false;
bSalesR = false;
bClerkR = false;
bCraftR = false;
bOperR = false;
bLabR = false;
bSerR = false;
bOffW = false;
bProW = false;
bTechW = false;
bSalesW = false;
bClerkW = false;
bCraftW = false;
bOperW = false;
bLabW = false;
bSerW = false;
bOffD = false;
bProD = false;
bTechD = false;
bSalesD = false;
bClerkD = false;
bCraftD = false;
bOperD = false;
bLabD = false;
bSerD = false;
createWAGS = false;
tableGroupModel = cap.getAppSpecificTableGroupModel();
tableModel = tableGroupModel.getTablesMap().values();
iTable = tableModel.iterator();
while (iTable.hasNext()) include("CMN;Licenses!DCR!AA Plan!NA;GetASITableGroups");
if (totEmp < 15) {
	cancel = true;
	showMessage = true;
	comment("Total employees needs to be 15 or greater.  You have specified " + totEmp + " employees.");
	}

if (totEmp >= 15) {
	modelASI = cap.getAppSpecificInfoGroups();
	iCurAsiGroup = modelASI.iterator();
	}

if (totEmp >= 15) {
	while (iCurAsiGroup.hasNext()) include("CMN;Licenses!DCR!AA Plan!NA;GetASIGroups");
	}

if (totEmp >= 15) {
	cap.setAppSpecificInfoGroups(modelASI);
	aa.env.setValue("CapModel",cap);
	}

if (totEmp >= 15 && createWAGS) {
	include("CMN;Licenses!Civil Rights!AA Plan!Public Works;CreateWAGSTable");
	}

if (totEmp >= 15 && !createWAGS) {
	aModel = cap.getAppSpecificTableGroupModel();
	}

if (totEmp >= 15 && !createWAGS) {
	aTablei = aModel.getTablesMap().values().iterator();
	}

if (totEmp >= 15 && !createWAGS) {
	while (aTablei.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Public Works;UpdateWAGSTable");
	}
`^
CAA;Licenses!Civil Rights!AA Plan!Exempt^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
rowCount = 0;
totF = 0;
totM = 0;
totR = 0;
totRow = 0;
totW = 0;
totB = 0;
totH = 0;
totA = 0;
totN = 0;
tot2 = 0;
totOff = 0;
totPro = 0;
totTech = 0;
totSales = 0;
totClerk = 0;
totCraft = 0;
totOper = 0;
totLab = 0;
totSer = 0;
totDis = 0;
totEmp = 0;
totOffR = 0;
totProR = 0;
totTechR = 0;
totSalesR = 0;
totClerkR = 0;
totCraftR = 0;
totOperR = 0;
totLabR = 0;
totSerR = 0;
totOffW = 0;
totProW = 0;
totTechW = 0;
totSalesW = 0;
totClerkW = 0;
totCraftW = 0;
totOperW = 0;
totLabW = 0;
totSerW = 0;
totOffD = 0;
totProD = 0;
totTechD = 0;
totSalesD = 0;
totClerkD = 0;
totCraftD = 0;
totOperD = 0;
totLabD = 0;
totSerD = 0;
emailText = "";
gender = "";
disabled = "";
jobCat = "";
perW = 0;
perR = 0;
bTot = false;
bDis = false;
bR= false;
bF = false;
bM = false;
bRow = false;
bW = false;
bB = false;
bH = false;
bA = false;
bN = false;
b2 = false;
bOff = false;
bPro = false;
bTech = false;
bSales = false;
bClerk = false;
bCraft = false;
bOper = false;
bLab = false;
bSer = false;
bDis = false;
bEmp = false;
bOffR = false;
bProR = false;
bTechR = false;
bSalesR = false;
bClerkR = false;
bCraftR = false;
bOperR = false;
bLabR = false;
bSerR = false;
bOffW = false;
bProW = false;
bTechW = false;
bSalesW = false;
bClerkW = false;
bCraftW = false;
bOperW = false;
bLabW = false;
bSerW = false;
bOffD = false;
bProD = false;
bTechD = false;
bSalesD = false;
bClerkD = false;
bCraftD = false;
bOperD = false;
bLabD = false;
bSerD = false;
tableGroupModel = cap.getAppSpecificTableGroupModel();
tableModel = tableGroupModel.getTablesMap().values();
iTable = tableModel.iterator();
emailText = "";
asiModel = aa.appSpecificTableScript.getAppSpecificTableModel(capId, "WORKFORCE HEAD COUNT").getOutput();
while (iTable.hasNext()) include("CMN;Licenses!DCR!AA Plan!NA;GetASITableGroups");
if (totEmp >= 15) {
	cancel = true;
	showMessage = true;
	comment("If you have 15 or more employees, you must file an affirmative action plan. Your firm must have less than 15 employees to qualify for an exemption.");
	}
`^
CAA;Licenses!Civil Rights!AA Plan!Exempt Under $25,000^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
rowCount = 0;
totF = 0;
totM = 0;
totR = 0;
totRow = 0;
totW = 0;
totB = 0;
totH = 0;
totA = 0;
totN = 0;
tot2 = 0;
totOff = 0;
totPro = 0;
totTech = 0;
totSales = 0;
totClerk = 0;
totCraft = 0;
totOper = 0;
totLab = 0;
totSer = 0;
totDis = 0;
totEmp = 0;
totOffR = 0;
totProR = 0;
totTechR = 0;
totSalesR = 0;
totClerkR = 0;
totCraftR = 0;
totOperR = 0;
totLabR = 0;
totSerR = 0;
totOffW = 0;
totProW = 0;
totTechW = 0;
totSalesW = 0;
totClerkW = 0;
totCraftW = 0;
totOperW = 0;
totLabW = 0;
totSerW = 0;
totOffD = 0;
totProD = 0;
totTechD = 0;
totSalesD = 0;
totClerkD = 0;
totCraftD = 0;
totOperD = 0;
totLabD = 0;
totSerD = 0;
emailText = "";
gender = "";
disabled = "";
jobCat = "";
perW = 0;
perR = 0;
bTot = false;
bDis = false;
bR= false;
bF = false;
bM = false;
bRow = false;
bW = false;
bB = false;
bH = false;
bA = false;
bN = false;
b2 = false;
bOff = false;
bPro = false;
bTech = false;
bSales = false;
bClerk = false;
bCraft = false;
bOper = false;
bLab = false;
bSer = false;
bDis = false;
bEmp = false;
bOffR = false;
bProR = false;
bTechR = false;
bSalesR = false;
bClerkR = false;
bCraftR = false;
bOperR = false;
bLabR = false;
bSerR = false;
bOffW = false;
bProW = false;
bTechW = false;
bSalesW = false;
bClerkW = false;
bCraftW = false;
bOperW = false;
bLabW = false;
bSerW = false;
bOffD = false;
bProD = false;
bTechD = false;
bSalesD = false;
bClerkD = false;
bCraftD = false;
bOperD = false;
bLabD = false;
bSerD = false;
tableGroupModel = cap.getAppSpecificTableGroupModel();
tableModel = tableGroupModel.getTablesMap().values();
iTable = tableModel.iterator();
emailText = "";
asiModel = aa.appSpecificTableScript.getAppSpecificTableModel(capId, "WORKFORCE HEAD COUNT").getOutput();
while (iTable.hasNext()) include("CMN;Licenses!DCR!AA Plan!NA;GetASITableGroups");
`^
CAA;Licenses!Civil Rights!AA Plan!Public Works^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
rowCount = 0;
totF = 0;
totM = 0;
totR = 0;
totRow = 0;
totW = 0;
totB = 0;
totH = 0;
totA = 0;
bTot = false;
bDis = false;
bR= false;
bF = false;
bM = false;
bRow = false;
bW = false;
bB = false;
totN = 0;
tot2 = 0;
totOff = 0;
totPro = 0;
totTech = 0;
totSales = 0;
totClerk = 0;
totCraft = 0;
totOper = 0;
totLab = 0;
totSer = 0;
totDis = 0;
totEmp = 0;
totOffR = 0;
totProR = 0;
totTechR = 0;
totSalesR = 0;
totClerkR = 0;
totCraftR = 0;
totOperR = 0;
totLabR = 0;
totSerR = 0;
totOffW = 0;
totProW = 0;
totTechW = 0;
totSalesW = 0;
totClerkW = 0;
totCraftW = 0;
totOperW = 0;
totLabW = 0;
totSerW = 0;
totOffD = 0;
totProD = 0;
totTechD = 0;
totSalesD = 0;
totClerkD = 0;
totCraftD = 0;
totOperD = 0;
totLabD = 0;
totSerD = 0;
emailText = "";
gender = "";
disabled = "";
jobCat = "";
perW = 0;
perR = 0;
bH = false;
bA = false;
bN = false;
b2 = false;
bOff = false;
bLab = false;
bPro = false;
bTech = false;
bSales = false;
bClerk = false;
bCraft = false;
bOper = false;
bSer = false;
bDis = false;
bEmp = false;
bOffR = false;
bProR = false;
bTechR = false;
bSalesR = false;
bClerkR = false;
bCraftR = false;
bOperR = false;
bLabR = false;
bSerR = false;
bOffW = false;
bProW = false;
bTechW = false;
bSalesW = false;
bClerkW = false;
bCraftW = false;
bOperW = false;
bLabW = false;
bSerW = false;
bOffD = false;
bProD = false;
bTechD = false;
bSalesD = false;
bClerkD = false;
bCraftD = false;
bOperD = false;
bLabD = false;
bSerD = false;
createWAGS = false;
tableGroupModel = cap.getAppSpecificTableGroupModel();
tableModel = tableGroupModel.getTablesMap().values();
iTable = tableModel.iterator();
while (iTable.hasNext()) include("CMN;Licenses!DCR!AA Plan!NA;GetASITableGroups");
if (totEmp < 15) {
	cancel = true;
	showMessage = true;
	comment("Total employees needs to be 15 or greater.  You have specified " + totEmp + " employees.");
	}

if (totEmp >= 15) {
	modelASI = cap.getAppSpecificInfoGroups();
	iCurAsiGroup = modelASI.iterator();
	}

if (totEmp >= 15) {
	while (iCurAsiGroup.hasNext()) include("CMN;Licenses!DCR!AA Plan!NA;GetASIGroups");
	}

if (totEmp >= 15) {
	cap.setAppSpecificInfoGroups(modelASI);
	aa.env.setValue("CapModel",cap);
	}

if (totEmp >= 15 && createWAGS) {
	include("CMN;Licenses!Civil Rights!AA Plan!Public Works;CreateWAGSTable");
	}

if (totEmp >= 15 && !createWAGS) {
	aModel = cap.getAppSpecificTableGroupModel();
	}

if (totEmp >= 15 && !createWAGS) {
	aTablei = aModel.getTablesMap().values().iterator();
	}

if (totEmp >= 15 && !createWAGS) {
	while (aTablei.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Public Works;UpdateWAGSTable");
	}
`^
CAA;Licenses!Civil Rights!AA Plan!Vendors and Suppliers^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
rowCount = 0;
totF = 0;
totM = 0;
totR = 0;
totRow = 0;
totW = 0;
totB = 0;
totH = 0;
totA = 0;
bTot = false;
bDis = false;
bR= false;
bF = false;
bM = false;
bRow = false;
bW = false;
bB = false;
totN = 0;
tot2 = 0;
totOff = 0;
totPro = 0;
totTech = 0;
totSales = 0;
totClerk = 0;
totCraft = 0;
totOper = 0;
totLab = 0;
totSer = 0;
totDis = 0;
totEmp = 0;
totOffR = 0;
totProR = 0;
totTechR = 0;
totSalesR = 0;
totClerkR = 0;
totCraftR = 0;
totOperR = 0;
totLabR = 0;
totSerR = 0;
totOffW = 0;
totProW = 0;
totTechW = 0;
totSalesW = 0;
totClerkW = 0;
totCraftW = 0;
totOperW = 0;
totLabW = 0;
totSerW = 0;
totOffD = 0;
totProD = 0;
totTechD = 0;
totSalesD = 0;
totClerkD = 0;
totCraftD = 0;
totOperD = 0;
totLabD = 0;
totSerD = 0;
emailText = "";
gender = "";
disabled = "";
jobCat = "";
perW = 0;
perR = 0;
bH = false;
bA = false;
bN = false;
b2 = false;
bOff = false;
bLab = false;
bPro = false;
bTech = false;
bSales = false;
bClerk = false;
bCraft = false;
bOper = false;
bSer = false;
bDis = false;
bEmp = false;
bOffR = false;
bProR = false;
bTechR = false;
bSalesR = false;
bClerkR = false;
bCraftR = false;
bOperR = false;
bLabR = false;
bSerR = false;
bOffW = false;
bProW = false;
bTechW = false;
bSalesW = false;
bClerkW = false;
bCraftW = false;
bOperW = false;
bLabW = false;
bSerW = false;
bOffD = false;
bProD = false;
bTechD = false;
bSalesD = false;
bClerkD = false;
bCraftD = false;
bOperD = false;
bLabD = false;
bSerD = false;
createWAGS = false;
tableGroupModel = cap.getAppSpecificTableGroupModel();
tableModel = tableGroupModel.getTablesMap().values();
iTable = tableModel.iterator();
while (iTable.hasNext()) include("CMN;Licenses!DCR!AA Plan!NA;GetASITableGroups");
if (totEmp < 15) {
	cancel = true;
	showMessage = true;
	comment("Total employees needs to be 15 or greater.  You have specified " + totEmp + " employees.");
	}

if (totEmp >= 15) {
	modelASI = cap.getAppSpecificInfoGroups();
	iCurAsiGroup = modelASI.iterator();
	}

if (totEmp >= 15) {
	while (iCurAsiGroup.hasNext()) include("CMN;Licenses!DCR!AA Plan!NA;GetASIGroups");
	}

if (totEmp >= 15) {
	cap.setAppSpecificInfoGroups(modelASI);
	aa.env.setValue("CapModel",cap);
	}

if (totEmp >= 15 && createWAGS) {
	include("CMN;Licenses!Civil Rights!AA Plan!Public Works;CreateWAGSTable");
	}

if (totEmp >= 15 && !createWAGS) {
	aModel = cap.getAppSpecificTableGroupModel();
	}

if (totEmp >= 15 && !createWAGS) {
	aTablei = aModel.getTablesMap().values().iterator();
	}

if (totEmp >= 15 && !createWAGS) {
	while (aTablei.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Public Works;UpdateWAGSTable");
	}
`^
CAA;Licenses!Engineering!Prequalified Contractor!Na^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var catA = getAppSpecific("CATEGORIES.A");
var catB = getAppSpecific("CATEGORIES.B");
var catC = getAppSpecific("CATEGORIES.C");
if (catB = "CHECKED") {
	include("CMN;Licenses!Engineering!Prequalified Contractor!Na;GetAAPlanStatus");
	}
`^
CAB;Land!Landmark!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL INFORMATION.Authorization'] == "No") {
	cancel = true;
	showMessage = true;
	comment("You MUST have authorzation from owner to continue with this application.<br>Please contact City of Madison Building Inspection for more information.");
	}
`^
CAB;Licenses!Civil Rights!AA Plan!CBO^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "POLICY STATEMENT";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!CBO;LoopGroups");
`^
CAB;Licenses!Civil Rights!AA Plan!Developer^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "POLICY STATEMENT";
pgNum = 1;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Developer;LoopGroups");
`^
CAB;Licenses!Civil Rights!AA Plan!Public Works^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "POLICY STATEMENT";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Public Works;LoopGroups");
`^
CAB;Licenses!Civil Rights!AA Plan!Vendors and Suppliers^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "POLICY STATEMENT";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Vendors and Suppliers;LoopGroups");
`^
CAB;Licenses!Clerk!Operator!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
rowCount = 0;
livedCount = 0;
convict = "No";
if (getAppSpecific("ARREST AND CONVICTION RECORD.Since 17th birthday, have you been convicted of a felony or misdemeanor?") == "Yes") {
	convict = "Yes";
	}

if (getAppSpecific("ARREST AND CONVICTION RECORD.As a juvenile, were you ever waived into adult court and convicted of a felony or misdemeanor?") == "Yes") {
	convict = "Yes";
	}

if (getAppSpecific("ARREST AND CONVICTION RECORD.Have you ever been convicted by a military court-martial?") == "Yes") {
	convict = "Yes";
	}

if (getAppSpecific("ARREST AND CONVICTION RECORD.Ever been convicted of disorderly conduct that involved violence against another person?") == "Yes") {
	convict = "Yes";
	}

if (typeof(TICKETSORCONVICTIONS) == "object") {
	for (eachrow in TICKETSORCONVICTIONS) rowCount = rowCount + 1;
	}

if (convict == "Yes" && rowCount == 0) {
	cancel = true;
	showMessage = true;
	comment("You have indicated that you have convictions.  Please complete needed the CRIMINAL CONVICTIONS entries.");
	}

if (typeof(CITYSTATESLIVEDINSINCE18) == "object") {
	for (eachrow in CITYSTATESLIVEDINSINCE18) livedCount = livedCount + 1;
	}

if (livedCount == 0) {
	cancel = true;
	showMessage = true;
	comment("You must enter at least one row in the CITY STATES LIVED IN SINCE 18 table.");
	}
`^
CAB;Licenses!Clerk!Operator!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
rowCount = 0;
convict = "No";
if (getAppSpecific("ARREST AND CONVICTION RECORD.Since 17th birthday, have you been convicted of a felony or misdemeanor?") == "Yes") {
	convict = "Yes";
	}

if (getAppSpecific("ARREST AND CONVICTION RECORD.As a juvenile, were you ever waived into adult court and convicted of a felony or misdemeanor?") == "Yes") {
	convict = "Yes";
	}

if (getAppSpecific("ARREST AND CONVICTION RECORD.Have you ever been convicted by a military court-martial?") == "Yes") {
	convict = "Yes";
	}

if (getAppSpecific("ARREST AND CONVICTION RECORD.Ever been convicted of disorderly conduct that involved violence against another person?") == "Yes") {
	convict = "Yes";
	}

if (typeof(TICKETSORCONVICTIONS) == "object") {
	for (eachrow in TICKETSORCONVICTIONS) rowCount = rowCount + 1;
	}

if (convict == "Yes" && rowCount == 0) {
	cancel = true;
	showMessage = true;
	comment("You have indicated that you have convictions.  Please complete needed the CRIMINAL CONVICTIONS entries.");
	}
`^
CAB;Licenses!Engineering!Prequalified Contractor!Na^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "CATEGORIES";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
`^
CAB;Licenses!Engineering!Prequalified Contractor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "CATEGORIES";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
`^
CAB;Permitting!Building!RepairReplace!Construction^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
jobValue = 0;
jobValue = getAppSpecific("GENERAL INFORMATION.Total Job Value");
if (jobValue == 0) {
	cancel = true;
	showMessage = true;
	comment("Please enter the job cost (materials and labor) of the repairs in the appropriate fields.");
	}
`^
CAB;Permitting!Building!RepairReplace!Electrical^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
numOpen = 0;
numServ = 0;
specWiring = "No";
numOpen = getAppSpecific("GENERAL INFORMATION.Number of Openings Added or Moved");
numServ = getAppSpecific("GENERAL INFORMATION.Number of Service Entrances");
specWiring = getAppSpecific("GENERAL INFORMATION.Special Events Temporary Wiring");
if (numOpen == 0 && numServ == 0 && specWiring == "No") {
	cancel = true;
	showMessage = true;
	comment(" Please read the ~~IMPORTANT instructions above under Permit Details and GENERAL INFORMATION. Your application is missing information needed for processing.");
	}
`^
CAB;Permitting!Building!RepairReplace!HVAC^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
var sInfoMessage = "";
var bNoFurnBoil = false;
var bNoAir  = false;
var bNoCost = false;
var bNoOilTank = false;
var bNoStove = false;
var bNoChimWood = false;
var bNoChimSeparate = false;
if (AInfo['GENERAL INFORMATION.Type of Unit to be Replaced'] != null && AInfo['GENERAL INFORMATION.Type of Unit to be Replaced'] != "" && (AInfo['ALTERATION BTU LOSS.60,000'] != "CHECKED" && AInfo['ALTERATION BTU LOSS.165,000'] != "CHECKED" && AInfo['ALTERATION BTU LOSS.300,000'] != "CHECKED" && AInfo['ALTERATION BTU LOSS.500,000'] != "CHECKED" && AInfo['ALTERATION BTU LOSS.3,000,000'] != "CHECKED" && AInfo['ALTERATION BTU LOSS.4,000,000'] != "CHECKED" && AInfo['ALTERATION BTU LOSS.5,000,000'] != "CHECKED" && AInfo['ALTERATION BTU LOSS.6,000,000'] != "CHECKED")) {
	sInfoMessage  = "<br>You must check one amount from the ALTERATION BTU LOSS section in order to process this application.";
	}

if ((AInfo['GENERAL INFORMATION.Add On Air Conditioning (Residential Only)'] == null || AInfo['GENERAL INFORMATION.Add On Air Conditioning (Residential Only)'] == 0)) {
	bNoAir = true;
	}

if ((AInfo['GENERAL INFORMATION.Est. Cost of Alterations to Existing System (dollar amt)'] == null || AInfo['GENERAL INFORMATION.Est. Cost of Alterations to Existing System (dollar amt)'] == 0)) {
	bNoCost = true;
	}

if ((AInfo['GENERAL INFORMATION.Replace Oil Tank'] == null || AInfo['GENERAL INFORMATION.Replace Oil Tank'] == 0)) {
	bNoOilTank = true;
	}

if ((AInfo['GENERAL INFORMATION.Replace Oil or Wood Burning Stoves'] == null || AInfo['GENERAL INFORMATION.Replace Oil or Wood Burning Stoves'] == 0)) {
	bNoStove = true;
	}

if ((AInfo['GENERAL INFORMATION.Repair Chimney installed with wood burning equipment'] == null || AInfo['GENERAL INFORMATION.Repair Chimney installed with wood burning equipment'] == 0)) {
	bNoChimWood = true;
	}

if ((AInfo['GENERAL INFORMATION.Chimney Installed Separately'] == null || AInfo['GENERAL INFORMATION.Chimney Installed Separately'] == 0)) {
	bNoChimSeparate = true;
	}

if ((AInfo['GENERAL INFORMATION.Type of Unit to be Replaced'] == null || AInfo['GENERAL INFORMATION.Type of Unit to be Replaced'] == "")) {
	bNoFurnBoil = true;
	}

if (bNoFurnBoil == true && bNoAir  == true && bNoCost == true && bNoOilTank == true && bNoStove == true && bNoChimWood == true && bNoChimSeparate == true) {
	sInfoMessage = sInfoMessage + "<br>You have not entered enough information to process your permit application.<br><br>Please enter a number greater than zero in one or more of these fields;<br> 
	 
	 
	 
	•
	 
	Add On Air Conditioning (Residential Only)<br> 
	 
	 
	 
	•
	 
	Est. Cost of Alterations to Existing System (dollar amt)<br> 
	 
	 
	 
	•
	 
	Replace Oil Tank<br> 
	 
	 
	 
	•
	 
	Replace Oil or Wood Burning Stoves<br> 
	 
	 
	 
	•
	 
	Repair Chimney installed with wood burning equipment<br> 
	 
	 
	 
	•
	 
	Chimney Installed Separately<br><br> 
	 
	 
	 
	 
	and!or Select an option from 'Type of Unit to be Replaced' and a BTU Loss amount.";
	}

if (sInfoMessage != "") {
	cancel = true;
	showMessage = true;
	comment(sInfoMessage);
	}
`^
CAB;Permitting!Building!RepairReplace!Plumbing^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
fixturesTot = 0;
if (typeof(PLUMBINGFIXTURES) == "object") {
	for (eachrow in PLUMBINGFIXTURES) fixturesTot = fixturesTot  + parseInt(PLUMBINGFIXTURES[eachrow]["Quantity"]);
	}

if (AInfo['GENERAL INFORMATION.Total Linear Feet of Drain'] == 0 && AInfo['GENERAL INFORMATION.Water Main - private or services'] == 0 && AInfo['GENERAL INFORMATION.New Private Main'] == 0 && fixturesTot == 0) {
	cancel = true;
	showMessage = true;
	comment ("<br>You have not entered enough information to process your permit application.<br><br>Please enter a number greater than zero in one or more of these fields;<br> 
	 
	 
	 
	•
	 
	New Private Main<br> 
	 
	 
	 
	•
	 
	Total Linear Feet of Drain<br> 
	 
	 
	 
	•
	 
	Water Main fields<br><br>and!or<br><br> 
	 
	 
	enter one or more plumbing fixtures.");
	}
`^
CAB;Permitting!Fire!Alarm!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
projectInfoChecked = false;
if (AInfo['PROJECT INFORMATION.New'] == "CHECKED") {
	projectInfoChecked = true;
	}

if (AInfo['PROJECT INFORMATION.Alteration'] == "CHECKED") {
	projectInfoChecked = true;
	}

if (AInfo['PROJECT INFORMATION.Revision!Resubmittal'] == "CHECKED") {
	projectInfoChecked = true;
	}

if (AInfo['PROJECT INFORMATION.Demolition'] == "CHECKED") {
	projectInfoChecked = true;
	}

if (projectInfoChecked == false) {
	cancel = true;
	showMessage = true;
	comment("You must Check one of the following; 'New', 'Alteration', 'Revision!Resubmittal' or 'Demolition'." );
	}
`^
CAB;Permitting!Fire!AltFireSuppression!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
scopeWorkChecked= false;
if (AInfo['SCOPE OF WORK.New Alternate Fire Suppression System'] == "CHECKED") {
	scopeWorkChecked= true;
	}

if (AInfo['SCOPE OF WORK.Alter Alternate Fire Suppression System'] == "CHECKED") {
	scopeWorkChecked= true;
	}

if (AInfo['SCOPE OF WORK.Repair to Alternate Fire Supp System'] == "CHECKED") {
	scopeWorkChecked= true;
	}

if (AInfo['SCOPE OF WORK.Demolition'] == "CHECKED") {
	scopeWorkChecked= true;
	}

if (scopeWorkChecked == false) {
	cancel = true;
	showMessage = true;
	comment("You must Check one of the following; 'Demo', 'New', 'Alter', or 'Repair'." );
	}
`^
CAB;Permitting!Fire!ControlledEgress!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
scopeWorkChecked= false;
if (AInfo['SCOPE OF WORK.New Controlled Egress'] == "CHECKED") {
	scopeWorkChecked= true;
	}

if (AInfo['SCOPE OF WORK.Alter Controlled Egress'] == "CHECKED") {
	scopeWorkChecked= true;
	}

if (AInfo['SCOPE OF WORK.Repair Existing Controlled Egress'] == "CHECKED") {
	scopeWorkChecked= true;
	}

if (scopeWorkChecked == false) {
	cancel = true;
	showMessage = true;
	comment("You must Check one of the following; 'New', 'Alter', or 'Repair'." );
	}
`^
CAB;Permitting!Fire!KitchenHood!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
scopeWorkChecked= false;
if (AInfo['SCOPE OF WORK.New Kitchen Hood Extinguishing System'] == "CHECKED") {
	scopeWorkChecked= true;
	}

if (AInfo['SCOPE OF WORK.Alter Kitchen Hood Extinguishing System'] == "CHECKED") {
	scopeWorkChecked= true;
	}

if (AInfo['SCOPE OF WORK.Demolition'] == "CHECKED") {
	scopeWorkChecked= true;
	}

if (AInfo['SCOPE OF WORK.Repair to Kitchen Hood Extinguishing System'] == "CHECKED") {
	scopeWorkChecked= true;
	}

if (scopeWorkChecked == false) {
	cancel = true;
	showMessage = true;
	comment("You must Check one of the following;  'Demo','New', 'Alter', or 'Repair'." );
	}
`^
CAB;Permitting!Fire!Sprinkler!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
projectInfoChecked = false;
if (AInfo['PROJECT INFORMATION.New'] == "CHECKED") {
	projectInfoChecked = true;
	}

if (AInfo['PROJECT INFORMATION.Alteration'] == "CHECKED") {
	projectInfoChecked = true;
	}

if (AInfo['PROJECT INFORMATION.Revision!Resubmittal'] == "CHECKED") {
	projectInfoChecked = true;
	}

if (AInfo['PROJECT INFORMATION.Demolition'] == "CHECKED") {
	projectInfoChecked = true;
	}

if (projectInfoChecked == false) {
	cancel = true;
	showMessage = true;
	comment("You must Check one of the following; 'New', 'Alteration', 'Revision!Resubmittal' or 'Demolition'." );
	}
`^
CAB;Permitting!Health!POWTS!Holding Tank^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
bIsSanRec = false;
include("CMN;Permitting!Health!POWTS!~;SanitaryPermitExistsCheck");
if (bIsSanRec == true) {
	include("CMN;Permitting!Health!POWTS!~;SanPermitHoldingTankCheck");
	}
`^
CAB;Permitting!Health!POWTS!TAM^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
bIsSanRec = false;
include("CMN;Permitting!Health!POWTS!~;SanitaryPermitExistsCheck");
if (bIsSanRec == true) {
	include("CMN;Permitting!Health!POWTS!~;SanPermitTAMCheck");
	}
`^
CAB;Permitting!Health!Temp Food Establishment!Dane County Restaurant^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
rowCount = 0;
if (typeof(DATESOFEVENT) == "object") {
	for (eachrow in DATESOFEVENT) rowCount = rowCount + 1;
	}

if (rowCount < 1) {
	cancel = true;
	showMessage = true;
	comment("Please enter all dates of event.");
	}

primrest = getAppSpecific("FOOD SERVICE.Primarily Restaurant");
primret = getAppSpecific("FOOD SERVICE.Primarily Retail Food");
if (primrest != "CHECKED" && primret != "CHECKED") {
	cancel = true;
	showMessage = true;
	comment("Must select Primarily Restaurant or Primarily Retail Food");
	}

if (primrest == "CHECKED" && primret == "CHECKED") {
	cancel = true;
	showMessage = true;
	comment("Must select Primarily Restaurant or Primarily Retail Food not both.");
	}
`^
CAB;Permitting!Parks!Block Party!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
numOfRows = 0;
eventType = getAppSpecific("EVENT INFORMATION.Event Type");
compareNumber = getAppSpecific("EVENT INFORMATION.Number of Days");
numOfRows = loadASITables4ACA();
if (eventType.equals("One Day") && numOfRows != compareNumber) {
	cancel = true;
	showMessage = true;
	comment("You must define one event date in the Event Dates table.");
	}
`^
CAB;Permitting!Parks!DiscGolf!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Parks!DiscGolf!NA;PermitHolderValidation");
if (AInfo['GENERAL INFORMATION.Permit Type'] == "Annual" && parseInt(AInfo['GENERAL INFORMATION.Annual Permits Requested']) + parseInt(AInfo['GENERAL INFORMATION.Replacement Permits Requested']) < 1) {
	cancel = true;
	showMessage = true;
	comment("You must select one or more permits to proceed.");
	}

if (AInfo['GENERAL INFORMATION.Permit Type'] == "Daily" && parseInt(AInfo['GENERAL INFORMATION.Daily Permits Requested']) < 1) {
	cancel = true;
	showMessage = true;
	comment("You must select one or more permits to proceed.");
	}
`^
CAB;Permitting!Parks!DogPark!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL INFORMATION.Permit Type'] == "Annual" && parseInt(AInfo['GENERAL INFORMATION.Additional Permits Requested']) < 1) {
	cancel = true;
	showMessage = true;
	comment("You must select one or more permits to proceed." );
	}

if (AInfo['GENERAL INFORMATION.Permit Type'] == "Daily" && parseInt(AInfo['GENERAL INFORMATION.Daily Permits Requested']) < 1) {
	cancel = true;
	showMessage = true;
	comment("You must select one or more permits to proceed." );
	}
`^
CAB;Permitting!Parks!Electrical Amplification!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
isUsed = 0;
isUsed = checkSiteTimeAvail(AInfo['EVENT INFORMATION.Site Requested'], AInfo['EVENT INFORMATION.Site Times'], AInfo['EVENT INFORMATION.Date Requested']);
if (isUsed > 0) {
	cancel = true;
	showMessage = true;
	comment("The site, time, and date you selected is already being used.");
	}
`^
CAB;Permitting!Parks!SkiTrail!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Parks!SkiTrail!NA;PermitHolderValidation");
if (AInfo['GENERAL INFORMATION.Permit Type'] == "Annual" && (parseInt(AInfo['GENERAL INFORMATION.Annual Passes Requested']) + parseInt(AInfo['GENERAL INFORMATION.Replacement Passes Requested']) + parseInt(AInfo['GENERAL INFORMATION.Senior Passes Requested']) + parseInt(AInfo['GENERAL INFORMATION.Disabled Passes Requested'])) < 1) {
	cancel = true;
	showMessage = true;
	comment("You must select one or more permits to proceed.");
	}

if (AInfo['GENERAL INFORMATION.Permit Type'] == "Daily" && parseInt(AInfo['GENERAL INFORMATION.Daily Passes Requested']) < 1) {
	cancel = true;
	showMessage = true;
	comment("You must select one or more permits to proceed.");
	}
`^
CAB;Permitting!Parks!Street Use!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
numOfRows = 0;
eventType = getAppSpecific("EVENT INFORMATION.Event Type");
numOfRows = loadASITableRowCount4ACA("EVENT DATES", capId);
if (eventType.equals("Recurring One Day")) {
	compareNumber = getAppSpecific("EVENT INFORMATION.Number of Recurrences");
	} else {
	compareNumber = getAppSpecific("EVENT INFORMATION.Number of Days");
	}

if (eventType.equals("Recurring One Day") && parseInt(numOfRows) != parseInt(compareNumber)) {
	cancel = true;
	showMessage = true;
	comment("You must define the same number (" + numOfRows + ") of event dates in the Event Dates table as the Number of Recurrences (" + compareNumber + ").");
	}

if (eventType.equals("Multi-Day") && parseInt(numOfRows) != parseInt(compareNumber)) {
	cancel = true;
	showMessage = true;
	comment("You must define the same number (" + numOfRows + ") of event dates in the Event Dates table as the Number of Days (" + compareNumber + ").");
	}

if (eventType.equals("One Day") && parseInt(numOfRows) != parseInt(compareNumber)) {
	cancel = true;
	showMessage = true;
	comment("You must define one event date in the Event Dates table.");
	}
`^
CAB;Permitting!Vending!Banner!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
numOfRows= 0;
numOfRows = loadASITables4ACA();
if (numOfRows == 0) {
	cancel = true;
	showMessage = true;
	comment("You must setup atleast one Banner Request to continue (including a start!end date and location).");
	}
`^
CAB2;Licenses!Civil Rights!AA Plan!CBO^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "DISSEMINATION OF POLICY";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!CBO;LoopGroups");
`^
CAB2;Licenses!Civil Rights!AA Plan!Developer^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "PERFORMANCE EVALUATION";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Developer;LoopGroups");
`^
CAB2;Licenses!Civil Rights!AA Plan!Public Works^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "DISSEMINATION OF POLICY";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Public Works;LoopGroups");
`^
CAB2;Licenses!Civil Rights!AA Plan!Vendors and Suppliers^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "DISSEMINATION OF POLICY";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Vendors and Suppliers;LoopGroups");
`^
CAB2;Licenses!Engineering!Prequalified Contractor!Na^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "SECTION I";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
`^
CAB2;Licenses!Engineering!Prequalified Contractor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "SECTION I";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
`^
CAB2;Licenses!Health!Temp Food Establishment!DaneCounty^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
rest = getAppSpecific("FOOD SOURCE.Restaurant");
grocery = getAppSpecific("FOOD SOURCE.Retail Grocery");
wholesale = getAppSpecific("FOOD SOURCE.Wholesaler");
fsOther = getAppSpecific("FOOD SOURCE.Other");
if (rest != "CHECKED" && grocery != "CHECKED" && fsOther  != "CHECKED" && wholesale  != "CHECKED") {
	cancel = true;
	showMessage = true;
	comment("At least one Food Source must be selected.");
	}

offsite= getAppSpecific("FOOD PREPARATION SITE.Off-Site");
onsite= getAppSpecific("FOOD PREPARATION SITE.On-Site");
if (onsite != "CHECKED" && offsite != "CHECKED") {
	cancel = true;
	showMessage = true;
	comment("At least one Food Preparation Site must be selected.");
	}

inscool = getAppSpecific("FOOD TRANSPORT METHOD.Insulated cooler(s)");
reftruck = getAppSpecific("FOOD TRANSPORT METHOD.Refrigerated truck");
cambro = getAppSpecific("FOOD TRANSPORT METHOD.Cambro(s)");
ftOther = getAppSpecific("FOOD TRANSPORT METHOD.Other");
if (inscool != "CHECKED" && reftruck != "CHECKED" && cambro != "CHECKED" && ftOther != "CHECKED") {
	cancel = true;
	showMessage = true;
	comment("At least one Food Transport Method must be selected.");
	}

feinscool = getAppSpecific("FOOD EQUIPMENT PROVIDED.Insulated cooler(s)");
frigtruck = getAppSpecific("FOOD EQUIPMENT PROVIDED.Refrigerated truck");
fecambro = getAppSpecific("FOOD EQUIPMENT PROVIDED.Cambro(s)");
commfrig = getAppSpecific("FOOD EQUIPMENT PROVIDED.Commercial refrigeration");
freezer = getAppSpecific("FOOD EQUIPMENT PROVIDED.Freezer(s)");
holdingunit = getAppSpecific("FOOD EQUIPMENT PROVIDED.Electrical hot holding unit(s)");
grill = getAppSpecific("FOOD EQUIPMENT PROVIDED.Grill(s)");
if (feinscool != "CHECKED" && frigtruck != "CHECKED" && fecambro != "CHECKED" && commfrig != "CHECKED" && freezer != "CHECKED" && freezer != "CHECKED" && holdingunit != "CHECKED" && grill != "CHECKED") {
	cancel = true;
	showMessage = true;
	comment("At least one Food Equipment must be selected.");
	}

fmenu = getAppSpecific("FOOD AND BEVERAGES.List all the food and drink items you will be serving");
if (fmenu == "") {
	cancel = true;
	showMessage = true;
	comment("Must list Food and Beverage menu items.");
	}

plumbSink = getAppSpecific("HANDWASHING.Plumbing Sink");
tempStation = getAppSpecific("HANDWASHING.Temporary Station");
if (plumbSink != "CHECKED" && tempStation != "CHECKED") {
	cancel = true;
	showMessage = true;
	comment("At least one Hand Washing option must be selected.");
	}

readRules = getAppSpecific("ATTESTATION.I have read the Temporary Food Stands; Key Points brochure and agree to comply with all the requirem");
statementsTrue = getAppSpecific("ATTESTATION.The statements made in this application are true to the best of my knowledge.");
if (readRules != "CHECKED" || statementsTrue != "CHECKED") {
	cancel = true;
	showMessage = true;
	comment("Must read and agree to each Attestation item by checking box.");
	}
`^
CAB2;Permitting!Fire!Alarm!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
occupancyTypeChecked = false;
if (AInfo['OCCUPANCY TYPE.A1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.A2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.A3'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.A4'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.A5'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.B'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.E'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.F1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.F2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.H1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.H2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.H3'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.H4'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.H5'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.I1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.I2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.I3'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.I4'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.M'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.R1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.R2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.R3'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.R4'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.S1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.S2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.U'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (occupancyTypeChecked == false) {
	cancel = true;
	showMessage = true;
	comment("You must Check one or more Occupancy Types." );
	}
`^
CAB2;Permitting!Fire!AltFireSuppression!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
occupancyTypeChecked = false;
if (AInfo['OCCUPANCY TYPE.A1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.A2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.A3'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.A4'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.A5'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.B'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.E'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.F1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.F2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.H1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.H2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.H3'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.H4'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.H5'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.I1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.I2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.I3'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.I4'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.M'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.R1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.R2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.R3'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.R4'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.S1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.S2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.U'] == "CHECKED") {
	occupancyTypeChecked = true;
	}
`^
CAB2;Permitting!Fire!ControlledEgress!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
occupancyTypeChecked = false;
if (AInfo['OCCUPANCY TYPE.A1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.A2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.A3'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.A4'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.A5'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.B'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.E'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.F1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.F2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.H1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.H2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.H3'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.H4'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.H5'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.I1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.I2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.I3'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.I4'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.M'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.R1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.R2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.R3'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.R4'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.S1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.S2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.U'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (occupancyTypeChecked == false) {
	cancel = true;
	showMessage = true;
	comment("You must Check one or more Occupancy Types." );
	}
`^
CAB2;Permitting!Fire!KitchenHood!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
occupancyTypeChecked = false;
if (AInfo['OCCUPANCY TYPE.A1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.A2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.A3'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.A4'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.A5'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.B'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.E'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.F1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.F2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.H1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.H2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.H3'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.H4'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.H5'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.I1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.I2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.I3'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.I4'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.M'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.R1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.R2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.R3'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.R4'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.S1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.S2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.U'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (occupancyTypeChecked == false) {
	cancel = true;
	showMessage = true;
	comment("You must Check one or more Occupancy Types." );
	}
`^
CAB2;Permitting!Fire!Sprinkler!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
occupancyTypeChecked = false;
if (AInfo['OCCUPANCY TYPE.A1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.A2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.A3'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.A4'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.A5'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.B'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.E'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.F1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.F2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.H1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.H2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.H3'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.H4'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.H5'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.I1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.I2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.I3'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.I4'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.M'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.R1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.R2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.R3'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.R4'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.S1'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.S2'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (AInfo['OCCUPANCY TYPE.U'] == "CHECKED") {
	occupancyTypeChecked = true;
	}

if (occupancyTypeChecked == false) {
	cancel = true;
	showMessage = true;
	comment("You must Check one or more Occupancy Types." );
	}
`^
CAB2;Permitting!Health!Temp Food Establishment!Dane County Restaurant^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
rest = getAppSpecific("FOOD SOURCE.Restaurant");
retgroc = getAppSpecific("FOOD SOURCE.Retail Grocery");
wholesale = getAppSpecific("FOOD SOURCE.Wholesaler");
fsother = getAppSpecific("FOOD SOURCE.Other");
if (rest != "CHECKED" && retgroc  != "CHECKED" && fsother  != "CHECKED" && wholesale  != "CHECKED") {
	cancel = true;
	showMessage = true;
	comment("At least one Food Source must be selected.");
	}

offsite= getAppSpecific("FOOD PREPARATION SITE.Off-Site");
onsite= getAppSpecific("FOOD PREPARATION SITE.On-Site");
if (onsite != "CHECKED" && offsite != "CHECKED") {
	cancel = true;
	showMessage = true;
	comment("At least one Food Preparation Site must be selected.");
	}

inscool = getAppSpecific("FOOD TRANSPORT METHOD.Insulated cooler(s)");
ftother = getAppSpecific("FOOD TRANSPORT METHOD.Other");
reftruck = getAppSpecific("FOOD TRANSPORT METHOD.Refrigerated truck");
cambro = getAppSpecific("FOOD TRANSPORT METHOD.Cambro(s)");
if (inscool != "CHECKED" && ftother != "CHECKED" && reftruck != "CHECKED" && cambro != "CHECKED") {
	cancel = true;
	showMessage = true;
	comment("At least one Food Transport Method must be selected.");
	}

feinscool = getAppSpecific("FOOD EQUIPMENT PROVIDED.Insulated cooler(s)");
fecambro = getAppSpecific("FOOD EQUIPMENT PROVIDED.Cambro(s)");
freezer = getAppSpecific("FOOD EQUIPMENT PROVIDED.Freezer(s)");
grill = getAppSpecific("FOOD EQUIPMENT PROVIDED.Grill(s)");
frigtruck = getAppSpecific("FOOD EQUIPMENT PROVIDED.Refrigerated truck");
commfrig = getAppSpecific("FOOD EQUIPMENT PROVIDED.Commercial refrigeration");
holdingunit = getAppSpecific("FOOD EQUIPMENT PROVIDED.Electrical hot holding unit(s)");
if (grill != "CHECKED" && feinscool != "CHECKED" && fecambro != "CHECKED" && freezer != "CHECKED" && commfrig != "CHECKED" && frigtruck != "CHECKED"  && freezer != "CHECKED" &&  holdingunit != "CHECKED") {
	cancel = true;
	showMessage = true;
	comment("At least one Food Equipment must be selected.");
	}

fmenu = getAppSpecific("FOOD AND DRINKS.List all the food and drink items you will be serving");
if (fmenu == "") {
	cancel = true;
	showMessage = true;
	comment("Must list Food and Drinks menu items.");
	}
`^
CAB3;Licenses!Civil Rights!AA Plan!CBO^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "PAYROLL PRACTICES";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!CBO;LoopGroups");
`^
CAB3;Licenses!Civil Rights!AA Plan!Public Works^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "PAYROLL PRACTICES";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Public Works;LoopGroups");
`^
CAB3;Licenses!Civil Rights!AA Plan!Vendors and Suppliers^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "PAYROLL PRACTICES";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Vendors and Suppliers;LoopGroups");
`^
CAB3;Licenses!Engineering!Prequalified Contractor!Na^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "SECT II BUILDING DEMOLITION";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
`^
CAB3;Licenses!Engineering!Prequalified Contractor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "SECT II BUILDING DEMOLITION";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
`^
CAB4;Licenses!Civil Rights!AA Plan!CBO^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "COMPLAINT PROCEDURES";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!CBO;LoopGroups");
`^
CAB4;Licenses!Civil Rights!AA Plan!Public Works^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "COMPLAINT PROCEDURES";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Public Works;LoopGroups");
`^
CAB4;Licenses!Civil Rights!AA Plan!Vendors and Suppliers^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "COMPLAINT PROCEDURES";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Vendors and Suppliers;LoopGroups");
`^
CAB4;Licenses!Engineering!Prequalified Contractor!Na^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "SECTION III";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
`^
CAB4;Licenses!Engineering!Prequalified Contractor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "SECTION III";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
`^
CAB5;Licenses!Civil Rights!AA Plan!CBO^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var gm = null;
var ta = null;
var collBar = null;
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "GOALS";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!CBO;LoopGroups");
gm =  cap.getAppSpecificTableGroupModel();
debugObject(gm);
if (gm != null) {
	ta = gm.getTablesMap();
	debugObject(ta.values().toArray()[2]);
	}

if (ta != null) {
	collBar = ta.values().toArray()[2];
	logDebug("CB; " + collBar.rowIndex);
	}

if (collBar != null && collBar.rowIndex == "[]" && AInfo['COLLECTIVE BARGAINING.We are party to collective bargaining'] == "CHECKED") {
	cancel = true;
	showMessage = true;
	comment("You must add at least one Union to the Collective Bargaining table to continue.");
	}

if (collBar != null && collBar.rowIndex != "[]" && AInfo['COLLECTIVE BARGAINING.We are not party to collective bargaining'] == "CHECKED") {
	cancel = true;
	showMessage = true;
	comment("75b was chosen, do not add a Union to the Collective Bargaining table.");
	}
`^
CAB5;Licenses!Civil Rights!AA Plan!Public Works^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var gm = null;
var ta = null;
var collBar = null;
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "GOALS";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Public Works;LoopGroups");
gm =  cap.getAppSpecificTableGroupModel();
if (gm != null) {
	ta = gm.getTablesMap();
	}

if (ta != null) {
	collBar = ta.values().toArray()[2];
	logDebug("CB; " + collBar.rowIndex);
	}

if (collBar != null && collBar.rowIndex == "[]" && AInfo['COLLECTIVE BARGAINING.We are party to collective bargaining'] == "CHECKED") {
	cancel = true;
	showMessage = true;
	comment("You must define at least one Union to the Collective Bargaining table to continue.");
	}

if (collBar != null && collBar.rowIndex != "[]" && AInfo['COLLECTIVE BARGAINING.We are not party to collective bargaining'] == "CHECKED") {
	cancel = true;
	showMessage = true;
	comment("75b was chosen, do not add a Union to the Collective Bargaining table.");
	}
`^
CAB5;Licenses!Civil Rights!AA Plan!Vendors and Suppliers^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var gm = null;
var ta = null;
var collBar = null;
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "GOALS";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Vendors and Suppliers;LoopGroups");
gm =  cap.getAppSpecificTableGroupModel();
debugObject(gm);
if (gm != null) {
	ta = gm.getTablesMap();
	debugObject(ta.values().toArray()[2]);
	}

if (ta != null) {
	collBar = ta.values().toArray()[2];
	logDebug("CB; " + collBar.rowIndex);
	}

if (collBar != null && collBar.rowIndex == "[]" && AInfo['COLLECTIVE BARGAINING.We are party to collective bargaining'] == "CHECKED") {
	cancel = true;
	showMessage = true;
	comment("You must define at least one Union to the Collective Bargaining table to continue.");
	}

if (collBar != null && collBar.rowIndex != "[]" && AInfo['COLLECTIVE BARGAINING.We are not party to collective bargaining'] == "CHECKED") {
	cancel = true;
	showMessage = true;
	comment("75b was chosen, do not add a Union to the Collective Bargaining table.");
	}
`^
CAB5;Licenses!Engineering!Prequalified Contractor!Na^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "SECTION IV 1-13";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
`^
CAB5;Licenses!Engineering!Prequalified Contractor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "SECTION IV 1-13";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
`^
CAB6;Licenses!Civil Rights!AA Plan!CBO^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "GOALS AND GOOD FAITH EFFORTS";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!CBO;LoopGroups");
`^
CAB6;Licenses!Civil Rights!AA Plan!Public Works^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "GOALS AND GOOD FAITH EFFORTS";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Public Works;LoopGroups");
`^
CAB6;Licenses!Civil Rights!AA Plan!Vendors and Suppliers^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "GOALS AND GOOD FAITH EFFORTS";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Vendors and Suppliers;LoopGroups");
`^
CAB6;Licenses!Engineering!Prequalified Contractor!Na^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "20.1";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
`^
CAB6;Licenses!Engineering!Prequalified Contractor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "20.1";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
`^
CAB7;Licenses!Civil Rights!AA Plan!CBO^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "PERFORMANCE EVALUATION";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!CBO;LoopGroups");
`^
CAB7;Licenses!Civil Rights!AA Plan!Public Works^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "PERFORMANCE EVALUATION";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Public Works;LoopGroups");
`^
CAB7;Licenses!Civil Rights!AA Plan!Vendors and Suppliers^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "PERFORMANCE EVALUATION";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Vendors and Suppliers;LoopGroups");
`^
CAB7;Licenses!Engineering!Prequalified Contractor!Na^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "23.";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
`^
CAB7;Licenses!Engineering!Prequalified Contractor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "23.";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
`^
CAB8;Licenses!Engineering!Prequalified Contractor!Na^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "28.";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
`^
CAB8;Licenses!Engineering!Prequalified Contractor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "28.";
pgNum = 0;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
`^
CAO;Licenses!Civil Rights!AA Plan!CBO^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "POLICY STATEMENT";
pgNum = 1;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!CBO;LoopGroups");
include("CAB2;Licenses!Civil Rights!AA Plan!CBO");
include("CAB3;Licenses!Civil Rights!AA Plan!CBO");
include("CAB4;Licenses!Civil Rights!AA Plan!CBO");
include("CAB5;Licenses!Civil Rights!AA Plan!CBO");
include("CAB6;Licenses!Civil Rights!AA Plan!CBO");
include("CAB7;Licenses!Civil Rights!AA Plan!CBO");
`^
CAO;Licenses!Civil Rights!AA Plan!Developer^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "POLICY STATEMENT";
pgNum = 1;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Developer;LoopGroups");
include("CAB2;Licenses!Civil Rights!AA Plan!Developer");
`^
CAO;Licenses!Civil Rights!AA Plan!Public Works^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "POLICY STATEMENT";
pgNum = 1;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Public Works;LoopGroups");
include("CAB2;Licenses!Civil Rights!AA Plan!Public Works");
include("CAB3;Licenses!Civil Rights!AA Plan!Public Works");
include("CAB4;Licenses!Civil Rights!AA Plan!Public Works");
include("CAB5;Licenses!Civil Rights!AA Plan!Public Works");
include("CAB6;Licenses!Civil Rights!AA Plan!Public Works");
include("CAB7;Licenses!Civil Rights!AA Plan!Public Works");
`^
CAO;Licenses!Civil Rights!AA Plan!Vendors and Suppliers^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "POLICY STATEMENT";
pgNum = 1;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Vendors and Suppliers;LoopGroups");
include("CAB2;Licenses!Civil Rights!AA Plan!Vendors and Suppliers");
include("CAB3;Licenses!Civil Rights!AA Plan!Vendors and Suppliers");
include("CAB4;Licenses!Civil Rights!AA Plan!Vendors and Suppliers");
include("CAB5;Licenses!Civil Rights!AA Plan!Vendors and Suppliers");
include("CAB6;Licenses!Civil Rights!AA Plan!Vendors and Suppliers");
include("CAB7;Licenses!Civil Rights!AA Plan!Vendors and Suppliers");
`^
CAO;Licenses!Engineering!Prequalified Contractor!Na^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "CATEGORIES";
pgNum = 1;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
include("CAB2;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB3;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB4;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB5;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB6;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB7;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB8;Licenses!Engineering!Prequalified Contractor!Na");
`^
CAO;Licenses!Engineering!Prequalified Contractor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "CATEGORIES";
pgNum = 1;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
include("CAB2;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB3;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB4;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB5;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB6;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB7;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB8;Licenses!Engineering!Prequalified Contractor!Na");
`^
CAO2;Licenses!Civil Rights!AA Plan!CBO^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "DISSEMINATION OF POLICY";
pgNum = 2;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!CBO;LoopGroups");
`^
CAO2;Licenses!Civil Rights!AA Plan!Developer^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "PERFORMANCE EVALUATION";
pgNum = 7;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Developer;LoopGroups");
`^
CAO2;Licenses!Civil Rights!AA Plan!Public Works^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "DISSEMINATION OF POLICY";
pgNum = 2;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Public Works;LoopGroups");
`^
CAO2;Licenses!Civil Rights!AA Plan!Vendors and Suppliers^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "DISSEMINATION OF POLICY";
pgNum = 2;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Vendors and Suppliers;LoopGroups");
`^
CAO2;Licenses!Engineering!Prequalified Contractor!Na^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "SECTION I";
pgNum = 2;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
include("CAB;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB3;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB4;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB5;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB6;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB7;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB8;Licenses!Engineering!Prequalified Contractor!Na");
`^
CAO2;Licenses!Engineering!Prequalified Contractor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "SECTION I";
pgNum = 2;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
include("CAB;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB3;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB4;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB5;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB6;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB7;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB8;Licenses!Engineering!Prequalified Contractor!Na");
`^
CAO3;Licenses!Civil Rights!AA Plan!CBO^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "PAYROLL PRACTICES";
pgNum = 3;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!CBO;LoopGroups");
`^
CAO3;Licenses!Civil Rights!AA Plan!Public Works^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "PAYROLL PRACTICES";
pgNum = 3;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Public Works;LoopGroups");
`^
CAO3;Licenses!Civil Rights!AA Plan!Vendors and Suppliers^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "PAYROLL PRACTICES";
pgNum = 3;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Vendors and Suppliers;LoopGroups");
`^
CAO3;Licenses!Engineering!Prequalified Contractor!Na^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "SECT II BUILDING DEMOLITION";
pgNum = 3;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
include("CAB;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB2;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB4;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB5;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB6;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB7;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB8;Licenses!Engineering!Prequalified Contractor!Na");
`^
CAO3;Licenses!Engineering!Prequalified Contractor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "SECT II BUILDING DEMOLITION";
pgNum = 3;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
include("CAB;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB2;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB4;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB5;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB6;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB7;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB8;Licenses!Engineering!Prequalified Contractor!Na");
`^
CAO4;Licenses!Civil Rights!AA Plan!CBO^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "COMPLAINT PROCEDURES";
pgNum = 4;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!CBO;LoopGroups");
`^
CAO4;Licenses!Civil Rights!AA Plan!Public Works^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "COMPLAINT PROCEDURES";
pgNum = 4;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Public Works;LoopGroups");
`^
CAO4;Licenses!Civil Rights!AA Plan!Vendors and Suppliers^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "COMPLAINT PROCEDURES";
pgNum = 4;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Vendors and Suppliers;LoopGroups");
`^
CAO4;Licenses!Engineering!Prequalified Contractor!Na^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "SECTION III";
pgNum = 4;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
include("CAB;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB2;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB3;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB5;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB6;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB7;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB8;Licenses!Engineering!Prequalified Contractor!Na");
`^
CAO4;Licenses!Engineering!Prequalified Contractor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "SECTION III";
pgNum = 4;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
include("CAB;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB2;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB3;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB5;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB6;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB7;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB8;Licenses!Engineering!Prequalified Contractor!Na");
`^
CAO5;Licenses!Civil Rights!AA Plan!CBO^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "GOALS";
pgNum = 5;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!CBO;LoopGroups");
`^
CAO5;Licenses!Civil Rights!AA Plan!Public Works^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "GOALS";
pgNum = 5;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Public Works;LoopGroups");
`^
CAO5;Licenses!Civil Rights!AA Plan!Vendors and Suppliers^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "GOALS";
pgNum = 5;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Vendors and Suppliers;LoopGroups");
`^
CAO5;Licenses!Engineering!Prequalified Contractor!Na^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "SECTION IV 1-13";
pgNum = 5;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
include("CAB;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB2;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB3;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB4;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB6;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB7;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB8;Licenses!Engineering!Prequalified Contractor!Na");
`^
CAO5;Licenses!Engineering!Prequalified Contractor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "SECTION IV 1-13";
pgNum = 5;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
include("CAB;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB2;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB3;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB4;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB6;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB7;Licenses!Engineering!Prequalified Contractor!Na");
include("CAB8;Licenses!Engineering!Prequalified Contractor!Na");
`^
CAO6;Licenses!Civil Rights!AA Plan!CBO^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "GOALS AND GOOD FAITH EFFORTS";
pgNum = 6;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Public Works;LoopGroups");
`^
CAO6;Licenses!Civil Rights!AA Plan!Public Works^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "GOALS AND GOOD FAITH EFFORTS";
pgNum = 6;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Public Works;LoopGroups");
`^
CAO6;Licenses!Civil Rights!AA Plan!Vendors and Suppliers^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "GOALS AND GOOD FAITH EFFORTS";
pgNum = 6;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Vendors and Suppliers;LoopGroups");
`^
CAO6;Licenses!Engineering!Prequalified Contractor!Na^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "20.1";
pgNum = 6;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
`^
CAO6;Licenses!Engineering!Prequalified Contractor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "20.1";
pgNum = 6;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
`^
CAO7;Licenses!Civil Rights!AA Plan!CBO^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "PERFORMANCE EVALUATION";
pgNum = 7;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!CBO;LoopGroups");
`^
CAO7;Licenses!Civil Rights!AA Plan!Developer^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "PERFORMANCE EVALUATION";
pgNum = 7;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Developer;LoopGroups");
`^
CAO7;Licenses!Civil Rights!AA Plan!Public Works^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "PERFORMANCE EVALUATION";
pgNum = 7;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Public Works;LoopGroups");
`^
CAO7;Licenses!Civil Rights!AA Plan!Vendors and Suppliers^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "PERFORMANCE EVALUATION";
pgNum = 7;
while (aGroup.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Vendors and Suppliers;LoopGroups");
`^
CAO7;Licenses!Engineering!Prequalified Contractor!Na^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "23.";
pgNum = 7;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
`^
CAO7;Licenses!Engineering!Prequalified Contractor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "23.";
pgNum = 7;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
`^
CAO8;Licenses!Civil Rights!AA Plan!CBO^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CAB;Licenses!Civil Rights!AA Plan!CBO");
include("CAB2;Licenses!Civil Rights!AA Plan!CBO");
include("CAB3;Licenses!Civil Rights!AA Plan!CBO");
include("CAB4;Licenses!Civil Rights!AA Plan!CBO");
include("CAB5;Licenses!Civil Rights!AA Plan!CBO");
include("CAB6;Licenses!Civil Rights!AA Plan!CBO");
include("CAB7;Licenses!Civil Rights!AA Plan!CBO");
`^
CAO8;Licenses!Civil Rights!AA Plan!Public Works^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CAB;Licenses!Civil Rights!AA Plan!Public Works");
include("CAB2;Licenses!Civil Rights!AA Plan!Public Works");
include("CAB3;Licenses!Civil Rights!AA Plan!Public Works");
include("CAB4;Licenses!Civil Rights!AA Plan!Public Works");
include("CAB5;Licenses!Civil Rights!AA Plan!Public Works");
include("CAB6;Licenses!Civil Rights!AA Plan!Public Works");
include("CAB7;Licenses!Civil Rights!AA Plan!Public Works");
`^
CAO8;Licenses!Civil Rights!AA Plan!Vendors and Suppliers^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CAB;Licenses!Civil Rights!AA Plan!Vendors and Suppliers");
include("CAB2;Licenses!Civil Rights!AA Plan!Vendors and Suppliers");
include("CAB3;Licenses!Civil Rights!AA Plan!Vendors and Suppliers");
include("CAB4;Licenses!Civil Rights!AA Plan!Vendors and Suppliers");
include("CAB5;Licenses!Civil Rights!AA Plan!Vendors and Suppliers");
include("CAB6;Licenses!Civil Rights!AA Plan!Vendors and Suppliers");
include("CAB7;Licenses!Civil Rights!AA Plan!Vendors and Suppliers");
`^
CAO8;Licenses!Engineering!Prequalified Contractor!Na^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "28.";
pgNum = 8;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
`^
CAO8;Licenses!Engineering!Prequalified Contractor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aGroup = cap.getAppSpecificInfoGroups().iterator();
groupName = "28.";
pgNum = 8;
while (aGroup.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups");
`^
CDB;Licenses!Civil Rights!AA Plan!CBO^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var rDocs = new Array();
var returnMessage = "";
if (getAppSpecific("SUBCONTRACTORS.Yes - We are subcontracting or will subcontract and have attached a copy of our standard subcontract") == "CHECKED") {
	rDocs.push("36a. Copy of standard subcontract");
	}

if (getAppSpecific("PAYROLL PRACTICES.At a minimum of every two years, review the entire payroll for potential equal pay act and Title") == "CHECKED") {
	rDocs.push("53. A review that shows no inequity in the entire payroll for potential Equal Pay Act and Title VII issues, wage discrimination, and disparities in wage and promotional opportunities in the workforce.");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.For contractors with unions referring them labor (act as hiring halls), we agree to make job-specifi") == "CHECKED") {
	rDocs.push("76. A form that we will transmit to our unions making the specific request for all needed labor");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.One or some of our CBAs contain restrictions prohibiting hiring outside of the union, and we hav") == "Yes") {
	rDocs.push("77. Copy of cover and relevant pages of most recent CBAs");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Two new AA recruitment outreach correspondences (letters!emails!feature advertisements!documentati") == "CHECKED") {
	rDocs.push("78a. Two new AA recruitment outreach correspondences (letters!emails!feature advertisements!documentation of in-person meetings) to relevant dedicated diversity!minority!female programs, (trade) publications or organizations");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Participation in!registration for a diversity-focused job fair, including preparation of and (pros") == "CHECKED") {
	rDocs.push("78b. Documentation of participation in!registration for a diversity-focused job fair, including preparation of and (prospective) use of materials that include the specific language 'Affirmative Action!Equal Opportunity Employer'");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Development of!participation in diversity mentor!intern!apprenticeship hiring and!or training!trad") == "CHECKED") {
	rDocs.push("78c. Documentation of development of!participation in diversity mentor!intern!apprenticeship hiring and!or training!trade or advanced skills!education programs to increase racial!gender!disability equity in underutilized employment areas!job groups");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Affirmative inclusion and incorporation of more of your current, non-involved minorities, females") == "CHECKED") {
	rDocs.push("78d. Documentation of affirmative inclusion and incorporation of more of your current, non-involved minorities, females and!or people with disabilities into your recruitment!hiring process");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Actual increase in AA utilization; hiring of additional minority, female and!or people with disabi") == "CHECKED") {
	rDocs.push("78e. Documentation of Actual increase in AA utilization; hiring of additional minority, female and!or people with disabilities.");
	}

if (rDocs != null) {
	returnMessage = checkRequiredDocumentsACA(rDocs , capId);
	} else {
	returnMessage = "All Attached";
	}

if (returnMessage != "All Attached") {
	cancel = true;
	showMessage = true;
	returnMessage = "<font size='2'>" +  returnMessage + "<!font>";
	comment(returnMessage);
	}
`^
CDB;Licenses!Civil Rights!AA Plan!Developer^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var rDocs = new Array();
var returnMessage = "";
if (getAppSpecific("SUBCONTRACTORS.Yes") == "CHECKED") {
	rDocs.push("4A. Individual Developer Copy  of Standard Subcontract");
	}

if (rDocs != null) {
	returnMessage = checkRequiredDocumentsACA(rDocs , capId);
	} else {
	returnMessage = "All Attached";
	}

if (returnMessage != "All Attached") {
	cancel = true;
	showMessage = true;
	returnMessage = "<font size='2'>" +  returnMessage + "<!font>";
	comment(returnMessage);
	}
`^
CDB;Licenses!Civil Rights!AA Plan!Public Works^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var rDocs = new Array();
var returnMessage = "";
if (getAppSpecific("SUBCONTRACTORS.Yes - We are subcontracting or will subcontract and have attached a copy of our standard subcontract") == "CHECKED") {
	rDocs.push("36a. Copy of standard subcontract");
	}

if (getAppSpecific("PAYROLL PRACTICES.At a minimum of every two years, review the entire payroll for potential equal pay act and Title") == "CHECKED") {
	rDocs.push("53. A review that shows no inequity in the entire payroll for potential Equal Pay Act and Title VII issues, wage discrimination, and disparities in wage and promotional opportunities in the workforce.");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.For contractors with unions referring them labor (act as hiring halls), we agree to make job-specifi") == "CHECKED") {
	rDocs.push("76. A form that we will transmit to our unions making the specific request for all needed labor");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.One or some of our CBAs contain restrictions prohibiting hiring outside of the union, and we hav") == "Yes") {
	rDocs.push("77. Copy of cover and relevant pages of most recent CBAs");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Two new AA recruitment outreach correspondences (letters!emails!feature advertisements!documentati") == "CHECKED") {
	rDocs.push("78a. Two new AA recruitment outreach correspondences (letters!emails!feature advertisements!documentation of in-person meetings) to relevant dedicated diversity!minority!female programs, (trade) publications or organizations");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Participation in!registration for a diversity-focused job fair, including preparation of and (pros") == "CHECKED") {
	rDocs.push("78b. Documentation of participation in!registration for a diversity-focused job fair, including preparation of and (prospective) use of materials that include the specific language 'Affirmative Action!Equal Opportunity Employer'");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Development of!participation in diversity mentor!intern!apprenticeship hiring and!or training!trad") == "CHECKED") {
	rDocs.push("78c. Documentation of development of!participation in diversity mentor!intern!apprenticeship hiring and!or training!trade or advanced skills!education programs to increase racial!gender!disability equity in underutilized employment areas!job groups");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Affirmative inclusion and incorporation of more of your current, non-involved minorities, females") == "CHECKED") {
	rDocs.push("78d. Documentation of affirmative inclusion and incorporation of more of your current, non-involved minorities, females and!or people with disabilities into your recruitment!hiring process");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Actual increase in AA utilization; hiring of additional minority, female and!or people with disabi") == "CHECKED") {
	rDocs.push("78e. Documentation of Actual increase in AA utilization; hiring of additional minority, female and!or people with disabilities.");
	}

if (rDocs != null) {
	returnMessage = checkRequiredDocumentsACA(rDocs , capId);
	} else {
	returnMessage = "All Attached";
	}

if (returnMessage != "All Attached") {
	cancel = true;
	showMessage = true;
	returnMessage = "<font size='2'>" +  returnMessage + "<!font>";
	comment(returnMessage);
	}
`^
CDB;Licenses!Civil Rights!AA Plan!Vendors and Suppliers^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var rDocs = new Array();
var returnMessage = "";
if (getAppSpecific("PAYROLL PRACTICES.At a minimum of every two years, review the entire payroll for potential equal pay act and Title") == "CHECKED") {
	rDocs.push("53. A review that shows no inequity in the entire payroll for potential Equal Pay Act and Title VII issues, wage discrimination, and disparities in wage and promotional opportunities in the workforce.");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.For contractors with unions referring them labor (act as hiring halls), we agree to make job-specifi") == "CHECKED") {
	rDocs.push("76. A form that we will transmit to our unions making the specific request for all needed labor");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.One or some of our CBAs contain restrictions prohibiting hiring outside of the union, and we hav") == "Yes") {
	rDocs.push("77. Copy of cover and relevant pages of most recent CBAs");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Two new AA recruitment outreach correspondences (letters!emails!feature advertisements!documentati") == "CHECKED") {
	rDocs.push("78a. Two new AA recruitment outreach correspondences (letters!emails!feature advertisements!documentation of in-person meetings) to relevant dedicated diversity!minority!female programs, (trade) publications or organizations");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Participation in!registration for a diversity-focused job fair, including preparation of and (pros") == "CHECKED") {
	rDocs.push("78b. Documentation of participation in!registration for a diversity-focused job fair, including preparation of and (prospective) use of materials that include the specific language 'Affirmative Action!Equal Opportunity Employer'");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Development of!participation in diversity mentor!intern!apprenticeship hiring and!or training!trad") == "CHECKED") {
	rDocs.push("78c. Documentation of development of!participation in diversity mentor!intern!apprenticeship hiring and!or training!trade or advanced skills!education programs to increase racial!gender!disability equity in underutilized employment areas!job groups");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Affirmative inclusion and incorporation of more of your current, non-involved minorities, females") == "CHECKED") {
	rDocs.push("78d. Documentation of affirmative inclusion and incorporation of more of your current, non-involved minorities, females and!or people with disabilities into your recruitment!hiring process");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Actual increase in AA utilization; hiring of additional minority, female and!or people with disabi") == "CHECKED") {
	rDocs.push("78e. Documentation of Actual increase in AA utilization; hiring of additional minority, female and!or people with disabilities.");
	}

if (rDocs != null) {
	returnMessage = checkRequiredDocumentsACA(rDocs , capId);
	} else {
	returnMessage = "All Attached";
	}

if (returnMessage != "All Attached") {
	cancel = true;
	showMessage = true;
	returnMessage = "<font size='2'>" +  returnMessage + "<!font>";
	comment(returnMessage);
	}
`^
CDB;Licenses!Clerk!Operator!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
msg = "All Attached";
catCompare = new Array("Beverage Server Training Certificate");
msg = checkRequiredDocumentsACA(catCompare, capId);
if (msg != "All Attached") {
	catCompare2 = new Array("Operator License - Other Municipality");
	msg = checkRequiredDocumentsACA(catCompare2, capId);
	}

if (msg != "All Attached") {
	cancel = true;
	showMessage = true;
	comment(catCompare[0] + ", or " + catCompare2[0] + " must be attached.");
	}
`^
CDB;Licenses!Engineering!Prequalified Contractor!Na^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var rDocs = new Array();
var returnMessage = "";
if (getAppSpecific("SECT II STREET UTIL SITE CONST.Petroleum Above!Below Ground Storage Tank Removal and Installation (Attach copies of State Certifica") == "CHECKED") {
	rDocs.push("Section II - 260 - State Certfications");
	}

if (getAppSpecific("SECT II STREET UTIL SITE CONST.Playground Installer (Provide References for installation of a minimum of three public or private co") == "CHECKED") {
	rDocs.push("Section II - 262 - Reference");
	}

if (getAppSpecific("SECTION III.Hazardous Material Removal (Contractor to be certified for asbestos and lead abatement") == "CHECKED") {
	rDocs.push("Section III - 429 - State Performance and Asbestos Abatement Cetificate");
	}

if (getAppSpecific("SECTION IV 1-13.4ABC") == "Yes") {
	rDocs.push("Section IV - 4 - Firm disbarred, suspended, or disapproved details");
	}

if (getAppSpecific("SECTION IV 1-13.5ABC") == "Yes") {
	rDocs.push("Section IV - 5 - Firm defaulted or failed to complete work details");
	}

if (getAppSpecific("SECTION IV 1-13.6ABC") == "Yes") {
	rDocs.push("Section IV - 6 - Firm convicted of violating Section 133.03 details");
	}

if (getAppSpecific("SECTION IV 1-13.10b") == "Yes") {
	rDocs.push("Section IV - 10 - Firm convicted with penalty over $10,000 details");
	}

if (getAppSpecific("SECTION IV 1-13.11ABC") == "Yes") {
	rDocs.push("Section IV - 11 - Firm had license, certification or registration revoked or suspended details");
	}

if (getAppSpecific("SECTION IV 1-13.12ABC") == "Yes") {
	rDocs.push("Section IV - 12 - Firm commited willful violation details");
	}

if (getAppSpecific("SECTION IV 1-13.13ABC") == "Yes") {
	rDocs.push("Section IV - 13 - Nature of firm relationship");
	}

if (AInfo['14..Attached'] == "CHECKED") {
	rDocs.push("Section IV - 14 - List of major equipment");
	}

if (AInfo['14..Renewal (with new categories)'] == "CHECKED") {
	rDocs.push("Section IV - 14 - List of major equipment");
	}

if (AInfo['15..Attached'] == "CHECKED") {
	rDocs.push("Section IV - 15 - Schedule of more recent projects");
	}

if (AInfo['16..Attached'] == "CHECKED") {
	rDocs.push("Section IV - 16 - Background information of principal officers or personnel");
	}

if (AInfo['17..Attached'] == "CHECKED") {
	rDocs.push("Section IV - 17 - Letter of reference from Financial Institution");
	}

if (AInfo['18..Attached'] == "CHECKED") {
	rDocs.push("Section IV - 18 - Firm latest complete financial report");
	}

if (AInfo['21..Attached'] == "CHECKED") {
	rDocs.push("Section IV - 21 - Form 11B Bond");
	}

if (AInfo['22. CATEGORY A.Certificate Attached'] == "CHECKED") {
	rDocs.push("Section IV - 22 - Category A Certificate");
	}

if (AInfo['22. CERTIFICATE OF INSURANCE.Certificate Attached'] == "CHECKED") {
	rDocs.push("Section IV - 22 - Category BC Certificate");
	}

if (AInfo['SIGNATURE.Signature'] == "CHECKED") {
	rDocs.push("Signature Form");
	}

if (rDocs != null) {
	returnMessage = checkRequiredDocumentsACA(rDocs , capId);
	} else {
	returnMessage = "All Attached";
	}

if (returnMessage != "All Attached") {
	cancel = true;
	showMessage = true;
	returnMessage = "<font size='2'>" +  returnMessage + "<!font>";
	comment(returnMessage);
	}
`^
CDB;Licenses!Engineering!Prequalified Contractor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var rDocs = new Array();
var returnMessage = "";
if (getAppSpecific("SECT II STREET UTIL SITE CONST.Petroleum Above!Below Ground Storage Tank Removal and Installation (Attach copies of State Certifica") == "CHECKED") {
	rDocs.push("Section II - 260 - State Certfications");
	}

if (getAppSpecific("SECT II STREET UTIL SITE CONST.Playground Installer (Provide References for installation of a minimum of three public or private co") == "CHECKED") {
	rDocs.push("Section II - 262 - Reference");
	}

if (getAppSpecific("SECTION III.Hazardous Material Removal (Contractor to be certified for asbestos and lead abatement") == "CHECKED") {
	rDocs.push("Section III - 429 - State Performance and Asbestos Abatement Cetificate");
	}

if (getAppSpecific("SECTION IV 1-13.4ABC") == "Yes") {
	rDocs.push("Section IV - 4 - Firm disbarred, suspended, or disapproved details");
	}

if (getAppSpecific("SECTION IV 1-13.5ABC") == "Yes") {
	rDocs.push("Section IV - 5 - Firm defaulted or failed to complete work details");
	}

if (getAppSpecific("SECTION IV 1-13.6ABC") == "Yes") {
	rDocs.push("Section IV - 6 - Firm convicted of violating Section 133.03 details");
	}

if (getAppSpecific("SECTION IV 1-13.10b") == "Yes") {
	rDocs.push("Section IV - 10 - Firm convicted with penalty over $10,000 details");
	}

if (getAppSpecific("SECTION IV 1-13.11ABC") == "Yes") {
	rDocs.push("Section IV - 11 - Firm had license, certification or registration revoked or suspended details");
	}

if (getAppSpecific("SECTION IV 1-13.12ABC") == "Yes") {
	rDocs.push("Section IV - 12 - Firm commited willful violation details");
	}

if (getAppSpecific("SECTION IV 1-13.13ABC") == "Yes") {
	rDocs.push("Section IV - 13 - Nature of firm relationship");
	}

if (AInfo['14..Renewal (with new categories)'] == "CHECKED") {
	rDocs.push("Section IV - 14 - List of major equipment");
	}

if (AInfo['17..Attached'] == "CHECKED") {
	rDocs.push("Section IV - 17 - Letter of reference from Financial Institution");
	}

if (AInfo['18..Attached'] == "CHECKED") {
	rDocs.push("Section IV - 18 - Firm latest complete financial report");
	}

if (AInfo['21..Attached'] == "CHECKED") {
	rDocs.push("Section IV - 21 - Form 11B Bond");
	}

if (AInfo['22. CATEGORY A.Certificate Attached'] == "CHECKED") {
	rDocs.push("Section IV - 22 - Category A Certificate");
	}

if (AInfo['22. CERTIFICATE OF INSURANCE.Certificate Attached'] == "CHECKED") {
	rDocs.push("Section IV - 22 - Category BC Certificate");
	}

if (AInfo['SIGNATURE.Signature'] == "CHECKED") {
	rDocs.push("Signature Form");
	}

if (rDocs != null) {
	returnMessage = checkRequiredDocumentsACA(rDocs , capId);
	} else {
	returnMessage = "All Attached";
	}

if (returnMessage != "All Attached") {
	cancel = true;
	showMessage = true;
	returnMessage = "<font size='2'>" +  returnMessage + "<!font>";
	comment(returnMessage);
	}
`^
CDB;Licenses!Treasurer!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
rabDate = new Date();
expType = "Rabies Certification";
if (cmnSubType == "Dog Registration" || cmnSubType == "Cat Registration") {
	rabDate = new Date(getAppSpecific("HEALTH STATUS.Rabies Shot Expiration Date"));
	}

if (cmnSubType == "Chicken Owner") {
	rabDate = new Date(getAppSpecific("LICENSE DETAILS.Livestock Premises Registration Expiration Date"));
	expType = "Livestock Registration";
	}

if (cmnCategory != "Renewal") {
	docList = aa.document.getDocumentListByEntity(capId, "TMP_CAP");
	docs = docList.getOutput();
	}

if (cmnCategory != "Renewal" && docs.isEmpty()) {
	cancel = true;
	showMessage = true;
	comment("The required documents are not attached to this application");
	}

if (cmnCategory == "Renewal") {
	docList = aa.document.getDocumentListByEntity(capId, "TMP_CAP");
	docs = docList.getOutput();
	}

if (cmnCategory == "Renewal" && rabDate < startDate && docs.isEmpty()) {
	cancel = true;
	showMessage = true;
	comment("Please attach a " + expType + " with the new Expiration Date");
	}
`^
CDB;Licenses!Vending!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
msg = "All Attached";
catCompare = new Array("Certificate of Insurance");
msg = checkRequiredDocumentsACA(catCompare, capId);
if (msg != "All Attached") {
	cancel = true;
	showMessage = true;
	comment(catCompare[0] + " must be attached.");
	}
`^
CDB;Licenses!Vending!MerchantVendor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
catCompare = new Array("Layout Plan");
msg = checkRequiredDocumentsACA(catCompare, capId);
if (msg != "All Attached") {
	cancel = true;
	showMessage = true;
	comment(msg);
	}
`^
CDB;Licenses!Vending!SidewalkCafe!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
catCompare = new Array("Layout Plan");
msg = checkRequiredDocumentsACA(catCompare, capId);
if (msg != "All Attached") {
	cancel = true;
	showMessage = true;
	comment(msg);
	}
`^
CDB;Permitting!Building!Residential!Construction^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
msg = "All Attached";
docList = aa.document.getDocumentListByEntity(capId, "TMP_CAP");
docs = docList.getOutput();
if (docs.isEmpty()) {
	cancel = true;
	showMessage = true;
	comment("The required documents are not attached to this application");
	}
`^
CDB;Permitting!Engineering!Street Terrace!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
bstNew = false;
if (AInfo['CURB DETAILS.Are you widening your driveway opening?'] == "Yes") {
	bstNew = true;
	}

if (AInfo['CURB DETAILS.Type'] == "New") {
	bstNew = true;
	}

if (AInfo['DRIVEWAY APRON DETAILS.Type'] == "Asphalt - New") {
	bstNew = true;
	}

if (AInfo['DRIVEWAY APRON DETAILS.Type'] == "Concrete - New") {
	bstNew = true;
	}

if (AInfo['CULVERT DETAILS.Type'] == "New") {
	bstNew = true;
	}

if (AInfo['SIDEWALK DETAILS.Type'] == "New") {
	bstNew = true;
	}

if (bstNew == true) {
	docList = aa.document.getDocumentListByEntity(capId, "TMP_CAP");
	docs = docList.getOutput();
	}

if (bstNew == true && docs.isEmpty()) {
	cancel = true;
	showMessage = true;
	comment("If you are doing NEW work or widening driveway, you are required to upload a plan.");
	}
`^
CDB;Permitting!Fire!Alarm!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
msg = "All Attached";
StateApprovedPlansChecked = AInfo['PROJECT INFORMATION.State Approved Plans?'] == "CHECKED";
if (StateApprovedPlansChecked) {
	catCompare = new Array("Plan Review Letter");
	msg = checkRequiredDocumentsACA(catCompare, capId);
	}

if (msg != "All Attached") {
	cancel = true;
	showMessage = true;
	comment(catCompare[0] + " must be attached.");
	}
`^
CDB;Permitting!Fire!Sprinkler!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
msg = "All Attached";
StateApprovedPlansChecked = AInfo['PROJECT INFORMATION.State Approved Plans'] == "CHECKED";
if (StateApprovedPlansChecked) {
	catCompare = new Array("Plan Review Letter");
	msg = checkRequiredDocumentsACA(catCompare, capId);
	}

if (msg != "All Attached") {
	cancel = true;
	showMessage = true;
	comment(catCompare[0] + " must be attached.");
	}
`^
CDB;Permitting!Miscellaneous!Edible Landscape!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var bPlanProjAttached = false;
var bHarvestPlanAttached = false;
var bVolunteerReleaseAttached = false;
docList = aa.document.getDocumentListByEntity(capId, "TMP_CAP");
oDocResults = docList.getOutput();
if (oDocResults) {
	oDocs = oDocResults.iterator();
	}

if (!oDocResults.isEmpty()) {
	while(oDocs.hasNext()) if(oDocs.next().docCategory == "Planting Plan") bPlanProjAttached = true;
	}

if ((oDocResults.isEmpty() || bPlanProjAttached == false)) {
	cancel = true;
	showMessage = true;
	comment("A Planting Plan, Harvest and Maintenance Plan, and at least one Volunteer Release form must be attached to this application.");
	}
`^
CDB;Permitting!Parks!Block Party!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var rDocs = new Array();
var returnMessage = "";
rDocs.push("Signature Petition");
if (rDocs != null) {
	returnMessage = checkRequiredDocumentsACA(rDocs , capId);
	} else {
	returnMessage = "All Attached";
	}

if (returnMessage != "All Attached") {
	showMessage = true;
	returnMessage = "<font size='2'>" + returnMessage + "<!font>";
	comment(returnMessage);
	}
`^
CDB;Permitting!Parks!Street Use!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var rDocs = new Array();
var returnMessage = "";
rDocs.push("Emergency Action Plan");
rDocs.push("Site Map");
if (AInfo['EVENT TYPE.Run!Walk'] == "CHECKED" || AInfo['EVENT TYPE.Parade'] == "CHECKED") {
	rDocs.push("Route Map");
	}

if (rDocs != null) {
	returnMessage = checkRequiredDocumentsACA(rDocs , capId);
	} else {
	returnMessage = "All Attached";
	}

if (returnMessage != "All Attached") {
	cancel = true;
	showMessage = true;
	returnMessage = "<font size='2'>" +  returnMessage + "<!font>";
	comment(returnMessage);
	}
`^
CDB;Permitting!Traffic Engineering!Street Occupancy!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
catCompare = new Array("Location of Dumpster");
msg = checkRequiredDocumentsACA(catCompare, capId);
if (msg !="All Attached") {
	cancel = true;
	showMessage = true;
	comment(msg);
	}
`^
CDB;Permitting!Vending!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
msg = "All Attached";
catCompare = new Array("Certificate of Insurance");
msg = checkRequiredDocumentsACA(catCompare, capId);
if (msg != "All Attached") {
	cancel = true;
	showMessage = true;
	comment(catCompare[0] + " must be attached.");
	}
`^
CDO;Licenses!Civil Rights!AA Plan!CBO^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var rDocs = new Array();
var returnMessage = "";
if (getAppSpecific("PAYROLL PRACTICES.At a minimum of every two years, review the entire payroll for potential equal pay act and Title") == "CHECKED") {
	rDocs.push("53. A review that shows no inequity in the entire payroll for potential Equal Pay Act and Title VII issues, wage discrimination, and disparities in wage and promotional opportunities in the workforce.");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.For contractors with unions referring them labor (act as hiring halls), we agree to make job-specifi") == "CHECKED") {
	rDocs.push("76. A form that we will transmit to our unions making the specific request for all needed labor");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.One or some of our CBAs contain restrictions prohibiting hiring outside of the union, and we hav") == "Yes") {
	rDocs.push("77. Copy of cover and relevant pages of most recent CBAs");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Two new AA recruitment outreach correspondences (letters!emails!feature advertisements!documentati") == "CHECKED") {
	rDocs.push("78a. Two new AA recruitment outreach correspondences (letters!emails!feature advertisements!documentation of in-person meetings) to relevant dedicated diversity!minority!female programs, (trade) publications or organizations");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Participation in!registration for a diversity-focused job fair, including preparation of and (pros") == "CHECKED") {
	rDocs.push("78b. Documentation of participation in!registration for a diversity-focused job fair, including preparation of and (prospective) use of materials that include the specific language 'Affirmative Action!Equal Opportunity Employer'");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Development of!participation in diversity mentor!intern!apprenticeship hiring and!or training!trad") == "CHECKED") {
	rDocs.push("78c. Documentation of development of!participation in diversity mentor!intern!apprenticeship hiring and!or training!trade or advanced skills!education programs to increase racial!gender!disability equity in underutilized employment areas!job groups");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Affirmative inclusion and incorporation of more of your current, non-involved minorities, females") == "CHECKED") {
	rDocs.push("78d. Documentation of affirmative inclusion and incorporation of more of your current, non-involved minorities, females and!or people with disabilities into your recruitment!hiring process");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Actual increase in AA utilization; hiring of additional minority, female and!or people with disabi") == "CHECKED") {
	rDocs.push("78e. Documentation of Actual increase in AA utilization; hiring of additional minority, female and!or people with disabilities.");
	}

if (rDocs != null) {
	returnMessage = checkRequiredDocumentsACA(rDocs , capId);
	} else {
	returnMessage = "All Attached";
	}

if (returnMessage != "All Attached") {
	showMessage = true;
	returnMessage = "<font size='2'>" + returnMessage + "<!font>";
	comment(returnMessage);
	}
`^
CDO;Licenses!Civil Rights!AA Plan!Public Works^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var rDocs = new Array();
var returnMessage = "";
if (getAppSpecific("SUBCONTRACTORS.Yes - We are subcontracting or will subcontract and have attached a copy of our standard subcontract") == "CHECKED") {
	rDocs.push("36a. Copy of standard subcontract");
	}

if (getAppSpecific("PAYROLL PRACTICES.At a minimum of every two years, review the entire payroll for potential equal pay act and Title") == "CHECKED") {
	rDocs.push("53. A review that shows no inequity in the entire payroll for potential Equal Pay Act and Title VII issues, wage discrimination, and disparities in wage and promotional opportunities in the workforce.");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.For contractors with unions referring them labor (act as hiring halls), we agree to make job-specifi") == "CHECKED") {
	rDocs.push("76. A form that we will transmit to our unions making the specific request for all needed labor");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.One or some of our CBAs contain restrictions prohibiting hiring outside of the union, and we hav") == "Yes") {
	rDocs.push("77. Copy of cover and relevant pages of most recent CBAs");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Two new AA recruitment outreach correspondences (letters!emails!feature advertisements!documentati") == "CHECKED") {
	rDocs.push("78a. Two new AA recruitment outreach correspondences (letters!emails!feature advertisements!documentation of in-person meetings) to relevant dedicated diversity!minority!female programs, (trade) publications or organizations");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Participation in!registration for a diversity-focused job fair, including preparation of and (pros") == "CHECKED") {
	rDocs.push("78b. Documentation of participation in!registration for a diversity-focused job fair, including preparation of and (prospective) use of materials that include the specific language 'Affirmative Action!Equal Opportunity Employer'");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Development of!participation in diversity mentor!intern!apprenticeship hiring and!or training!trad") == "CHECKED") {
	rDocs.push("78c. Documentation of development of!participation in diversity mentor!intern!apprenticeship hiring and!or training!trade or advanced skills!education programs to increase racial!gender!disability equity in underutilized employment areas!job groups");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Affirmative inclusion and incorporation of more of your current, non-involved minorities, females") == "CHECKED") {
	rDocs.push("78d. Documentation of affirmative inclusion and incorporation of more of your current, non-involved minorities, females and!or people with disabilities into your recruitment!hiring process");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Actual increase in AA utilization; hiring of additional minority, female and!or people with disabi") == "CHECKED") {
	rDocs.push("78e. Documentation of Actual increase in AA utilization; hiring of additional minority, female and!or people with disabilities.");
	}

if (rDocs != null) {
	returnMessage = checkRequiredDocumentsACA(rDocs , capId);
	} else {
	returnMessage = "All Attached";
	}

if (returnMessage != "All Attached") {
	showMessage = true;
	returnMessage = "<font size='2'>" + returnMessage + "<!font>";
	comment(returnMessage);
	}
`^
CDO;Licenses!Civil Rights!AA Plan!Vendors and Suppliers^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var rDocs = new Array();
var returnMessage = "";
if (getAppSpecific("SUBCONTRACTORS.Yes - We are subcontracting or will subcontract and have attached a copy of our standard subcontract") == "CHECKED") {
	rDocs.push("36a. Copy of standard subcontract");
	}

if (getAppSpecific("PAYROLL PRACTICES.At a minimum of every two years, review the entire payroll for potential equal pay act and Title") == "CHECKED") {
	rDocs.push("53. A review that shows no inequity in the entire payroll for potential Equal Pay Act and Title VII issues, wage discrimination, and disparities in wage and promotional opportunities in the workforce.");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.For contractors with unions referring them labor (act as hiring halls), we agree to make job-specifi") == "CHECKED") {
	rDocs.push("76. A form that we will transmit to our unions making the specific request for all needed labor");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.One or some of our CBAs contain restrictions prohibiting hiring outside of the union, and we hav") == "Yes") {
	rDocs.push("77. Copy of cover and relevant pages of most recent CBAs");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Two new AA recruitment outreach correspondences (letters!emails!feature advertisements!documentati") == "CHECKED") {
	rDocs.push("78a. Two new AA recruitment outreach correspondences (letters!emails!feature advertisements!documentation of in-person meetings) to relevant dedicated diversity!minority!female programs, (trade) publications or organizations");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Participation in!registration for a diversity-focused job fair, including preparation of and (pros") == "CHECKED") {
	rDocs.push("78b. Documentation of participation in!registration for a diversity-focused job fair, including preparation of and (prospective) use of materials that include the specific language 'Affirmative Action!Equal Opportunity Employer'");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Development of!participation in diversity mentor!intern!apprenticeship hiring and!or training!trad") == "CHECKED") {
	rDocs.push("78c. Documentation of development of!participation in diversity mentor!intern!apprenticeship hiring and!or training!trade or advanced skills!education programs to increase racial!gender!disability equity in underutilized employment areas!job groups");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Affirmative inclusion and incorporation of more of your current, non-involved minorities, females") == "CHECKED") {
	rDocs.push("78d. Documentation of affirmative inclusion and incorporation of more of your current, non-involved minorities, females and!or people with disabilities into your recruitment!hiring process");
	}

if (getAppSpecific("GOALS AND GOOD FAITH EFFORTS.Actual increase in AA utilization; hiring of additional minority, female and!or people with disabi") == "CHECKED") {
	rDocs.push("78e. Documentation of Actual increase in AA utilization; hiring of additional minority, female and!or people with disabilities.");
	}

if (rDocs != null) {
	returnMessage = checkRequiredDocumentsACA(rDocs , capId);
	} else {
	returnMessage = "All Attached";
	}

if (returnMessage != "All Attached") {
	showMessage = true;
	returnMessage = "<font size='2'>" + returnMessage + "<!font>";
	comment(returnMessage);
	}
`^
CDO;Licenses!Engineering!Prequalified Contractor!Na^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var rDocs = new Array();
var returnMessage = "";
if (getAppSpecific("SECT II STREET UTIL SITE CONST.Petroleum Above!Below Ground Storage Tank Removal and Installation (Attach copies of State Certifica") == "CHECKED") {
	rDocs.push("Section II - 260 - State Certfications");
	}

if (getAppSpecific("SECT II STREET UTIL SITE CONST.Playground Installer (Provide References for installation of a minimum of three public or private co") == "CHECKED") {
	rDocs.push("Section II - 262 - Reference");
	}

if (getAppSpecific("SECTION III.Hazardous Material Removal (Contractor to be certified for asbestos and lead abatement") == "CHECKED") {
	rDocs.push("Section III - 429 - State Performance and Asbestos Abatement Cetificate");
	}

if (getAppSpecific("SECTION IV 1-13.4ABC") == "Yes") {
	rDocs.push("Section IV - 4 - Firm disbarred, suspended, or disapproved details");
	}

if (getAppSpecific("SECTION IV 1-13.5ABC") == "Yes") {
	rDocs.push("Section IV - 5 - Firm defaulted or failed to complete work details");
	}

if (getAppSpecific("SECTION IV 1-13.6ABC") == "Yes") {
	rDocs.push("Section IV - 6 - Firm convicted of violating Section 133.03 details");
	}

if (getAppSpecific("SECTION IV 1-13.10b") == "Yes") {
	rDocs.push("Section IV - 10 - Firm convicted with penalty over $10,000 details");
	}

if (getAppSpecific("SECTION IV 1-13.11ABC") == "Yes") {
	rDocs.push("Section IV - 11 - Firm had license, certification or registration revoked or suspended details");
	}

if (getAppSpecific("SECTION IV 1-13.12ABC") == "Yes") {
	rDocs.push("Section IV - 12 - Firm commited willful violation details");
	}

if (getAppSpecific("SECTION IV 1-13.13ABC") == "Yes") {
	rDocs.push("Section IV - 13 - Nature of firm relationship");
	}

if (AInfo['14..Attached'] == "CHECKED") {
	rDocs.push("Section IV - 14 - List of major equipment");
	}

if (AInfo['14..Renewal (with new categories)'] == "CHECKED") {
	rDocs.push("Section IV - 14 - List of major equipment");
	}

if (AInfo['15..Attached'] == "CHECKED") {
	rDocs.push("Section IV - 15 - Schedule of more recent projects");
	}

if (AInfo['16..Attached'] == "CHECKED") {
	rDocs.push("Section IV - 16 - Background information of principal officers or personnel");
	}

if (AInfo['17..Attached'] == "CHECKED") {
	rDocs.push("Section IV - 17 - Letter of reference from Financial Institution");
	}

if (AInfo['18..Attached'] == "CHECKED") {
	rDocs.push("Section IV - 18 - Firm latest complete financial report");
	}

if (AInfo['21..Attached'] == "CHECKED") {
	rDocs.push("Section IV - 21 - Form 11B Bond");
	}

if (AInfo['22. CATEGORY A.Certificate Attached'] == "CHECKED") {
	rDocs.push("Section IV - 22 - Category A Certificate");
	}

if (AInfo['22. CERTIFICATE OF INSURANCE.Certificate Attached'] == "CHECKED") {
	rDocs.push("Section IV - 22 - Category BC Certificate");
	}

if (AInfo['SIGNATURE.Signature'] == "CHECKED") {
	rDocs.push("Signature Form");
	}

if (rDocs != null) {
	returnMessage = checkRequiredDocumentsACA(rDocs , capId);
	} else {
	returnMessage = "All Attached";
	}

if (returnMessage != "All Attached") {
	showMessage = true;
	returnMessage = "<font size='2'>" + returnMessage + "<!font>";
	comment(returnMessage);
	}
`^
CDO;Licenses!Engineering!Prequalified Contractor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var rDocs = new Array();
var returnMessage = "";
if (getAppSpecific("SECT II STREET UTIL SITE CONST.Petroleum Above!Below Ground Storage Tank Removal and Installation (Attach copies of State Certifica") == "CHECKED") {
	rDocs.push("Section II - 260 - State Certfications");
	}

if (getAppSpecific("SECT II STREET UTIL SITE CONST.Playground Installer (Provide References for installation of a minimum of three public or private co") == "CHECKED") {
	rDocs.push("Section II - 262 - Reference");
	}

if (getAppSpecific("SECTION III.Hazardous Material Removal (Contractor to be certified for asbestos and lead abatement") == "CHECKED") {
	rDocs.push("Section III - 429 - State Performance and Asbestos Abatement Cetificate");
	}

if (getAppSpecific("SECTION IV 1-13.4ABC") == "Yes") {
	rDocs.push("Section IV - 4 - Firm disbarred, suspended, or disapproved details");
	}

if (getAppSpecific("SECTION IV 1-13.5ABC") == "Yes") {
	rDocs.push("Section IV - 5 - Firm defaulted or failed to complete work details");
	}

if (getAppSpecific("SECTION IV 1-13.6ABC") == "Yes") {
	rDocs.push("Section IV - 6 - Firm convicted of violating Section 133.03 details");
	}

if (getAppSpecific("SECTION IV 1-13.10b") == "Yes") {
	rDocs.push("Section IV - 10 - Firm convicted with penalty over $10,000 details");
	}

if (getAppSpecific("SECTION IV 1-13.11ABC") == "Yes") {
	rDocs.push("Section IV - 11 - Firm had license, certification or registration revoked or suspended details");
	}

if (getAppSpecific("SECTION IV 1-13.12ABC") == "Yes") {
	rDocs.push("Section IV - 12 - Firm commited willful violation details");
	}

if (getAppSpecific("SECTION IV 1-13.13ABC") == "Yes") {
	rDocs.push("Section IV - 13 - Nature of firm relationship");
	}

if (AInfo['14..Renewal (with new categories)'] == "CHECKED") {
	rDocs.push("Section IV - 14 - List of major equipment");
	}

if (AInfo['17..Attached'] == "CHECKED") {
	rDocs.push("Section IV - 17 - Letter of reference from Financial Institution");
	}

if (AInfo['18..Attached'] == "CHECKED") {
	rDocs.push("Section IV - 18 - Firm latest complete financial report");
	}

if (AInfo['21..Attached'] == "CHECKED") {
	rDocs.push("Section IV - 21 - Form 11B Bond");
	}

if (AInfo['22. CATEGORY A.Certificate Attached'] == "CHECKED") {
	rDocs.push("Section IV - 22 - Category A Certificate");
	}

if (AInfo['22. CERTIFICATE OF INSURANCE.Certificate Attached'] == "CHECKED") {
	rDocs.push("Section IV - 22 - Category BC Certificate");
	}

if (AInfo['SIGNATURE.Signature'] == "CHECKED") {
	rDocs.push("Signature Form");
	}

if (rDocs != null) {
	returnMessage = checkRequiredDocumentsACA(rDocs , capId);
	} else {
	returnMessage = "All Attached";
	}

if (returnMessage != "All Attached") {
	cancel = true;
	showMessage = true;
	returnMessage = "<font size='2'>" +  returnMessage + "<!font>";
	comment(returnMessage);
	}
`^
CDO;Permitting!Parks!Block Party!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var rDocs = new Array();
var returnMessage = "";
rDocs.push("Signature Petition");
if (rDocs != null) {
	returnMessage = checkRequiredDocumentsACA(rDocs , capId);
	} else {
	returnMessage = "All Attached";
	}

if (returnMessage != "All Attached") {
	showMessage = true;
	returnMessage = "<font size='2'>" + returnMessage + "<!font>";
	comment(returnMessage);
	}
`^
CDO;Permitting!Parks!Street Use!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var rDocs = new Array();
var returnMessage = "";
rDocs.push("Emergency Action Plan");
rDocs.push("Site Map");
if (AInfo['EVENT TYPE.Run!Walk'] == "CHECKED" || AInfo['EVENT TYPE.Parade'] == "CHECKED") {
	rDocs.push("Route Map");
	}

if (rDocs != null) {
	returnMessage = checkRequiredDocumentsACA(rDocs , capId);
	} else {
	returnMessage = "All Attached";
	}

if (returnMessage != "All Attached") {
	cancel = true;
	showMessage = true;
	returnMessage = "<font size='2'>" +  returnMessage + "<!font>";
	comment(returnMessage);
	}
`^
CDO;Permitting!Traffic Engineering!Street Occupancy!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
catCompare = new Array("Location of Dumpster - Required", "Certificate of Insurance - May Upload Later");
listRequiredDocumentsACA(catCompare);
`^
CEA;Licenses!~!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
`^
CEA;Licenses!Building Inspection!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if ((isTaskStatus("License Issuance","Issued") || isTaskStatus("License Status","Active") || isTaskStatus("License Status","Inactive"))) {
	include("CMN;Licenses!Building Inspection!~;UpdateRefProfessional");
	}
`^
CEA;Licenses!Clerk!ParaTransitOperating!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (capStatus == "Active") {
	include("CMN;Licenses!Clerk!ParaTransitOperating!~;UpdateRefProfessional");
	}
`^
CEA;Licenses!Health!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;LicenseHolderUpdateFullNameWBusName");
include("CMN;ApplicantOrContactUpdateAppNameWDBAName");
`^
CEA;Permitting!Health!Temp Food Establishment!Dane County Restaurant^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Health!Temp Food Establishment!~;UpdateCAPDetail");
`^
ChristTest^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (true output = debugObject(aa.env);) {
	}

if (aa.env.setValue("ScriptReturnCode", "-1");) {
	}

if (aa.env.setValue("ScriptReturnMessage", output);) {
	}
`^
CLB;Permitting!Building!RepairReplace!Construction^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
callType = "Before";
permitType = "general";
lpArray = new Array("GENERAL");
include("CMN;Permitting!Building!~!~;ValidateLP");
`^
CLB;Permitting!Building!RepairReplace!Electrical^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
callType = "Before";
permitType = "electrical";
lpArray = new Array("ELEC - RESIDENTIAL", "ELEC - MASTER");
if (!checkCapForLicensedProfessionalType("HOME OWNER")) {
	include("CMN;Permitting!Building!~!~;ValidateLP");
	}
`^
CLB;Permitting!Building!RepairReplace!HVAC^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
callType = "Before";
permitType = "HVAC";
lpArray = new Array("HTG - WARM AIR", "HTG - HOT WATER");
if (!checkCapForLicensedProfessionalType("HOME OWNER")) {
	include("CMN;Permitting!Building!~!~;ValidateLP");
	}
`^
CLB;Permitting!Building!RepairReplace!Plumbing^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
callType = "Before";
permitType = "plumbing";
lpArray = new Array("PLUMBING");
if (!checkCapForLicensedProfessionalType("HOME OWNER")) {
	include("CMN;Permitting!Building!~!~;ValidateLP");
	}
`^
CLB;Permitting!Building!Residential!Construction^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
callType = "Before";
permitType = "general";
lpArray = new Array("GENERAL");
if (!checkCapForLicensedProfessionalType("HOME OWNER")) {
	include("CMN;Permitting!Building!~!~;ValidateLP");
	}
`^
CLB;Permitting!Engineering!ROW!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!ROW!NA;ValidateLP");
`^
CLB;Permitting!Engineering!Street Terrace!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
callType = "Before";
permitType = "Street Terrace";
lpArray = new Array("PREQUALIFIED TER");
if (!checkCapForLicensedProfessionalType("HOME OWNER")) {
	include("CMN;Permitting!Engineering!~!~;ValidateLP");
	}
`^
CLB;Permitting!Traffic Engineering!Street Occupancy!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Traffic Engineering!Street Occupancy!NA;ValidateLP");
`^
CLO;Permitting!Building!RepairReplace!Construction^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
callType = "Onload";
permitType = "general";
lpArray = new Array("GENERAL");
include("CMN;Permitting!Building!~!~;ValidateLP");
`^
CLO;Permitting!Building!RepairReplace!Electrical^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showMessage = false;
showDebug = false;
callType = "Onload";
permitType = "electrical";
lpArray = new Array("ELEC - RESIDENTIAL", "ELEC - MASTER");
include("CMN;Permitting!Building!~!~;ValidateLP");
`^
CLO;Permitting!Building!RepairReplace!HVAC^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
callType = "Onload";
permitType = "HVAC";
lpArray = new Array("HTG - WARM AIR", "HTG - HOT WATER");
include("CMN;Permitting!Building!~!~;ValidateLP");
`^
CLO;Permitting!Building!RepairReplace!Plumbing^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
callType = "Onload";
permitType = "plumbing";
lpArray = new Array("PLUMBING");
include("CMN;Permitting!Building!~!~;ValidateLP");
`^
CLO;Permitting!Building!Residential!Construction^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
callType = "Onload";
permitType = "general";
lpArray = new Array("GENERAL");
include("CMN;Permitting!Building!~!~;ValidateLP");
`^
CLO;Permitting!Engineering!Street Terrace!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
callType = "Onload";
permitType = "Street Terrace";
ownerWork = false;
if (getAppSpecific("ALTERNATIVE BUILDER.Work to be performed by property owner if no Licensed Professional chosen") == "Yes") {
	ownerWork = true;
	}

if (!ownerWork) {
	lpArray = new Array("PREQUALIFIED TER");
	}

if (!ownerWork) {
	include("CMN;Permitting!Engineering!~!~;ValidateLP");
	}
`^
CLO;Permitting!Traffic Engineering!Street Occupancy!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showMessage = false;
showDebug = false;
include("CMN;Permitting!Traffic Engineering!Street Occupancy!NA;ValidateLP");
`^
CMN;~!~!~!~;GET_APP_PARTS^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
cmnGroup = appTypeArray[0];
cmnType = appTypeArray[1];
cmnSubType = appTypeArray[2];
cmnCategory = appTypeArray[3];
`^
CMN;!Licenses!Vending!~!~;GetExpirationDate^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
msg = 0;
skip = false;
compareYear = startDate.getFullYear();
licYear = startDate.getFullYear() - 1;
highDen = AInfo['Location'];
mallCraft = AInfo['Location'];
if ((highDen == "Langondon Street 30-Day" || highDen == "Camp Randall - Football Season")) {
	skip = true;
	}

if ((mallCraft == "Daily State Street - 30-Day" || mallCraft == "Saturday Capitol Square - 30-Day")) {
	skip = true;
	}

streetVendorCap = aa.cap.getCapID(AInfo['City of Madison Street Vendor License Number']);
if (streetVendorCap.getSuccess()) {
	svCapId = streetVendorCap.getOutput();
	lic = aa.expiration.getLicensesByCapID(svCapId).getOutput();
	licDate = lic.getExpDate();
	licYear = licDate.getYear();
	}

janOne = new Date("01!01!" + startDate.getFullYear());
febFifteen = new Date("02!15!" + startDate.getFullYear());
decThirtyOne = new Date("12!31!" + startDate.getFullYear());
if (startDate >= janOne && startDate < febFifteen) {
	compareYear = startDate.getFullYear();
	}

if (startDate >= febFifteen && startDate <= decThirtyOne) {
	compareYear = startDate.getFullYear() + 1;
	}

if (licYear < compareYear && !skip) {
	msg = 1;
	cancel = true;
	showMessage = true;
	comment("The Street Vendor License you have supplied will expire soon.  Please renew the Street Vendor License (" + svCapId.getCustomID() + ") before proceeding with this license.");
	}

if (publicUser == true && msg == 1;) {
	comment("Please click the 'Save and resume later' button at the bottom of this screen.  Click the 'Home' tab then 'Search for a License!Registration' to renew your Street Vendor License.  Thank you.");
	}
`^
CMN;!Permitting!Building!~!~_CheckForExpiredLicense^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
expCheckMsg = "";
lpArray = getLicenseProfessional(capId);
if (lpArray.length > 0) {
	for (eachrow in lpArray) include("CMN;!Permitting!Building!~!~_CheckForExpiredLicense_Loop1");
	}

if (expCheckMsg != "") {
	showMessage = true;
	comment(expCheckMsg);
	cancel = true;
	}
`^
CMN;!Permitting!Building!~!~_CheckForExpiredLicense_Loop1^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
lpLicNum = "";
lpType = "";
lpExpDate = null;
lpDate = null;
tDate = new Date();
lpName = "";
lpEx = null;
lpQuaDate = null;
lpQDate = null;
todayDate = new Date((tDate.getMonth() + 1) + "!" + tDate.getDate() + "!" + tDate.getFullYear());
lpLicNum = lpArray[eachrow].getLicenseNbr();
lpType = lpArray[eachrow].getLicenseType();
lpName = lpArray[eachrow].getBusinessName();
if (lpType == "GENERAL" && lpLicNum != "") {
	lp = getRefLicenseProf(lpLicNum);
	}

if (lpType == "GENERAL" && lpLicNum != "") {
	lpExpDate = lp.getLicenseExpirationDate();
	lpQuaDate = lp.getBusinessLicExpDate();
	aa.print(lpExpDate.getMonth());
	}

if (lpType == "GENERAL" && lpLicNum != ""  && lpExpDate == null) {
	expCheckMsg += "<br>License " + lpLicNum + " for " + lpName + " does not have an expiration date.";
	}

if (lpType == "GENERAL" && lpLicNum != "" && lpExpDate != null) {
	lpDate = new Date(lpExpDate.getMonth()  + "!" + lpExpDate.getDayOfMonth() + "!" + lpExpDate.getYear());
	}

if (lpExpDate != null && lpDate.getTime() < todayDate.getTime()) {
	expCheckMsg += "<br>Warning; License " + lpLicNum + " for " + lpName + " has an expired license.";
	}

if (lpType == "GENERAL" && lpLicNum != ""  && lpQuaDate == null) {
	expCheckMsg += "<br>Warning; The Qualifier # expiration date is blank for License " + lpLicNum + " for " + lpName;
	}

if (lpType == "GENERAL" && lpLicNum != "" && lpQuaDate != null) {
	lpQDate = new Date(lpQuaDate.getMonth() + "!" + lpQuaDate.getDayOfMonth() + "!" + lpQuaDate.getYear());
	}

if (lpExpDate != null && lpQDate.getTime() < todayDate.getTime()) {
	expCheckMsg += "<br>Warning; License " + lpLicNum + " for " + lpName + " has an expired qualifier #.";
	}
`^
CMN;AAPLAN_JOBCAT_LIST^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
jobCatAry.push("Officials and Managers; TOTAL EMPLOYEES");
jobCatAry.push("Officials and Managers; Racial!Ethnic AA Group");
jobCatAry.push("Officials and Managers; Women");
jobCatAry.push("Officials and Managers; With a Disability");
jobCatAry.push("Professionals; TOTAL EMPLOYEES");
jobCatAry.push("Professionals; Racial!Ethnic AA Group");
jobCatAry.push("Professionals; Women");
jobCatAry.push("Professionals; With a Disability");
jobCatAry.push("Technicians; TOTAL EMPLOYEES");
jobCatAry.push("Technicians; Racial!Ethnic AA Group");
jobCatAry.push("Technicians; Women");
jobCatAry.push("Technicians; With a Disability");
jobCatAry.push("Sales; TOTAL EMPLOYEES");
jobCatAry.push("Sales; Racial!Ethnic AA Group");
jobCatAry.push("Sales; Women");
jobCatAry.push("Sales; With a Disability");
jobCatAry.push("Clerical and Admin. Support; TOTAL EMPLOYEES");
jobCatAry.push("Clerical and Admin. Support; Racial!Ethnic AA Group");
jobCatAry.push("Clerical and Admin. Support; Women");
jobCatAry.push("Clerical and Admin. Support; With a Disability");
jobCatAry.push("Craft Workers; TOTAL EMPLOYEES");
jobCatAry.push("Craft Workers; Racial!Ethnic AA Group");
jobCatAry.push("Craft Workers; Women");
jobCatAry.push("Craft Workers; With a Disability");
jobCatAry.push("Operatives; TOTAL EMPLOYEES");
jobCatAry.push("Operatives; Racial!Ethnic AA Group");
jobCatAry.push("Operatives; Women");
jobCatAry.push("Operatives; With a Disability");
jobCatAry.push("Laborers, Helpers, Material Handlers; TOTAL EMPLOYEES");
jobCatAry.push("Laborers, Helpers, Material Handlers; Racial!Ethnic AA Group");
jobCatAry.push("Laborers, Helpers, Material Handlers; Women");
jobCatAry.push("Laborers, Helpers, Material Handlers; With a Disability");
jobCatAry.push("Service Workers; TOTAL EMPLOYEES");
jobCatAry.push("Service Workers; Racial!Ethnic AA Group");
jobCatAry.push("Service Workers; Women");
jobCatAry.push("Service Workers; With a Disability");
jobCatAry.push("TOTAL EMPLOYEES");
jobCatAry.push("TOTAL RACIAL!ETHNIC AA GROUP EMPLOYEES");
jobCatAry.push("TOTAL WOMEN EMPLOYEES");
jobCatAry.push("TOTAL EMPLOYEES WITH A DISABILITY");
`^
CMN;AddAsset^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
`^
CMN;AddAssetIDtoShortNotes^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var strName = "";
AssetList = aa.asset.getAssetListByWorkOrder(capId,null);
if (AssetList.getSuccess()) {
	AssetList = AssetList.getOutput();
	for (x in AssetList) strName = strName + (AssetList[x].assetMasterModel["g1AssetID"]) + ", ";
	}

if (strName != null) {
	strName = strName.substring(0, strName.length - 2);
	updateShortNotes(strName.substring(0, 200));
	}
`^
CMN;AddParcelAndOwner^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
addparcel = parcelExistsOnCap(capId) == false;
if (addparcel) {
	ad = aa.address.getAddressByCapId(capId).getOutput();
	var RefAddressID = "";
	}

if (addparcel && ad.length && ad[0].getRefAddressId() != null) {
	RefAddressID = ad[0].getRefAddressId();
	logDebug("RefAddress = " + RefAddressID);
	}

if (addparcel && RefAddressID != "") {
	addParcelAndOwnerFromRefAddress(RefAddressID);
	copyParcelGisObjects();
	}
`^
CMN;AddPermitToCustRowSet^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
var setName = "";
var setCreateResult = "";
logDebug("testing");
businessName = "";
ca = getContactArray();
for (eachRecord in ca) include("EML;GetContactInfo");
if (businessName != "") {
	custId = lookup("ROW_CUST_LOOKUP", businessName);
	logDebug("custId is;"+custId);
	} else {
	logDebug("bus name null");
	}

if (businessName != "" && custId == undefined) {
	custId = lookup("ROW_CUST_SEQ","NextSeq");
	addLookup("ROW_CUST_LOOKUP",businessName, custId);
	editLookup("ROW_CUST_SEQ","NextSeq",(Number(custId)+1).toString());
	}

if (businessName != "") {
	var dtToday = new Date();
	var iMonth = dtToday.getMonth() + 1;
	var iYear = dtToday.getFullYear();
	setName ="ROW"+ Right(("0" + iMonth.toString()),2) +iYear+ Right("00000"+ custId,6);
	}

if (businessName != "") {
	var setHeader = aa.set.getSetByPK(setName).getOutput();
	}

if (businessName != "" && setHeader == null) {
	logDebug("no set found");
	setCreateResult = aa.set.createSet(setName,businessName+" ROW billing set");
	}

if (businessName != "" && setCreateResult) {
	setHeader = aa.set.getSetByPK(setName).getOutput();
	}

if (businessName != "" && setHeader) {
	setHeader.setRecordSetType("Other");
	aa.set.updateSetHeader(setHeader);
	}

if (businessName != "") {
	aa.set.add(setName,capId);
	}
`^
CMN;AddReferenceAddressAndOwner^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
refAdd = null;
refAddress = null;
capO = null;
capOwner = null;
addStreetNumber = add[0].getHouseNumberStart();
addStreetName = add[0].getStreetName();
addStreetSuffix = add[0].getStreetSuffix();
addStreetUnit = add[0].getUnitStart();
if (addStreetName != null) {
	addStreetName = addStreetName.toUpperCase();
	}

if (addStreetSuffix != null) {
	addStreetSuffix = addStreetSuffix.toUpperCase();
	} else {
	addStreetSuffix = "";
	}

if (addStreetUnit != null) {
	addStreetUnit = addStreetUnit.toUpperCase();
	} else {
	addStreetUnit = "";
	}

refAdd = aa.address.getRefAddressByStreetName(add[0].getStreetName()).getOutput();
if (refAdd != null) {
	for(r in refAdd) include("CMN;LoopThroughAddressAndCompare");
	}

if (refAddress != null) {
	aa.address.removeAddress(capId, add[0].getAddressId());
	logDebug("1");
	}

if (refAddress != null) {
	aa.address.createAddressWithRefAddressModel(capId, refAddress);
	logDebug("2");
	}

if (refAddress != null) {
	capOwner = aa.owner.getParcelOwnersByCap(capId);
	capO = aa.owner.getOwnerByCapId(capId);
	}

if (capO != null) {
	capOMod = capO.getOutput();
	aa.owner.removeCapOwnerModel(capOMod[0]);
	}

if (capOwner != null) {
	capOwnerMod = capOwner.getOutput();
	aa.owner.createCapOwnerWithAPOAttribute(capOwnerMod[0]);
	}

if (refAddress != null) {
	updateAppStatus("Open", "Opened", capId);
	}
`^
CMN;AMS!Engineering Facility Maint!Email Assigned^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
assignmentUpdated=false;
cd=aa.cap.getCapDetail(capId).getOutput().getCapDetailModel();
prevAssignTo= getAppSpecific("WORK ORDER INFO.Previous Assignment");
if(prevAssignTo==null) prevAssignTo="Blank";
curAssignTo=cd.getAsgnStaff();
if(curAssignTo==null) curAssignTo="Blank";
if (!prevAssignTo.equals(curAssignTo)) {
	assignmentUpdated = true;
	if(!curAssignTo.equals("Blank")) include("EML;AMS!Facility Work Order!~!~;RecordAssigned");
	}

if (assignmentUpdated) {
	editAppSpecific("WORK ORDER INFO.Previous Assignment",curAssignTo);
	}
`^
CMN;AMS!Engineering Facility Maint!Email Assigned Dept Users^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (assignedDept != null) {
	groupUserIds = lookup("FacilityGroupEmails",assignedDept);
	showDebug = true;
	emlText ="";
	}

if (groupUserIds != undefined && groupUserIds != null) {
	userIdArray = groupUserIds.split(",");
	var user = aa.person.getUser(userIdArray[0]);
	user = user.getOutput();
	userEmail= user.getEmail();
	include("EML;AMS!Facility Work Order!~!~;RecordAssignedGroup");
	}

if (userIdArray != undefined) {
	var user = aa.person.getUser(userIdArray[1]);
	user = user.getOutput();
	userEmail= user.getEmail();
	include("EML;AMS!Facility Work Order!~!~;RecordAssignedGroup");
	}
`^
CMN;AMS!Engineering Storm!Mowing!~;addAssetInfo^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
strName = strName + (AssetList[x].assetMasterModel["g1AssetName"]) + " - ";
strName = strName + (AssetList[x].assetMasterModel["g1Description"]) + " ";
if (AssetList[x].assetMasterModel["g1AssetType"] == "Greenway") {
	retval = aa.gis.addCapGISObject(capId,"agis_madison","Drainage Greenway Nodes",AssetList[x].assetMasterModel["g1AssetID"]);
	}

if (AssetList[x].assetMasterModel["g1AssetType"] == "Pond") {
	retval = aa.gis.addCapGISObject(capId,"agis_madison","Drainage Pond Nodes",AssetList[x].assetMasterModel["g1AssetID"]);
	}

if (retval.getSuccess()) {
	editAppSpecific("OFFICE USE.District",getGISInfo("agis_madison","Heat Inspect Dist","BI_HEAT"));
	}
`^
CMN;AMS!Streets!Graffiti Removal!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
editAppName(AInfo['GRAFFITI DETAIL.Owner or Agency']);
var iRmvCount = 0;
if (getShortNotes(capId) == "") {
	include("CMN;GetAPOAddress");
	updateShortNotes(APOAddress);
	}

if (AInfo['GRAFFITI DETAIL.Asset Description'] == null) {
	updateWorkDesc(AInfo['GRAFFITI DETAIL.Asset Type']);
	} else {
	updateWorkDesc(AInfo['GRAFFITI DETAIL.Asset Type'] + " - " + AInfo['GRAFFITI DETAIL.Asset Description']);
	}

if (AInfo['GRAFFITI DETAIL.Owner or Agency'] == "Private Other") {
	include("CMN;AMS!Streets!Graffiti Removal!NA;Private");
	}

if (AInfo['GRAFFITI DETAIL.Referred'] == "Yes") {
	include("CMN;AMS!Streets!Graffiti Removal!NA;Referral");
	updateAppStatus("Referred","");
	}

if (AInfo['GRAFFITI DETAIL.Painted'] == "Yes") {
	updateAppStatus("Painted","");
	iRmvCount = iRmvCount + 1;
	}

if (AInfo['GRAFFITI DETAIL.Cleaned'] == "Yes") {
	updateAppStatus("Cleaned","");
	iRmvCount = iRmvCount + 1;
	}

if (AInfo['GRAFFITI DETAIL.Blasted'] == "Yes") {
	updateAppStatus("Blasted","");
	iRmvCount = iRmvCount + 1;
	}

if (AInfo['GRAFFITI DETAIL.Referred'] != "Yes" && iRmvCount > 1) {
	updateAppStatus("Removed","");
	}
`^
CMN;AMS!Streets!Graffiti Removal!NA;Private^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
childId = createChild("Enforcement","Building Inspection", "Property Maintenance", "Graffiti", "Reported by Streets");
rscapModel = cap.getCapModel();
cd = aa.cap.getCapDetail(childId).getOutput().getCapDetailModel();
copyDocuments(capId, childId);
copyAddresses(capId, childId);
updateAppStatus("Open","",childId);
`^
CMN;AMS!Streets!Graffiti Removal!NA;Referral^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
emailSubject = "City of Madison Streets Division - Graffiti Notice";
emailBody = "The City of Madison Streets Division found the following graffiti;<br !>";
emailBody +="Location; " + getShortNotes(capId) + "<br !> Location Type ! Description; " + workDescGet(capId)  + "<br !> Owner; " + AInfo['GRAFFITI DETAIL.Owner or Agency'] + "<br !>";
emailBody += "Action(s) Taken; ";
if (AInfo['GRAFFITI DETAIL.Painted'] == "Yes") {
	emailBody += "Painted ";
	}

if (AInfo['GRAFFITI DETAIL.Cleaned'] == "Yes") {
	emailBody += "Cleaned ";
	}

if (AInfo['GRAFFITI DETAIL.Blasted'] == "Yes") {
	emailBody += "Blasted";
	}

emailTo = AInfo['GRAFFITI DETAIL.Referral Contacts'];
if (emailTo != null && emailTo != "" && emailTo != "NA") {
	email(emailTo, "noreply@cityofmadisonDEV.com",emailSubject,emailBody);
	}
`^
CMN;AMS!Vehicle;AddID^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var strName = "";
AssetList = aa.asset.getAssetListByWorkOrder(capId,null);
if (AssetList.getSuccess()) {
	AssetList = AssetList.getOutput();
	for (x in AssetList) strName = strName + (AssetList[x].assetMasterModel["g1AssetID"]) + " ";
	updateShortNotes(strName);
	}
`^
CMN;AnimalServices!Bite!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (isTaskActive("Investigation") && (capStatus == "Euth!Test" || capStatus == "Owner Unknown" || capStatus == "Press Release") && capStatus != "Void") {
	closeTask("Investigation", capStatus, "Investigation has been completed with a " + capStatus + " status", "Automated");
	}

if (isTaskActive("Investigation") && (capStatus == "Quarantine Confirmed" || capStatus == "No Quarantine Required" || capStatus == "Failure to Quarantine")  && capStatus != "Void") {
	closeTask("Investigation", capStatus, "Investigation has been completed with a " + capStatus + " status", "Automated");
	}

if (isTaskActive("Review") && capStatus == "Reviewed"  && capStatus != "Void") {
	closeTask("Review", capStatus, "Review has been completed with a " + capStatus + " status", "Automated");
	}

if (isTaskActive("Follow-up") && (capStatus == "Letter Sent" || capStatus == "NFA" || capStatus == "Unlocated Letter Sent") && capStatus != "Void") {
	closeTask("Follow-up", capStatus, "Review has been completed with a " + capStatus + " status", "Automated");
	}

if (isTaskActive("Review") && countActiveTasks("HEBITE") == 2 && capStatus != "Void") {
	updateAppStatus("Review", "App status updated to Review due to Follow-up being closed");
	}

if (isTaskActive("Follow-up") && countActiveTasks("HEBITE") == 2 && capStatus != "Void") {
	updateAppStatus("Follow-up", "App status updated to Follow-up due to Review being closed");
	}

if (isTaskActive("Investigation") == false && countActiveTasks("HEBITE") < 2 && capStatus != "Void") {
	closeTask("Closed", "Closed", "Closed due to completed Follow-up", "Automated");
	}
`^
CMN;AnimalServices!General!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (isTaskActive("Investigation") && capStatus == "Founded" && capStatus != "Void") {
	closeTask("Investigation", capStatus, "Investigation has been founded","Automated");
	}

if (isTaskActive("Investigation") && (capStatus == "DOA" || capStatus == "Phone Consultation" || capStatus == "Transported") && capStatus != "Void") {
	branchTask("Investigation", capStatus, "Investigation has been " + capStatus + ", Case Closed", "Automated");
	closeTask("Closed", "Closed", "Closed due to completed investigation", "Automated");
	}

if (isTaskActive("Investigation") && (capStatus == "Unfounded" || capStatus == "UTC" || capStatus == "UTL") && capStatus != "Void") {
	branchTask("Investigation", capStatus, "Investigation has been " + capStatus + ", Case Closed", "Automated");
	closeTask("Closed", "Closed", "Closed due to completed investigation", "Automated");
	}

if (isTaskActive("Investigation") && capStatus == "Issue Resolved" && capStatus != "Void") {
	closeTask("Investigation", "Founded", "Investigation has been Founded, Case Closed", "Automated");
	closeTask("Follow-up", capStatus, "Follow-up has been " + capStatus + ", Case Closed", "Automated");
	closeTask("Closed", "Closed", "Closed due to completed follow-up", "Automated");
	}

if (isTaskActive("Follow-up") && capStatus == "Issue Resolved" && capStatus != "Void") {
	closeTask("Follow-up", capStatus, "Follow-up has been " + capStatus + ", Case Closed", "Automated");
	closeTask("Closed", "Closed", "Closed due to completed follow-up", "Automated");
	}
`^
CMN;AnimalServices!Rabies Exposure!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (isTaskActive("First Contact") && (capStatus == "Animal Pickup" || capStatus == "Pet Quarantine") && capStatus != "Void") {
	closeTask("First Contact",capStatus,"First Contact has resulted in " + capStatus + ", moved to SLOH", "Automated");
	}

if (isTaskActive("First Contact") && (capStatus == "No Animal" || capStatus == "Phone Consultation") && capStatus != "Void") {
	branchTask("First Contact", capStatus, "First Contact has resulted in " + capStatus + ", First Contact is Closed","Automated");
	closeTask("Closed","Closed","Closed due to First Contact","Automated");
	include("CMN;AssignCapBlank");
	}

if (isTaskActive("SLOH") && (capStatus == "Indeterminate" || capStatus == "Negative" || capStatus == "Positive") && capStatus != "Void") {
	closeTask("SLOH", capStatus, "SLOH has resulted in " + capStatus + ", moved to Follow-up","Automated");
	}

if (isTaskActive("Follow-up") && capStatus == "Letter Sent" && capStatus != "Void") {
	closeTask("Follow-up", capStatus, "Follow-up has resulted in " + capStatus + ", moved to Closed","Automated");
	closeTask("Closed","Closed","Closed due to Follow-up","Automated");
	}
`^
CMN;AnimalServices!Welfare!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (isTaskActive("Investigation") && capStatus == "Founded" && capStatus != "Void") {
	closeTask("Investigation", capStatus, "Investigation has been founded", "Automated");
	}

if (isTaskActive("Investigation") && (capStatus == "Unfounded" || capStatus == "Phone Consultation") && capStatus != "Void") {
	branchTask("Investigation", capStatus, "Investigation has been completed with a " + capStatus + " status, Case Closed", "Automated");
	closeTask("Closed", "Closed", "Closed due to completed investigation", "Automated");
	}

if (isTaskActive("Follow-up") && capStatus == "Non-compliant" && capStatus != "Void") {
	closeTask("Follow-up", capStatus, "Follow-up has resulted in Non-Compliance", "Automated");
	}

if (capStatus == "Issue Resolved" && isTaskActive("Investigation")) {
	branchTask("Investigation", "Founded", "Investigation has been Founded, Case Closed", "Automated");
	}

if (capStatus == "Issue Resolved" && capStatus != "Void") {
	branchTask("Follow-up", capStatus, "Follow-up has resulted in Resolution", "Automated");
	closeTask("Closed", "Closed", "Closed due to completed Follow-up", "Automated");
	}

if (isTaskActive("Adjudication") && (capStatus == "Dismissed" || capStatus == "Forfeiture") && capStatus != "Void") {
	branchTask("Adjudication", capStatus, "Adjudication has been closed with a " + capStatus + " status", "Automated");
	closeTask("Closed", "Closed", "Closed due to completed Adjudication", "Automated");
	}
`^
CMN;AnimalServices!Wildlife!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (capStatus != "Open" && isTaskActive("Investigation") && capStatus != "Void") {
	closeTask("Investigation", capStatus, "Investigation has been completed with a " + capStatus + " status, Case closed", "Automated");
	closeTask("Closed", "Closed", "Closed due to completed investigation", "Automated");
	}
`^
CMN;ApplicantOrContactUpdateAppNameWDBAName^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var dbaName = "";
var applPeople;
var capContactResult = aa.people.getCapContactByCapID(capId);
if (capContactResult.getSuccess()) {
	Contacts = capContactResult.getOutput();
	}

if (Contacts.length > 0) {
	for (var curContact in Contacts) if (Contacts[curContact].getPeople().contactType == "Applicant or Contact") applPeople = Contacts[curContact].getCapContactModel();
	}

if (applPeople) {
	dbaName = applPeople.getTradeName();
	}

if (dbaName != "") {
	editAppName(dbaName, capId);
	}
`^
CMN;ASIT_PROCESS^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (tblColi.hasNext() == false) {
	tblColi = aModel.getColumns().iterator();
	colCount = 0;
	rowCount = rowCount + 1;
	}

showDebug = true;
val = tblFieldi.next();
col = tblColi.next();
colCount = colCount + 1;
colName = col.getColumnName();
logDebug("columnName;"+colName);
if (colName == "Date"  && (val ==null || val == "")) {
	tblField.set(fieldCount, sysDateMMDDYYYY);
	}

fieldCount = fieldCount + 1;
`^
CMN;AssembyContact^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
dupName = iContacts[iContact]["firstName"] + " " + iContacts[iContact]["lastName"] + "<br>";
if (iContacts[iContact]["addressLine1"] != null) {
	dupName += iContacts[iContact]["addressLine1"] + "<br>";
	}

if (iContacts[iContact]["addressLine2"] != null) {
	dupName += iContacts[iContact]["addressLine2"] + "<br>";
	}

if (iContacts[iContact]["city"] != null) {
	dupName += iContacts[iContact]["city"] + ", ";
	}

if (iContacts[iContact]["state"] != null) {
	dupName += iContacts[iContact]["state"] + " ";
	}

if (iContacts[iContact]["zip"] != null) {
	dupName += iContacts[iContact]["zip"];
	}
`^
CMN;AssignBIInspectionTask^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (validateGisObjects() != undefined) {
	var varInsp = getGISInfo("agis_madison","Bldg Inspect Dist","ACES_User_ID");
	if(varInsp != undefined) assignTask("Building Inspection",varInsp.toUpperCase());
	}
`^
CMN;AssignBldgInsp^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (validateGisObjects() == undefined) {
	copyParcelGisObjects();
	}

if (validateGisObjects()) {
	var varInsp = getGISInfo("agis_madison","Bldg Inspect Dist","ACES_User_ID");
	if(varInsp != undefined) assignCap(varInsp.toUpperCase());
	userId = varInsp.toUpperCase();
	if(AInfo['OFFICIAL USE ONLY.Difficulty Factor'] > 3) include("EML;AssignInspector");
	}
`^
CMN;AssignBldgSignInsp^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
inspecUserID = "";
if (validateGisObjects() == undefined) {
	copyParcelGisObjects();
	}

if (validateGisObjects()) {
	var varInsp = getGISInfo("agis_madison","Bldg Sign Inspect Dist","ACES_User_ID");
	}
`^
CMN;AssignCapBlank^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
cd = aa.cap.getCapDetail(capId).getOutput().getCapDetailModel();
cd.setAsgnDept("");
cd.setAsgnStaff("");
cdWrite = aa.cap.editCapDetail(cd);
`^
CMN;AssignCapCurrentUser^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (cd = aa.cap.getCapDetail(capId).getOutput().getCapDetailModel();) {
	}

if (cd.setAsgnDept(currentUserID);) {
	}

if (cd.setAsgnStaff(currentUserID);) {
	}

if (cdWrite = aa.cap.editCapDetail(cd);) {
	}
`^
CMN;AssignElecInsp^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (validateGisObjects() == undefined) {
	copyParcelGisObjects();
	}

if (validateGisObjects()) {
	var varInsp = getGISInfo("agis_madison","Elec Inspect Dist","ACES_User_ID");
	if(varInsp != undefined) assignCap(varInsp.toUpperCase());
	userId = varInsp.toUpperCase();
	if(AInfo['OFFICIAL USE ONLY.Difficulty Factor'] > 3) include("EML;AssignInspector");
	}
`^
CMN;AssignFireInspectionTaskPrevention^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (validateGisObjects() == undefined) {
	copyParcelGisObjects();
	}

if (validateGisObjects()) {
	var varInsp = getGISInfo("agis_madison","Fire Inspect Dist","UserID");
	if(varInsp != undefined) assignTask("Fire Inspection",varInsp.toUpperCase());
	}
`^
CMN;AssignHeatInsp^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (validateGisObjects() == undefined) {
	copyParcelGisObjects();
	}

if (validateGisObjects()) {
	var varInsp = getGISInfo("agis_madison","Heat Inspect Dist","ACES_User_ID");
	if(varInsp != undefined) assignCap(varInsp.toUpperCase());
	userId = varInsp.toUpperCase();
	if(AInfo['OFFICIAL USE ONLY.Difficulty Factor'] > 3) include("EML;AssignInspector");
	}
`^
CMN;AssignPlumbInsp^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (validateGisObjects() == undefined) {
	copyParcelGisObjects();
	}

if (validateGisObjects()) {
	var varInsp = getGISInfo("agis_madison","Plumb Inspect Dist","ACES_User_ID");
	if(varInsp != undefined) assignCap(varInsp.toUpperCase());
	userId = varInsp.toUpperCase();
	if(AInfo['OFFICIAL USE ONLY.Difficulty Factor'] > 3) include("EML;AssignInspector");
	}
`^
CMN;Banner_Store_Report_To_Disk^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
reportInfoModel = aa.reportManager.getReportInfoModelByName("Vending Banner Permit");
if (reportInfoModel.getSuccess()) {
	report = reportInfoModel.getOutput();
	}

if (reportInfoModel.getSuccess()) {
	report.setModule(appTypeArray[0]);
	report.setCapId(capId);
	}

if (reportInfoModel.getSuccess()) {
	parameters = aa.util.newHashMap();
	parameters.put("AltID", capIDString);
	}

if (reportInfoModel.getSuccess()) {
	report.setReportParameters(parameters);
	}

if (reportInfoModel.getSuccess()) {
	report2 = report.getReportInfoModel();
	report2.setNotSaveToEDMS(true);
	}

if (reportInfoModel.getSuccess()) {
	reportResult = aa.reportManager.getReportResult(report);
	}

if (reportResult.getSuccess()) {
	reportResult = reportResult.getOutput();
	}

reportFile = aa.reportManager.storeReportToDisk(reportResult);
if (reportFile.getSuccess()) {
	reportFile = reportFile.getOutput();
	}
`^
CMN;BANNERASIT^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
BANSTARTREQ = varLocTable[x]["Start Date Requested"];
BANENDREQ = varLocTable[x]["End Date Requested"];
BANSTARTAPP = varLocTable[x]["Starting Date Approved"];
BANENDAPP = varLocTable[x]["Ending Date Approved"];
LOCATIONREQ = varLocTable[x]["Location Requested"];
SIDEREQ = varLocTable[x]["Side Requested"];
LOCATIONAPP = varLocTable[x]["Location Approved"];
SIDEAPP = varLocTable[x]["Side Approved"];
BANMSG = varLocTable[x]["Exact Banner Message"];
emailText += "<p>For your Banner Message; " + BANMSG + "<!p>";
if ((BANSTARTAPP == "" || BANSTARTAPP == "null")) {
	emailText += "<p><b><BLOCKQUOTE>We have not approved this banner, for more information please contact a representative.<!BLOCKQUOTE><!b><!p>";
	} else {
	emailText += "<p><b><BLOCKQUOTE>We have approved Start-End Dates of; " + BANSTARTAPP + " - " + BANENDAPP + " Located; " + LOCATIONAPP + " - " + SIDEAPP + "<!BLOCKQUOTE><!b><!p>";
	}
`^
CMN;BANNERCNT;ASIT^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
BANSTARTAPP = varLocTable[x]["Starting Date Approved"];
if ((BANSTARTAPP == "" || BANSTARTAPP == null)) {
	false;
	} else {
	rowCount = rowCount + 1;
	}
`^
CMN;CAPITOLFIREDISTRICT^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (proximity("agis_madison","Capitol Fire District",-1,"feet") && appHasCondition("CAPITOL FIRE DISTRICT","APPLIED","CapitolFireDist",null) == false) {
	addAppCondition("CAPITOL FIRE DISTRICT","APPLIED","CapitolFireDist","Permit applications in this area may require special construction techniques due to the proximity to the State Capitol Building","Notice");
	include("EML;CAPITOLFIREDISTRICT");
	}
`^
CMN;CHECK_AND_CREATE_ROW^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (jobCatAry[jobCatIdx] == "Officials and Managers; TOTAL EMPLOYEES") {
	numEmp = totOff;
	perc = 100;
	if(!bOff)  include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Officials and Managers; Racial!Ethnic AA Group") {
	numEmp = totOffR;
	perc= String(Math.round(totOffR!totOff~100~ 100) ! 100);
	if(!bOffR) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Officials and Managers; Women") {
	numEmp = totOffW;
	perc=String(Math.round(totOffW!totOff~100~ 100) ! 100);
	if(!bOffW) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Officials and Managers; With a Disability") {
	numEmp = totOffD;
	perc=String(Math.round(totOffD!totOff~100~ 100) ! 100);
	if(!bOffD) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Professionals; TOTAL EMPLOYEES") {
	numEmp = totPro;
	perc = 100;
	if(!bPro) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Professionals; Racial!Ethnic AA Group") {
	numEmp = totProR;
	perc = String(Math.round(totProR!totPro~100~ 100) ! 100);
	if(!bProR) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Professionals; Women") {
	numEmp = totProW;
	perc=String(Math.round(totProW!totPro~100~ 100) ! 100);
	if(!bProW) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Professionals; With a Disability") {
	numEmp = totProD;
	perc = String(Math.round(totProD!totPro~100~ 100) ! 100);
	if(!bProD) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Technicians; TOTAL EMPLOYEES") {
	numEmp = totTech;
	perc=100;
	if(!bTech) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Technicians; Racial!Ethnic AA Group") {
	numEmp = totTechR;
	perc=String(Math.round(totTechR!totTech~100~ 100) ! 100);
	if(!bTechR) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Technicians; Women") {
	numEmp = totTechW;
	perc= String(Math.round(totTechW!totTech~100~ 100) ! 100);
	if(!bTechW) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Technicians; With a Disability") {
	numEmp = totTechD;
	perc=String(Math.round(totTechD!totTech~100~ 100) ! 100);
	if(!bTechD) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Sales; TOTAL EMPLOYEES") {
	numEmp = totSales;
	perc = 100;
	if(!bSales) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Sales; Racial!Ethnic AA Group") {
	numEmp = totSalesR;
	perc=String(Math.round(totSalesR!totSales~100~ 100) ! 100);
	if(!bSalesR) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Sales; Women") {
	numEmp = totSalesW;
	perc=String(Math.round(totSalesW!totSales~100~ 100) ! 100);
	if(!bSalesW) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Sales; With a Disability") {
	numEmp = totSalesD;
	perc=String(Math.round(totSalesD!totSales~100~ 100) ! 100);
	if(!bSalesD) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Clerical and Admin. Support; TOTAL EMPLOYEES") {
	numEmp = totClerk;
	perc=100;
	if(!bClerk) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Clerical and Admin. Support; Racial!Ethnic AA Group") {
	numEmp = totClerkR;
	perc=String(Math.round(totClerkR!totClerk~100~ 100) ! 100);
	if(!bClerkR) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Clerical and Admin. Support; Women") {
	numEmp = totClerkW;
	perc =String(Math.round(totClerkW!totClerk~100~ 100) ! 100);
	if(!bClerkW) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Clerical and Admin. Support; With a Disability") {
	numEmp = totClerkD;
	perc=String(Math.round(totClerkD!totClerk~100~ 100) ! 100);
	if(!bClerkD) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Craft Workers; TOTAL EMPLOYEES") {
	numEmp = totCraft;
	perc=100;
	if(!bCraft) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Craft Workers; Racial!Ethnic AA Group") {
	numEmp = totCraftR;
	perc=String(Math.round(totCraftR!totCraft~100~ 100) ! 100);
	if(!bCraftR) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Craft Workers; Women") {
	numEmp = totCraftW;
	String(Math.round(totCraftW!totCraft~100~ 100) ! 100);
	if(!bCraftW) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Craft Workers; With a Disability") {
	numEmp = totCraftD;
	perc=String(Math.round(totCraftD!totCraft~100~ 100) ! 100);
	if(!bCraftD) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Operatives; TOTAL EMPLOYEES") {
	numEmp = totOper;
	perc=100;
	if(!bOper) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Operatives; Racial!Ethnic AA Group") {
	numEmp = totOperR;
	perc=String(Math.round(totOperR!totOper~100~ 100) ! 100);
	if(!bOperR) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Operatives; Women") {
	numEmp = totOperW;
	perc=String(Math.round(totOperW!totOper~100~ 100) ! 100);
	if(!bOperW) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Operatives; With a Disability") {
	numEmp = totOperD;
	perc=String(Math.round(totOperD!totOper~100~ 100) ! 100);
	if(!bOperD) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Laborers, Helpers, Material Handlers; TOTAL EMPLOYEES") {
	numEmp = totLab;
	perc=100;
	if(!bLab) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Laborers, Helpers, Material Handlers; Racial!Ethnic AA Group") {
	numEmp = totLabR;
	perc=String(Math.round(totLabR!totLab~100~ 100) ! 100);
	if(!bLabR) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Laborers, Helpers, Material Handlers; Women") {
	numEmp = totLabW;
	perc = String(Math.round(totLabW!totLab~100~ 100) ! 100);
	if(!bLabW) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Laborers, Helpers, Material Handlers; With a Disability") {
	numEmp = totLabD;
	perc=String(Math.round(totLabD!totLab~100~ 100) ! 100);
	if(!bLabD) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Service Workers; TOTAL EMPLOYEES") {
	numEmp = totSer;
	perc=100;
	if(!bSer) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Service Workers; Racial!Ethnic AA Group") {
	numEmp = totSerR;
	perc = String(Math.round(totSerR!totSer~100~ 100) ! 100);
	if(!bSerR) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Service Workers; Women") {
	numEmp = totSerW;
	perc=String(Math.round(totSerW!totSer~100~ 100) ! 100);
	if(!bSerW) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "Service Workers; With a Disability") {
	numEmp = totSerD;
	perc = String(Math.round(totSerD!totSer~100~ 100) ! 100);
	if(!bSerD) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "TOTAL EMPLOYEES") {
	numEmp = totEmp;
	perc=100;
	if(!bTot) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "TOTAL RACIAL!ETHNIC AA GROUP EMPLOYEES") {
	numEmp = totR;
	perc = String(Math.round(totR!totEmp~100~ 100) ! 100);
	perR = perc;
	if(!bR) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "TOTAL WOMEN EMPLOYEES") {
	numEmp = totF;
	perc = String(Math.round(totF!totEmp~100~ 100) ! 100);
	perW=perc;
	if(!bF) include("CMN;CREATE_WORKFORCE_ROW");
	}

if (jobCatAry[jobCatIdx] == "TOTAL EMPLOYEES WITH A DISABILITY") {
	numEmp = totDis;
	perc = String(Math.round(totDis!totEmp~100~ 100) ! 100);
	if(!bDis) include("CMN;CREATE_WORKFORCE_ROW");
	}

jobCatIdx++;
jobIdx ++;
`^
CMN;CheckAEDExpiration^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
assetSeq = AssetList[x].getAssetMasterModel().getG1AssetSequenceNumber();
var battExp = "01!01!1900";
var padExp = "01!01!1900";
selectString = "DECLARE @AssetSeq varchar(250);
SET @AssetSeq = '" + assetSeq + "';
SELECT G1_Attribute_value FROM GASSET_attribute where serv_prov_code = 'MADISON' and g1_attribute_name = 'AED Battery Expiration' and G1_asset_seq_nbr = @AssetSeq";
var initialContext = aa.proxyInvoker.newInstance("javax.naming.InitialContext").getOutput();
var ds = initialContext.lookup("java;!AA");
var conn = ds.getConnection();
var sStmt = conn.prepareStatement(selectString);
var rSet = sStmt.executeQuery();
if (rSet && rSet.next()) {
	batteryExp = rSet.getString("G1_Attribute_value");
	}

selectString = "DECLARE @AssetSeq varchar(250);
SET @AssetSeq = '" + assetSeq + "';
SELECT G1_Attribute_value FROM GASSET_attribute where serv_prov_code = 'MADISON' and g1_attribute_name = 'Pads Replacement Due Date' and G1_asset_seq_nbr = @AssetSeq";
sStmt = conn.prepareStatement(selectString);
var rSet = sStmt.executeQuery();
if (rSet && rSet.next()) {
	padExp = rSet.getString("G1_Attribute_value");
	rSet.close();
	conn.close();
	} else {
	conn.close();
	}

var dtToday = new Date();
var battExpDt = new Date(batteryExp);
var padExpDt = new Date(padExp);
if (dtToday > battExpDt || dtToday > padExpDt) {
	expired = true;
	}
`^
CMN;CheckGenLicProfExpDates^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var LicMod = null;
var qualifierExpDate = null;
var dtQualifierExpDate = null;
var contractorExpDate = null;
var dtContractorExpDate = null;
var dtToday = new Date();
var infoMsg = "";
var bDoCancel = false;
if (CAE) {
	LicMod = CAE.getLicenseModel();
	!!CAE is object from ASB MasterScript.;
	}

if (LicMod != null) {
	qualifierExpDate = LicMod.getBusinessLicExpDate();
	logDebug("Business!Qualifier Lic Exp Date = " + qualifierExpDate);
	} else {
	logDebug("Unable to retrieve CAE.getLicenseModel object, which is needed to get the Qualifier Exp Date.");
	}

if ((qualifierExpDate != null && qualifierExpDate != "")) {
	dtQualifierExpDate = convertDateAlt(aa.date.parseDate(qualifierExpDate));
	}

if (LicMod != null && (qualifierExpDate == null || qualifierExpDate == "" )) {
	infoMsg += "Warning; The Qualifier # expiration date is blank for the selected licensed professional.<br>";
	logDebug("Qualifier # exp date is blank");
	} else {
	logDebug("Qualifier # has an expiration date.");
	}

if (dtQualifierExpDate != null && dtToday > dtQualifierExpDate) {
	infoMsg += "Warning; The Qualifier # is expired for the selected licensed professional.<br>";
	logDebug("Qualifier # is expired");
	} else {
	logDebug("Qualifier # is valid.");
	}

if (LicMod != null) {
	contractorExpDate = LicMod.getLicenseLastRenewalDate();
	logDebug("Contractor Exp Date = " + contractorExpDate);
	} else {
	logDebug("Unable to retrieve CAE.getLicenseModel object, which is needed to get the Contractor Exp Date.");
	}

if ((contractorExpDate != null && contractorExpDate != "")) {
	dtContractorExpDate = convertDateAlt(aa.date.parseDate(contractorExpDate));
	}

if (LicMod != null && (contractorExpDate == null || contractorExpDate == "")) {
	infoMsg += "Warning; The Contractor's License # expiration date is blank for the selected licensed professional.<br>";
	logDebug("Contractor License exp date is blank");
	} else {
	logDebug("Contractor License has an expiration date.");
	}

if (dtContractorExpDate != null && dtToday > dtContractorExpDate) {
	infoMsg += "Warning; The Contractor's License #  is expired for the selected licensed professional.<br>";
	logDebug("Contractor License is expired");
	} else {
	logDebug("Contractor License is valid.");
	logDebug("The message = " + infoMsg);
	}

if (dtToday != null) {
	logDebug("Today's Date = " + dtToday.toString());
	}

if (dtQualifierExpDate != null) {
	logDebug("dtQualifierExpDate = " + dtQualifierExpDate.toString());
	}

if (dtContractorExpDate != null) {
	logDebug("dtContractorExpDate = " + dtContractorExpDate.toString());
	}

if (cancel == true) {
	bDoCancel = true;
	} else {
	bDoCancel = false;
	!!Need this line due to address type check in ASB;Permitting!Building!~!~.;
	}

if (infoMsg != "") {
	cancel = bDoCancel;
	showMessage = true;
	comment(infoMsg);
	}
`^
CMN;CheckGISNoticeCondition^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
par = false;
gis = true;
valGis = true;
appCond = false;
appCond = appHasCondition("MAPPING", "Applied", "Parcel could not be located on the map", "Notice");
par = parcelExistsOnCap(capId);
if (par == true) {
	gisObj = aa.gis.getCapGISObjects(capId).getOutput();
	} else {
	gis = false;
	}

if (gis == true) {
	if(gisObj[0] == undefined) valGis = false;
	if(gisObj[0] != undefined) valGis = validateGisObjects();
	} else {
	valGis = false;
	}

if (par == false && appCond == true) {
	removeCapCondition("MAPPING", "Parcel could not be located on the map", capId);
	}

if (par == true && valGis == true && appCond == true) {
	removeCapCondition("MAPPING", "Parcel could not be located on the map", capId);
	}

if (par == true && valGis == false && appCond == false) {
	addAppCondition("MAPPING", "Applied", "Parcel could not be located on the map", "Could not find parcel on the Map to determine if any Holds and!or Conditions exists. Please manually check for any Department Holds and!or Conditions.", "Notice");
	include("EML;NoGISObject");
	}
`^
CMN;CHECKROWSECTION^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var asiGroup = asiGroups[asi].getCheckboxType();
asiValue = asiGroups[asi].checklistComment;
if ((asiGroup == "SECT II STREET UTIL SITE CONST" || asiGroup == "SECT II BRIDGE CONSTRUCTION") && asiValue == "CHECKED") {
	createROWCard = true;
	}
`^
CMN;CHECKTERSECTION^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var asiGroup = asiGroups[asi].getCheckboxType();
var asiField = asiGroups[asi].checkboxDesc;
asiValue = asiGroups[asi].checklistComment;
if (asiGroup == "SECTION I" && (asiField == "Concrete Layer (No fee required)" || asiField == "Asphalt Paver (No fee required)" || asiField == "Mudjacking of Concrete Sidewalk and Driveways (No fee required)" || asiField == "Landscaping Pavers!Other (No fee required)") && asiValue == "CHECKED") {
	createTERCard = true;
	}
`^
CMN;CloseAndCloseParent^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
taskCloseAllExcept("Closed","Closed by Script");
updateAppStatus("Closed","Updated via Script");
parentCapId = getParent();
logDebug("Parent is;"+parentCapId);
if (parentCapId) {
	holdId = capId;
	capId = parentCapId;
	taskCloseAllExcept("Closed","Closed by Script from Closed W.O.");
	updateAppStatus("Closed","Updated via Script");
	capId = holdId;
	}
`^
CMN;CloseFromFinalInspection^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (inspType.toUpperCase() == "FINAL" && (inspResult == "Approved")) {
	updateAppStatus("Closed","");
	closeTask("Inspection","Complete","Inspection Result","");
	closeTask("Certificate of Occupancy","No CoO Required","","");
	closeTask("Closed","Closed","","");
	}

if (inspType.toUpperCase() == "FINAL" && inspResult == "CO Approved Closed") {
	updateAppStatus("Ready for CoO","");
	closeTask("Inspection","Complete","Inspection Result","");
	}

if (inspType.toUpperCase() == "FINAL" && inspResult == "CO Approved Open") {
	updateAppStatus("Ready for CoO","");
	}

if (inspType.toUpperCase() == "FOOTING") {
	include("EML;ENFooting");
	}
`^
CMN;CloseRecord^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
result = aa.expiration.isExpiredLicenses(capId);
hasExpire = result.getErrorMessage();
if (capClosed && hasExpire != null) {
	licEditExpInfo("Inactive", null);
	}

if (capClosed) {
	include("CMN;AssignCapBlank");
	}

if (capClosed) {
	inspCancelAll();
	}

if (capClosed && isTaskActive("Close")) {
	closeTask("Close","Closed","Closed by script.","");
	}

if (capClosed && isTaskActive("Closed")) {
	closeTask("Closed","Closed","Closed by script.","");
	}
`^
CMN;CloseTasksHistoricLandmarkUrbanIfNA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var isaca = false;
var closeHistoric = false;
var closeUrban = false;
var closeLandmark=false;
var closeHistoricMsg = "";
var closeUrbanMsg = "";
var closeLandmarkMsg = "";
if (cap.isCreatedByACA()) {
	closeHistoricMsg = "Closed via script because not in an Historic District";
	closeUrbanMsg = "Closed via script because not in an Urban Design District";
	closeLandmarkMsg = "Closed via script because not near a landmark";
	} else {
	closeHistoric = true;
	closeUrban = true;
	closeLandmark=true;
	closeHistoricMsg = "Closed via script because not ACA";
	closeUrbanMsg = "Closed via script because not ACA";
	closeLandmarkMsg = "Closed via script because not ACA";
	}

if (closeHistoric == false) {
	closeHistoric = appHasCondition("LOCAL HISTORIC DISTRICT","APPLIED","LocalHistDist",null) == false;
	}

if (closeUrban == false) {
	closeUrban = appHasCondition("URBAN DESIGN DISTRICT","APPLIED","UrbanDesignDist",null) == false;
	}

if (closeLandmark == false) {
	closeLandmark = appHasCondition("ADJACENT TO LANDMARK","APPLIED","Adjacent to Landmark",null) == false && appHasCondition("LANDMARK SITE","APPLIED","Landmark Site",null) == false;
	}

if (closeHistoric) {
	closeTask("Local Historic Review","Not Required", closeHistoricMsg, "");
	}

if (closeUrban) {
	closeTask("Urban Design Review", "Not Required", closeUrbanMsg, "");
	}

if (closeLandmark) {
	closeTask("Landmark Review", "Not Required", closeLandmarkMsg, "");
	}
`^
CMN;CloseTaskWellOrSepticReview^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
capsText = "";
closeSepticReviewMsg = "Closed via script because N!A";
relatedCaps = getRelatedCapsByParcel("Permitting!Health!~!~");
if ((relatedCaps[0] != null && relatedCaps[0].toString().length()>0 )) {
	for (rc in relatedCaps) include("CMN;Permitting!Health;SanitaryHealthLicenseDetail");
	}

capsTextLen = capsText.length;
if (appTypeString == "Licenses!Health!DischofNonStrmwtr!Madison") {
	capsTextLen = 0;
	!! Always close this one;
	}

if (capsTextLen == 0) {
	closeTask("Well or Septic Review","Not Required", closeSepticReviewMsg , "");
	}
`^
CMN;ConditionalLicenseIssuance^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (feesInvoicedTotal > 0 && balanceDue <= 0) {
	bCondLicIssued = true;
	} else {
	bCondLicIssued = false;
	}

if (bCondLicIssued == true) {
	updateTask("License Status", "Active - Conditional", "Updated by Conditional License Issuance script", "");
	}

if (bCondLicIssued == false) {
	include("EML;Licenses!~!~!~;LicenseNotIssued");
	logDebug("Conditional License NOT issued");
	}
`^
CMN;ContactRemovefromParentCapId^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aa.people.removeCapContact(parentCapId, pConArray[pC].contactSeqNumber);
`^
CMN;CopySignInspectionsLoop^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var inspecId = null;
var copyResult = null;
inspecId = aryInspections[insp].idNumber;
logDebug("Inspection ID Number = " + inspecId);
if (inspecId != null) {
	copyResult = aa.inspection.copyInspectionWithGuideSheet(capId, childId, aa.inspection.getInspection(capId, inspecId).getOutput().getInspection());
	}
`^
CMN;CREATE_ENGFAC_WO_CHILD^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
childId = null;
parentCap = null;
workDesc = "";
assignedUser = "";
assignedDept = "";
holdId = "";
if (tsiResults[0].getChecklistComment() == "Repair - Scheduled") {
	childId = createChild("AMS","Engineering Facility Maint", "Repair", "Scheduled", "Engineering Facility Repair Work Order");
	}

if (tsiResults[0].getChecklistComment() == "Repair - Unscheduled") {
	childId = createChild("AMS","Engineering Facility Maint", "Repair", "Unscheduled", "Engineering Facility Repair Work Order");
	}

if (tsiResults[0].getChecklistComment() == "Customer Request") {
	childId = createChild("AMS","Engineering Facility Maint", "Customer Request", "NA", "Engineering Facility Customer Request");
	}

if (tsiResults[0].getChecklistComment() == "New Installation") {
	childId = createChild("AMS","Engineering Facility Maint", "New Installation", "NA", "Engineering Facility New Installation");
	}

if (tsiResults[0].getChecklistComment() == "Predictive Testing and Insp") {
	childId = createChild("AMS","Engineering Facility Maint", "Predictive Testing and Insp", "NA", "Engineering Facility Predictive Testing and Insp");
	}

if (tsiResults[0].getChecklistComment() == "Preventive Maintenance") {
	childId = createChild("AMS","Engineering Facility Maint", "Preventive Maintenance", "NA", "Engineering Facility Preventative Maintenance");
	}

if (tsiResults[0].getChecklistComment() == "Programmed Maintenance") {
	childId = createChild("AMS","Engineering Facility Maint", "Programmed Maintenance", "NA", "Engineering Facility Programmed Maintenance");
	}

if (tsiResults[0].getChecklistComment() == "Trouble Call") {
	childId = createChild("AMS","Engineering Facility Maint", "Trouble Call", "NA", "Engineering Facility Trouble Call");
	}

if (tsiResults[0].getChecklistComment() == "Upgrade or Retrofit") {
	childId = createChild("AMS","Engineering Facility Maint", "Upgrade or Retrofit", "NA", "Engineering Facility Upgrade or Retrofit");
	}

workDesc = tsiResults[1].getChecklistComment();
if (workDesc == null || workDesc == "") {
	workDesc = workDescGet(capId);
	}

rscapModel = cap.getCapModel();
aa.asset.cloneAssets(rscapModel, childId);
newWorkDesModel = aa.cap.capWorkDesModel.getOutput();
newWorkDesModel.setCapID(childId);
newWorkDesModel.setAuditDate(aa.util.now());
newWorkDesModel.setAuditStatus("A");
newWorkDesModel.setAuditID(currentUserID);
newWorkDesModel.setDescription(workDesc);
newWorkDes = aa.cap.createCapWorkDes(newWorkDesModel);
updateWorkDesc(workDesc);
copyDocuments(capId, childId);
copyAddresses(capId, childId);
assignedDept = lookup("Facility Territory", tsiResults[2].getChecklistComment());
if (tsiResults[3].getChecklistComment() != null && tsiResults[3].getChecklistComment() != "") {
	assignedUser = lookup("Facility Assigned User", tsiResults[2].getChecklistComment() + " " + tsiResults[3].getChecklistComment());
	}

if (tsiResults[4].getChecklistComment() != null && tsiResults[4].getChecklistComment() != "") {
	assignedUser = lookup("Facility Assigned User", tsiResults[2].getChecklistComment() + " " + tsiResults[4].getChecklistComment());
	}

if (tsiResults[5].getChecklistComment() != null && tsiResults[5].getChecklistComment() != "") {
	assignedUser = lookup("Facility Assigned User", tsiResults[2].getChecklistComment() + " " + tsiResults[5].getChecklistComment());
	}

if (assignedDept != null && assignedDept != "") {
	cd = aa.cap.getCapDetail(childId).getOutput().getCapDetailModel();
	}

if (assignedDept != null && assignedDept != "" && cd) {
	cd.setAsgnDept(assignedDept);
	}

if (assignedUser != null && assignedUser != "" && cd) {
	cd.setAsgnStaff(assignedUser);
	}

if (cd) {
	aa.cap.editCapDetail(cd);
	editAppName("No", childId);
	}

if (assignedUser != null && assignedUser != "") {
	holdId = capId;
	capId = childId;
	include("CMN;AMS!Engineering Facility Maint!Email Assigned");
	}

if ((assignedUser == "" || assignedUser == null) && assignedDept != null) {
	holdId = capId;
	capId = childId;
	include("CMN;AMS!Engineering Facility Maint!Email Assigned Dept Users");
	}

updateAppStatus("Open","",childId);
updateShortNotes(getAppSpecific("SR - ENGINEERING MAINTENANCE.Facility", holdId) ,childId);
if (assignedUser != null && assignedUser != "") {
	capId = holdId;
	}

if (tsiResults[6].getChecklistComment() != null && tsiResults[6].getChecklistComment() != "") {
	editAppSpecific("WORK ORDER INFO.Billable", tsiResults[6].getChecklistComment(), childId);
	}

if (tsiResults[7].getChecklistComment() != null && tsiResults[7].getChecklistComment() != "") {
	editAppSpecific("WORK ORDER INFO.Account Number", tsiResults[7].getChecklistComment(), childId);
	}

if (tsiResults[8].getChecklistComment() != null && tsiResults[8].getChecklistComment() != "") {
	editAppSpecific("WORK ORDER INFO.Project Number", tsiResults[8].getChecklistComment(), childId);
	}
`^
CMN;CREATE_TE_SR_CHILD^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
childId = null;
parentCap = null;
workDesc = "";
if (tsiResults[study].getCheckboxDesc()== "Count") {
	childId = createChild("ServiceRequest","Traffic Engineering", "Study", "Count", "Traffic Engineering Count");
	workDesc = tsiResults[1].getChecklistComment();
	}

if (tsiResults[study].getCheckboxDesc() == "Crash Study") {
	childId = createChild("ServiceRequest","Traffic Engineering", "Study", "Crash Study", "Traffic Engineering Crash Study");
	workDesc = tsiResults[3].getChecklistComment();
	}

if (tsiResults[study].getCheckboxDesc() == "Field Check") {
	childId = createChild("ServiceRequest","Traffic Engineering", "Study", "Field Check", "Traffic Engineering Field Check");
	workDesc = tsiResults[5].getChecklistComment();
	}

if (tsiResults[study].getCheckboxDesc() == "Parking Study") {
	childId = createChild("ServiceRequest","Traffic Engineering", "Study", "Parking Study", "Traffic Engineering Parking Study");
	workDesc = tsiResults[7].getChecklistComment();
	}

if (tsiResults[study].getCheckboxDesc() == "Previous Study") {
	childId = createChild("ServiceRequest","Traffic Engineering", "Study", "Previous Study", "Traffic Engineering Previous Study");
	workDesc = tsiResults[9].getChecklistComment();
	}

if (tsiResults[study].getCheckboxDesc() == "Sight Distance") {
	childId = createChild("ServiceRequest","Traffic Engineering", "Study", "Sight Distance", "Traffic Engineering Sight Distance");
	workDesc = tsiResults[11].getChecklistComment();
	}

if (tsiResults[study].getCheckboxDesc() == "User Study") {
	childId = createChild("ServiceRequest","Traffic Engineering", "Study", "User Study", "Traffic Engineering User Study");
	workDesc = tsiResults[13].getChecklistComment();
	}

if (tsiResults[study].getCheckboxDesc() == "Speed Study") {
	childId = createChild("ServiceRequest","Traffic Engineering", "Study", "Speed Study", "Traffic Engineering Speed Study");
	workDesc = tsiResults[15].getChecklistComment();
	}

if (tsiResults[study].getCheckboxDesc() == "Electrical Work Order") {
	childId = createChild("AMS","Traffic","Electrical","Na", "Electrical Work Order");
	workDesc = tsiResults[17].getChecklistComment();
	activateTask("Work Order Review");
	}

if (tsiResults[study].getCheckboxDesc() == "Sign Work Order") {
	childId = createChild("AMS","Traffic","Sign","Na", "Sign Work Order");
	workDesc = tsiResults[19].getChecklistComment();
	activateTask("Work Order Review");
	}

if (childId != null) {
	parentCap = aa.cap.getCap(capId).getOutput();
	}

if (childId != null) {
	aa.asset.cloneAssets(parentCap.getCapModel(), childId);
	}

if (childId != null) {
	aa.cap.copyCapDetailInfo(capId, childId);
	aa.cap.copyCapWorkDesInfo(capId, childId);
	if (workDesc != null) updateWorkDesc(workDesc,childId);
	}

if (childId != null) {
	updateAppStatus("Open","",childId);
	}
`^
CMN;CreateAffirmativeActionPlan^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
childId = null;
oAAPlanCapID = null;
var thisYearCreatedAlready = false;
oAAPlanCapID = childGetByCapType("Licenses!Civil Rights!AA Plan!NA");
logDebug("AA Plan CapId object = " + oAAPlanCapID);
if (wfTask == "Intake" && ((wfStatus == "Complete" && isTaskActive("Affirmative Action Review")) || wfStatus == "Complete - AA Plan already created")) {
	thisYearCreatedAlready = true;
	}

if ((oAAPlanCapID == undefined || oAAPlanCapID == null) || thisYearCreatedAlready == false) {
	childId = createChild("Licenses","DCR","AA Plan","NA",capName);
	logDebug("Child ID = " + childId);
	}

if (childId) {
	holdId = capId;
	capId = childId;
	}

if (childId) {
	closeTask("Intake","Complete","Closed via script");
	}

var contactArray = null;
var newCon = null;
if (childId) {
	oContacts = aa.people.getCapContactByCapID(capId);
	}

if (childId && oContacts.getSuccess()) {
	conAry = oContacts.getOutput();
	}

if (childId && conAry) {
	for(con in conAry) if (conAry[con].getCapContactModel().getContactType() == "Contractor") newCon = conAry[con].getCapContactModel();
	}

if (childId && newCon) {
	newCon.setContactType("EEO!AA Officer");
	newCon.setPrimaryFlag("Y");
	newCon.setEmail(null);
	newCon.setFullName(null);
	newCon.setFirstName(null);
	newCon.setMiddleName(null);
	newCon.setLastName(null);
	newCon.setPhone1(null);
	newCon.setPhone2(null);
	newCon.setPhone3(null);
	newCon.setFax(null);
	newCon.setAddressLine1(null);
	newCon.setAddressLine2(null);
	newCon.setComment(null);
	newCon.sePreferredChannele(null);
	}

if (childId && newCon) {
	aa.people.createCapContact(newCon);
	!!debugObject(newCon);
	}

if (childId && conAry) {
	for(con in conAry) if (conAry[con].getPeople().contactType == "Business Contact") aa.people.removeCapContact(childId, conAry[con].getPeople().contactSeqNumber);
	}

if (childId) {
	capId = holdId;
	}

if (currentUserID == "ITJBS") {
	showDebug = true;
	}
`^
cmn;CreateCaseForFireRoutine^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
childId = createChild("Enforcement","Fire","Prevention","NA",capName);
editAppSpecific("APPLICATION INFORMATION.Parent Application Type Generating Case","Routine Inspection",childId);
updateAppStatus("Open","Updated via script",childId);
holdId = capId;
capId = childId;
copyParcelGisObjects();
loopTask("Intake","Inspection Required","Updated due to failed Routine","Updated via script");
var varInsp = getGISInfo("agis_madison","Fire Inspect Dist","UserID");
if(varInsp != undefined) assignCap(varInsp.toUpperCase());
userId = varInsp.toUpperCase();
copyResult = aa.inspection.copyInspectionWithGuideSheet(holdId,childId,aa.inspection.getInspection(holdId,inspId).getOutput().getInspection());
if (getShortNotes(holdId) != null) {
	updateShortNotes(getShortNotes(holdId),childId);
	}

updateWorkDesc("Enforcement Case due to failed routine reinspection");
userId = varInsp.toUpperCase();
include("EML;AssignInspectorNoASI");
capId = holdId;
`^
CMN;CreateChildTEWO^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (type == "elec") {
	childId = createChild("AMS","Traffic","Electrical","Na","Electrical Work Order");
	workDesc = tsiResults[0].getChecklistComment();
	}

if (type == "sign") {
	childId = createChild("AMS","Traffic","Sign","Na","Sign Work Order");
	workDesc = tsiResults[1].getChecklistComment();
	}

holdId = capId;
capId = childId;
rscapModel = cap.getCapModel();
aa.asset.cloneAssets(rscapModel, childId);
aa.cap.copyRenewCapDocument(holdId, childId, currentUserID);
cDocList = aa.document.getCapDocumentList(childId, currentUserID);
if (cDocList.getSuccess()) {
	childDocList = cDocList.getOutput();
	}

if (type == "elec" && cDocList.getSuccess()) {
	for(doc in childDocList) if(childDocList[doc].docCategory != "Electrical WO Diagram") aa.document.removeDocumentByPK(childDocList[doc].entityPK.entitySeq1,"","","ServiceRequest");
	}

if (type == "sign" && cDocList.getSuccess()) {
	for(doc in childDocList) if(childDocList[doc].docCategory != "Sign WO Diagram") aa.document.removeDocumentByPK(childDocList[doc].entityPK.entitySeq1,"","","ServiceRequest");
	}

newWorkDesModel = aa.cap.capWorkDesModel.getOutput();
newWorkDesModel.setCapID(capId);
newWorkDesModel.setAuditDate(aa.util.now());
newWorkDesModel.setAuditStatus("A");
newWorkDesModel.setAuditID(currentUserID);
newWorkDesModel.setDescription(getAppSpecific("REVIEWERS RESULTS.Recommendation",holdId));
newWorkDes = aa.cap.createCapWorkDes(newWorkDesModel);
updateWorkDesc(workDesc);
updateAppStatus("Open","",childId);
capId = holdId;
`^
CMN;CreateSignEnforcementCase^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
childId = null;
holdId = null;
var inspectorArray = null;
var sInspectorDept = null;
var sInspectorUserID = null;
var sParentWorkDescr = "";
var oInspections = null;
aryInspections = null;
var cd = null;
inspectorArray = getLastInspectorDeptUserID("Sign Inspection", "Incorrect Installation");
if (inspectorArray != null) {
	sInspectorDept = inspectorArray["inspectorDept"];
	sInspectorUserID = inspectorArray["inspectorUserID"];
	}

sParentWorkDescr = workDescGet(capId);
logDebug("Parent Work Descrip = " + sParentWorkDescr);
childId = createChild("Enforcement","Building Inspection","Zoning","Sign", capName);
if (childId != null) {
	holdId = capId;
	capId = childId;
	copyParcelGisObjects();
	}

cd = aa.cap.getCapDetail(capId).getOutput().getCapDetailModel();
if (cd != null && sInspectorDept != null && sInspectorUserID != null) {
	cd.setAsgnDept(sInspectorDept);
	cd.setAsgnStaff(sInspectorUserID);
	cdWrite = aa.cap.editCapDetail(cd);
	updateAppStatus("Official Notice", "Status updated by script");
	}

if (childId != null) {
	capId = holdId;
	}

if (childId != null) {
	copyOwner(capId, childId);
	updateWorkDesc(sParentWorkDescr, childId);
	}

oInspections = aa.inspection.getInspections(capId);
if (oInspections != null) {
	if(oInspections.getSuccess()) aryInspections = oInspections.getOutput();
	}

if (aryInspections != null) {
	for(insp in aryInspections) include("CMN;CopySignInspectionsLoop");
	}
`^
CMN;DaneCounty!Zoning!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (inspResult == "Pass") {
	closeTask("Inspection",inspResult,inspComment,"");
	}

if (inspResult == "Fail") {
	updateTask("Inspection",inspResult,inspComment,"");
	}
`^
CMN;DaneCounty!Zoning!Conditional Use!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['PETITION TYPE.Type of Conditional Use you are applying for'] == "Communication Tower") {
	if(feeExists("CUPCOMMTWR") == false) updateFee("CUPCOMMTWR","DCPCUP","FINAL",1,"N");
	} else {
	if(feeExists("CUPCOMMTWR") == true) removeFee("CUPCOMMTWR","FINAL");
	}

if (AInfo['PETITION TYPE.Type of Conditional Use you are applying for'] == "General") {
	if(feeExists("CUPAPPLCTN") == false) updateFee("CUPAPPLCTN","DCPCUP","FINAL",1,"N");
	} else {
	if(feeExists("CUPAPPLCTN") == true) removeFee("CUPAPPLCTN","FINAL");
	}

if (AInfo['PETITION TYPE.Type of Conditional Use you are applying for'] == "Mineral Extraction") {
	if(feeExists("CUPMINERALEX") == false) updateFee("CUPMINERALEX","DCPCUP","FINAL",1,"N");
	} else {
	if(feeExists("CUPMINERALEX") == true) removeFee("CUPMINERALEX","FINAL");
	}
`^
CMN;DaneCounty!Zoning!Request for Service!Water Determination;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['STUDIES REQUESTED.Navigability of a Stream'] == "CHECKED") {
	if(feeExists("STRNAV") == false) updateFee("STRNAV","DCPWATER","FINAL",1,"N");
	} else {
	if(feeExists("STRNAV") == true) removeFee("STRNAV","FINALl");
	}

if (AInfo['STUDIES REQUESTED.Wetlands Status of a Proposed Building Site'] == "CHECKED") {
	if(feeExists("WETSTAT") == false) updateFee("WETSTAT","DCPWATER","FINAL",1,"N");
	} else {
	if(feeExists("WETSTAT") == true) removeFee("WETSTAT","FINAL");
	}

if (AInfo['STUDIES REQUESTED.Floodplain Status of a Proposed Building Site'] == "CHECKED") {
	if(feeExists("FLOODSTAT") == false) updateFee("FLOODSTAT","DCPWATER","FINAL",1,"N");
	} else {
	if(feeExists("FLOODSTAT") == true) removeFee("FLOODSTAT","FINAL");
	}

if (AInfo['STUDIES REQUESTED.Ordinary High Water Mark'] == "CHECKED") {
	if(feeExists("OHWMSTAT") == false) updateFee("OHWMSTAT","DCPWATER","FINAL",1,"N");
	} else {
	if(feeExists("OHWMSTAT") == true) removeFee("OHWMSTAT","FINAL");
	}
`^
CMN;DaneCounty!Zoning!Rezone!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
fromDistrict = REZONE[x]["From District"];
toDistrict = REZONE[x]["To District"];
if (fromDistrict != "A-1Ex Exclusive Ag District" && toDistrict != "M-1 Industrial District" && toDistrict != "C-1 Commercial District" && toDistrict != "C-2 Commercial District") {
	if(feeExists("350REZ") == false) updateFee("350REZ","DCPREZONE","FINAL",1,"N");
	}

if (fromDistrict == "A-1Ex Exclusive Ag District" && toDistrict != "M-1 Industrial District" && toDistrict != "C-1 Commercial District" && toDistrict != "C-2 Commercial District") {
	if(feeExists("350REZ") == false) updateFee("350REZ","DCPREZONE","FINAL",1,"N");
	if(feeExists("DEN") == false) updateFee("DEN","DCPREZONE","FINAL",1,"N");
	}

if (fromDistrict != "A-1Ex Exclusive Ag District" && (toDistrict == "M-1 Industrial District" || toDistrict == "C-1 Commercial District" || toDistrict == "C-2 Commercial District")) {
	if(feeExists("500REZ") == false) updateFee("500REZ","DCPREZONE","FINAL",1,"N");
	}

if (fromDistrict == "A-1Ex Exclusive Ag District" && (toDistrict == "M-1 Industrial District" || toDistrict == "C-1 Commercial District" || toDistrict == "C-2 Commercial District")) {
	if(feeExists("500REZ") == false) updateFee("500REZ","DCPREZONE","FINAL",1,"N");
	if(feeExists("DEN") == false) updateFee("DEN","DCPREZONE","FINAL",1,"N");
	}
`^
CMN;DaneCounty!Zoning!Rezone!NA;MainFee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if(feeExists("DEN") == true) removeFee("DEN","FINAL");
if(feeExists("350REZ") == true) removeFee("350REZ","FINAL");
if(feeExists("350REZA1") == true) removeFee("350REZA1","FINAL");
if(feeExists("500REZ") == true) removeFee("500REZ","FINAL");
if(feeExists("500REZA1") == true) removeFee("500REZA1","FINAL");
if(feeExists("625REZ") == true) removeFee("625REZ","FINAL");
if (typeof(REZONE) == "object") {
	for(x in REZONE) include("CMN;DaneCounty!Zoning!Rezone!NA;Fee");
	}

if (AInfo['GENERAL INFORMATION.Includes Shoreland-wetland or Inland-wetland from A-1 Exclusive'] == "CHECKED") {
	if(feeExists("SHORE") == false) updateFee("SHORE","DCPREZONE","FINAL",1,"N");
	if(feeExists("SHORE") == true) removeFee("SHORE","FINAL");
	}
`^
CMN;DaneCounty!Zoning!Rezone!NA;MainTownFee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
removeFee("ALB","FINAL");
removeFee("BER","FINAL");
removeFee("BLK","FINAL");
removeFee("BLG","FINAL");
removeFee("BLM","FINAL");
removeFee("CHR","FINAL");
removeFee("COT","FINAL");
removeFee("CP","FINAL");
removeFee("DANE","FINAL");
removeFee("MAD","FINAL");
removeFee("MAZ","FINAL");
removeFee("MED","FINAL");
removeFee("MON","FINAL");
removeFee("OR","FINAL");
removeFee("DF","FINAL");
removeFee("DK","FINAL");
removeFee("DUNN","FINAL");
removeFee("YORK","FINAL");
removeFee("WIN","FINAL");
removeFee("PE","FINAL");
removeFee("PLS","FINAL");
removeFee("PRI","FINAL");
removeFee("ROX","FINAL");
removeFee("RUT","FINAL");
removeFee("SPR","FINAL");
removeFee("SUN","FINAL");
removeFee("VER","FINAL");
removeFee("VIE","FINAL");
removeFee("WES","FINAL");
if (typeof(PARCELINFO) == "object") {
	for(x in PARCELINFO) include("CMN;DaneCounty!Zoning!Rezone!NA;TownFee");
	}
`^
CMN;DaneCounty!Zoning!Rezone!NA;TownFee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
PARCELINFOTownship = PARCELINFO[x]["Township"];
PARCELINFOAcres = PARCELINFO[x]["Acres of Working Land Being Converted"];
logDebug("PARCELINFOTownship " + PARCELINFOTownship);
if (PARCELINFOTownship == "Albion") {
	updateFee("ALB","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Berry") {
	updateFee("BER","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Black Earth") {
	updateFee("BLK","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Blooming Grove") {
	updateFee("BLG","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Blue Mounds") {
	updateFee("BLM","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Christiana") {
	updateFee("CHR","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Cottage Grove") {
	updateFee("COT","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Cross Plains") {
	updateFee("CP","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Dane") {
	updateFee("DANE","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Deerfield") {
	updateFee("DF","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Dunkirk") {
	updateFee("DK","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Dunn") {
	updateFee("DUNN","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Madison") {
	updateFee("MAD","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Mazomanie") {
	updateFee("MAZ","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Medina") {
	updateFee("MED","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Montrose") {
	updateFee("MON","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Oregon") {
	updateFee("OR","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Perry") {
	updateFee("PE","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Pleasant Springs") {
	updateFee("PLS","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Primrose") {
	updateFee("PRI","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Roxbury") {
	updateFee("ROX","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Rutland") {
	updateFee("RUT","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Springfield") {
	updateFee("SPR","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Sun Prairie") {
	updateFee("SUN","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Vermont") {
	updateFee("VER","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Verona") {
	updateFee("VNA","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Vienna") {
	updateFee("VIE","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Westport") {
	updateFee("WES","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "Windsor") {
	updateFee("WIN","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}

if (PARCELINFOTownship == "York") {
	updateFee("YORK","DCPREZONE","FINAL",PARCELINFOAcres,"N");
	}
`^
CMN;DaneCounty!Zoning!Zoning Permit!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['SIGN APPLICATIONS.Apartment Complex'] != null) {
	if(feeExists("SIGNAPARTMNT") == false) updateFee("SIGNAPARTMNT","DCPZONING","FINAL",1,"N");
	} else {
	if(feeExists("SIGNAPARTMNT") == true) removeFee("SIGNAPARTMNT","FINAL");
	}

if (AInfo['SIGN APPLICATIONS.Development'] != null) {
	if(feeExists("SIGNDEVELPMT") == false) updateFee("SIGNDEVELPMT","DCPZONING","FINAL",1,"N");
	} else {
	if(feeExists("SIGNDEVELPMT") == true) removeFee("SIGNDEVELPMT","FINAL");
	}

if (AInfo['SIGN APPLICATIONS.Directory'] != null) {
	if(feeExists("SIGNDIRECTRY") == false) updateFee("SIGNDIRECTRY","DCPZONING","FINAL",1,"N");
	} else {
	if(feeExists("SIGNDIRECTRY") == true) removeFee("SIGNDIRECTRY","FINAL");
	}

if (AInfo['SIGN APPLICATIONS.Home Occupation'] != null) {
	if(feeExists("SIGNHOMEOCC") == false) updateFee("SIGNHOMEOCC","DCPZONING","FINAL",1,"N");
	} else {
	if(feeExists("SIGNHOMEOCC") == true) removeFee("SIGNHOMEOCC","FINAL");
	}

if (AInfo['SIGN APPLICATIONS.Limited Family Business'] != null) {
	if(feeExists("SIGNLTDFAMLY") == false) updateFee("SIGNLTDFAMLY","DCPZONING","FINAL",1,"N");
	} else {
	if(feeExists("SIGNLTDFAMLY") == true) removeFee("SIGNLTDFAMLY","FINAL");
	}

if (AInfo['SIGN APPLICATIONS.Number of Billboard Faces'] != null) {
	if(feeExists("SIGNBILLBRDS") == false) updateFee("SIGNBILLBRDS","DCPZONING","FINAL",1,"N");
	} else {
	if(feeExists("SIGNBILLBRDS") == true) removeFee("SIGNBILLBRDS","FINAL");
	}

if (AInfo['SIGN APPLICATIONS.On-Premise Advertising'] != null) {
	if(feeExists("SIGNONPREMIS") == false) updateFee("SIGNONPREMIS","DCPZONING","FINAL",1,"N");
	} else {
	if(feeExists("SIGNONPREMIS") == true) removeFee("SIGNONPREMIS","FINAL");
	}

if (AInfo['SIGN APPLICATIONS.Marquee'] != null) {
	if(feeExists("SIGNMARQUEE") == false) updateFee("SIGNMARQUEE","DCPZONING","FINAL",1,"N");
	} else {
	if(feeExists("SIGNMARQUEE") == true) removeFee("SIGNMARQUEE","FINAL");
	}

if (AInfo['SIGN APPLICATIONS.Subdivision'] != null) {
	if(feeExists("SIGNSUBDIVIS") == false) updateFee("SIGNSUBDIVIS","DCPZONING","FINAL",1,"N");
	} else {
	if(feeExists("SIGNSUBDIVIS") == true) removeFee("SIGNSUBDIVIS","FINAL");
	}

if (AInfo['OFFICE USE ONLY.Census Code'] == "101 - SFR (detached)" && AInfo['RESIDENTIAL OR AGRICULTURAL.Total Square Feet'] != null) {
	if(feeExists("NEWSINGLE") == false) updateFee("NEWSINGLE","DCPZONING","FINAL",1,"N");
	}

if (AInfo['OFFICE USE ONLY.Census Code'] == "102 - SFR (attached)" && AInfo['RESIDENTIAL OR AGRICULTURAL.Total Square Feet'] != null) {
	if(feeExists("NEWSINGLE") == false);
	updateFee("NEWSINGLE","DCPZONING","FINAL",1,"N");
	}

if (AInfo['OFFICE USE ONLY.Census Code'] == "103 - Duplex" && AInfo['RESIDENTIAL OR AGRICULTURAL.Total Square Feet'] != null) {
	if(feeExists("DUPLEXES") == false);
	updateFee("DUPLEXES","DCPZONING","FINAL",1,"N");
	}

if (AInfo['OFFICE USE ONLY.Census Code'] == "104 - MFR (3 – 4 Units)" && AInfo['COMMERCIAL APPLICATIONS.Estimated Construction Cost - Please round to nearest dollar'] != null) {
	if(feeExists("COMMERCIAL") == false);
	updateFee("COMMERCIAL","DCPZONING","FINAL",1,"N");
	}

if (AInfo['OFFICE USE ONLY.Census Code'] == "105 - Multi-family (5+ Units)" && AInfo['COMMERCIAL APPLICATIONS.Estimated Construction Cost - Please round to nearest dollar'] != null) {
	if(feeExists("COMMERCIAL") == false);
	updateFee("COMMERCIAL","DCPZONING","FINAL",1,"N");
	}

if (AInfo['OFFICE USE ONLY.Census Code'] == "213 - Hotels" && AInfo['COMMERCIAL APPLICATIONS.Estimated Construction Cost - Please round to nearest dollar'] != null) {
	if(feeExists("COMMERCIAL") == false);
	updateFee("COMMERCIAL","DCPZONING","FINAL",1,"N");
	}

if (AInfo['OFFICE USE ONLY.Census Code'] == "214 - Rooming House" && AInfo['COMMERCIAL APPLICATIONS.Estimated Construction Cost - Please round to nearest dollar'] != null) {
	if(feeExists("COMMERCIAL") == false);
	updateFee("COMMERCIAL","DCPZONING","FINAL",1,"N");
	}

if (AInfo['OFFICE USE ONLY.Census Code'] == "318 - Amusement Park" && AInfo['COMMERCIAL APPLICATIONS.Estimated Construction Cost - Please round to nearest dollar'] != null) {
	if(feeExists("COMMERCIAL") == false);
	updateFee("COMMERCIAL","DCPZONING","FINAL",1,"N");
	}

if (AInfo['OFFICE USE ONLY.Census Code'] == "319 - Religious Building" && AInfo['COMMERCIAL APPLICATIONS.Estimated Construction Cost - Please round to nearest dollar'] != null) {
	if(feeExists("COMMERCIAL") == false);
	updateFee("COMMERCIAL","DCPZONING","FINAL",1,"N");
	}

if (AInfo['OFFICE USE ONLY.Census Code'] == "320 - Industrial Building" && AInfo['COMMERCIAL APPLICATIONS.Estimated Construction Cost - Please round to nearest dollar'] != null) {
	if(feeExists("COMMERCIAL") == false);
	updateFee("COMMERCIAL","DCPZONING","FINAL",1,"N");
	}

if (AInfo['OFFICE USE ONLY.Census Code'] == "321 - Parking Garage" && AInfo['COMMERCIAL APPLICATIONS.Estimated Construction Cost - Please round to nearest dollar'] != null) {
	if(feeExists("COMMERCIAL") == false);
	updateFee("COMMERCIAL","DCPZONING","FINAL",1,"N");
	}

if (AInfo['OFFICE USE ONLY.Census Code'] == "322 - Repair Garage" && AInfo['COMMERCIAL APPLICATIONS.Estimated Construction Cost - Please round to nearest dollar'] != null) {
	if(feeExists("COMMERCIAL") == false);
	updateFee("COMMERCIAL","DCPZONING","FINAL",1,"N");
	}

if (AInfo['OFFICE USE ONLY.Census Code'] == "323 - Hospitals" && AInfo['COMMERCIAL APPLICATIONS.Estimated Construction Cost - Please round to nearest dollar'] != null) {
	if(feeExists("COMMERCIAL") == false);
	updateFee("COMMERCIAL","DCPZONING","FINAL",1,"N");
	}

if (AInfo['OFFICE USE ONLY.Census Code'] == "324 - Offices" && AInfo['COMMERCIAL APPLICATIONS.Estimated Construction Cost - Please round to nearest dollar'] != null) {
	if(feeExists("COMMERCIAL") == false);
	updateFee("COMMERCIAL","DCPZONING","FINAL",1,"N");
	}

if (AInfo['OFFICE USE ONLY.Census Code'] == "325 - Public Works" && AInfo['COMMERCIAL APPLICATIONS.Estimated Construction Cost - Please round to nearest dollar'] != null) {
	if(feeExists("COMMERCIAL") == false);
	updateFee("COMMERCIAL","DCPZONING","FINAL",1,"N");
	}

if (AInfo['OFFICE USE ONLY.Census Code'] == "326 - Schools" && AInfo['COMMERCIAL APPLICATIONS.Estimated Construction Cost - Please round to nearest dollar'] != null) {
	if(feeExists("COMMERCIAL") == false);
	updateFee("COMMERCIAL","DCPZONING","FINAL",1,"N");
	}

if (AInfo['OFFICE USE ONLY.Census Code'] == "327 - Stores" && AInfo['COMMERCIAL APPLICATIONS.Estimated Construction Cost - Please round to nearest dollar'] != null) {
	if(feeExists("COMMERCIAL") == false);
	updateFee("COMMERCIAL","DCPZONING","FINAL",1,"N");
	}

if (AInfo['OFFICE USE ONLY.Census Code'] == "327 - Stores" && AInfo['COMMERCIAL APPLICATIONS.Estimated Construction Cost - Please round to nearest dollar'] != null) {
	if(feeExists("COMMERCIAL") == false);
	updateFee("COMMERCIAL","DCPZONING","FINAL",1,"N");
	}

if (AInfo['OFFICE USE ONLY.Census Code'] == "329 - Other" && AInfo['RESIDENTIAL OR AGRICULTURAL.Total Square Feet'] != null) {
	if(feeExists("AGRICULTURE") == false);
	updateFee("AGRICULTURE","DCPZONING","FINAL",1,"N");
	}

if (AInfo['OFFICE USE ONLY.Census Code'] == "434 - Residential Addition" && AInfo['RESIDENTIAL OR AGRICULTURAL.Total Square Feet'] != null) {
	if(feeExists("RESADDITION") == false);
	updateFee("RESADDITION","DCPZONING","FINAL",1,"N");
	}

if (AInfo['OFFICE USE ONLY.Census Code'] == "437 - Non-Res Addition" && AInfo['COMMERCIAL APPLICATIONS.Estimated Construction Cost - Please round to nearest dollar'] != null) {
	if(feeExists("COMMERCIAL") == false);
	updateFee("COMMERCIAL","DCPZONING","FINAL",1,"N");
	}

if (AInfo['OFFICE USE ONLY.Census Code'] == "438 - Garage" && AInfo['RESIDENTIAL OR AGRICULTURAL.Total Square Feet'] != null) {
	if(feeExists("AGRICULTURE") == false);
	updateFee("AGRICULTURE","DCPZONING","FINAL",1,"N");
	}
`^
CMN;DEPTHOLD^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var paArray = new Array();
loadParcelAttributes(paArray, capId);
if (paArray["ParcelAttribute.DEPT_HOLD"] != null && paArray["ParcelAttribute.CouncilDistrict"] != "") {
	var dept_hold = paArray["ParcelAttribute.DEPT_HOLD"];
	showMessage = true;
	comment("The parcel the application is being submitted for has a department hold " + dept_hold);
	if(appHasCondition("DEPARTMENT HOLD","APPLIED","Dept Hold " + dept_hold,null) == false) addAppCondition("DEPARTMENT HOLD","APPLIED","Dept Hold " + dept_hold,"This property has a department hold "+ dept_hold + ", please contact the appropriate agency and ask about its requirements","Notice");
	}
`^
CMN;EmailAssignedAndAssignCap^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
processEmails = false;
assignedStaffUserID = null;
assignedUser = "";
assignedUserEmail = "";
assignedUserPhone = "";
task = wfObj[i].getTaskItem();
assignedStaffUserID = getInspectorUserID(wfObj[i].assignedStaff);
logDebug("Assigned Staff UserID = " + assignedStaffUserID);
if (sDept == "Other" && task.taskDescription == "Other Property Review") {
	processEmails = true;
	}

if (sDept == "Parks" && task.taskDescription == "Parks Review") {
	processEmails = true;
	}

if (sDept == "Engineering" && task.taskDescription == "City Engineering Review") {
	processEmails = true;
	}

if (sDept == "Water" && task.taskDescription == "Water Utility Review") {
	processEmails = true;
	}

if (sDept == "CDA" && task.taskDescription == "CDA Review") {
	processEmails = true;
	}

if (processEmails && assignedStaffUserID != null) {
	taskUserObj = aa.person.getUser(assignedStaffUserID).getOutput();
	debugObject(taskUserObj);
	}

if (processEmails && assignedStaffUserID != null) {
	assignedUser = taskUserObj.resFirstName + " " + taskUserObj.resLastName;
	assignedUserPhone = taskUserObj.getPhoneNumber();
	assignedUserEmail = taskUserObj.getEmail();
	}

if (processEmails) {
	emailText = "Edible Landscape Permit Application has been submitted and requires your review!approval.";
	}

emailSubject = "Edible Landscape Permit Application Submitted; ";
include("EML;AddressLine");
if (processEmails) {
	emailText += "<br><br><b>Application;<!b> <a href=" + "" + "https;!!av.cityofmadison.com!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=Permitting&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capId.getCustomID() + "<!a><br><br>";
	}

if (processEmails) {
	email("jschneider@cityofmadison.com", "noreplyDEV@cityofmadison.com", emailSubject, emailText);
	!!For IT testing only.;
	}

if (processEmails) {
	include("EML;Permitting!Miscellaneous!Edible Landscape!NA");
	}
`^
CMN;EMAILLASIT^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
TRAFFICREQUEST=TRAFFIC[x]["Request"];
TRAFFICDESCRIPT=TRAFFIC[x]["Description"];
TRAFFICASSIGNED=TRAFFIC[x]["Assigned to Staff"];
TRAFFICRESOLUTION=TRAFFIC[x]["Resolution"];
TRAFFICDATE=TRAFFIC[x]["Date"];
emailSubject = "Request for a " + TRAFFICREQUEST + " - " + capIDString;
emailText = currentUserID + " has requested a " + TRAFFICREQUEST + "<br>";
emailText += "<b>CAP<!b> <a href=" + "" + "https;!!av73dev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=Permitting&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a><br><br>";
emailText += TRAFFICDESCRIPT + " " + TRAFFICREQUEST;
varFoo = TRAFFIC[x]["Email Sent"];
comment("before sent is " + varFoo);
showComment = true;
if (varFoo != "Yes") {
	email("jleach@cityofmadisonDEV.com,bwalker@cityofmadisonDEV.com,poleary@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
	varLocTable[x]["Email Sent"] = "Yes";
	varFoo = varLocTable[x]["Email Sent"];
	comment("after sent2 is " + varFoo);
	showComment = true;
	}
`^
CMN;Enforcement!Building Inspection!~!~;Building Inspection Workflow Update^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var parentCapId = null;
var holdId = null;
var isSignCase = false;
var isLndmrkCase = false;
if (inspType == "Initial Inspection" && inspResult == "No Violation") {
	updateAppStatus("No Violation","Updated via Script");
	branchTask("Initial Inspection","No Violation","Updated by Inspection Result","Note");
	}

if (inspType == "Initial Inspection" && (inspResult == "Official Notice" || inspResult == "No Occupancy")) {
	updateAppStatus(inspResult ,"Updated via Script");
	updateTask("Initial Inspection",inspResult,"Updated by Inspection Result","Note");
	}

if (inspType == "Initial Inspection" && inspResult == "No Entry") {
	updateAppStatus("No Entry","Updated via Script");
	updateTask("Initial Inspection","No Access","Updated by Inspection Result","Note");
	scheduleInspectDate("Initial Inspection",nextWorkDay(null),getLastInspectorMadAlt("Initial Inspection"),"AM","Continuation of Initial Inspection due to no access");
	}

if (inspType == "Initial Inspection" && inspResult == "Inspection") {
	updateAppStatus("Inspection","Updated via Script");
	updateTask("Initial Inspection","Inspection","Updated by Inspection Result","Note");
	scheduleInspectDate("Initial Inspection",nextWorkDay(null),getLastInspectorMadAlt("Initial Inspection"),"AM","Continuation of Initial Inspection due to incomplete inspection");
	}

if (inspType == "Initial Inspection" && inspResult == "Citation") {
	updateAppStatus("Citation","Updated via Script");
	updateTask("Initial Inspection","Citation","Updated by Inspection Result","Note");
	}

if (inspType == "Reinspection" && inspResult == "Compliance") {
	updateAppStatus("Compliance","Updated via Script");
	branchTask("Reinspection","Compliance","Updated by Inspection Result","Note");
	}

if (inspType == "Reinspection" && (inspResult == "Reinspection" || inspResult == "No Fee Reinspection")) {
	updateAppStatus("Reinspection","Updated via Script");
	updateTask("Reinspection","Reinspection","Updated by Inspection Result","Note");
	scheduleInspectDate("Reinspection",nextWorkDay(null),getLastInspectorMadAlt("Reinspection"),"AM","Continuation of Reinspection due to incomplete inspection");
	}

if (inspType == "Reinspection" && (inspResult == "Citation" || inspResult == "No Fee Citation")) {
	updateAppStatus("Citation","Updated via Script");
	updateTask("Reinspection","Citation","Updated by Inspection Result","Note");
	}

if (inspType == "Reinspection" && (inspResult == "No Access" || inspResult == "No Fee No Access")) {
	updateAppStatus("No Access","Updated via Script");
	updateTask("Reinspection","No Access","Updated by Inspection Result","Note");
	scheduleInspectDate("Reinspection",nextWorkDay(null),getLastInspectorMadAlt("Initial Inspection"),"AM","Continuation of Reinspection due to No Access");
	}

if (inspType == "Reinspection" && (inspResult == "Extension Processing" || inspResult == "No Fee Extension Processing" || inspResult == "No Occupancy" || inspResult == "No Fee No Occupancy" || inspResult == "On Going Enforcement" || inspResult == "No Fee On Going Enforcement")) {
	updateAppStatus(inspResult, "Updated via Script");
	updateTask("Reinspection", inspResult, "Updated by Inspection Result","Note");
	}

if (inspType == "Reinspection" && (inspResult == "CA Referral" || inspResult == "No Fee City Attorney Referral")) {
	loopTask("Reinspection","CA Referral","CA Processing Review","Note");
	updateAppStatus("CA Referral","Updated via Script");
	}

if (inspType == "Reinspection" && inspResult.substring(0,6) != "No Fee" && inspResult != "No Access" && inspResult != "Compliance") {
	addFee("CEBLDREINSP","CEBLD","FINAL",1,"N");
	aa.set.add("ENFREINSPFEE",capId);
	}

if (inspType == "Reinspection" && inspResult == "No Access") {
	addFee("CEBLDNOENTRY","CEBLD","FINAL",1,"N");
	aa.set.add("ENFREINSPFEE",capId);
	}

if (inspType == "CA Reinspection" && inspResult == "No Access") {
	scheduleInspectDate("CA Reinspection",nextWorkDay(null),getLastInspectorMadAlt("Initial Inspection"),"AM","Continuation of CA Reinspection due to No Access");
	}

if ((appMatch("Enforcement!Building Inspection!Zoning!Sign") == true || appMatch("Enforcement!Building Inspection!Housing!General Maintenance Exterior") == true) && inspGroup == "CODEBLD" && (inspType == "Initial Inspection" || inspType == "Reinspection" || inspType == "CA Reinspection" || inspType == "High ! Low Reinspection") && (inspResult == "No Violation" || inspResult == "Compliance")) {
	parentCapId = getParent();
	}

if (parentCapId) {
	holdId = capId;
	capId = parentCapId;
	}

if (parentCapId) {
	if(capId.customID.slice(0,6) == "ZONGSN" || capId.customID.slice(0,6) == "ZONNGS") isSignCase = true;
	}

if (parentCapId) {
	if(capId.customID.slice(0,6) == "LNDMRK") isLndmrkCase = true;
	}

if (isSignCase && isTaskActive("Inspection", "ZONINGSIGN")) {
	updateAppStatus("Correctly Installed","Updated by Enforcement inspection script");
	closeTask("Inspection","Completed","Sign Inspection - Correctly Installed","Updated by Enforcement inspection script","ZONINGSIGN");
	}

if (isLndmrkCase  && isTaskActive("Inspection", "LNDMRK")) {
	updateAppStatus("Correctly Installed","Updated by Enforcement inspection script");
	closeTask("Inspection","Work Completed","Landmark Inspection - Correctly Installed","Updated by Enforcement inspection script","LNDMRK");
	}

if (parentCapId && holdId) {
	capId = holdId;
	}
`^
CMN;Enforcement!Building Inspection!~!~;Department Assignments^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask.equals("Supervisory Review") && wfStatus.equals("Assign to Housing")) {
	childId = createChild("Enforcement","Building Inspection","Housing",appTypeArray[3],capName);
	copyAppSpecific(childId);
	updateAppStatus("Pending - Housing","Updated via script",childId);
	holdId = capId;
	capId = childId;
	copyParcelGisObjects();
	capId = holdId;
	}

if (wfTask.equals("Supervisory Review") && wfStatus.equals("Assign to Property")) {
	childId = createChild("Enforcement","Building Inspection","Property Maintenance",appTypeArray[3],capName);
	copyAppSpecific(childId);
	updateAppStatus("Pending - Property","Updated via script",childId);
	holdId = capId;
	capId = childId;
	copyParcelGisObjects();
	capId = holdId;
	}

if (wfTask.equals("Supervisory Review") && wfStatus.equals("Assign to Zoning")) {
	childId = createChild("Enforcement","Building Inspection","Zoning",appTypeArray[3],capName);
	copyAppSpecific(childId);
	updateAppStatus("Pending - Zoning","Updated via script",childId);
	holdId = capId;
	capId = childId;
	copyParcelGisObjects();
	capId = holdId;
	}

if (wfTask.equals("Supervisory Review") && wfStatus.equals("Assign to Construction")) {
	childId = createChild("Enforcement","Building Inspection","Construction",appTypeArray[3],capName);
	copyAppSpecific(childId);
	updateAppStatus("Pending - Construction","Updated via script",childId);
	holdId = capId;
	capId = childId;
	copyParcelGisObjects();
	capId = holdId;
	}

if (wfTask.equals("Supervisory Review") && wfStatus.equals("Assign to Weights")) {
	childId = createChild("Enforcement","Building Inspection","Weights and Measures",appTypeArray[3],capName);
	copyAppSpecific(childId);
	updateAppStatus("Pending - Weights","Updated via script",childId);
	holdId = capId;
	capId = childId;
	copyParcelGisObjects();
	capId = holdId;
	}
`^
CMN;Enforcement!Building Inspection;Initial Inspection;Citation^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
citationNo = Number(lookup("CitationSeq","BILastNbr"));
citationSeries = lookup("CitationSeq","BISeries");
citationNo = citationNo + 1;
editLookup("CitationSeq","BILastNbr",citationNo.toString());
editTaskSpecific("Initial Inspection","Citation Number",citationSeries + Right(("00000" + citationNo.toString()),5) );
`^
CMN;Enforcement!Building Inspection;Reinspection;Citation^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
citationNo = Number(lookup("CitationSeq","BILastNbr"));
citationSeries = lookup("CitationSeq","BISeries");
citationNo = citationNo + 1;
editLookup("CitationSeq","BILastNbr",citationNo.toString());
editTaskSpecific("Reinspection","Citation Number",citationSeries + Right(("00000" + citationNo.toString()),5) );
`^
CMN;Enforcement!Engineering!~!~;Engineering Workflow Update^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (inspType == "Initial Inspection" && inspResult == "In Progress") {
	updateTask("Initial Inspection","In Progress","Updated by Inspection Result","Note");
	}

if (inspType == "Initial Inspection" && inspResult == "No Violation") {
	branchTask("Initial Inspection","No Violation","Updated by Inspection Result","Note");
	}

if (inspType == "Initial Inspection" && inspResult == "Official Notice") {
	closeTask("Initial Inspection","Official Notice","Updated by Inspection Result","Note");
	}

if (inspType == "Reinspection" && inspResult == "Compliance") {
	branchTask("Reinspection","Compliance","Updated by Inspection Result","Note");
	}

if (inspType == "Reinspection" && inspResult == "In Progress") {
	updateTask("Reinspection","In Progress","Updated by Inspection Result","Note");
	}

if (inspType == "Reinspection" && inspResult == "No Change") {
	updateTask("Reinspection","No Change","Updated by Inspection Result","Note");
	}

if (inspType == "Reinspection" && inspResult == "Non-Compliance") {
	updateTask("Reinspection","Non-Complaince","Updated by Inspection Result","Note");
	}

if (inspType == "Reinspection" && inspResult == "Work Completed WO Permit") {
	updateTask("Reinspection","Work Completed WO Permit","Updated by Inspection Result","Note");
	}

if (inspType == "Reinspection" && inspResult == "Work Continued After SW") {
	updateTask("Reinspection","Work Continued After SW","Updated by Inspection Result","Note");
	}

if (inspType == "Reinspection" && inspResult == "Work Order Required") {
	updateTask("Reinspection","Work Order Required","Updated by Inspection Result","Note");
	}
`^
CMN;ENG HOLDS^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if ((wfTask == "Permit Issuance" || wfTask == "Issuance" || wfTask == "Certificate of Occupancy") && wfStatus == "Issued" && parcelConditionStatusExists("ENGINEERING HOLDS","APPLIED")) {
	message="Permit cannot be issued due to Engineering Holds currently on the Parcel";
	showMessage = true;
	cancel = true;
	}

if ((wfTask == "Permit Issuance" || wfTask == "Issuance" || wfTask == "Certificate of Occupancy") && wfStatus == "Issued" && appHasCondition("ENGINEERING HOLDS","APPLIED",null,null)) {
	message="Permit cannot be issued due to Engineering Holds currently on the Application";
	showMessage = true;
	cancel = true;
	}

if ((wfTask == "Permit Issuance" || wfTask == "Issuance" || wfTask == "Certificate of Occupancy") && wfStatus == "Issued" && addressConditionStatusExists("ENGINEERING HOLDS","APPLIED",null,null)) {
	message="Permit cannot be issued due to Engineering Holds currently on the Address";
	showMessage = true;
	cancel = true;
	}
`^
cmn;FindContractor^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
newContact = Contacts[yy].getCapContactModel();
if (newContact.getContactType() == "Contractor" && newContact.getPrimaryFlag() != "Y") {
	refContactNbr = newContact.getPeople().getContactSeqNumber();
	}
`^
cmn;FindNewLicenseHolder^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
newContact = Contacts[yy].getCapContactModel();
if (newContact.getContactType() == "License Holder" && newContact.getPrimaryFlag() != "Y") {
	refContactNbr = newContact.getPeople().getContactSeqNumber();
	}
`^
CMN;FireAlarmSprinklerEmailFooter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
ReportHeaderFile = "Fire Permitting Report Header Info";
if (lookup(ReportHeaderFile, "AgencyName") != undefined) {
	emailText += lookup(ReportHeaderFile, "AgencyName") + "<br>";
	}

if (lookup(ReportHeaderFile, "AgencyAddress") != undefined) {
	emailText += lookup(ReportHeaderFile, "AgencyAddress") + "<br>";
	}

if (lookup(ReportHeaderFile, "AgencyCityStateZip") != undefined) {
	emailText += lookup(ReportHeaderFile, "AgencyCityStateZip");
	}
`^
CMN;FirePermitEmailFooter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
ReportHeaderFile = "Fire Permitting Report Header Info";
if (lookup(ReportHeaderFile, "AgencyName") != undefined) {
	emailText += lookup(ReportHeaderFile, "AgencyName") + "<br>";
	}

if (lookup(ReportHeaderFile, "AgencyAddress") != undefined) {
	emailText += lookup(ReportHeaderFile, "AgencyAddress") + "<br>";
	}

if (lookup(ReportHeaderFile, "AgencyCityStateZip") != undefined) {
	emailText += lookup(ReportHeaderFile, "AgencyCityStateZip");
	}
`^
CMN;GENERIC;ExpDec31^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var appExpDate = aa.expiration.getLicensesByCapID(capId).getOutput();
rsYear = new Date().getFullYear();
rsExpDate = new Date(appExpDate.getExpDate().getMonth() + "!" + appExpDate.getExpDate().getDayOfMonth() + "!" + rsYear);
rsCutOffDate = rsExpDate;
rsCutOffDate = new Date((appExpDate.getExpDate().getMonth() -2) + "!" + appExpDate.getExpDate().getDayOfMonth() + "!" + rsYear);
if ((startDate < rsCutOffDate)) {
	newExpDate = dateAddMonths(rsExpDate,0,"Y");
	} else {
	newExpDate = dateAddMonths(rsExpDate,12,"Y");
	}

licEditExpInfo(rsEXPStatus, newExpDate);
`^
CMN;GET_FIELDS^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (tblColi.hasNext() == false) {
	tblColi = tableGroup.getColumns().iterator();
	rowCount = rowCount + 1;
	totRow = 0;
	}

racial = false;
field = tblFieldi.next();
col = tblColi.next();
if (col.getColumnName() == "Job Category") {
	jobCat = field.getInputValue();
	}

if (col.getColumnName() == "Gender") {
	gender = field.getInputValue();
	}

if (col.getColumnName() == "Disabled") {
	disabled = field.getInputValue();
	}

if (field != "" && col.getColumnName() == "White (not of Hispanic origin)") {
	totW += Number(field.getInputValue());
	totRow+= Number(field.getInputValue());
	}

if (field != "" && col.getColumnName() == "Black (not of Hispanic origin)") {
	totB += Number(field.getInputValue());
	totRow += Number(field.getInputValue());
	racial = true;
	}

if (field != "" && col.getColumnName() == "Hispanic") {
	totH += Number(field.getInputValue());
	totRow += Number(field.getInputValue());
	racial = true;
	}

if (field != "" && col.getColumnName() == "Asian or Pacific Islander") {
	totA += Number(field.getInputValue());
	totRow += Number(field.getInputValue());
	racial = true;
	}

if (field != "" && col.getColumnName() == "American Indian or Alaskan Native") {
	totN += Number(field.getInputValue());
	totRow += Number(field.getInputValue());
	racial = true;
	}

if (field != "" && col.getColumnName() == "Two or More Races") {
	tot2 += Number(field.getInputValue());
	totRow += Number(field.getInputValue());
	racial = true;
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Officials and Managers") {
	if(gender == "Female") totOffW += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Officials and Managers") {
	if(disabled == "Yes") totOffD += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Officials and Managers") {
	if(racial) totOffR += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Professionals") {
	if(gender == "Female") totProW += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Professionals") {
	if(disabled == "Yes") totProD += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Professionals") {
	if(racial) totProR += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Technicians") {
	if(gender == "Female") totTechW += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Technicians") {
	if(disabled == "Yes") totTechD += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Technicians") {
	if(racial) totTechR += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Sales") {
	if(gender == "Female") totSalesW += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Sales") {
	if(disabled == "Yes") totSalesD += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Sales") {
	if(racial) totSalesR += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Clerical & Admin. Support") {
	if(gender == "Female") totClerkW += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Clerical & Admin. Support") {
	if(disabled == "Yes") totClerkD += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Clerical & Admin. Support") {
	if(racial) totClerkR += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Craft Workers") {
	if(gender == "Female") totCraftW += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Craft Workers") {
	if(disabled == "Yes") totCraftD += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Craft Workers") {
	if(racial) totCraftR += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Operatives") {
	if(gender == "Female") totOperW += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Operatives") {
	if(disabled == "Yes") totOperD += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Operatives") {
	if(racial) totOperR += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Laborers, Helpers & Material Handlers") {
	if(gender == "Female") totLabW += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Laborers, Helpers & Material Handlers") {
	if(disabled == "Yes") totLabD += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Laborers, Helpers & Material Handlers") {
	if(racial) totLabR += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Service Workers") {
	if(gender == "Female") totSerW += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Service Workers") {
	if(disabled == "Yes") totSerD += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Service Workers") {
	if(racial) totSerR += Number(field.getInputValue());
	}

if (jobCat == "Officials and Managers" && col.getColumnName() == "Total") {
	totOff += Number(field.getInputValue());
	}

if (jobCat == "Professionals" && col.getColumnName() == "Total") {
	totPro += Number(field.getInputValue());
	}

if (jobCat == "Technicians" && col.getColumnName() == "Total") {
	totTech += Number(field.getInputValue());
	}

if (jobCat == "Sales" && col.getColumnName() == "Total") {
	totSales += Number(field.getInputValue());
	}

if (jobCat == "Craft Workers" && col.getColumnName() == "Total") {
	totCraft += Number(field.getInputValue());
	}

if (jobCat == "Operatives" && col.getColumnName() == "Total") {
	totOper += Number(field.getInputValue());
	}

if (jobCat == "Laborers, Helpers & Material Handlers" && col.getColumnName() == "Total") {
	totLab += Number(field.getInputValue());
	}

if (jobCat == "Service Workers" && col.getColumnName() == "Total") {
	totSer += Number(field.getInputValue());
	}

if (jobCat == "Clerical & Admin. Support" && col.getColumnName() == "Total") {
	totClerk += Number(field.getInputValue());
	}

if (gender == "Female") {
	if(col.getColumnName() == "Total") totF += Number(field.getInputValue());
	} else {
	if(col.getColumnName() == "Total") totM += Number(field.getInputValue());
	}

if (disabled == "Yes" && col.getColumnName() == "Total") {
	totDis += Number(field.getInputValue());
	}

if (col.getColumnName() == "Total") {
	totEmp += Number(field.getInputValue());
	}
`^
CMN;GET_WF_FIELDS^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (tblColi.hasNext() == false) {
	tblColi = tableGroup.getColumns().iterator();
	rowCount = rowCount + 1;
	totRow = 0;
	}

field = tblFieldi.next();
col = tblColi.next();
if (col.getColumnName() == "Job Category" && String(field.getInputValue()).indexOf("; TOTAL EMPLOYEES") > 0) {
	totalRow = true;
	jobCat = field.getInputValue().substring(0,String(field.getInputValue()).indexOf("; TOTAL EMPLOYEES"));
	} else {
	if(col.getColumnName() == "Job Category") totalRow = false;
	}

if (col.getColumnName() == "Job Category") {
	curJobCat = field.getInputValue();
	}

if (curJobCat =="TOTAL EMPLOYEES" || curJobCat =="TOTAL RACIAL!ETHNIC AA GROUP EMPLOYEES" || curJobCat =="TOTAL WOMEN EMPLOYEES" || curJobCat =="TOTAL EMPLOYEES WITH A DISABILITY") {
	overallTotals = true;
	}

if (totalRow && col.getColumnName() == "No. of Employees 1 year ago") {
	tot1YearAgo = field.getInputValue();
	}

if (totalRow && col.getColumnName() == "No. of Employees Hired During Past Year") {
	totHiredPastYear = field.getInputValue();
	}

if (totalRow && col.getColumnName() == "No. of Employees Who Left During Past Year") {
	totLeftPastYear = field.getInputValue();
	}

if (totalRow && col.getColumnName() == "Est. No. of Employees to be Hired w!in Next Year") {
	totHiredNextYear = field.getInputValue();
	}

if (totalRow && col.getColumnName() == "Est. No. of Employees to Leave w!in Next Year") {
	totLeftNextYear = field.getInputValue();
	}

if (totalRow && col.getColumnName() == "Target Workforce") {
	totTarget = field.getInputValue();
	}

if (!totalRow && !overallTotals &&  col.getColumnName() == "No. of Employees 1 year ago" && (field.getInputValue() > tot1YearAgo)) {
	returnMessage += "<B>" + curJobCat  + " <!B>" +col.getColumnName() + " total cannot be greater than Category Total<br>";
	}

if (!totalRow && !overallTotals && col.getColumnName() == "No. of Employees Hired During Past Year" && (field.getInputValue() > totHiredPastYear)) {
	returnMessage += "<B>" + curJobCat  + " <!B>" +col.getColumnName() +" group total cannot be greater than Category Total<br>";
	}

if (!totalRow && !overallTotals && col.getColumnName() == "No. of Employees Who Left During Past Year" && (field.getInputValue() > totLeftPastYear)) {
	returnMessage += "<B>" + curJobCat  + " <!B>" +col.getColumnName() +" group total cannot be greater than Category Total<br>";
	}

if (!totalRow && !overallTotals &&  col.getColumnName() == "Est. No. of Employees to be Hired w!in Next Year" && (field.getInputValue() > totHiredNextYear)) {
	returnMessage += "<B>" + curJobCat  + " <!B>" +col.getColumnName() +" group total cannot be greater than Category Total<br>";
	}

if (!totalRow && !overallTotals &&  col.getColumnName() == "Est. No. of Employees to Leave w!in Next Year" && (field.getInputValue() > totLeftNextYear)) {
	returnMessage += "<B>" + curJobCat  + " <!B>" +col.getColumnName() +" group total cannot be greater than Category Total<br>";
	}

if (!totalRow && !overallTotals &&  col.getColumnName() == "Target Workforce" && (field.getInputValue() > totTarget)) {
	returnMessage += "<B>" + curJobCat  + "<!B> " +col.getColumnName() +" group total cannot be greater than Category Total<br>";
	}

if (!overallTotals && col.getColumnName() == "No. of Employees 1 year ago") {
	num1YearAgo = field.getInputValue();
	}

if (!overallTotals && col.getColumnName() == "No. of Employees Hired During Past Year") {
	numHiredPastYear = field.getInputValue();
	}

if (!overallTotals && col.getColumnName() == "No. of Employees Who Left During Past Year") {
	numLeftPastYear = field.getInputValue();
	}

if (!overallTotals && col.getColumnName() == "Current No. of Employees") {
	currentNum = field.getInputValue();
	}

if (!overallTotals && col.getColumnName() == "Est. No. of Employees to be Hired w!in Next Year") {
	numHiredNextYear = field.getInputValue();
	}

if (!overallTotals && col.getColumnName() == "Est. No. of Employees to Leave w!in Next Year") {
	numLeftNextYear = field.getInputValue();
	}

if (!overallTotals && col.getColumnName() == "Target Workforce") {
	targetNextYear = field.getInputValue();
	}

if (!overallTotals && col.getColumnName() == "Target Workforce" && parseInt(num1YearAgo) + parseInt(numHiredPastYear) - parseInt(numLeftPastYear) != parseInt(currentNum)) {
	returnMessage += "<B>" + curJobCat + "<!B> - Current Employees should equal No. of Employees 1 year ago + No. of Employees Hired During Past Year - No. Of Employees Who Left During Past Year <BR>";
	}

if (!overallTotals && col.getColumnName() == "Target Workforce" && parseInt(currentNum) + parseInt(numHiredNextYear) - parseInt(numLeftNextYear) != parseInt(targetNextYear)) {
	returnMessage +=  "<B>" + curJobCat + "<!B> - Target workforce should equal Current No. of Employees + Est. No. of Employees to be Hired w!in Next Year - Est. No. Of Employees to Leave w!in Next Year <BR>";
	}
`^
CMN;GetAADocumentLink^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
currFileKey = 0;
localURL = "";
soapResp = null;
stringResp = "";
startString = 0;
var d = getDocumentModel(documentCategory);
if (d != false) {
	currFileKey = d.fileKey;
	}

if (d != false) {
	soapResp = aa.util.httpPost("http;!!klaccelatest!sites!Accela1!_vti_bin!listdata.svc!AccelaDev(" + currFileKey + ")", "");
	}

if (d != false && soapResp != null) {
	stringResp = soapResp.getOutput();
	}

if (stringResp != "" && stringResp != null) {
	startString = stringResp.search("<d;CopySource>");
	endString = stringResp.search("<!d;CopySource>");
	}

if (startString > 0) {
	localURL = stringResp.substring(startString + 14, endString);
	}

showDebug = true;
showMessage = true;
logDebug("DEBUG stringResp ; >" + stringResp +"<" );
debugObject(soapResp);
`^
CMN;GetAEDAssetDetails^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emailText += AssetList[x].getAssetMasterModel().g1AssetID + " " + AssetList[x].getAssetMasterModel().g1AssetComments + "<BR>";
var battExp = "01!01!1900";
var padExp = "01!01!1900";
assetSeq = AssetList[x].getAssetMasterModel().getG1AssetSequenceNumber();
selectString = "DECLARE @AssetSeq varchar(250);
SET @AssetSeq = '" + assetSeq + "';
SELECT G1_Attribute_value FROM GASSET_attribute where serv_prov_code = 'MADISON' and g1_attribute_name = 'AED Battery Expiration' and G1_asset_seq_nbr = @AssetSeq";
var initialContext = aa.proxyInvoker.newInstance("javax.naming.InitialContext").getOutput();
var ds = initialContext.lookup("java;!AA");
var conn = ds.getConnection();
var sStmt = conn.prepareStatement(selectString);
var rSet = sStmt.executeQuery();
if (rSet && rSet.next()) {
	batteryExp = rSet.getString("G1_Attribute_value");
	}

selectString = "DECLARE @AssetSeq varchar(250);
SET @AssetSeq = '" + assetSeq + "';
SELECT G1_Attribute_value FROM GASSET_attribute where serv_prov_code = 'MADISON' and g1_attribute_name = 'Pads Replacement Due Date' and G1_asset_seq_nbr = @AssetSeq";
sStmt = conn.prepareStatement(selectString);
var rSet = sStmt.executeQuery();
if (rSet && rSet.next()) {
	padExp = rSet.getString("G1_Attribute_value");
	rSet.close();
	conn.close();
	} else {
	conn.close();
	}

var dtToday = new Date();
var battExpDt = new Date(batteryExp);
padExpDt = new Date(padExp);
if (dtToday > battExpDt) {
	emailText += "<b><font color='red'>EXPIRED Battery needs replacement!<!font><!b> ";
	workDesc += " EXPIRED Battery! ";
	}

if (dtToday > padExpDt) {
	emailText += "<b><font color='red'>EXPIRED Pads need replacement!<!font><!b> ";
	workDesc += " EXPIRED Pads! ";
	}

emailText += "Battery Expiration; " + batteryExp + " Pads Replacement Due Date;"+padExp+"<BR><BR>";
if (dtToday > battExpDt || dtToday > padExpDt) {
	workDesc += "- " + AssetList[x].getAssetMasterModel().g1AssetID + " " + AssetList[x].getAssetMasterModel().g1AssetComments;
	}
`^
CMN;getAlderDist^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var paArray = new Array();
alderDist = "";
contactEmail = "";
loadParcelAttributes(paArray, capId);
logDebug(paArray["ParcelAttribute.CouncilDistrict"]);
if (paArray["ParcelAttribute.CouncilDistrict"] != null && paArray["ParcelAttribute.CouncilDistrict"] != "") {
	alderDist = paArray["ParcelAttribute.CouncilDistrict"];
	}

if (alderDist != null && alderDist != "" && alderDist != undefined) {
	contactEmail = "kgrittner" + alderDist + "@cityofmadisonDEV.com";
	}

logDebug(contactEmail + " = contact email");
`^
CMN;GetAPOAddress^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
APOAddress = "";
ad = aa.address.getAddressByCapId(capId).getOutput();
if (ad.length && ad[0].getHouseNumberStart() != null) {
	APOAddress = ad[0].getHouseNumberStart();
	}

if (ad.length && ad[0].getStreetDirection() != null) {
	APOAddress += " " + ad[0].getStreetDirection();
	}

if (ad.length && ad[0].getStreetName() != null) {
	APOAddress += " " + ad[0].getStreetName();
	}

if (ad.length && ad[0].getStreetSuffix() != null) {
	APOAddress += " " + ad[0].getStreetSuffix();
	}

if (ad.length && ad[0].getUnitStart() != null) {
	APOAddress += " # " + ad[0].getUnitStart();
	}
`^
CMN;GetAssetContactEmail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
var emailAddr = "";
var userId = "";
var user = "";
assetID = AssetList[x].getAssetMasterModel().getG1AssetID();
selectString = "DECLARE @AssetId varchar(50);
SET @AssetId = '" + assetID + "';
select g1_email, g1_fname, g1_lname, ga_user_id from gasset_master gam, XrefCONTACT_entity xcon, G3CONTACT con left outer join g3staffs st on con.SERV_PROV_CODE = st.SERV_PROV_CODE and con.G1_LNAME = st.GA_LNAME and con.G1_FNAME = st.GA_FNAME and GA_DIVISION_CODE <> 'PUBLIC' where gam.SERV_PROV_CODE = xcon.SERV_PROV_CODE and gam.G1_ASSET_SEQ_NBR = xcon.ent_id1 and xcon.G1_CONTACT_NBR = con.G1_CONTACT_NBR and con.g1_contact_type = 'Responsible Party' and gam.G1_ASSET_ID = @AssetId";
var initialContext = aa.proxyInvoker.newInstance("javax.naming.InitialContext").getOutput();
var ds = initialContext.lookup("java;!AA");
var conn = ds.getConnection();
var sStmt = conn.prepareStatement(selectString);
var rSet = sStmt.executeQuery();
if (rSet.next();) {
	emailAddr = rSet.getString("g1_email");
	userId = rSet.getString("ga_user_id");
	rSet.close();
	conn.close();
	} else {
	conn.close();
	}

if (userId != null && userId != "") {
	assignCap(userId);
	}

if (emailAddr != null) {
	emailList += emailAddr + ";
	";
	}
`^
CMN;getAssignedUser^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
fTask = wfObj[i];
taskUserObj = aa.person.getUser(wfTaskObj.getTaskItem().getAssignedUser().getFirstName(),wfTaskObj.getTaskItem().getAssignedUser().getMiddleName(),wfTaskObj.getTaskItem().getAssignedUser().getLastName()).getOutput();
if (taskUserObj != null) {
	userId = taskUserObj.userID;
	}
`^
CMN;GetContactAddress^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
conBizName="";
conAddress1="";
conAddress2="";
conCity="";
conState="";
conZip="";
if (ca[ca1]["businessName"] != null) {
	conBizName = ca[ca1]["businessName"];
	}

if (ca[ca1]["addressLine1"] != null) {
	conAddress1 = ca[ca1]["addressLine1"];
	}

if (ca[ca1]["addressLine2"] != null) {
	conAddress2 = ca[ca1]["addressLine2"];
	}

if (ca[ca1]["city"] != null) {
	conCity = ca[ca1]["city"];
	}

if (ca[ca1]["state"] != null) {
	conState = ca[ca1]["state"];
	}

if (ca[ca1]["zip"] != null) {
	conZip = ca[ca1]["zip"];
	}
`^
CMN;GetContactInfoFire^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
businessName = ca[item]["businessName"];
contactFName = ca[item]["firstName"];
contactLName = ca[item]["lastName"];
contactEmail = ca[item]["email"];
contactPhone1 = ca[item]["phone1"];
`^
CMN;GetDBA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var emailText = "";
businessName = "";
var capContactResult = aa.people.getCapContactByCapID(capId);
if (capContactResult.getSuccess()) {
	Contacts = capContactResult.getOutput();
	}

for (curContact in Contacts) if (Contacts[curContact].getPeople().getContactType() == "Applicant or Contact") var applPeople = Contacts[curContact].getPeople();
if (applPeople) {
	businessName = applPeople.getTradeName();
	} else {
	for (curContact in Contacts) if (Contacts[curContact].getPeople().getContactType() == "Applicant") var applPeople = Contacts[curContact].getPeople();
	}

if (applPeople) {
	businessName = applPeople.getTradeName();
	} else {
	for (curContact in Contacts) if (Contacts[curContact].getPeople().getContactType() == "License Holder") var applPeople = Contacts[curContact].getPeople();
	}

if (!businessName && applPeople) {
	businessName = applPeople.getTradeName();
	}

if (!businessName && applPeople) {
	businessName = applPeople.getBusinessName();
	}
`^
CMN;GetFireAlarmSprinklerEmailHdrVals^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emailText += "Project Name; 
 
" + AInfo['PROJECT INFORMATION.Project Name'];
emailText += "Record ID; 
 
" + capIDString + "<br>";
ad = aa.address.getAddressByCapId(capId);
if (ad.getSuccess()) {
	addrObj = ad.getOutput();
	} else {
	logDebug("Record does not have an address");
	}

if ((addrObj[0] != null && addrObj[0].toString().length() > 0)) {
	emailText += "Address of Work; 
	 
	" + addrObj[0].getDisplayAddress();
	}
`^
CMN;GetFirePemitApplicantInfo^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
phoneLen = 0;
ca = getContactArray();
for(item in ca) if ((ca[item]["contactType"]) == "Applicant") include("CMN;GetContactInfoFire");
for(ca1 in ca) if ((ca[ca1]["contactType"]) == "Applicant") include("CMN;GetContactAddress");
emailText += "<br>Applicant Information;";
emailText += "<br><b>" + contactFName + " " + contactLName + "<!b>";
if (businessName!= null && businessName != "") {
	emailText += "<br>" + businessName;
	}

emailText += "<br>" + conAddress1;
if (conAddress2 != null && conAddress2 != "") {
	emailText += "<br>" + conAddress2;
	}

emailText += "<br>" + conCity + ", " + conState  + " " +conZip;
if (contactPhone1 != null && contactPhone1 != "") {
	contactPhone1 = contactPhone1.toString();
	phoneLen = contactPhone1.length();
	}

if (phoneLen > 9 && contactPhone1.indexOf("-") == -1) {
	contactPhone1 = contactPhone1.substr(0, 3) + '-' + contactPhone1.substr(3, 3) + '-' + contactPhone1.substr(6,4);
	}

emailText += "<br>" + contactPhone1;
emailText += "<br>" + contactEmail;
`^
CMN;GetFirePermitEmailHdrVals^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if ((cmnSubType == "Alarm" || cmnSubType == "Sprinkler")) {
	emailText += "Project Name; 
	 
	" + AInfo['PROJECT INFORMATION.Project Name'];
	}

emailText += "Record ID; 
 
" + capIDString + "<br>";
ad = aa.address.getAddressByCapId(capId);
if (ad.getSuccess()) {
	addrObj = ad.getOutput();
	} else {
	logDebug("Record does not have an address");
	}

if ((addrObj[0] != null && addrObj[0].toString().length() > 0)) {
	emailText += "Address of Work; 
	 
	" + addrObj[0].getDisplayAddress();
	}
`^
CMN;getMPDEmail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
logDebug("Testing MPD District");
loadAddressAttributes(AInfo, capId);
var mpd = "";
contactEmail="";
if (AInfo["AddressAttribute.POLICE DISTRICT"] != null && AInfo["AddressAttribute.POLICE DISTRICT"] != "") {
	mpd = AInfo["AddressAttribute.POLICE DISTRICT"];
	}

logDebug("Police District = " + AInfo["AddressAttribute.POLICE DISTRICT"]);
if (mpd == "A") {
	contactEmail = "mwalizada@cityofmadison.com;
	testingMPD_A@cityofmadisonDEV.com";
	}

if (mpd == "C") {
	contactEmail = "mwalizada@cityofmadison.com;
	testingMPD_C@cityofmadisonDEV.com";
	}

if (mpd == "D") {
	contactEmail = "mwalizada@cityofmadison.com;
	cgloede@cityofmadison.com;
	testingMPD_D@cityofmadisonDEV.com";
	}

if (mpd == "E") {
	contactEmail = "mwalizada@cityofmadison.com;
	testingMPD_E@cityofmadisonDEV.com";
	}

if (mpd == "F") {
	contactEmail = "mwalizada@cityofmadison.com;
	testingMPD_F@cityofmadisonDEV.com";
	}
`^
CMN;GetMuni^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
muni = "";
addr = aa.address.getAddressByCapId(capId).getOutput();
if (addr[0]) {
	muni = addr[0].getNeighborhood();
	}
`^
CMN;GetParentRecordSubmitter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
parentCapId = getParent();
logDebug("Parent is;"+parentCapId);
if (parentCapId) {
	var cd = aa.cap.getCapDetail(parentCapId).getOutput().getCapDetailModel();
	}

if (parentCapId && cd != null) {
	assignUserId = cd.getAsgnStaff();
	createdByUserId = cd.createBy;
	logDebug("create user is ;"+createdByUserId);
	}
`^
CMN;GetParksAppName^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
cName = " ";
if (cmnSubType == "Beer Sales") {
	cName = "Beer Sales";
	}

if (cmnSubType == "Block Party") {
	cName = "Block Party";
	}

if (cmnSubType == "Electrical Amplification") {
	cName = "Downtown Performance Space Use";
	}

if (cmnSubType == "Farmers Market Electric") {
	cName = "Farmers Market Electric";
	}

if (cmnSubType == "Street Use") {
	cName = "Street Use";
	}

if (cmnSubType == "Street Use Vending") {
	cName = "Street Use Vending";
	}
`^
CMN;GetRefOwnerNameAddressfromParcel^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var parcelListResult = null;
var aryParcelList = null;
var ownerListResult = null;
var aryOwnerList = null;
var ownerPrimaryIndx = "";
var idx = null;
sOwnerFirstName = "";
sOwnerLastName = "";
sOwnerAddr1 = "";
sOwnerAddr2 = "";
sOwnerAddr3 = "";
sOwnerCity = "";
sOwnerState = "";
sOwnerZip = "";
parcelListResult = aa.parcel.getParcelDailyByCapID(capId,null);
if (parcelListResult.getSuccess()) {
	aryParcelList = parcelListResult.getOutput();
	}

if (aryParcelList != null) {
	ownerListResult = aa.owner.getOwnersByParcel(aryParcelList[0]);
	}

if (ownerListResult.getSuccess()) {
	aryOwnerList = ownerListResult.getOutput();
	}

if (aryOwnerList != null) {
	for(x in aryOwnerList) if(aryOwnerList[x].primaryOwner == "Y") ownerPrimaryIndx +=  x.toString() + ",";
	}

if (aryOwnerList != null && ownerPrimaryIndx.indexOf("0,") > -1) {
	idx = 0;
	}

if (aryOwnerList != null && idx == null && ownerPrimaryIndx.indexOf("1,") > -1) {
	idx = 1;
	}

if (aryOwnerList != null && idx == null) {
	idx = 0;
	logDebug("Neither 0 or 1 owner is primary, so go with 0.");
	}

if (aryOwnerList != null && aryOwnerList[idx].ownerFirstName != null) {
	sOwnerFirstName = aryOwnerList[idx].ownerFirstName.trim();
	}

if (aryOwnerList != null && aryOwnerList[idx].ownerLastName != null) {
	sOwnerLastName = aryOwnerList[idx].ownerLastName.trim();
	}

if (aryOwnerList != null && aryOwnerList[idx].mailAddress1 != null) {
	sOwnerAddr1 =  aryOwnerList[idx].mailAddress1.trim();
	}

if (aryOwnerList != null && aryOwnerList[idx].mailAddress2 != null) {
	sOwnerAddr2 =  aryOwnerList[idx].mailAddress2.trim();
	}

if (aryOwnerList != null && aryOwnerList[idx].mailAddress3 != null) {
	sOwnerAddr3 =  aryOwnerList[idx].mailAddress3.trim();
	}

if (aryOwnerList != null && aryOwnerList[idx].mailCity != null) {
	sOwnerCity =  aryOwnerList[idx].mailCity;
	}

if (aryOwnerList != null && aryOwnerList[idx].mailState != null) {
	sOwnerState =  aryOwnerList[idx].mailState;
	}

if (aryOwnerList != null && aryOwnerList[idx].mailZip != null) {
	sOwnerZip = aryOwnerList[idx].mailZip;
	}
`^
CMN;getRelatedCapsByDetailAddress^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
fa = "";
goodAddr = "";
addressValidatedNumber = aa.env.getValue("AddressValidatedNumber");
ats = appTypeString;
retArr_related = new Array();
goodAddr = aa.address.getRefAddressByPK(parseInt(addressValidatedNumber)).getSuccess();
if (goodAddr) {
	addObj = aa.address.getRefAddressByPK(parseInt(addressValidatedNumber)).getOutput();
	}

if (goodAddr) {
	addressStreetName = addObj.getStreetName();
	}

if (goodAddr) {
	addressHouseNumber = addObj.getHouseNumberStart();
	if (addressHouseNumber == "") addressHouseNumber = 0;
	}

if (goodAddr) {
	addressStreetSuffix = addObj.getStreetSuffix();
	if (addressStreetSuffix == "") addressStreetSuffix = null;
	}

if (goodAddr) {
	addressZip = addObj.getZip();
	if (addressZip == "") addressZip = null;
	}

if (goodAddr) {
	addressStreetDirection = addObj.getStreetDirection();
	if (addressStreetDirection == "") addressStreetDirection = null;
	}

if (goodAddr) {
	capAddResult = aa.cap.getCapListByDetailAddress(addressStreetName,parseInt(addressHouseNumber),addressStreetSuffix,addressZip,addressStreetDirection,null);
	}

if (goodAddr) {
	fa = capAddResult.getSuccess();
	!!fa = found array;
	}

if (fa) {
	capIdArray = capAddResult.getOutput();
	}

if (fa) {
	for (cappy in capIdArray) include("CMN;getRelatedCapsByDetailAddress_loop1");
	}

matchFound = "N";
matchNote = "<B>Warning, open cases for this address found.<!B><P>Please review the records below before opening a new case. If this a new unrelated case, use the checkbox \"Bypass duplicate case check\" before submitting again.<!P>";
if (fa) {
	for (x in retArr_related) include("CMN;getRelatedCapsByDetailAddress_Loop2");
	}

if (matchFound == "Y") {
	comment(matchNote);
	}

if (matchFound == "Y") {
	cancel = true;
	}
`^
CMN;getRelatedCapsByDetailAddress_loop1^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
rc = aa.cap.getCap(capIdArray[cappy].getCapID()).getSuccess();
rta = "";
if (rc) {
	relcap = aa.cap.getCap(capIdArray[cappy].getCapID()).getOutput();
	!! get file date;
	}

if (rc) {
	reltype = relcap.getCapType().toString();
	!! get cap type;
	}

isMatch = true;
ata = ats.split("!");
rta = reltype.split("!");
if (ata.length == 4 && rta.length == 4) {
	for (ataPart in ata) include("CMN;getRelatedCapsByDetailAddress_loop1_Sub1");
	} else {
	isMatch = false;
	}

if (isMatch) {
	retArr_related.push(capIdArray[cappy]);
	}
`^
CMN;getRelatedCapsByDetailAddress_loop1_Sub1^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var potentialMatch = true;
if ((ata[ataPart].equals(rta[ataPart]) || (ata[ataPart].equals("~")))) {
	} else {
	potentialMatch = false;
	}

if (ataPart < 2 && potentialMatch == false) {
	isMatch = false;
	}
`^
CMN;getRelatedCapsByDetailAddress_Loop2^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var cs = aa.cap.getCap(retArr_related[x].getCapID());
capInfo = "";
if (cs.getSuccess()) {
	ci = cs.getOutput();
	}

if (cs.getSuccess()) {
	capInfo = ci.capStatus;
	capType = ci.capType;
	}

if (cs.getSuccess()) {
	var shortNotes = getShortNotes(ci.capID);
	var workDes = workDescGet(ci.capID);
	}

var ignore = "N";
if (capInfo == "Closed") {
	ignore = "Y";
	}

if (capInfo == "Compliance") {
	ignore = "Y";
	}

if (capInfo == "Closed New Case") {
	ignore = "Y";
	}

if (capInfo == "No Violation") {
	ignore = "Y";
	}

if (capInfo == "Void") {
	ignore = "Y";
	}

if (ignore == "N") {
	matchFound = "Y";
	}

if (ignore == "N") {
	matchNote += "<BR!><B><U>ALT ID; " + retArr_related[x].customID + " 
	 
	 
	<!U><!B><small>";
	}

if (ignore == "N") {
	matchNote += "<BR!>Current Status; "  + capInfo;
	}

if (ignore == "N") {
	matchNote += "<BR!>Type;  " +  capType;
	}

if (ignore == "N") {
	matchNote += "<BR!>Application!!Project; " +  shortNotes;
	}

if (ignore == "N") {
	matchNote += "<BR!>Detailed Description; " +  workDes;
	}

if (ignore == "N") {
	matchNote += "<!small><BR!>";
	}
`^
CMN;getRelatedCapsByParcelNumber^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
ParcelValidatedNumber =  pnum;
eb = true;
relatedCapIds = new Array();
if (true) {
	capAddResult = aa.cap.getCapListByParcelID(ParcelValidatedNumber,null);
	}

if ((capAddResult.getSuccess())) {
	capIdArray=capAddResult.getOutput();
	} else {
	logDebug("~~ERROR; getting similar parcels; " + capAddResult.getErrorMessage());
	eb = false;
	}

if ((eb = true)) {
	for (cappy in capIdArray) include("CMN;getRelatedCapsByParcelNumber_subloop1");
	}

if ((eb = false)) {
	relatedCapIds = null;
	}
`^
CMN;getRelatedCapsByParcelNumber_subloop1^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
relcap = aa.cap.getCap(capIdArray[cappy].getCapID()).getOutput();
!! get cap ids;
reltypeArray = relcap.getCapType().toString().split("!");
!! get cap type;
isMatch = true;
ata = ats.split("!");
if ((ata.length != 4)) {
	logDebug("~~ERROR; The following Application Type String is incorrectly formatted; " + ats);
	} else {
	for (xx in ata)  if (!ata[xx].equals(reltypeArray[xx]) && !ata[xx].equals("~")) isMatch = false;
	}

if ((isMatch)) {
	relatedCapIds.push(capIdArray[cappy]);
	}
`^
CMN;getRelatedCapsByParcelNumber_subloop2^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
`^
CMN;GetWorkflowAssignedByProcessID^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
!! assignWorkFlow = false;
isParTask = false;
workflowTasks = aa.workflow.getTasks(capId, workflowGroups[wfg].getProcessID()).getOutput();
!!debugObject(workflowTasks[0]);
parTaskName = workflowGroups[wfg].getParentTaskName();
!!logDebug("Debuggg equal?; " + (parentTaskName == parTaskName));
if (parTaskName == null) {
	parTaskName = "";
	}

for (wfTaskItem in workflowTasks) include("CMN;GetWorkflowAssignedByProcessIDLoop");
`^
CMN;GetWorkflowAssignedByProcessIDLoop^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
currentStep = true;
taskItem = null;
assignedUser = null;
if (workflowTasks[wfTaskItem].getTaskDescription() != wfTask) {
	currentStep = false;
	}

if (parntTaskName != parTaskName) {
	currentStep = false;
	}

if (currentStep == true) {
	taskItem = workflowTasks[wfTaskItem].getTaskItem();
	!!debugObject(taskItem);
	}

if (currentStep == true) {
	assignedPerson = workflowTasks[wfTaskItem].getAssignedStaff();
	!!debugObject(assignedPerson);
	}

if (currentStep == true) {
	assignedFullName = assignedPerson.getFullName();
	!!logDebug(assignedFullName);
	}

if (currentStep == true) {
	assignedPersonDept = assignedPerson.getDeptOfUser();
	!!logDebug(assignedPersonDept);
	}

if (currentStep == true) {
	deptList = aa.people.getSysUserListByDepartmentName(assignedPersonDept).getOutput();
	!!debugObject(deptList );
	}

if (currentStep == true) {
	for (sUser in deptList) if (deptList[sUser].getFullName().equals(assignedFullName)) assignedUserEmail = deptList[sUser].getEmail();
	}

if (currentStep == true) {
	logDebug("DEBUG; parntTaskName " + parntTaskName +  ", parTaskName; " + parTaskName + ", getstep;" + workflowTasks[wfTaskItem].getStepNumber() + ", EMAIL;" + assignedUserEmail);
	}
`^
CMN;GetWorkflowItems^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
fTask = wfObj[i];
!!&& (fTask.getProcessID() == wfProcessID);
if (fTask.getTaskDescription().equals(task)) {
	wfStep = fTask.getStepNumber();
	}

if (fTask.getTaskDescription().equals(task)) {
	wfNote = fTask.getDispositionNote();
	}

if (fTask.getTaskDescription().equals(task)) {
	wfDue = fTask.getDueDate();
	}

if (fTask.getTaskDescription().equals(task)) {
	wfProcess = fTask.getProcessCode();
	}

if (fTask.getTaskDescription().equals(task)) {
	wfComment = fTask.getDispositionComment();
	}

if (fTask.getTaskDescription().equals(task)) {
	wfTaskObj = fTask;
	}
`^
CMN;HealthInspections^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if ((inspType.toUpperCase() == "ROUTINE INSPECTION" || inspType.toUpperCase() == "NON-CONTINUOUS COOKING") && (inspResult == "Reinsp Req" || inspResult == "Immediate Suspension") && cmnSubType == "FoodandDrink") {
	scheduleInspectDateGroup(inspGroup, "First Reinspection Chargeable", nextWorkDay(dateAdd(inspOccurredDate,7)), currentUserID);
	}

if (inspType.toUpperCase() == "ROUTINE INSPECTION" && (inspResult == "Reinsp Req" || inspResult == "Immediate Suspension") && (cmnSubType != "FoodandDrink" && cmnSubType != "School")) {
	scheduleInspectDateGroup(inspGroup, "First Reinspection Chargeable", nextWorkDay(dateAdd(inspOccurredDate,7)), currentUserID);
	}

if ((inspType == "First Reinspection Chargeable" || inspType == "Subsequent Reinspection Chargeable" || inspType.toUpperCase() == "REINSPECTION" || inspType.toUpperCase() == "RE-INSPECTION CHARGEABLE") && (inspResult == "Reinsp Req" || inspResult == "Immediate Suspension") && cmnSubType != "School") {
	scheduleInspectDateGroup(inspGroup, "Subsequent Reinspection Chargeable", nextWorkDay(dateAdd(inspOccurredDate,7)), currentUserID);
	}

if ((inspType.toUpperCase() == "ON-SITE VISIT" || inspType.toUpperCase() == "REINSPECTION NON-CHARGEABLE" || inspType.toUpperCase() == "RE-INSPECTION NON-CHARGEABLE" || inspType.toUpperCase() == "PRE-INSPECTION") && (inspResult == "Reinsp Req" || inspResult == "Immediate Suspension") && cmnSubType != "School") {
	scheduleInspectDateGroup(inspGroup, "Reinspection Non-Chargeable", nextWorkDay(dateAdd(inspOccurredDate,7)), currentUserID);
	}
`^
CMN;invoiceAssessedFees^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (typeof(excludeCode) == "undefined") {
	excludeCode = "";
	}

if (typeof(onlyIncludeCode) == "undefined") {
	onlyIncludeCode = "";
	}

fees = aa.fee.getFeeItems(capId);
feeList = fees.getOutput();
assessedFeeSeqList = new Array();
payPeriodList = new Array();
if ((excludeCode + onlyIncludeCode == "")) {
	for(feeItem in feeList) if(feeList[feeItem].getFeeitemStatus() == "NEW") assessedFeeSeqList.push(feeList[feeItem].getFeeSeqNbr());
	payPeriodList.push(feeList[feeItem].period);
	}

if (excludeCode.length > 0) {
	for(feeItem in feeList) if(feeList[feeItem].getFeeitemStatus() == "NEW" && feeList[feeItem].getFeeCod() != excludeCode) assessedFeeSeqList.push(feeList[feeItem].getFeeSeqNbr());
	payPeriodList.push(feeList[feeItem].period);
	}

if (onlyIncludeCode.length > 0) {
	for(feeItem in feeList) if(feeList[feeItem].getFeeitemStatus() == "NEW" && feeList[feeItem].getFeeCod() == onlyIncludeCode) assessedFeeSeqList.push(feeList[feeItem].getFeeSeqNbr());
	payPeriodList.push(feeList[feeItem].period);
	}

aa.finance.createInvoice(capId, assessedFeeSeqList, payPeriodList);
`^
CMN;IRSA;Enforcement!Building Inspection;CITATION^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (inspType == "Initial Inspection" && (inspResult == "Citation" || inspResult == "No Fee Citation")) {
	include("CMN;Enforcement!Building Inspection;Initial Inspection;Citation");
	}

if (inspType == "Reinspection" && (inspResult == "Citation" || inspResult == "No Fee Citation")) {
	include("CMN;Enforcement!Building Inspection;Reinspection;Citation");
	}
`^
CMN;Land!~!~!~;DetermineDocumentEmail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
docGroup = docArray[doc].getDocGroup();
for (compGroup in docGroupArray) if (docGroup.equals(docGroupArray[compGroup])) docExists = true;
`^
CMN;Land!Land Use!Conditional Use Demo!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['CELL TOWER CONDITIONAL USE.Total Acres For Conditional Use In This Section (Rounded to Next Whole Acre)'] != null) {
	if(feeExists("STD_CUA") == false) updateFee("STD_CUA","LMCOND","FINAL",1,"N");
	} else {
	if(feeExists("STD_CUA") == true) removeFee("STD_CUA","FINAL");
	}

if (AInfo['MAJOR CONDITIONAL USE TYPE.Total Acres Included for Conditional Use in This Section (rounded to next whole acre)'] != null) {
	if(feeExists("MAJCONUSE") == false) updateFee("MAJCONSUE","LMCOND","FINAL",1,"N");
	} else {
	if(feeExists("MAJCONUSE") == true) removeFee("MAJCONUSE","FINAL");
	}

if (AInfo['OTHER CONDITIONAL USE TYPE.Total Acres For Conditional Use In This Section (Rounded to Next Whole Acre)'] != null) {
	if(feeExists("STD_CUA") == false) updateFee("STD_CUA","LMCOND","FINAL",1,"N");
	} else {
	if(feeExists("STD_CUA") == true) removeFee("STD_CUA","FINAL");
	}
`^
CMN;Land!Land Use!Conditional Use!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['CELL TOWER CONDITIONAL USE.Total Acres For Conditional Use In This Section (Rounded to Next Whole Acre)'] != null) {
	if(feeExists("STD_CUA") == false) updateFee("STD_CUA","LMCOND","FINAL",1,"N");
	} else {
	if(feeExists("STD_CUA") == true) removeFee("STD_CUA","FINAL");
	}

if (AInfo['MAJOR CONDITIONAL USE TYPE.Total Acres Included for Conditional Use in This Section (rounded to next whole acre)'] != null) {
	if(feeExists("MAJCONUSE") == false) updateFee("MAJCONSUE","LMCOND","FINAL",1,"N");
	} else {
	if(feeExists("MAJCONUSE") == true) removeFee("MAJCONUSE","FINAL");
	}

if (AInfo['OTHER CONDITIONAL USE TYPE.Total Acres For Conditional Use In This Section (Rounded to Next Whole Acre)'] != null) {
	if(feeExists("STD_CUA") == false) updateFee("STD_CUA","LMCOND","FINAL",1,"N");
	} else {
	if(feeExists("STD_CUA") == true) removeFee("STD_CUA","FINAL");
	}
`^
CMN;Land!Land Use!NA!NA;SaveProjectRevision^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
tblCurrentRevision = new Array();
addCurrentRevision = true;
tblRevisions = loadASITable("PROJECT INFORMATION REVISIONS");
if ((tblRevisions.length != undefined)) {
	tblRowCount = tblRevisions.length;
	}

if ((tblRevisions.length == undefined)) {
	tblRevisions = new Array();
	tblRowCount = 0;
	}

tblCurrentRevision["Revision Number"] = String(getAppSpecific("PROJECT INFORMATION.Revision Number"));
tblCurrentRevision["Requested Action"] = String(workDescGet(capId));
tblCurrentRevision["General Description of Project"] = String(getAppSpecific("PROJECT INFORMATION.General Description of Project"));
var dtToday = new Date();
var iMonth = dtToday.getMonth() + 1;
var iDay = dtToday.getDate();
var iYear = dtToday.getFullYear();
var sdt = iMonth + "!" + iDay + "!" + iYear;
tblCurrentRevision["Date"] = sdt;
tblCurrentRevision["Applicable Regulations and Standards"] = String(getAppSpecific("PROJECT INFORMATION.Applicable Regulations and Standards"));
tblCurrentRevision["Recommendation"] = String(getAppSpecific("PROJECT INFORMATION.Recommendation"));
if ((Number(tblRowCount) > 0)) {
	for(x in tblRevisions) include("CMN;Land!Land Use!NA!NA;SaveProjectRevisionLoop");
	}

if (addCurrentRevision) {
	tblRevisions.push(tblCurrentRevision);
	!! Adds the current revision to the end of array;
	}

if ((Number(tblRowCount) > 0)) {
	removeASITable("PROJECT INFORMATION REVISIONS");
	}

addASITable("PROJECT INFORMATION REVISIONS", tblRevisions);
`^
CMN;Land!Land Use!NA!NA;SaveProjectRevisionLoop^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
isCurrentRevision = false;
if (tblCurrentRevision["Revision Number"] == tblRevisions[x]["Revision Number"]) {
	isCurrentRevision = true;
	addCurrentRevision = false;
	}

if (isCurrentRevision) {
	tblRevisions.splice(x, 1, tblCurrentRevision);
	}
`^
CMN;Land!Landmark!NA!NA;CreateEnforcementCase^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
childId = null;
holdId = null;
var sInspectorDept = "MADISON!CE!INSP!INSP!NA!NA!NA";
var sInspectorUserID = "BIAFV";
var sParentWorkDescr = "";
var oInspections = null;
aryInspections = null;
var cd = null;
sParentWorkDescr = workDescGet(capId);
logDebug("Parent Work Descrip = " + sParentWorkDescr);
childId = createChild("Enforcement","Building Inspection","Housing","General Maintenance Exterior", capName);
if (childId != null) {
	holdId = capId;
	capId = childId;
	copyParcelGisObjects();
	}

if (childId != null) {
	cd = aa.cap.getCapDetail(capId).getOutput().getCapDetailModel();
	}

if (childId != null && cd) {
	cd.setAsgnDept(sInspectorDept);
	cd.setAsgnStaff(sInspectorUserID);
	cdWrite = aa.cap.editCapDetail(cd);
	updateAppStatus("Official Notice", "Status updated by script");
	}

if (childId != null) {
	capId = holdId;
	}

if (childId != null) {
	copyOwner(capId, childId);
	updateWorkDesc(sParentWorkDescr, childId);
	}

oInspections = aa.inspection.getInspections(capId);
if (oInspections != null) {
	if(oInspections.getSuccess()) aryInspections = oInspections.getOutput();
	}

if (aryInspections != null) {
	for(insp in aryInspections) include("CMN;CopySignInspectionsLoop");
	}
`^
CMN;Land!Non-PUD Rezoning!NonPUD Cond Use Demo!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['NON-PUD REZONING TYPE.Acres to be Rezoned (Rounded to Next Whole Acre)'] != null) {
	if(feeExists("REZONE_OTH") == false) updateFee("REZONE_OTH","LMZONE","FINAL",1,"N");
	} else {
	if(feeExists("REZONE_OTH") == true) removeFee("REZONE_OTH","FINAL");
	}
`^
CMN;Land!Non-PUD Rezoning!NonPUD Cond Use!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['NON-PUD REZONING TYPE.Acres to be Rezoned (Rounded to Next Whole Acre)'] != null) {
	if(feeExists("REZONE_OTH") == false) updateFee("REZONE_OTH","LMZONE","FINAL",1,"N");
	} else {
	if(feeExists("REZONE_OTH") == true) removeFee("REZONE_OTH","FINAL");
	}
`^
CMN;Land!Non-PUD Rezoning!NonPUD Demo!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['NON-PUD REZONING TYPE.Acres to be Rezoned (Rounded to Next Whole Acre)'] != null) {
	if(feeExists("REZONE_OTH") == false) updateFee("REZONE_OTH","LMZONE","FINAL",1,"N");
	} else {
	if(feeExists("REZONE_OTH") == true) removeFee("REZONE_OTH","FINAL");
	}
`^
CMN;Land!Non-PUD Rezoning!NonPUD!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['NON-PUD REZONING TYPE.Acres to be Rezoned (Rounded to Next Whole Acre)'] != null) {
	if(feeExists("REZONE_OTH") == false) updateFee("REZONE_OTH","LMZONE","FINAL",1,"N");
	} else {
	if(feeExists("REZONE_OTH") == true) removeFee("REZONE_OTH","FINAL");
	}
`^
CMN;Land!Permitted Use!Site Plan Review!NA;TrafficEngASITLoop^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var sComment = "";
var sTEStatus = "";
sTEStatus = oTraffEng[x]["Status"];
sComment = String(oTraffEng[x]["Comment"]);
logDebug("Status = " + sTEStatus);
logDebug("Comment = " + sComment);
if ((sComment.substr(0, 44) == "Permitting Fees Due for Commercial Driveway;" || sComment.substr(0, 28) == "The Driveway Approach Fee of" ) && sTEStatus == "Supplement Accepted") {
	bSuppAccept = true;
	}
`^
CMN;Land!PUD Rezoning!PUD Cond Use Demo!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['PUD REZONING TYPE.Acres to be Rezoned (Rounded to Next Whole Acre)'] != null) {
	if(feeExists("PUD_PCD_REZONE") == false) updateFee("PUD_PCD_REZONE","LMPUD","FINAL",1,"N");
	} else {
	if(feeExists("PUD_PCD_REZONE") == true) removeFee("PUD_PCD_REZONE","FINAL");
	}
`^
CMN;Land!PUD Rezoning!PUD Cond Use!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['PUD REZONING TYPE.Acres to be Rezoned (Rounded to Next Whole Acre)'] != null) {
	if(feeExists("PUD_PCD_REZONE") == false) updateFee("PUD_PCD_REZONE","LMPUD","FINAL",1,"N");
	} else {
	if(feeExists("PUD_PCD_REZONE") == true) removeFee("PUD_PCD_REZONE","FINAL");
	}
`^
CMN;Land!PUD Rezoning!PUD Demo!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['PUD REZONING TYPE.Acres to be Rezoned (Rounded to Next Whole Acre)'] != null) {
	if(feeExists("PUD_PCD_REZONE") == false) updateFee("PUD_PCD_REZONE","LMPUD","FINAL",1,"N");
	} else {
	if(feeExists("PUD_PCD_REZONE") == true) removeFee("PUD_PCD_REZONE","FINAL");
	}
`^
CMN;Land!PUD Rezoning!PUD!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['PUD REZONING TYPE.Acres to be Rezoned (Rounded to Next Whole Acre)'] != null) {
	if(feeExists("PUD_PCD_REZONE") == false) updateFee("PUD_PCD_REZONE","LMPUD","FINAL",1,"N");
	} else {
	if(feeExists("PUD_PCD_REZONE") == true) removeFee("PUD_PCD_REZONE","FINAL");
	}
`^
CMN;Land!Rezoning!Rezoning!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (AInfo['REZONE TYPE.Acres to be Rezoned (Whole Acres)'] != null) {
	if(feeExists("REZONE_OTH") == false) updateFee("REZONE_OTH","LMZONE","FINAL",1,"N");
	} else {
	if(feeExists("REZONE_OTH") == true) removeFee("REZONE_OTH","FINAL");
	}
`^
CMN;Land!Subdivision!Certified Survey Map!NA;AddParcelCondition^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
recId = capId.getCustomID();
conditionExists = false;
if (parcelNum == null) {
	var capParcelResult = aa.parcel.getParcelandAttribute(capId,null);
	}

if (parcelNum == null && capParcelResult.getSuccess()) {
	var Parcels = capParcelResult.getOutput().toArray();
	}

if (parcelNum == null && (Parcels.length > 0)) {
	parcelNum = Parcels[0].getParcelNumber();
	}

if (parcelNum != null) {
	conditionObjects = getConditions("PLANNING", "APPLIED", "CSM Pending", null);
	}

if (parcelNum != null) {
	for (eachrow in conditionObjects) if(conditionObjects[eachrow].arObject.getParcelNumber()==parcelNum) conditionExists = true;
	}

if (parcelNum != null && conditionExists == false) {
	conditionComment = "A Certified Survey Map (CSM) has been submitted to the Planning Division that includes this parcel. No CAPs shall be created nor any permits issued for new construction until that CSM has been approved by the City, recorded at the Dane County Register of Deeds, and the new resulting lot(s) created by the CSM has been listed in the appropriate parcel database(s)." + String.fromCharCode(13) + String.fromCharCode(10) + String.fromCharCode(13) + String.fromCharCode(10) + "Refer to " + recId;
	}

if (parcelNum != null && conditionExists == false) {
	addParcelCondition(parcelNum, "PLANNING", "APPLIED", "CSM Pending", conditionComment, "Notice");
	}
`^
CMN;Land!Subdivision!Certified Survey Map!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['SUBDIVISION INFORMATION.Total No. Of Lots and Outlots'] != null) {
	if(feeExists("CSM") == false) updateFee("CSM","LMCSM","FINAL",1,"N");
	} else {
	if(feeExists("CSM") == true) removeFee("CSM","FINAL");
	}
`^
CMN;Land!Subdivision!Certified Survey Map!NA;RemoveParcelCondition^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
conditionObjects = getConditions("PLANNING", "APPLIED", "CSM Pending", null);
for (eachrow in conditionObjects) if(conditionObjects[eachrow].arObject.getParcelNumber()==parcelNum) conditionObjects[eachrow].arObject.setConditionStatus("RELEASED");
for (eachrow in conditionObjects) if(conditionObjects[eachrow].arObject.getParcelNumber()==parcelNum) aa.parcelCondition.editParcelCondition(conditionObjects[eachrow].arObject);
`^
CMN;Land!Subdivision!Subdivision Plat!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['SUBDIVISION INFORMATION.Total No. Of Lots and Outlots'] != null) {
	if(feeExists("SBDV") == false) updateFee("SBDV","LMSBDV","FINAL",1,"N");
	} else {
	if(feeExists("SBDV") == true) removeFee("SBDV","FINAL");
	}
`^
CMN;Land!Urban Design Commission!General Application!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['Project Type.RPSM Variance'] == "CHECKED") {
	if(feeExists("UDCCDR") == false) updateFee("UDCCDR","UDCCDREV","FINAL",1,"N");
	} else {
	if(feeExists("UDCCDR") == true) removeFee("UDCCDR","FINAL");
	}

if (AInfo['Project Type.Street Graphics Variance ! Comp. Design Review'] == "CHECKED") {
	if(feeExists("SVGCDR") == false) updateFee("SVGCDR","UDCCDREV","FINAL",1,"N");
	} else {
	if(feeExists("SVGCDR") == true) removeFee("SVGCDR","FINAL");
	}

if (AInfo['Project Type.Minor Ext. Remodeling in UDD!C4'] == "CHECKED") {
	if(feeExists("MER") == false) updateFee("MER","UDCCDREV","FINAL",1,"N");
	} else {
	if(feeExists("MER") == true) removeFee("MER","FINAL");
	}

if (AInfo['Project Type.New Const. or Major Ext. Remodeling In UDD!C4'] == "CHECKED") {
	if(feeExists("UDCCDR") == false) updateFee("UDCCDR","UDCCDREV","FINAL",1,"N");
	} else {
	if(feeExists("UDCCDR") == true) removeFee("UDCCDR","FINAL");
	}
`^
CMN;LICENSE;2YrExpJune30^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var appExpDate = aa.expiration.getLicensesByCapID(capId).getOutput();
rsYear = startDate.getFullYear();
if(rsYear % 2 == 1) rsYear = rsYear + 1;
rsExpDate = new Date(appExpDate.getExpDate().getMonth() + "!" + appExpDate.getExpDate().getDayOfMonth() + "!" + rsYear);
rsCutOffDate = rsExpDate;
if (appExpDate.getExpStatus() != "Pending") {
	rsCutOffDate = new Date((appExpDate.getExpDate().getMonth() -3) + "!" + appExpDate.getExpDate().getDayOfMonth() + "!" + rsYear);
	} else {
	rsCutOffDate = new Date((appExpDate.getExpDate().getMonth() - 2) + "!" + appExpDate.getExpDate().getDayOfMonth() + "!" + rsYear);
	}

if ((startDate < rsCutOffDate)) {
	newExpDate = dateAddMonths(rsExpDate,0,"Y");
	} else {
	newExpDate = dateAddMonths(rsExpDate,24,"Y");
	}

licEditExpInfo("Active",newExpDate);
`^
CMN;LICENSE;ExpDec31^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var appExpDate = aa.expiration.getLicensesByCapID(capId).getOutput();
rsYear = new Date().getFullYear();
rsExpDate = new Date(appExpDate.getExpDate().getMonth() + "!" + appExpDate.getExpDate().getDayOfMonth() + "!" + rsYear);
rsCutOffDate = rsExpDate;
rsCutOffDate = new Date((appExpDate.getExpDate().getMonth() - 1) + "!" + (appExpDate.getExpDate().getDayOfMonth() - 13) + "!" + rsYear);
if (startDate < rsCutOffDate) {
	newExpDate = dateAddMonths(rsExpDate,0,"Y");
	} else {
	newExpDate = dateAddMonths(rsExpDate,12,"Y");
	}

licEditExpInfo(null, newExpDate);
`^
CMN;LICENSE;ExpJanuary31^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var dtBaseDate;
if (callProc == "workflow") {
	dtBaseDate = new Date(wfDateMMDDYYYY);
	}

if (callProc == "AppStatus" && (new Date() > new Date(dateAdd(new Date(AInfo['LICENSE INFORMATION.License Expiration Date']),-60)))) {
	dtBaseDate = new Date(AInfo['LICENSE INFORMATION.License Expiration Date']);
	} else {
	dtBaseDate = new Date();
	}

var currentYear = dtBaseDate.getFullYear();
var expYear = currentYear + 2;
if (callProc == "workflow" && dtBaseDate.getMonth() == 11) {
	expYear = expYear + 1;
	}

var newExpDate = "1!31!" + expYear;
editAppSpecific("LICENSE INFORMATION.License Expiration Date",  newExpDate);
editAppSpecific("LICENSE INFORMATION.License Status", "Active");
licEditExpInfo ("Active", newExpDate);
`^
CMN;LICENSE;ExpJune30^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var appExpDate = aa.expiration.getLicensesByCapID(capId).getOutput();
rsYear = startDate.getFullYear();
rsExpDate = new Date(appExpDate.getExpDate().getMonth() + "!" + appExpDate.getExpDate().getDayOfMonth() + "!" + rsYear);
rsCutOffDate = rsExpDate;
if (((appMatch("Licenses!Health!~!~") || appMatch("Licenses!Fire!~!~")) && appExpDate.getExpStatus() == "Pending")) {
	rsCutOffDate = new Date((appExpDate.getExpDate().getMonth() -3) + "!" + appExpDate.getExpDate().getDayOfMonth() + "!" + rsYear);
	}

if (((appMatch("Licenses!Building Inspection!~!~") || appMatch("Licenses!Clerk!~!~") || appMatch("Licenses!Health!~!~") || appMatch("Licenses!Fire!~!~")) && appExpDate.getExpStatus() != "Pending")) {
	rsCutOffDate = new Date((appExpDate.getExpDate().getMonth() -2) + "!" + appExpDate.getExpDate().getDayOfMonth() + "!" + rsYear);
	}

if ((startDate < rsCutOffDate)) {
	newExpDate = dateAddMonths(rsExpDate,0,"Y");
	} else {
	newExpDate = dateAddMonths(rsExpDate,12,"Y");
	}

licEditExpInfo("Active",newExpDate);
lic = new licenseObject(capIDString);
if (lic) {
	lic.setIssued(dateAdd("",0));
	lic.setExpiration(newExpDate);
	}

if ((appMatch("Licenses!Health!~!~") || appMatch("Licenses!Fire!~!~") || appMatch("Licenses!Clerk!~!~")) && appMatch("Licenses!Health!DischofNonStrmwtr!Madison") == false && appMatch("Licenses!Health!Temp Food Establishment!DaneCounty") == false) {
	aa.set.add("CL LIC DAILY",capId);
	}
`^
CMN;LICENSE;ExpMarch1^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var dtBaseDate = null;
var currExpDate = null;
var compareDate = null;
if (callProc == "workflow") {
	dtBaseDate = new Date(wfDateMMDDYYYY);
	}

if (callProc == "AppStatus") {
	currExpDate = new Date(AInfo['LICENSE INFORMATION.License Expiration Date']);
	}

if (!! ~~ Assuming cut-off month!day is always 1!1 unless told otherwise.) {
	}

if (callProc == "AppStatus") {
	compareDate = "1!1!" + currExpDate.getFullYear();
	logDebug("compareDate = " + compareDate);
	}

if (callProc == "AppStatus" && (new Date() > new Date(compareDate))) {
	dtBaseDate = new Date(AInfo['LICENSE INFORMATION.License Expiration Date']);
	} else {
	dtBaseDate = new Date();
	}

var currentYear = dtBaseDate.getFullYear();
var expYear = currentYear + 2;
logDebug("BaseDate = " + dtBaseDate + "");
var newExpDate = "3!1!" + expYear;
editAppSpecific("LICENSE INFORMATION.License Expiration Date",  newExpDate);
editAppSpecific("LICENSE INFORMATION.License Status", "Active");
licEditExpInfo ("Active", newExpDate);
showDebug = false;
`^
CMN;LICENSEBIISNP^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (inspType.toUpperCase() == "FINAL" && inspResult.toUpperCase() == "APPROVED") {
	closeTask("Building Inspection","Completed","","");
	}
`^
CMN;LicenseHolderUpdateFullNameWBusName^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var con = null;
var capContacts = aa.people.getCapContactByCapID(capId);
if (capContacts.getSuccess()) {
	conArray = capContacts.getOutput();
	}

if (conArray.length > 0) {
	for(var c in conArray) if (conArray[c].getPeople().contactType == "License Holder") con = conArray[c].getCapContactModel();
	}

if (con != null) {
	con.setFullName(con.getBusinessName());
	}

if (con != null) {
	aa.people.editCapContact(con);
	}
`^
CMN;LicenseIssuanceProcess^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (feesInvoicedTotal > 0 && balanceDue <= 0) {
	bLicenseIssued = true;
	} else {
	bLicenseIssued = false;
	}

if (bLicenseIssued == false) {
	include("EML;Licenses!~!~!~;LicenseNotIssued");
	logDebug("License NOT issued");
	}

if (bLicenseIssued) {
	closeTask("License Issuance", "Issued", "Closed by License Issuance script", "");
	}

if (bLicenseIssued) {
	updateTask("License Status", "Active", "Updated by License Issuance script", "");
	}

if (bLicenseIssued) {
	updateAppStatus("Active", "Updated by License Issuance script");
	}
`^
CMN;Licenses!~!~!~;UpdateReferenceLicensedProfessional^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
licProfType = appTypeArray[3];
contactType = "Contractor";
x = false;
if (licProfType.equals("Electrical Specialist")) {
	licProfType = "ELEC SPECIALIST";
	x = true;
	}

if (licProfType.equals("Maintenance Electrical")) {
	licProfType = "ELEC - MAINT.";
	x = true;
	}

if (licProfType.equals("Electrical Heating")) {
	licProfType = "HTG - ELEC HEAT";
	x = true;
	}

if (licProfType.equals("Hot Water Heating")) {
	licProfType = "HTG - HOT WATER";
	x = true;
	}

if (licProfType.equals("Serviceman Heating")) {
	licProfType = "HTG - SERVICE";
	x = true;
	}

if (licProfType.equals("Solar Heating")) {
	licProfType = "HTG - SOLAR";
	x = true;
	}

if (licProfType.equals("Master Electrician")) {
	licProfType = "ELEC - MASTER";
	x = true;
	}

if (licProfType.equals("Electrical Restriction")) {
	licProfType = "ELEC - MSTR RES";
	x = true;
	}

if (licProfType.equals("Warm Air Heating")) {
	licProfType = "HTG - WARM AIR";
	x = true;
	}

if (x != true) {
	licProfType = appTypeArray[2];
	contactType = "Contractor";
	}

if (licProfType.equals("Christmas Tree Lots")) {
	licProfType = "XMAS TREE LOTS";
	x = true;
	}

if (licProfType.equals("General Contractor") && appTypeArray[3] == "Na") {
	licProfType = "GENERAL";
	x = true;
	}

if (licProfType.equals("General Contractor") && appTypeArray[3] == "Mail") {
	licProfType = "GENERAL MAIL";
	x = true;
	}

if (licProfType.equals("Plumbing")) {
	licProfType = "PLUMBING";
	x = true;
	}

if (licProfType.equals("Sign")) {
	licProfType = "STREET GRAPHIC";
	x = true;
	}

if (licProfType.equals("FIRE EXT MAINT")) {
	licProfType = "FIRE EXT MAINT";
	x = true;
	}

if (x) {
	createRefLicProf(capIDString,licProfType,contactType);
	}

expYear = "EVEN";
newExpDate = dateNextOccur("12","31","06!30!2009",expYear);
licEditExpInfo("Active",newExpDate);
if (x) {
	lic = new licenseObject(capIDString);
	}

if (x) {
	lic.setIssued(dateAdd("",0));
	}

if (x) {
	lic.setExpiration(newExpDate);
	}
`^
CMN;Licenses!~!~!~;UpdateReferenceLicensedProfessionalState^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
licProfType = appTypeArray[2];
contactType = "Contractor";
x= false;
if (licProfType.equals("Christmas Tree Lots")) {
	licProfType = "XMAS TREE LOTS";
	x = true;
	}

if (licProfType.equals("General Contractor") && appTypeArray[3] == "Na") {
	licProfType = "GENERAL";
	x = true;
	}

if (licProfType.equals("General Contractor") && appTypeArray[3] == "Mail") {
	licProfType = "GENERAL MAIL";
	x = true;
	}

if (licProfType.equals("Plumbing")) {
	licProfType = "PLUMBING";
	x = true;
	}

if (licProfType.equals("Sign")) {
	licProfType = "STREET GRAPHIC";
	x = true;
	}

if (licProfType.equals("FIRE EXT MAINT")) {
	licProfType = "FIRE EXT MAINT";
	x = true;
	}

if (x) {
	createReferenceLP(capIDString,licProfType,contactType);
	}

newExpDate = dateAdd("06!30!2011",0,"Y");
licEditExpInfo("Active",newExpDate);
if (x) {
	lic = new licenseObject(capIDString);
	}

if (x) {
	lic.setIssued(dateAdd("",0));
	}

if (x) {
	lic.setExpiration(newExpDate);
	}
`^
CMN;Licenses!Building Inspection!~!~;UpdateCityBondInfo^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var bUpdateFields = false;
var dtToday = new Date();
var iMonth = dtToday.getMonth() + 1;
var iDate = dtToday.getDate();
var iYear = dtToday.getFullYear();
var sCurrentDate = iMonth + "!" + iDate + "!" + iYear;
var sfeeCode = feeResult[feeItem].code;
var iAssessDtMonth =  feeResult[feeItem].applyDate.getMonth() + 1;
var iAssessDtDay = feeResult[feeItem].applyDate.getDate();
var iAssessDtYear = feeResult[feeItem].applyDate.getFullYear();
var sAssessDate = iAssessDtMonth + "!" + iAssessDtDay + "!" + iAssessDtYear;
if ((sfeeCode == "BONDING" || sfeeCode == "BONDS" || sfeeCode == "BOND") &&  sAssessDate == sCurrentDate) {
	bUpdateFields = true;
	}

if (bUpdateFields) {
	if(iMonth > 4) iYear = iYear + 1;
	}

if (bUpdateFields) {
	editAppSpecific("INSURANCE INFORMATION.Bonded Begin Date", sAssessDate);
	}

if (bUpdateFields) {
	var bondEndDt = "6!30!" + iYear;
	editAppSpecific("INSURANCE INFORMATION.Bonded End Date", bondEndDt);
	}

if (bUpdateFields) {
	editAppSpecific("INSURANCE INFORMATION.Bond Company", "CITY OF MADISON");
	}

if (bUpdateFields) {
	editAppSpecific("INSURANCE INFORMATION.Bond Number", "");
	}

if (bUpdateFields) {
	editRefLicProfAttribute(capIDString, "BOND START DATE", sAssessDate);
	}

if (bUpdateFields) {
	editRefLicProfAttribute(capIDString, "BOND END DATE", bondEndDt);
	}

if (bUpdateFields) {
	editRefLicProfAttribute(capIDString, "BOND COMPANY", "CITY OF MADISON");
	}

if (bUpdateFields) {
	editRefLicProfAttribute(capIDString, "BOND NUMBER", "");
	}
`^
CMN;Licenses!Building Inspection!~;UpdateRefProfessional^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
bElec = false;
licProfType = appTypeArray[3];
contactType = "Contractor";
licProfTypeValue = "None";
if (licProfType.equals("Electrical Specialist")) {
	licProfTypeValue = "ELEC SPECIALIST";
	bElec = true;
	}

if (licProfType.equals("Maintenance Electrical")) {
	licProfTypeValue = "ELEC - MAINT.";
	bElec = true;
	}

if (licProfType.equals("Electrical Heating")) {
	licProfTypeValue = "HTG - ELEC HEAT";
	}

if (licProfType.equals("Hot Water Heating")) {
	licProfTypeValue = "HTG - HOT WATER";
	}

if (licProfType.equals("Serviceman Heating")) {
	licProfTypeValue = "HTG - SERVICE";
	}

if (licProfType.equals("Solar Heating")) {
	licProfTypeValue = "HTG - SOLAR";
	}

if (licProfType.equals("Master Electrician")) {
	licProfTypeValue = "ELEC - MASTER";
	bElec = true;
	}

if (licProfType.equals("Electrical Restriction")) {
	licProfTypeValue = "ELEC - MSTR RES";
	bElec = true;
	}

if (licProfType.equals("Warm Air Heating")) {
	licProfTypeValue = "HTG - WARM AIR";
	}

if (licProfTypeValue == "None") {
	licProfType = appTypeArray[2];
	}

if (licProfType.equals("Christmas Tree Lots")) {
	licProfTypeValue = "XMAS TREE LOTS";
	}

if (licProfType.equals("General Contractor")) {
	licProfTypeValue = "GENERAL";
	}

if (licProfType.equals("Plumbing")) {
	licProfTypeValue = "PLUMBING";
	}

if (licProfType.equals("Sign")) {
	licProfTypeValue = "STREET GRAPHIC";
	}

if (licProfType.equals("FIRE EXT MAINT")) {
	licProfTypeValue = "FIRE EXT MAINT";
	}

if (licProfType.equals("PREQUALIFIED")) {
	licProfTypeValue = "PREQUALIFIED";
	}

if (licProfTypeValue != "None") {
	createRefLicProf(capIDString,licProfTypeValue,contactType);
	}

if (AInfo['INSURANCE INFORMATION.Bond Company'] != null && licProfTypeValue != "None") {
	editRefLicProfAttribute(capIDString, "BOND COMPANY", AInfo['INSURANCE INFORMATION.Bond Company']);
	}

if (AInfo['INSURANCE INFORMATION.Bonded Begin Date'] != null && licProfTypeValue != "None") {
	editRefLicProfAttribute(capIDString, "BOND START DATE", AInfo['INSURANCE INFORMATION.Bonded Begin Date']);
	}

if (AInfo['INSURANCE INFORMATION.Bonded End Date'] != null && licProfTypeValue != "None") {
	editRefLicProfAttribute(capIDString, "BOND END DATE", AInfo['INSURANCE INFORMATION.Bonded End Date']);
	}

if (AInfo['INSURANCE INFORMATION.Bond Number'] != null && licProfTypeValue != "None") {
	editRefLicProfAttribute(capIDString, "BOND NUMBER", AInfo['INSURANCE INFORMATION.Bond Number']);
	}

if (!bElec && AInfo['LICENSE INFORMATION.Renewal Letter'] == "Yes" && licProfTypeValue != "None") {
	editRefLicProfAttribute(capIDString, "RENEWAL LETTER?", AInfo['LICENSE INFORMATION.Renewal Letter']);
	}

if (!bElec && AInfo['LICENSE INFORMATION.Renewal Letter'] == "No" && licProfTypeValue != "None") {
	editRefLicProfAttribute(capIDString, "RENEWAL LETTER?", AInfo['LICENSE INFORMATION.Renewal Letter']);
	}

if (!bElec && AInfo['LICENSE INFORMATION.Renewal Letter'] == "Yes" && licProfTypeValue != "None") {
	editRefLicProfAttribute(capIDString, "MAIL RENEWAL?", AInfo['LICENSE INFORMATION.Renewal Letter']);
	}

if (!bElec && AInfo['LICENSE INFORMATION.Renewal Letter'] == "No" && licProfTypeValue != "None") {
	editRefLicProfAttribute(capIDString, "MAIL RENEWAL?", AInfo['LICENSE INFORMATION.Renewal Letter']);
	}
`^
CMN;Licenses!Building Inspection!Foreclosure Registration!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var regDate = "";
var insDate = "";
regDate = new Date(AInfo['GENERAL INFORMATION.Date Registered']);
insDate = new Date(AInfo['GENERAL INFORMATION.Date Inspection Confirmed Vacant']);
intDiff = Math.ceil(regDate.getTime() - insDate.getTime())!86400000;
logDebug("Diff is;"+intDiff);
if (intDiff <=5) {
	if(feeExists("BIFORE1","NEW","INVOICED") == false) updateFee("BIFORE1","BIFORE","FINAL",1,"Y","N");
	}

if (intDiff > 5) {
	if(feeExists("BIFORE2","NEW","INVOICED") == false) updateFee("BIFORE2","BIFORE","FINAL",1,"Y","N");
	}
`^
CMN;Licenses!Building Inspection!Landlord Registration!Bundle;RenewalInfo^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var appExpDate = aa.expiration.getLicensesByCapID(capId).getOutput();
rsYear = startDate.getFullYear();
rsExpDate = new Date(appExpDate.getExpDate().getMonth() + "!" + appExpDate.getExpDate().getDayOfMonth() + "!" + rsYear);
newExpDate = dateAddMonths(rsExpDate,12,"Y");
licEditExpInfo(null, newExpDate);
`^
CMN;Licenses!Building Inspection!Landlord Registration!NA;ASIValidation^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
var msg = "False";
`^
CMN;Licenses!Building Inspection!Landlord Registration!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (getParent()) {
	include("CMN;GetAPOAddress");
	addFeeWithExtraData("LICLR","LICLR","FINAL",1,"Y",getParent(),APOAddress);
	} else {
	updateFee("LICLR","LICLR","FINAL",1,"Y","N");
	}
`^
CMN;Licenses!Building Inspection!Landlord Registration!Renewal;UpdateRenwal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
capO = null;
capOwner = null;
readyRenew = false;
parentCapId = getParentLicenseCapID(capId);
taskCloseAllExcept("Closed","Comment");
updateAppStatus("Closed");
copyASIFields(capId, parentCapId, "Municipality");
if (parentCapId) {
	readyRenew = aa.expiration.isExpiredLicenses(parentCapId);
	}

aa.cap.updateAccessByACA(capId, "N");
if (readyRenew) {
	rsEXPStatus = "Active";
	holdCapId = capId;
	capId = parentCapId;
	}

if (readyRenew) {
	include("CMN;GENERIC;ExpDec31");
	updateAppStatus("Registered");
	}

if (readyRenew) {
	capOwner = aa.owner.getParcelOwnersByCap(capId);
	}

if (readyRenew) {
	capO = aa.owner.getOwnerByCapId(capId);
	}

if (capO != null) {
	capOMod = capO.getOutput();
	aa.owner.removeCapOwnerModel(capOMod[0]);
	}

if (capOwner != null) {
	capOwnerMod = capOwner.getOutput();
	aa.owner.createCapOwnerWithAPOAttribute(capOwnerMod[0]);
	}

if (readyRenew) {
	capId = holdCapId;
	}

pConArray = getContactArray(parentCapId);
if (pConArray != null) {
	for (pC in pConArray) include("CMN;ContactRemovefromParentCapId");
	}

copyContacts(capId,parentCapId);
if (publicUser == false) {
	reportName = "RPEC Receipt Posting";
	include("CMN;RUN_REPORT_NO_MSG");
	}
`^
CMN;Licenses!Building Inspection!Landlord Registration;ProcessChildren^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
updateTask("Registration Status","Registered","","","",childsLICLR[eachrecord]);
`^
CMN;Licenses!Building Inspection!Landlord Registration;ProcessParent^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug=false;
elementArray=new Array();
elementArray["License Number"]=capIDString;
addToASITable("RELATEDCAPS",ParentCapModel);
ParentCapModel = aa.cap.getCapID(RELATEDCAPS[eachrow]["License Number"]);
logDebug(RELATEDCAPS[eachrow]["License Number"]);
`^
CMN;Licenses!Civil Rights!AA Plan!CBO;LoopGroups^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
asiGroup = aGroup.next();
if (asiGroup.groupName == groupName) {
	aFields = asiGroup.getFields().iterator();
	}

if (asiGroup.groupName == groupName) {
	while (aFields.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!CBO;PageNumber");
	}
`^
CMN;Licenses!Civil Rights!AA Plan!CBO;PageNumber^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
f = aFields.next();
if (f.getFieldLabel() == "PageNumber") {
	f.setChecklistComment(pgNum);
	}
`^
CMN;Licenses!Civil Rights!AA Plan!Developer;LoopGroups^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
asiGroup = aGroup.next();
if (asiGroup.groupName == groupName) {
	aFields = asiGroup.getFields().iterator();
	}

if (asiGroup.groupName == groupName) {
	while (aFields.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Developer;PageNumber");
	}
`^
CMN;Licenses!Civil Rights!AA Plan!Developer;PageNumber^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
f = aFields.next();
if (f.getFieldLabel() == "PageNumber") {
	f.setChecklistComment(pgNum);
	}
`^
CMN;Licenses!Civil Rights!AA Plan!Public Works;CreateWAGSTable^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
jobCatAry = new Array();
wagsValueAry = new Array();
include("CMN;AAPLAN_JOBCAT_LIST");
for (i = 0;
i < jobCatAry.length;
i++) include("CMN;Licenses!Civil Rights!AA Plan!Public Works;CreateWAGSValues");
r = createASITable4AAPlan(jobCatAry, wagsValueAry);
r = createASITable4AAPlan(jobCatAry, wagsValueAry);
`^
CMN;Licenses!Civil Rights!AA Plan!Public Works;CreateWAGSValues^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var table = aa.appSpecificTableScript.getAppSpecificTableModel(capId, "WORKFORCE ANALYSIS AND GOALS").getOutput().getAppSpecificTableModel();
coli = table.getColumns().iterator();
while(coli.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Public Works;CreateWAGSValuesLoop");
`^
CMN;Licenses!Civil Rights!AA Plan!Public Works;CreateWAGSValuesLoop^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var c = coli.next();
if (c.getColumnName().equals("Job Category")) {
	wagsValueAry.push(jobCatAry[i]);
	}

if (c.getColumnName().equals("No. of Employees 1 year ago")) {
	wagsValueAry.push(0);
	}

if (c.getColumnName().equals("Percent 1 year ago")) {
	wagsValueAry.push(0);
	}

if (c.getColumnName().equals("No. of Employees Hired During Past Year")) {
	wagsValueAry.push(0);
	}

if (c.getColumnName().equals("No. of Employees Who Left During Past Year")) {
	wagsValueAry.push(0);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Officials and Managers; TOTAL EMPLOYEES")) {
	wagsValueAry.push(totOff);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Officials and Managers; Racial!Ethnic AA Group")) {
	wagsValueAry.push(totOffR);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Officials and Managers; Women")) {
	wagsValueAry.push(totOffW);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Officials and Managers; With a Disability")) {
	wagsValueAry.push(totOffD);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Professionals; TOTAL EMPLOYEES")) {
	wagsValueAry.push(totPro);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Professionals; Racial!Ethnic AA Group")) {
	wagsValueAry.push(totProR);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Professionals; Women")) {
	wagsValueAry.push(totProW);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Professionals; With a Disability")) {
	wagsValueAry.push(totProD);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Technicians; TOTAL EMPLOYEES")) {
	wagsValueAry.push(totTech);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Technicians; Racial!Ethnic AA Group")) {
	wagsValueAry.push(totTechR);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Technicians; Women")) {
	wagsValueAry.push(totTechW);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Technicians; With a Disability")) {
	wagsValueAry.push(totTechD);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Sales; TOTAL EMPLOYEES")) {
	wagsValueAry.push(totSales);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Sales; Racial!Ethnic AA Group")) {
	wagsValueAry.push(totSalesR);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Sales; Women")) {
	wagsValueAry.push(totSalesW);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Sales; With a Disability")) {
	wagsValueAry.push(totSalesD);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Clerical and Admin. Support; TOTAL EMPLOYEES")) {
	wagsValueAry.push(totClerk);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Clerical and Admin. Support; Racial!Ethnic AA Group")) {
	wagsValueAry.push(totClerkR);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Clerical and Admin. Support; Women")) {
	wagsValueAry.push(totClerkW);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Clerical and Admin. Support; With a Disability")) {
	wagsValueAry.push(totClerkD);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Craft Workers; TOTAL EMPLOYEES")) {
	wagsValueAry.push(totCraft);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Craft Workers; Racial!Ethnic AA Group")) {
	wagsValueAry.push(totCraftR);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Craft Workers; Women")) {
	wagsValueAry.push(totCraftW);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Craft Workers; With a Disability")) {
	wagsValueAry.push(totCraftD);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Operatives; TOTAL EMPLOYEES")) {
	wagsValueAry.push(totOper);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Operatives; Racial!Ethnic AA Group")) {
	wagsValueAry.push(totOperR);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Operatives; Women")) {
	wagsValueAry.push(totOperW);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Operatives; With a Disability")) {
	wagsValueAry.push(totOperD);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Laborers, Helpers, Material Handlers; TOTAL EMPLOYEES")) {
	wagsValueAry.push(totLab);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Laborers, Helpers, Material Handlers; Racial!Ethnic AA Group")) {
	wagsValueAry.push(totLabR);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Laborers, Helpers, Material Handlers; Women")) {
	wagsValueAry.push(totLabW);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Laborers, Helpers, Material Handlers; With a Disability")) {
	wagsValueAry.push(totLabD);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Service Workers; TOTAL EMPLOYEES")) {
	wagsValueAry.push(totSer);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Service Workers; Racial!Ethnic AA Group")) {
	wagsValueAry.push(totSerR);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Service Workers; Women")) {
	wagsValueAry.push(totSerW);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("Service Workers; With a Disability")) {
	wagsValueAry.push(totSerD);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("TOTAL EMPLOYEES")) {
	wagsValueAry.push(totEmp);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("TOTAL RACIAL!ETHNIC AA GROUP EMPLOYEES")) {
	wagsValueAry.push(totR);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("TOTAL WOMEN EMPLOYEES")) {
	wagsValueAry.push(totF);
	}

if (c.getColumnName().equals("Current No. of Employees") && jobCatAry[i].equals("TOTAL EMPLOYEES WITH A DISABILITY")) {
	wagsValueAry.push(totDis);
	}

if (c.getColumnName().equals("Percent Current")) {
	wagsValueAry.push(100);
	}

if (c.getColumnName().equals("Est. No. of Employees to be Hired w!in Next Year")) {
	wagsValueAry.push(0);
	}

if (c.getColumnName().equals("Est. No. of Employees to Leave w!in Next Year")) {
	wagsValueAry.push(0);
	}

if (c.getColumnName().equals("Target Workforce")) {
	wagsValueAry.push(0);
	}

if (c.getColumnName().equals("Percent Target")) {
	wagsValueAry.push(0);
	}
`^
CMN;Licenses!Civil Rights!AA Plan!Public Works;GetFieldTotals^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (tblColi.hasNext() == false) {
	tblColi = tableGroup.getColumns().iterator();
	rowCount = rowCount + 1;
	totRow = 0;
	}

racial = false;
field = tblFieldi.next();
col = tblColi.next();
if (col.getColumnName() == "Job Category") {
	jobCat = field.getInputValue();
	}

if (col.getColumnName() == "Gender") {
	gender = field.getInputValue();
	}

if (col.getColumnName() == "Disabled") {
	disabled = field.getInputValue();
	}

if (field != "" && col.getColumnName() == "White (not of Hispanic origin)") {
	totW += Number(field.getInputValue());
	totRow+= Number(field.getInputValue());
	}

if (field != "" && col.getColumnName() == "Black (not of Hispanic origin)") {
	totB += Number(field.getInputValue());
	totRow += Number(field.getInputValue());
	racial = true;
	}

if (field != "" && col.getColumnName() == "Hispanic") {
	totH += Number(field.getInputValue());
	totRow += Number(field.getInputValue());
	racial = true;
	}

if (field != "" && col.getColumnName() == "Asian or Pacific Islander") {
	totA += Number(field.getInputValue());
	totRow += Number(field.getInputValue());
	racial = true;
	}

if (field != "" && col.getColumnName() == "American Indian or Alaskan Native") {
	totN += Number(field.getInputValue());
	totRow += Number(field.getInputValue());
	racial = true;
	}

if (field != "" && col.getColumnName() == "Two or More Races") {
	tot2 += Number(field.getInputValue());
	totRow += Number(field.getInputValue());
	racial = true;
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Officials and Managers") {
	if(gender == "Female") totOffW += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Officials and Managers") {
	if(disabled == "Yes") totOffD += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Officials and Managers") {
	if(racial) totOffR += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Professionals") {
	if(gender == "Female") totProW += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Professionals") {
	if(disabled == "Yes") totProD += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Professionals") {
	if(racial) totProR += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Technicians") {
	if(gender == "Female") totTechW += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Technicians") {
	if(disabled == "Yes") totTechD += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Technicians") {
	if(racial) totTechR += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Sales") {
	if(gender == "Female") totSalesW += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Sales") {
	if(disabled == "Yes") totSalesD += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Sales") {
	if(racial) totSalesR += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Clerical & Admin. Support") {
	if(gender == "Female") totClerkW += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Clerical & Admin. Support") {
	if(disabled == "Yes") totClerkD += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Clerical & Admin. Support") {
	if(racial) totClerkR += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Craft Workers") {
	if(gender == "Female") totCraftW += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Craft Workers") {
	if(disabled == "Yes") totCraftD += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Craft Workers") {
	if(racial) totCraftR += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Operatives") {
	if(gender == "Female") totOperW += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Operatives") {
	if(disabled == "Yes") totOperD += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Operatives") {
	if(racial) totOperR += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Laborers, Helpers & Material Handlers") {
	if(gender == "Female") totLabW += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Laborers, Helpers & Material Handlers") {
	if(disabled == "Yes") totLabD += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Laborers, Helpers & Material Handlers") {
	if(racial) totLabR += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Service Workers") {
	if(gender == "Female") totSerW += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Service Workers") {
	if(disabled == "Yes") totSerD += Number(field.getInputValue());
	}

if (field != "" && (col.getColumnName() == "White (not of Hispanic origin)" ||  col.getColumnName() == "Black (not of Hispanic origin)" || col.getColumnName() == "Hispanic" || col.getColumnName() == "Asian or Pacific Islander" || col.getColumnName() == "American Indian or Alaskan Native" || col.getColumnName() == "Two or More Races") && jobCat == "Service Workers") {
	if(racial) totSerR += Number(field.getInputValue());
	}

if (jobCat == "Officials and Managers" && col.getColumnName() == "Total") {
	totOff += Number(field.getInputValue());
	}

if (jobCat == "Professionals" && col.getColumnName() == "Total") {
	totPro += Number(field.getInputValue());
	}

if (jobCat == "Technicians" && col.getColumnName() == "Total") {
	totTech += Number(field.getInputValue());
	}

if (jobCat == "Sales" && col.getColumnName() == "Total") {
	totSales += Number(field.getInputValue());
	}

if (jobCat == "Craft Workers" && col.getColumnName() == "Total") {
	totCraft += Number(field.getInputValue());
	}

if (jobCat == "Operatives" && col.getColumnName() == "Total") {
	totOper += Number(field.getInputValue());
	}

if (jobCat == "Laborers, Helpers & Material Handlers" && col.getColumnName() == "Total") {
	totLab += Number(field.getInputValue());
	}

if (jobCat == "Service Workers" && col.getColumnName() == "Total") {
	totSer += Number(field.getInputValue());
	}

if (jobCat == "Clerical & Admin. Support" && col.getColumnName() == "Total") {
	totClerk += Number(field.getInputValue());
	}

if (gender == "Female") {
	if(col.getColumnName() == "Total") totF += Number(field.getInputValue());
	} else {
	if(col.getColumnName() == "Total") totM += Number(field.getInputValue());
	}

if (disabled == "Yes" && col.getColumnName() == "Total") {
	totDis += Number(field.getInputValue());
	}

if (col.getColumnName() == "Total") {
	totEmp += Number(field.getInputValue());
	}
`^
CMN;Licenses!Civil Rights!AA Plan!Public Works;LoopGroups^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
asiGroup = aGroup.next();
if (asiGroup.groupName == groupName) {
	aFields = asiGroup.getFields().iterator();
	}

if (asiGroup.groupName == groupName) {
	while (aFields.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Public Works;PageNumber");
	}
`^
CMN;Licenses!Civil Rights!AA Plan!Public Works;PageNumber^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
f = aFields.next();
if (f.getFieldLabel() == "PageNumber") {
	f.setChecklistComment(pgNum);
	}
`^
CMN;Licenses!Civil Rights!AA Plan!Public Works;UpdateWAGSTable^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aTable = aTablei.next();
if (aTable.getTableName().equals("WORKFORCE ANALYSIS AND GOALS")) {
	tfs = aTable.getTableFields();
	tfsi = tfs.iterator();
	}

if (aTable.getTableName().equals("WORKFORCE ANALYSIS AND GOALS")) {
	tblColi = aTable.getColumns().iterator();
	}

if (aTable.getTableName().equals("WORKFORCE ANALYSIS AND GOALS")) {
	while (tfsi.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Public Works;UpdateWAGSTableLoop");
	}

if (aTable.getTableName().equals("WORKFORCE ANALYSIS AND GOALS")) {
	cap.setAppSpecificTableGroupModel(aModel);
	!!aa.env.setValue("CapModel", cap);
	}
`^
CMN;Licenses!Civil Rights!AA Plan!Public Works;UpdateWAGSTableLoop^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (tblColi.hasNext() == false) {
	tblColi = aTable.getColumns().iterator();
	}

f = tfsi.next();
col = tblColi.next();
if (col.getColumnName().equals("Job Category")) {
	jobCat = f.getInputValue();
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Officials and Managers; TOTAL EMPLOYEES")) {
	f.setInputValue(parseInt(totOff));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Officials and Managers; Racial!Ethnic AA Group")) {
	f.setInputValue(parseInt(totOffR));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Officials and Managers; Women")) {
	f.setInputValue(parseInt(totOffW));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Officials and Managers; With a Disability")) {
	f.setInputValue(parseInt(totOffD));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Professionals; TOTAL EMPLOYEES")) {
	f.setInputValue(parseInt(totPro));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Professionals; Racial!Ethnic AA Group")) {
	f.setInputValue(parseInt(totProR));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Professionals; Women")) {
	f.setInputValue(parseInt(totProW));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Professionals; With a Disability")) {
	f.setInputValue(parseInt(totProD));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Technicians; TOTAL EMPLOYEES")) {
	f.setInputValue(parseInt(totTech));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Technicians; Racial!Ethnic AA Group")) {
	f.setInputValue(parseInt(totTechR));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Technicians; Women")) {
	f.setInputValue(parseInt(totTechW));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Technicians; With a Disability")) {
	f.setInputValue(parseInt(totTechD));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Sales; TOTAL EMPLOYEES")) {
	f.setInputValue(parseInt(totSales));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Sales; Racial!Ethnic AA Group")) {
	f.setInputValue(parseInt(totSalesR));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Sales; Women")) {
	f.setInputValue(parseInt(totSalesW));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Sales; With a Disability")) {
	f.setInputValue(parseInt(totSalesD));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Clerical and Admin. Support; TOTAL EMPLOYEES")) {
	f.setInputValue(parseInt(totClerk));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Clerical and Admin. Support; Racial!Ethnic AA Group")) {
	f.setInputValue(parseInt(totClerkR));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Clerical and Admin. Support; Women")) {
	f.setInputValue(parseInt(totClerkW));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Clerical and Admin. Support; With a Disability")) {
	f.setInputValue(parseInt(totClerkD));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Craft Workers; TOTAL EMPLOYEES")) {
	f.setInputValue(parseInt(totCraft));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Craft Workers; Racial!Ethnic AA Group")) {
	f.setInputValue(parseInt(totCraftR));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Craft Workers; Women")) {
	f.setInputValue(parseInt(totCraftW));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Craft Workers; With a Disability")) {
	f.setInputValue(parseInt(totCraftD));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Operatives; TOTAL EMPLOYEES")) {
	f.setInputValue(parseInt(totOper));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Operatives; Racial!Ethnic AA Group")) {
	f.setInputValue(parseInt(totOperR));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Operatives; Women")) {
	f.setInputValue(parseInt(totOperW));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Operatives; With a Disability")) {
	f.setInputValue(parseInt(totOperD));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Laborers, Helpers, Material Handlers; TOTAL EMPLOYEES")) {
	f.setInputValue(parseInt(totLab));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Laborers, Helpers, Material Handlers; Racial!Ethnic AA Group")) {
	f.setInputValue(parseInt(totLabR));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Laborers, Helpers, Material Handlers; Women")) {
	f.setInputValue(parseInt(totLabW));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Laborers, Helpers, Material Handlers; With a Disability")) {
	f.setInputValue(parseInt(totLabD));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Service Workers; TOTAL EMPLOYEES")) {
	f.setInputValue(parseInt(totSer));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Service Workers; Racial!Ethnic AA Group")) {
	f.setInputValue(parseInt(totSerR));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Service Workers; Women")) {
	f.setInputValue(parseInt(totSerW));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("Service Workers; With a Disability")) {
	f.setInputValue(parseInt(totSerD));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("TOTAL EMPLOYEES")) {
	f.setInputValue(parseInt(totEmp));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("TOTAL RACIAL!ETHNIC AA GROUP EMPLOYEES")) {
	f.setInputValue(parseInt(totR));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("TOTAL WOMEN EMPLOYEES")) {
	f.setInputValue(parseInt(totF));
	}

if (col.getColumnName().equals("Current No. of Employees") && jobCat.equals("TOTAL EMPLOYEES WITH A DISABILITY")) {
	f.setInputValue(parseInt(totDis));
	}
`^
CMN;Licenses!Civil Rights!AA Plan!Vendors and Suppliers;LoopGroups^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
asiGroup = aGroup.next();
if (asiGroup.groupName == groupName) {
	aFields = asiGroup.getFields().iterator();
	}

if (asiGroup.groupName == groupName) {
	while (aFields.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Vendors and Suppliers;PageNumber");
	}
`^
CMN;Licenses!Civil Rights!AA Plan!Vendors and Suppliers;PageNumber^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
f = aFields.next();
if (f.getFieldLabel() == "PageNumber") {
	f.setChecklistComment(pgNum);
	}
`^
CMN;Licenses!Clerk!AmusementDevice!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (AInfo['GENERAL INFORMATION.Number of Amusement Devices'] != null) {
	if(feeExists("LIC_RENEWAL") == false) updateFee("LIC_RENEWAL","LICAD","FINAL",1,"N");
	} else {
	if(feeExists("LIC_RENEWAL") == true) removeFee("LIC_RENEWAL","FINAL");
	}
`^
CMN;Licenses!Clerk!HorseDrawnOrPedalCab!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['OFFICE USE ONLY.Provisional Expiration Date'] != null) {
	if(feeExists("PROVHDC") == false) updateFee("PROVHDC","LICHDV","FINAL",1,"N");
	} else {
	if(feeExists("PROVHDC") == true) removeFee("PROVHDC","FINAL");
	}
`^
CMN;Licenses!Clerk!MallSecondHandDealer!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (AInfo['GENERAL INFORMATION.Mall or Flea Market Special Event Dates (up to 3 days)'] && AInfo['GENERAL INFORMATION.Mall or Flea Market Special Event Dates (up to 3 days)'] != "") {
	removeAllFees(capId);
	updateFee("SHDSPEC","LICMSHD","FINAL",1,"N");
	} else {
	removeFee("SHDSPEC","FINAL");
	}
`^
CMN;Licenses!Clerk!Operator!NA;ContactRemove^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
aa.people.removeCapContact(parentCapId, pConArray[pC].contactSeqNumber);
`^
CMN;Licenses!Clerk!Operator!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
invoiceFees = "Y";
currentDate = new Date();
!!currentDate = new Date("5!1!2016");
here for testing;
beginningYear = new Date("01!01!" + currentDate.getFullYear());
endYear = new Date("01!01!" + (currentDate.getFullYear() + 1));
currentYear = currentDate.getFullYear();
expireYear = currentYear%2;
if (expireYear == 1) {
	cutoffDate = new Date("05!01!" + currentDate.getFullYear());
	} else {
	cutoffDate = new Date("05!01!" + currentDate.getFullYear());
	}

if (expireYear == 0 && (currentDate >= beginningYear && currentDate <= cutoffDate) && !feeExists("OPRY2", "INVOICED")) {
	updateFee("OPRY2","LICOPR","FINAL",1, invoiceFees);
	logDebug("OPRY1 " + feeExists("OPRY2"));
	}

if (expireYear == 0 && (currentDate > cutoffDate && currentDate <= endYear) && !feeExists("OPRA", "INVOICED")) {
	updateFee("OPRA","LICOPR","FINAL",1, invoiceFees);
	}

if (expireYear == 1 && (currentDate >= beginningYear && currentDate <= cutoffDate) && !feeExists("OPRA", "INVOICED")) {
	updateFee("OPRA","LICOPR","FINAL",1, invoiceFees);
	}

if (expireYear == 1 && (currentDate > cutoffDate && currentDate <= endYear) && !feeExists("OPRY2", "INVOICED")) {
	updateFee("OPRY2","LICOPR","FINAL",1, invoiceFees);
	}

if (AInfo['OFFICE USE ONLY.Provisional Expiration Date'] != null || getAppSpecific("ADDITIONAL APPLICANT INFO.Do you need a provisional license") == "Yes" && !feeExists("OPRP", "INVOICED")) {
	updateFee("OPRP","LICOPR","FINAL",1, invoiceFees);
	}

logDebug("currentDate;"+currentDate+ " cutoff date;"+ cutoffDate + " end Year;"+endYear);
`^
CMN;Licenses!Clerk!Operator!NA;LicenseIssueActions^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (feesInvoicedTotal > 0 && balanceDue <= 0) {
	licIssued = true;
	} else {
	licIssued = false;
	}

if (!licIssued) {
	include("EML;Licenses!~!~!~;LicenseNotIssued");
	}

include("EML;GetContactEmail");
if ((contactEmail == "" || contactEmail == null)) {
	aa.set.add("CL LIC DAILY",capId);
	}

if (licIssued) {
	include("CMN;LICENSE;2YrExpJune30");
	}

if (licIssued && contactEmail != "" && contactEmail != null) {
	include("EML;Licenses!Clerk!Operator!NA;LicenseIssued");
	}

if (licIssued && isTaskStatus("License Status", "Active") == false) {
	updateTask("License Status", "Active", "Updated By License Issuance script", "");
	}

if (licIssued) {
	closeTask("License Issuance", "Issued", "Closed by License Issuance script", "");
	}

if (licIssued) {
	updateTask("License Status", "Active", "Updated by License Issuance script", "");
	}
`^
CMN;Licenses!Clerk!Operator!Renewal;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
invoicedFees = "Y";
proj = aa.cap.getProjectByChildCapID(capId, "Renewal", "Incomplete");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	parentCapId = proj[0].getProjectID();
	}

if (!feeExists("LIC_RENEWAL", "INVOICED")) {
	updateFee("LIC_RENEWAL","LICOPRR","FINAL",1, invoicedFees);
	}

lic = aa.expiration.getLicensesByCapID(parentCapId).getOutput();
licExpDate = lic.getExpDate();
filedDate = new Date(fileDate);
expDate = new Date(lic.getExpDate().getMonth() + "!" + lic.getExpDate().getDayOfMonth() + "!" + lic.getExpDate().getYear() );
if (filedDate > expDate && !feeExists("PENALTY", "INVOICED")) {
	updateFee("PENALTY","LICOPRR","FINAL",1, invoicedFees);
	}
`^
CMN;Licenses!Clerk!ParaTransitOperating!~;UpdateRefProfessional^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
createRefLicProf(capIDString,"TAXI CAB COMPANY","Applicant");
`^
CMN;Licenses!Clerk!Scrap-Recycling!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = true;
if (AInfo['LICENSE TYPE(S).Collector (Scrap!Recycling)'] == "CHECKED") {
	updateFee("COLLECTOR","LICRCY","FINAL",1,"N");
	} else {
	removeFee("COLLECTOR","FINAL");
	}

if (AInfo['LICENSE TYPE(S).Yard, Haulers, Towing Businesses & Dealers'] == "CHECKED") {
	updateFee("YARDHAULTOW","LICRCY","FINAL",1,"N");
	} else {
	removeFee("YARDHAULTOW","FINAL");
	}

if (AInfo['LICENSE TYPE(S).Vehicle Storage Business'] == "CHECKED") {
	updateFee("VEHSTORE","LICRCY","FINAL",1,"N");
	} else {
	removeFee("VEHSTORE","FINAL");
	}
`^
cmn;Licenses!Clerk!SecondHandDealer!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (AInfo['GENERAL INFORMATION.Business Type'] == "Secondhand Article Dealer") {
	updateFee("SHD","LICSHD","FINAL",1,"N");
	} else {
	removeFee("SHD","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Business Type'] == "Pawnbroker") {
	updateFee("PAWNBROKER","LICSHD","FINAL",1,"N");
	} else {
	removeFee("PAWNBROKER","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Business Type'] == "Secondhand Jewelry Dealer") {
	updateFee("JEWELRY","LICSHD","FINAL",1,"N");
	} else {
	removeFee("JEWELRY","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Business Type'] == "Precious Metal Dealer") {
	updateFee("PRECIOUS","LICSHD","FINAL",1,"N");
	} else {
	removeFee("PRECIOUS","FINAL");
	}
`^
CMN;Licenses!Clerk!Theatre!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (AInfo['GENERAL INFORMATION.Seating Capacity'] != null) {
	if(feeExists("THE") == false) updateFee("THE","LICTHE","FINAL",1,"N");
	} else {
	if(feeExists("THE") == true) removeFee("THE","FINAL");
	}
`^
CMN;Licenses!DCR!AA Plan!NA;GetASIFields^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
fieldNames = "Fields; ";
field = asiFieldi.next();
fName = field.getFieldLabel();
fieldNames += fieldNames +", "+fName;
if (fName == "Total Black Employees") {
	field.setChecklistComment(totB);
	}

if (fName == "Total White Employees") {
	field.setChecklistComment(totW);
	}

if (fName == "Total Hispanic Employees") {
	field.setChecklistComment(totH);
	}

if (fName == "Total Asian or Pacific Islander Employees") {
	field.setChecklistComment(totA);
	}

if (fName == "Total American Indian or Alaskan Native Employees") {
	field.setChecklistComment(totN);
	}

if (fName == "Total Employees - Two or More Races") {
	field.setChecklistComment(tot2);
	}

if (fName == "Total Males") {
	field.setChecklistComment(totM);
	}

if (fName == "Total Females") {
	field.setChecklistComment(totF);
	}

if (fName == "Total Officials and Managers") {
	field.setChecklistComment(totOff);
	}

if (fName == "Total Professionals") {
	field.setChecklistComment(totPro);
	}

if (fName == "Total Technicians") {
	field.setChecklistComment(totTech);
	}

if (fName == "Total Clerical & Admin. Support Employees") {
	field.setChecklistComment(totClerk);
	}

if (fName == "Total Craft Workers") {
	field.setChecklistComment(totCraft);
	}

if (fName == "Total Operatives") {
	field.setChecklistComment(totOper);
	}

if (fName == "Total Laborers, Helpers & Material Handlers") {
	field.setChecklistComment(totLab);
	}

if (fName == "Total Service Workers") {
	field.setChecklistComment(totSer);
	}

if (fName == "Total Employees") {
	field.setChecklistComment(totEmp);
	}

if (fName == "Total Sales Employees") {
	field.setChecklistComment(totSales);
	}

if (fName == "Total Employees w! Disability") {
	field.setChecklistComment(totDis);
	}

if (fName == "Total Racial!Ethnic AA Group Employees") {
	field.setChecklistComment(totR);
	}

if (fName == "Percentage Women Employees") {
	field.setChecklistComment(perW);
	}

if (fName == "Percentage Racial!Ethnic AA Group Employees") {
	field.setChecklistComment(perR);
	}
`^
CMN;Licenses!DCR!AA Plan!NA;GetASIGroups^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
group = iCurAsiGroup.next();
groupName = group.getGroupName();
if (groupName == "TOTALS") {
	asiField = group.getFields();
	asiFieldi = asiField.iterator();
	}

if (groupName == "TOTALS") {
	while (asiFieldi.hasNext()) include("CMN;Licenses!DCR!AA Plan!NA;GetASIFields");
	}
`^
CMN;Licenses!DCR!AA Plan!NA;GetASITableGroups^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
tableGroup = iTable.next();
if (tableGroup.getTableName() == "WORKFORCE ANALYSIS AND GOALS" && tableGroup.getTableFields() == null) {
	createWAGS = true;
	}

if (tableGroup.getTableName() == "WORKFORCE HEAD COUNT" && tableGroup.getRowIndex() != "[]") {
	tblFieldi = tableGroup.getTableFields().iterator();
	}

if (tableGroup.getTableName() == "WORKFORCE HEAD COUNT" && tableGroup.getRowIndex() != "[]") {
	tblColi = tableGroup.getColumns().iterator();
	rowCount = 1;
	}

if (tableGroup.getTableName() == "WORKFORCE HEAD COUNT" && tableGroup.getRowIndex() != "[]") {
	while (tblFieldi.hasNext()) include("CMN;Licenses!Civil Rights!AA Plan!Public Works;GetFieldTotals");
	}

totR = totB + totH + totA + totN + tot2;
if (totR != 0 && totEmp != 0) {
	perR = String(Math.round(totR!totEmp~100~ 100) ! 100);
	}

if (totF != 0 && totEmp != 0) {
	perW= String(Math.round(totF!totEmp~100~ 100) ! 100);
	}
`^
CMN;Licenses!DCR!AA Plan!NA;getEmailAddrs^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
sToEmail = "";
sCcEmail = "";
sBizName = "";
bNoEmail = false;
myContactType = "Contractor";
contractorEmail = "";
contractorBizName = "";
include("EML;GetContactTypeEmail");
if (contactEmail != undefined && contactEmail != null && contactEmail != "nomail@cityofmadisonDEV.com") {
	contractorEmail = contactEmail;
	contractorBizName = businessName;
	}

myContactType = "EEO!AA Officer";
eeo_aa_Email = "";
eeo_aa_BizName = "";
include("EML;GetContactTypeEmail");
if (contactEmail != undefined && contactEmail != null && contactEmail != "nomail@cityofmadisonDEV.com") {
	eeo_aa_Email = contactEmail;
	eeo_aa_BizName = businessName;
	}

if (eeo_aa_Email != "") {
	sToEmail = eeo_aa_Email;
	if(contractorEmail != "") sCcEmail = contractorEmail;
	} else {
	if(contractorEmail != "")  sToEmail = contractorEmail;
	}

if (eeo_aa_BizName != "") {
	sBizName = eeo_aa_BizName;
	} else {
	if(contractorBizName != "") sBizName = contractorBizName;
	}

if (contractorEmail  == "" && eeo_aa_Email  == "") {
	bNoEmail = true;
	}
`^
CMN;Licenses!Engineering!Prequalified Contractor!Na;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
feeRequired = false;
if (getAppSpecific("SECTION I.Sewer Drain Cleaner") == "CHECKED") {
	feeRequired = true;
	}

if (getAppSpecific("SECTION I.Sewer CCTV Inspector") == "CHECKED") {
	feeRequired = true;
	}

if (getAppSpecific("SECTION I.Private Snow Removal Equipment Operator") == "CHECKED") {
	feeRequired = true;
	}

if (getAppSpecific("SECTION I.Tree pruning and removal (Certification required – see Sec.III)") == "CHECKED") {
	feeRequired = true;
	}

if (getAppSpecific("SECTION I.Trees - Pesticide treatment of (Certification required – see Sec.III)") == "CHECKED") {
	feeRequired = true;
	}

if (getAppSpecific("SECTION I.Lining of Sanitary Sewer Laterals") == "CHECKED") {
	feeRequired = true;
	}

if (feeRequired == true) {
	if(feeExists("LIC_FEE") == false) updateFee("LIC_FEE","LICPW","FINAL",1,"N");
	} else {
	if(feeExists("LIC_FEE") == true) removeFee("LIC_FEE","FINAL");
	}
`^
CMN;Licenses!Engineering!Prequalified Contractor!Na;GetAAPlanStatus^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
aaPlanTaskStatus = "";
type = false;
aaPlanNumber = getAppSpecific("CATEGORIES.AA Plan Number");
if (aaPlanNumber != null && aaPlanNumber != "") {
	aaPlanNumber = aaPlanNumber.toUpperCase();
	}

if (aaPlanNumber != null && aaPlanNumber != "") {
	type = aaPlanNumber.contains("AAEX");
	}

aaPlanCap = aa.cap.getCapID(aaPlanNumber);
if (aaPlanCap.getSuccess()) {
	addChild(aaPlanNumber);
	}

if (aaPlanCap.getSuccess() && !type) {
	aaPlanTaskStatus = aa.workflow.getTask(aaPlanCap.getOutput(), "AA Plan Review").getOutput().getTaskItem().getDisposition();
	}

if (aaPlanCap.getSuccess() && type) {
	aaPlanTaskStatus = aa.workflow.getTask(aaPlanCap.getOutput(), "AA Exemption Review").getOutput().getTaskItem().getDisposition();
	}

if (aaPlanTaskStatus.equals("Approved")) {
	closeTask("Affirmative Action Review", "Approved", "Current status of " + aaPlanNumber, "Current status of " + aaPlanNumber, "LIC_PREQUAL");
	}

if (aaPlanTaskStatus.equals("Denied")) {
	closeTask("Affirmative Action Review", "Denied", "Current status of " + aaPlanNumber , "Current status of " + aaPlanNumber, "LIC_PREQUAL");
	}

if (!isTaskComplete("Application Review", "LIC_PREQUAL")) {
	deactivateTask("License Issuance");
	}
`^
CMN;Licenses!Engineering!Prequalified Contractor!Na;LoopGroups^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
asiGroup = aGroup.next();
if (asiGroup.groupName == groupName) {
	aFields = asiGroup.getFields().iterator();
	}

if (asiGroup.groupName == groupName) {
	while (aFields.hasNext()) include("CMN;Licenses!Engineering!Prequalified Contractor!Na;PageNumber");
	}
`^
CMN;Licenses!Engineering!Prequalified Contractor!Na;PageNumber^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
f = aFields.next();
if (f.getFieldLabel() == "PageNumber") {
	f.setChecklistComment(pgNum);
	}
`^
CMN;Licenses!Engineering!Prequalified Contractor!Renewal;ContactRemove^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
aa.people.removeCapContact(parentCapId, pConArray[pC].contactSeqNumber);
`^
CMN;Licenses!Fire!SpecialHazards!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if(feeExists("SPECHAZ") == false) updateFee("SPECHAZ","FIRSPECHAZ","FINAL",1,"N");
`^
CMN;Licenses!Fire!SpecialOccupancy!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if(feeExists("SPECOCC") == false) updateFee("SPECOCC","FIRSPECOCC","FINAL",1,"N");
`^
CMN;Licenses!Health!~!~;CloseAllTasks^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (isTaskActive("Health Inspection")) {
	closeTask("Health Inspection","", "Closed via Script" , "");
	}

closeTask("License Issuance","", "Closed via Script" , "");
if (isTaskActive("License Status")) {
	closeTask("License Status","", "Closed via Script" , "");
	}

if (isTaskActive("Well or Septic Review")) {
	closeTask("Well or Septic Review","", "Closed via Script" , "");
	}
`^
cmn;Licenses!Health!BedAndBreakfast!~;LicenseRenewalFee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
updateFee("BNBPHMDC","LICBNB","FINAL",1,"N");
updateFee("BNBREIMB","LICBNB","FINAL",1,"N");
`^
CMN;Licenses!Health!Campgrounds!DaneCounty;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (AInfo['GENERAL INFORMATION.Number of sites in Campground'] != null) {
	if(feeExists("CMPPHMDC") == false) updateFee("CMPPHMDC","LICCMP","FINAL",1,"N");
	} else {
	if(feeExists("CMPPHMDC") == true) removeFee("CMPPHMDC","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Number of sites in Campground'] != null) {
	if(feeExists("CMPREIMB") == false) updateFee("CMPREIMB","LICCMP","FINAL",1,"N");
	} else {
	if(feeExists("CMPREIMB") == true) removeFee("CMPREIMB","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Number of sites in Campground'] != null  && isTaskActive("Intake")) {
	updateFee("CMPPI","LICCMP","FINAL",1,"N");
	}
`^
CMN;Licenses!Health!Campgrounds!DaneCounty;RenewalFee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (AInfo['GENERAL INFORMATION.Number of sites in Campground'] != null) {
	if(feeExists("CMPPHMDC") == false) updateFee("CMPPHMDC","LICCMP","FINAL",1,"N");
	} else {
	if(feeExists("CMPPHMDC") == true) removeFee("CMPPHMDC","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Number of sites in Campground'] != null) {
	if(feeExists("CMPREIMB") == false) updateFee("CMPREIMB","LICCMP","FINAL",1,"N");
	} else {
	if(feeExists("CMPREIMB") == true) removeFee("CMPREIMB","FINAL");
	}
`^
CMN;Licenses!Health!Campgrounds!Madison;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (AInfo['GENERAL INFORMATION.Number of sites in Campground'] != null) {
	if(feeExists("CMPPHMDC") == false) updateFee("CMPPHMDC","LICCMP","FINAL",1,"N");
	} else {
	if(feeExists("CMPPHMDC") == true) removeFee("CMPPHMDC","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Number of sites in Campground'] != null) {
	if(feeExists("CMPREIMB") == false) updateFee("CMPREIMB","LICCMP","FINAL",1,"N");
	} else {
	if(feeExists("CMPREIMB") == true) removeFee("CMPREIMB","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Number of sites in Campground'] != null  && isTaskActive("Intake")) {
	updateFee("CMPPI","LICCMP","FINAL",1,"N");
	}
`^
CMN;Licenses!Health!DischofNonStrmwtr!Madison;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (AInfo['WASTEWATER FLOW.Annual Discharge'] != null) {
	if(feeExists("DISCH") == false) updateFee("DISCH","LICDNSW","FINAL",1,"N");
	} else {
	if(feeExists("DISCH") == true) removeFee("DISCH","FINAL");
	}

if (feeExists("PREINSP","INVOICED")) {
	updateFee("PREINSP","LICDNSW","FINAL",1,"N");
	}
`^
CMN;Licenses!Health!HotelMotelTRH!DaneCounty;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
numberOfRooms = 0;
if (AInfo['GENERAL INFORMATION.Number of Rooms'] != null) {
	numberOfRooms = AInfo['GENERAL INFORMATION.Number of Rooms'];
	}

if (AInfo['GENERAL INFORMATION.Number of Rooms'] != null && AInfo['GENERAL INFORMATION.Rooming House'] != "CHECKED") {
	if(feeExists("HTLPHMDC") == false) updateFee("HTLPHMDC","LICHTL","FINAL",1,"N");
	} else {
	if(feeExists("HTLPHMDC") == true) removeFee("HTLPHMDC","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Number of Rooms'] != null && AInfo['GENERAL INFORMATION.Rooming House'] != "CHECKED" && isTaskActive("Intake")) {
	if(feeExists("HTLPI") == false) updateFee("HTLPI","LICHTL","FINAL",1,"N");
	} else {
	if(feeExists("HTLPI") == true) removeFee("HTLPI","FINAL");
	}

if ((numberOfRooms > 4)) {
	if(feeExists("HTLREIMB") == false) updateFee("HTLREIMB","LICHTL","FINAL",1,"N");
	} else {
	if(feeExists("HTLREIMB") == true) removeFee("HTLREIMB","FINAL");
	}

if ((numberOfRooms > 0 && numberOfRooms <= 4)) {
	if(feeExists("TRHREIMB") == false) updateFee("TRHREIMB","LICHTL","FINAL",1,"N");
	} else {
	if(feeExists("TRHREIMB") == true) removeFee("TRHREIMB","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Rooming House'] == "CHECKED") {
	updateFee("TRHPHMDC","LICHTL","FINAL",1,"N");
	} else {
	if(feeExists("TRHPHMDC") == true) removeFee("TRHPHMDC","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Rooming House'] == "CHECKED" && isTaskActive("Intake")) {
	if(feeExists("TRHPI") == false) updateFee("TRHPI","LICHTL","FINAL",1,"N");
	} else {
	if(feeExists("TRHPI") == true) removeFee("TRHPI","FINAL");
	}
`^
CMN;Licenses!Health!HotelMotelTRH!Madison;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL INFORMATION.Number of Rooms'] > 4) {
	if(feeExists("HTLPHMDC") == false) updateFee("HTLPHMDC","LICHTL","FINAL",1,"N");
	} else {
	if(feeExists("HTLPHMDC") == true) removeFee("HTLPHMDC","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Number of Rooms'] > 4) {
	if(feeExists("HTLREIMB") == false) updateFee("HTLREIMB","LICHTL","FINAL",1,"N");
	} else {
	if(feeExists("HTLREIMB") == true) removeFee("HTLREIMB","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Number of Rooms'] > 4 && isTaskActive("Intake")) {
	updateFee("HTLPI","LICHTL","FINAL",1,"N");
	}

if ((AInfo['GENERAL INFORMATION.Number of Rooms'] > 0 && AInfo['GENERAL INFORMATION.Number of Rooms'] <= 4)) {
	if(feeExists("TRHPHMDC") == false) updateFee("TRHPHMDC","LICHTL","FINAL",1,"N");
	} else {
	if(feeExists("TRHPHMDC") == true) removeFee("TRHPHMDC","FINAL");
	}

if ((AInfo['GENERAL INFORMATION.Number of Rooms'] > 0 && AInfo['GENERAL INFORMATION.Number of Rooms'] <= 4)) {
	if(feeExists("TRHREIMB") == false) updateFee("TRHREIMB","LICHTL","FINAL",1,"N");
	} else {
	if(feeExists("TRHREIMB") == true) removeFee("TRHREIMB","FINAL");
	}

if ((AInfo['GENERAL INFORMATION.Number of Rooms'] > 0 && AInfo['GENERAL INFORMATION.Number of Rooms'] <= 4) && isTaskActive("Intake")) {
	updateFee("TRHPI","LICHTL","FINAL",1,"N");
	}
`^
CMN;Licenses!Health!MobileHomePark!DaneCounty;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (AInfo['GENERAL INFORMATION.Number of Mobile Home Spaces'] != null) {
	if(feeExists("MHPPHMDC") == false) updateFee("MHPPHMDC","LICMHP","FINAL",1,"N");
	} else {
	if(feeExists("MHPPHMDC") == true) removeFee("MHPPHMDC","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Number of Mobile Home Spaces'] != null && isTaskActive("Intake")) {
	if(feeExists("MHPPI") == false) updateFee("MHPPI","LICMHP","FINAL",1,"N");
	}

if (AInfo['GENERAL INFORMATION.Number of Mobile Home Spaces'] != null) {
	if(feeExists("MHPREIMB") == false) updateFee("MHPREIMB","LICMHP","FINAL",1,"N");
	} else {
	if(feeExists("MHPREIMB") == true) removeFee("MHPREIMB","FINAL");
	}
`^
CMN;Licenses!Health!MobileHomePark!Madison;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (AInfo['GENERAL INFORMATION.Number of Mobile Home Spaces'] != null) {
	if(feeExists("MHPPHMDC") == false) updateFee("MHPPHMDC","LICMHP","FINAL",1,"N");
	} else {
	if(feeExists("MHPPHMDC") == true) removeFee("MHPPHMDC","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Number of Mobile Home Spaces'] != null && isTaskActive("Intake")) {
	if(feeExists("MHPPI") == false) updateFee("MHPPI","LICMHP","FINAL",1,"N");
	}

if (AInfo['GENERAL INFORMATION.Number of Mobile Home Spaces'] != null) {
	if(feeExists("MHPREIMB") == false) updateFee("MHPREIMB","LICMHP","FINAL",1,"N");
	} else {
	if(feeExists("MHPREIMB") == true) removeFee("MHPREIMB","FINAL");
	}
`^
CMN;Licenses!Health!RecreationEducationCamps!DaneCounty;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (AInfo['GENERAL INFORMATION.Number of Camps'] != null) {
	if(feeExists("RECMPPHMDC") == false) updateFee("RECMPPHMDC","LICRECMP","FINAL",1,"N");
	} else {
	if(feeExists("RECMPPHMDC") == true) removeFee("RECMPPHMDC","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Number of Camps'] != null) {
	if(feeExists("RECMPREIMB") == false) updateFee("RECMPREIMB","LICRECMP","FINAL",1,"N");
	} else {
	if(feeExists("RECMPREIMB") == true) removeFee("RECMPREIMB","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Number of Camps'] != null && isTaskActive("Intake")) {
	if(feeExists("RECMPPI") == false) updateFee("RECMPPI","LICRECMP","FINAL",1,"N");
	}
`^
CMN;Licenses!Health!RecreationEducationCamps!Madison;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (AInfo['GENERAL INFORMATION.Number of Camps'] != null) {
	if(feeExists("RECMPPHMDC") == false) updateFee("RECMPPHMDC","LICRECMP","FINAL",1,"N");
	} else {
	if(feeExists("RECMPPHMDC") == true) removeFee("RECMPPHMDC","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Number of Camps'] != null) {
	if(feeExists("RECMPREIMB") == false) updateFee("RECMPREIMB","LICRECMP","FINAL",1,"N");
	} else {
	if(feeExists("RECMPREIMB") == true) removeFee("RECMPREIMB","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Number of Camps'] != null && isTaskActive("Intake")) {
	if(feeExists("RECMPPI") == false) updateFee("RECMPPI","LICRECMP","FINAL",1,"N");
	}
`^
CMN;Licenses!Health!SwimmingPool!DaneCounty;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (AInfo['GENERAL INFORMATION.First Indoor Pool - Enter 1'] != null) {
	if(feeExists("ISWP1PHMDC") == false) updateFee("ISWP1PHMDC","LICSWP","FINAL",1,"N");
	} else {
	if(feeExists("ISWP1PHMDC") == true) removeFee("ISWP1PHMDC","FINAL");
	}

if (AInfo['GENERAL INFORMATION.First Indoor Pool - Enter 1'] != null && isTaskActive("Intake")) {
	if(feeExists("ISWP1PI") == false) updateFee("ISWP1PI","LICSWP","FINAL",1,"N");
	}

if (AInfo['GENERAL INFORMATION.First Indoor Pool - Enter 1'] != null) {
	if(feeExists("ISWP1REIMB") == false) updateFee("ISWP1REIMB","LICSWP","FINAL",1,"N");
	} else {
	if(feeExists("ISWP1REIMB") == true) removeFee("ISWP1REIMB","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Additional Indoor Pools'] != null) {
	if(feeExists("ISWPPHMDC") == false) updateFee("ISWPPHMDC","LICSWP","FINAL",1,"N");
	} else {
	if(feeExists("ISWPPHMDC") == true) removeFee("ISWPPHMDC","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Additional Indoor Pools'] != null && isTaskActive("Intake")) {
	if(feeExists("ISWPPI") == false) updateFee("ISWPPI","LICSWP","FINAL",1,"N");
	}

if (AInfo['GENERAL INFORMATION.Additional Indoor Pools'] != null) {
	if(feeExists("ISWPREIMB") == false) updateFee("ISWPREIMB","LICSWP","FINAL",1,"N");
	} else {
	if(feeExists("ISWPREIMB") == true) removeFee("ISWPREIMB","FINAL");
	}

if (AInfo['GENERAL INFORMATION.First Outdoor Pool - Enter 1'] != null) {
	if(feeExists("OSWP1PHMDC") == false) updateFee("OSWP1PHMDC","LICSWP","FINAL",1,"N");
	} else {
	if(feeExists("OSWP1PHMDC") == true) removeFee("OSWP1PHMDC","FINAL");
	}

if (AInfo['GENERAL INFORMATION.First Outdoor Pool - Enter 1'] != null && isTaskActive("Intake")) {
	if(feeExists("OSWP1PI") == false) updateFee("OSWP1PI","LICSWP","FINAL",1,"N");
	}

if (AInfo['GENERAL INFORMATION.First Outdoor Pool - Enter 1'] != null) {
	if(feeExists("OSWP1REIMB") == false) updateFee("OSWP1REIMB","LICSWP","FINAL",1,"N");
	} else {
	if(feeExists("OSWP1REIMB") == true) removeFee("OSWP1REIMB","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Additional Outdoor Pools'] != null) {
	if(feeExists("OSWPPHMDC") == false) updateFee("OSWPPHMDC","LICSWP","FINAL",1,"N");
	} else {
	if(feeExists("OSWPPHMDC") == true) removeFee("OSWPPHMDC","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Additional Outdoor Pools'] != null && isTaskActive("Intake")) {
	if(feeExists("OSWPPI") == false) updateFee("OSWPPI","LICSWP","FINAL",1,"N");
	}

if (AInfo['GENERAL INFORMATION.Additional Outdoor Pools'] != null) {
	if(feeExists("OSWPREIMB") == false) updateFee("OSWPREIMB","LICSWP","FINAL",1,"N");
	} else {
	if(feeExists("OSWPREIMB") == true) removeFee("OSWPREIMB","FINAL");
	}
`^
CMN;Licenses!Health!SwimmingPool!Madison;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL INFORMATION.First Indoor Pool - Enter 1'] != null) {
	updateFee("ISWP1PHMDC","LICSWP","FINAL",1,"N");
	} else {
	if(feeExists("ISWP1PHMDC") == true) removeFee("ISWP1PHMDC","FINAL");
	}

if (AInfo['GENERAL INFORMATION.First Indoor Pool - Enter 1'] != null) {
	if(feeExists("ISWP1REIMB") == false) updateFee("ISWP1REIMB","LICSWP","FINAL",1,"N");
	} else {
	if(feeExists("ISWP1REIMB") == true) removeFee("ISWP1REIMB","FINAL");
	}

if (AInfo['GENERAL INFORMATION.First Indoor Pool - Enter 1'] != null && isTaskActive("Intake")) {
	if(feeExists("ISWP1PI") == false) updateFee("ISWP1PI","LICSWP","FINAL",1,"N");
	}

if (AInfo['GENERAL INFORMATION.Additional Indoor Pools'] != null) {
	if(feeExists("ISWPPHMDC","NEW") == false) updateFee("ISWPPHMDC","LICSWP","FINAL",1,"N");
	} else {
	if(feeExists("ISWPPHMDC") == true) removeFee("ISWPPHMDC","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Additional Indoor Pools'] != null) {
	if(feeExists("ISWPREIMB") == false) updateFee("ISWPREIMB","LICSWP","FINAL",1,"N");
	} else {
	if(feeExists("ISWPREIMB") == true) removeFee("ISWPREIMB","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Additional Indoor Pools'] != null && isTaskActive("Intake")) {
	if(feeExists("ISWPPI") == false) updateFee("ISWPPI","LICSWP","FINAL",1,"N");
	}

if (AInfo['GENERAL INFORMATION.First Outdoor Pool - Enter 1'] != null) {
	if(feeExists("OSWP1PHMDC") == false) updateFee("OSWP1PHMDC","LICSWP","FINAL",1,"N");
	} else {
	if(feeExists("OSWP1PHMDC") == true) removeFee("OSWP1PHMDC","FINAL");
	}

if (AInfo['GENERAL INFORMATION.First Outdoor Pool - Enter 1'] != null) {
	if(feeExists("OSWP1REIMB") == false) updateFee("OSWP1REIMB","LICSWP","FINAL",1,"N");
	} else {
	if(feeExists("OSWP1REIMB") == true) removeFee("OSWP1REIMB","FINAL");
	}

if (AInfo['GENERAL INFORMATION.First Outdoor Pool - Enter 1'] != null && isTaskActive("Intake")) {
	if(feeExists("OSWP1PI") == false) updateFee("OSWP1PI","LICSWP","FINAL",1,"N");
	}

if (AInfo['GENERAL INFORMATION.Additional Outdoor Pools'] != null) {
	if(feeExists("OSWPPHMDC") == false) updateFee("OSWPPHMDC","LICSWP","FINAL",1,"N");
	} else {
	if(feeExists("OSWPPHMDC") == true) removeFee("OSWPPHMDC","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Additional Outdoor Pools'] != null) {
	if(feeExists("OSWPREIMB") == false) updateFee("OSWPREIMB","LICSWP","FINAL",1,"N");
	} else {
	if(feeExists("OSWPREIMB") == true) removeFee("OSWPREIMB","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Additional Outdoor Pools'] != null && isTaskActive("Intake")) {
	if(feeExists("OSWPPI") == false) updateFee("OSWPPI","LICSWP","FINAL",1,"N");
	}
`^
CMN;Licenses!Health!Temp Food Establishment!DaneCounty;Fees^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (AInfo['FOOD SERVICE.Food Service Type'] == "Primarily Restaurant") {
	updateFee("TFERESPHMDC", "LICTFD", "FINAL", 1, "Y");
	updateFee("TFERESREIMB", "LICTFD", "FINAL", 1, "Y");
	} else {
	removeFee("TFERESPHMDC", "FINAL");
	removeFee("TFERESREIMB", "FINAL");
	}

if (AInfo['FOOD SERVICE.Food Service Type'] == "Primarily Retail Food") {
	updateFee("TFERTLPHMDC", "LICTFD", "FINAL", 1, "Y");
	updateFee("TFERTLREIMB", "LICTFD", "FINAL", 1, "Y");
	} else {
	removeFee("TFERTLPHMDC", "FINAL");
	removeFee("TFERTLREIMB", "FINAL");
	}
`^
CMN;Licenses!Treasurer!~!~;ContactCompare^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aa.people.removeCapContact(parentCapId, pConArray[pC].contactSeqNumber);
`^
CMN;Licenses!Treasurer!~!~;DuplicateLicCheck^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
check = 0;
if (cmnSubType == "Chicken Owner") {
	checkType = "LICENSE DETAILS";
	} else {
	checkType = "ANIMAL DETAILS";
	}

if (cmnSubType == "Chicken Owner") {
	checkDesc = "License Number";
	} else {
	checkDesc = "License Number";
	}

if (callType == "ASBCRCB") {
	if(cmnSubType == "Chicken Owner") asiValue = AInfo['License Number'];
	if(cmnSubType != "Chicken Owner") asiValue = AInfo['License Number'];
	}

if (callType == "ASIUB") {
	if(cmnSubType == "Chicken Owner") asiValue = AInfo['LICENSE DETAILS.License Number'];
	if(cmnSubType != "Chicken Owner") asiValue = AInfo['ANIMAL DETAILS.License Number'];
	}

firstDate = new Date("1!1!" + startDate.getFullYear());
cutoffDate = new Date("11!15!" + startDate.getFullYear());
endDate = new Date("12!31!" + startDate.getFullYear());
if (startDate >= firstDate && startDate < cutoffDate) {
	bDate = "1!1!" + startDate.getFullYear();
	eDate =  "12!31!" + startDate.getFullYear();
	}

if (startDate >= cutoffDate && startDate <= endDate) {
	bDate =  "1!1!" + (startDate.getFullYear() + 1);
	eDate =  "12!31!" + (startDate.getFullYear() + 1);
	}

if (callType == "ASIUB" && cmnCategory == "NA") {
	check = findDuplicateASIValues(callType, checkType, checkDesc, asiValue, 'Expire', bDate, eDate, false);
	}

if (callType == "ASIUB" && cmnCategory == "Renewal") {
	check = findDuplicateASIValues(callType, checkType, checkDesc, asiValue, 'Expire', bDate, eDate, true);
	}

if (callType == "ASBCRCB") {
	check = findDuplicateASIValues(callType, checkType, checkDesc, asiValue, 'Expire', bDate, eDate, false);
	}

if (check > 0) {
	cancel = true;
	showMessage = true;
	comment("The License Number entered (" + asiValue + " ) is already being used.  Please enter another License Number.");
	}
`^
CMN;Licenses!Treasurer!~!~;SetRenewalInfo^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
UpdateExpStatus = "";
if (capStatus == "Closed" || capStatus == "Inactive") {
	UpdateExpStatus = "Inactive";
	}

if (capStatus == "Expired") {
	UpdateExpStatus = "Expired";
	}

if (UpdateExpStatus != "") {
	licEditExpInfo(UpdateExpStatus, null);
	}
`^
CMN;Licenses!Treasurer!Cat Registration!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
filedDate = new Date(fileDate);
april1= new Date("04!01!" + startDate.getFullYear());
nov15= new Date("11!15!" + startDate.getFullYear());
july1 = new Date("07!01!" + startDate.getFullYear());
if (AInfo['HEALTH STATUS.Spayed or Neutered'] == "Un-Neutered Male") {
	if(feeExists("UNMCL", "NEW", "INVOICED") == false) updateFee("UNMCL","TRECREG","FINAL",1,"N");
	} else {
	if(feeExists("UNMCL") == true) removeFee("UNMCL","FINAL");
	}

if (AInfo['HEALTH STATUS.Spayed or Neutered'] == "Un-Neutered Male" && (AInfo['ANIMAL DETAILS.Cat is 5 Months Old or Less'] != null && AInfo['ANIMAL DETAILS.Cat is 5 Months Old or Less'] == "CHECKED" && filedDate >=  july1 && filedDate <= nov15)) {
	if(feeExists("UNMCL", "NEW", "INVOICED") == true) removeFee("UNMCL","FINAL");
	if(feeExists("UNMCLMY", "NEW", "INVOICED")  == false) updateFee("UNNMCLMY","TRECREG","FINAL",1,"N");
	} else {
	if(feeExists("UNNMCLMY") == true) removeFee("UNNMCLMY","FINAL");
	}

if (AInfo['HEALTH STATUS.Spayed or Neutered'] == "Neutered Male") {
	if(feeExists("NMCL", "NEW", "INVOICED") == false) updateFee("NMCL","TRECREG","FINAL",1,"N");
	} else {
	if(feeExists("NMCL") == true) removeFee("NMCL","FINAL");
	}

if (AInfo['HEALTH STATUS.Spayed or Neutered'] == "Neutered Male" && (AInfo['ANIMAL DETAILS.Cat is 5 Months Old or Less'] != null && AInfo['ANIMAL DETAILS.Cat is 5 Months Old or Less'] == "CHECKED" && filedDate >=  july1 && filedDate <= nov15)) {
	if(feeExists("NMCL", "NEW", "INVOICED") == true) removeFee("NMCL","FINAL");
	if(feeExists("NMCLMY", "NEW", "INVOICED")  == false) updateFee("NMCLMY","TRECREG","FINAL",1,"N");
	} else {
	if(feeExists("NMCLMY") == true) removeFee("NMCLMY","FINAL");
	}

if (AInfo['HEALTH STATUS.Spayed or Neutered'] == "Spayed Female") {
	if(feeExists("SFCL", "NEW", "INVOICED") == false) updateFee("SFCL","TRECREG","FINAL",1,"N");
	} else {
	if(feeExists("SFCL") == true) removeFee("SFCL","FINAL");
	}

if (AInfo['HEALTH STATUS.Spayed or Neutered'] == "Spayed Female" && (AInfo['ANIMAL DETAILS.Cat is 5 Months Old or Less'] != null && AInfo['ANIMAL DETAILS.Cat is 5 Months Old or Less'] == "CHECKED" && filedDate >=  july1 && filedDate <= nov15)) {
	if(feeExists("SFCL", "NEW", "INVOICED") == true) removeFee("SFCL","FINAL");
	if(feeExists("SFCLMY", "NEW", "INVOICED")  == false) updateFee("SFCLMY","TRECREG","FINAL",1,"N");
	} else {
	if(feeExists("SFCLMY") == true) removeFee("SFCLMY","FINAL");
	}

if (AInfo['HEALTH STATUS.Spayed or Neutered'] == "Un-Spayed Female") {
	if(feeExists("USFCL", "NEW", "INVOICED") == false) updateFee("USFCL","TRECREG","FINAL",1,"N");
	} else {
	if(feeExists("USFCL") == true) removeFee("USFCL","FINAL");
	}

if (AInfo['HEALTH STATUS.Spayed or Neutered'] == "Un-Spayed Female" && (AInfo['ANIMAL DETAILS.Cat is 5 Months Old or Less'] != null && AInfo['ANIMAL DETAILS.Cat is 5 Months Old or Less'] == "CHECKED" && filedDate >=  july1 && filedDate <= nov15)) {
	if(feeExists("USFCL", "NEW", "INVOICED") == true) removeFee("USFCL","FINAL");
	if(feeExists("USFCLMY", "NEW", "INVOICED")  == false) updateFee("USFCLMY","TRECREG","FINAL",1,"N");
	} else {
	if(feeExists("USFCLMY") == true) removeFee("USFCLMY","FINAL");
	}

if (cmnCategory != "Renewal" && ((AInfo['OFFICE USE ONLY.No Late Fee'] == null || AInfo['OFFICE USE ONLY.No Late Fee'] != "Yes") && (AInfo['ANIMAL DETAILS.Cat is 5 Months Old or Less'] == null || AInfo['ANIMAL DETAILS.Cat is 5 Months Old or Less'] != "CHECKED") && (AInfo['ANIMAL DETAILS.I have had my cat in the City of Madison for 30 days or less'] == null || AInfo['ANIMAL DETAILS.I have had my cat in the City of Madison for 30 days or less'] != "CHECKED")) && filedDate >= april1 && filedDate <= nov15) {
	if(feeExists("CLF", "NEW", "INVOICED") == false) updateFee("CLF","TRECREG","FINAL",1,"N");
	} else {
	if(feeExists("CLF") == true) removeFee("CLF","FINAL");
	}

if ((AInfo['OFFICE USE ONLY.No Late Fee'] == null || AInfo['OFFICE USE ONLY.No Late Fee'] == "No") && filedDate >= april1 && filedDate <= nov15 && cmnCategory == "Renewal") {
	if(feeExists("CRLF", "NEW", "INVOICED") == false) updateFee("CRLF","TRECREG","FINAL",1,"N");
	} else {
	if(feeExists("CRLF") == true) removeFee("CRLF","FINAL");
	}

if ((AInfo['OFFICE USE ONLY.Replacement License'] != null && AInfo['OFFICE USE ONLY.Replacement License'] == "CHECKED")) {
	removeAllFees(capId);
	if(feeExists("REPL", "NEW", "INVOICED") == false) updateFee("REPL","TRECREG","FINAL",1,"N");
	} else {
	if(feeExists("REPL") == true) removeFee("REPL","FINAL");
	}
`^
CMN;Licenses!Treasurer!Chicken Owner!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if ((AInfo['LICENSE DETAILS.Replacement License'] != null && AInfo['LICENSE DETAILS.Replacement License'] == "CHECKED")) {
	removeAllFees(capId);
	if(feeExists("REPL", "NEW", "INVOICED") == false) updateFee("REPL","TRCHKREG","FINAL",1,"N");
	} else {
	if(feeExists("REPL") == true) removeFee("REPL","FINAL");
	}
`^
CMN;Licenses!Treasurer!Dog Registration!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
regPay = false;
filedDate = new Date(fileDate);
var april1= new Date("04!01!" + startDate.getFullYear());
nov15= new Date("11!15!" + startDate.getFullYear());
july1 = new Date("07!01!" + startDate.getFullYear());
pCapId = "";
if (AInfo['HEALTH STATUS.Spayed or Neutered'] == "Un-Neutered Male") {
	if(feeExists("UNMDLM", "NEW", "INVOICED") == false) updateFee("UNMDLM","TRDREG","FINAL",1,"N");
	} else {
	if(feeExists("UNMDLM") == true) removeFee("UNMDLM","FINAL");
	}

if (AInfo['HEALTH STATUS.Spayed or Neutered'] == "Un-Neutered Male" && (AInfo['ANIMAL DETAILS.Dog is 5 Months Old or Less'] != null && AInfo['ANIMAL DETAILS.Dog is 5 Months Old or Less'] == "CHECKED" && filedDate >=  july1 && filedDate <= nov15)) {
	if(feeExists("UNMDLM") == true) removeFee("UNMDLM","FINAL");
	if(feeExists("UNMDLMMY", "NEW", "INVOICED") == false) updateFee("UNMDLMMY","TRDREG","FINAL",1,"N");
	} else {
	if(feeExists("UNMDLMMY") == true) removeFee("UNMDLMMY","FINAL");
	}

if (AInfo['HEALTH STATUS.Spayed or Neutered'] == "Neutered Male") {
	if(feeExists("NMDLM", "NEW", "INVOICED") == false) updateFee("NMDLM","TRDREG","FINAL",1,"N");
	} else {
	if(feeExists("NMDLM") == true) removeFee("NMDLM","FINAL");
	}

if (AInfo['HEALTH STATUS.Spayed or Neutered'] == "Neutered Male" && (AInfo['ANIMAL DETAILS.Dog is 5 Months Old or Less'] != null && AInfo['ANIMAL DETAILS.Dog is 5 Months Old or Less'] == "CHECKED" && filedDate >=  july1 && filedDate <= nov15)) {
	if(feeExists("NMDLM") == true) removeFee("NMDLM","FINAL");
	if(feeExists("NMDLMMY", "NEW", "INVOICED") == false) updateFee("NMDLMMY","TRDREG","FINAL",1,"N");
	} else {
	if(feeExists("NMDLMMY") == true) removeFee("NMDLMMY","FINAL");
	}

if (AInfo['HEALTH STATUS.Spayed or Neutered'] == "Spayed Female") {
	if(feeExists("SFDLM", "NEW", "INVOICED") == false) updateFee("SFDLM","TRDREG","FINAL",1,"N");
	} else {
	if(feeExists("SFDLM") == true) removeFee("SFDLM","FINAL");
	}

if (AInfo['HEALTH STATUS.Spayed or Neutered'] == "Spayed Female" && (AInfo['ANIMAL DETAILS.Dog is 5 Months Old or Less'] != null && AInfo['ANIMAL DETAILS.Dog is 5 Months Old or Less'] == "CHECKED" && filedDate >=  july1 && filedDate <= nov15)) {
	if(feeExists("SFDLM") == true) removeFee("SFDLM","FINAL");
	if(feeExists("SFDLMMY", "NEW", "INVOICED") == false) updateFee("SFDLMMY","TRDREG","FINAL",1,"N");
	} else {
	if(feeExists("SFDLMMY") == true) removeFee("SFDLMMY","FINAL");
	}

if (AInfo['HEALTH STATUS.Spayed or Neutered'] == "Un-Spayed Female") {
	if(feeExists("USFDLM", "NEW", "INVOICED") == false) updateFee("USFDLM","TRDREG","FINAL",1,"N");
	} else {
	if(feeExists("USFDLM") == true) removeFee("USFDLM","FINAL");
	}

if (AInfo['HEALTH STATUS.Spayed or Neutered'] == "Un-Spayed Female" && (AInfo['ANIMAL DETAILS.Dog is 5 Months Old or Less'] != null && AInfo['ANIMAL DETAILS.Dog is 5 Months Old or Less'] == "CHECKED" && filedDate >=  july1 && filedDate <= nov15)) {
	if(feeExists("USFDLM") == true) removeFee("USFDLM","FINAL");
	if(feeExists("USFDLMMY", "NEW", "INVOICED") == false) updateFee("USFDLMMY","TRDREG","FINAL",1,"N");
	} else {
	if(feeExists("USFDLMMY") == true) removeFee("USFDLMMY","FINAL");
	}

if ((AInfo['DOG PARK PERMIT REQUEST.Already has permit for current year on another dog'] == null || AInfo['DOG PARK PERMIT REQUEST.Already has permit for current year on another dog'] == "No")  && AInfo['DOG PARK PERMIT REQUEST.Number of Annual Permits Requested for This Dog'] != null && AInfo['DOG PARK PERMIT REQUEST.Number of Annual Permits Requested for This Dog'] > 0 && (AInfo['DOG PARK PERMIT REQUEST.Senior!Disabled (65 or older)'] == null || AInfo['DOG PARK PERMIT REQUEST.Senior!Disabled (65 or older)'] != "CHECKED")) {
	if(feeExists("REGANN", "NEW", "INVOICED") == false) updateFee("REGANN","PRKDGPRK","FINAL",1,"N");
	if(feeExists("ADDLPERM", "NEW", "INVOICED") == false) updateFee("ADDLPERM","PRKDGPRK","FINAL",AInfo['DOG PARK PERMIT REQUEST.Number of Annual Permits Requested for This Dog']-1,"N");
	regPay = true;
	} else {
	removeFee("REGANN","FINAL");
	removeFee("ADDLPERM","FINAL");
	}

if ((AInfo['DOG PARK PERMIT REQUEST.Already has permit for current year on another dog'] == null || AInfo['DOG PARK PERMIT REQUEST.Already has permit for current year on another dog'] == "No") && AInfo['DOG PARK PERMIT REQUEST.Number of Annual Permits Requested for This Dog'] != null && AInfo['DOG PARK PERMIT REQUEST.Number of Annual Permits Requested for This Dog'] > 0 && AInfo['DOG PARK PERMIT REQUEST.Senior!Disabled (65 or older)'] != null && AInfo['DOG PARK PERMIT REQUEST.Senior!Disabled (65 or older)'] == "CHECKED") {
	if(feeExists("SENDIS", "NEW", "INVOICED") == false)  updateFee("SENDIS","PRKDGPRK","FINAL",1,"N");
	if(feeExists("ADDLPERM", "NEW", "INVOICED") == false) updateFee("ADDLPERM","PRKDGPRK","FINAL",AInfo['DOG PARK PERMIT REQUEST.Number of Annual Permits Requested for This Dog']-1,"N");
	regPay = true;
	} else {
	removeFee ("SENDIS","FINAL");
	if (AInfo['DOG PARK PERMIT REQUEST.Senior!Disabled (65 or older)'] == "CHECKED") removeFee("ADDLPERM","FINAL");
	}

if (AInfo['DOG PARK PERMIT REQUEST.Already has permit for current year on another dog'] != null && AInfo['DOG PARK PERMIT REQUEST.Already has permit for current year on another dog'] == "Yes" && AInfo['DOG PARK PERMIT REQUEST.Number of Annual Permits Requested for This Dog'] != null && AInfo['DOG PARK PERMIT REQUEST.Number of Annual Permits Requested for This Dog'] > 0) {
	if(feeExists("ADDLPERM", "NEW", "INVOICED") == false) updateFee("ADDLPERM","PRKDGPRK","FINAL",AInfo['DOG PARK PERMIT REQUEST.Number of Annual Permits Requested for This Dog'],"N");
	} else {
	if (regPay == false) removeFee("ADDLPERM","FINAL");
	}

if (AInfo['DOG PARK PERMIT REQUEST.Number of Replacements Requested - Annual Permits Only'] != null && AInfo['DOG PARK PERMIT REQUEST.Number of Replacements Requested - Annual Permits Only'] > 0) {
	if(feeExists("REPL", "NEW", "INVOICED") == false) updateFee("REPL","PRKDGPRK","FINAL",AInfo['DOG PARK PERMIT REQUEST.Number of Replacements Requested - Annual Permits Only'],"N");
	} else {
	removeFee("REPL","FINAL");
	}

if (cmnCategory != "Renewal" && ((AInfo['OFFICE USE ONLY.No Late Fee'] == null || AInfo['OFFICE USE ONLY.No Late Fee'] == "No") && (AInfo['ANIMAL DETAILS.Dog is 5 Months Old or Less'] == null || AInfo['ANIMAL DETAILS.Dog is 5 Months Old or Less'] != "CHECKED") && (AInfo['ANIMAL DETAILS.I have had my dog in the City of Madison for 30 days or less'] == null || AInfo['ANIMAL DETAILS.I have had my dog in the City of Madison for 30 days or less'] != "CHECKED")) && filedDate >= april1 && filedDate <= nov15) {
	if(feeExists("DLF", "NEW", "INVOICED") == false) updateFee("DLF","TRDREG","FINAL",1,"N");
	} else {
	if(feeExists("DLF") == true) removeFee("DLF","FINAL");
	}

if (AInfo['OFFICE USE ONLY.Replacement License'] != null && AInfo['OFFICE USE ONLY.Replacement License'] == "CHECKED") {
	removeAllFees(capId);
	if(feeExists("DLREPL", "NEW", "INVOICED") == false) updateFee("DLREPL","TRDREG","FINAL",1,"N");
	} else {
	if(feeExists("DLREPL") == true) removeFee("DLREPL","FINAL");
	}

if ((AInfo['OFFICE USE ONLY.No Late Fee'] == null || AInfo['OFFICE USE ONLY.No Late Fee'] == "No") && filedDate >= april1 && filedDate <= nov15 && cmnCategory == "Renewal") {
	if(feeExists("DRLF", "NEW", "INVOICED") == false) updateFee("DRLF","TRDREG","FINAL",1,"N");
	} else {
	if(feeExists("DRLF") == true) removeFee("DRLF","FINAL");
	}

if (AInfo['ANIMAL DETAILS.Service Dog'] != null && AInfo['ANIMAL DETAILS.Service Dog'] == "Yes") {
	removeAllFees(capId);
	!!This line must be last active line.;
	}
`^
CMN;Licenses!Vending!~!~;AppName^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (cmnSubType == "HighDensityVending") {
	cName = "High Density Vending";
	}

if (cmnSubType == "LateNightVendor") {
	cName = "Late Night Vendor";
	}

if (cmnSubType == "MallCraftVendor") {
	cName = "Arts and Crafts";
	}

if (cmnSubType == "MallFoodVendor") {
	cName = "Mall Food Vendor";
	}

if (cmnSubType == "MerchantVendor") {
	cName = "Merchant Vendor";
	}

if (cmnSubType == "SidewalkCafe") {
	cName = "Sidewalk Cafe";
	}

if (cmnSubType == "SoutheastCampusVending") {
	cName = "Southeast Campus Vendor";
	}

if (cmnSubType == "StreetVendor") {
	cName = "Street Vendor";
	}

if (cmnSubType == "TEM") {
	cName = "TEM Permit";
	}

if (cmnSubType == "TOSVOD") {
	cName = "Top of State Street Overlay District";
	}
`^
CMN;Licenses!Vending!~!~;ContactCompare^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
aa.people.removeCapContact(capId, pConArray[pC].contactSeqNumber);
`^
CMN;Licenses!Vending!~!~;ExpirationDate^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
cName = "Undefined CAP";
include("CMN;Licenses!Vending!~!~;AppName");
janOne = new Date("01!01!" + startDate.getFullYear());
febFifteen = new Date("02!15!" + startDate.getFullYear());
decThirtyOne = new Date("12!31!" + startDate.getFullYear());
if (startDate >= janOne && startDate < febFifteen) {
	expireDate = "04!15!" + startDate.getFullYear();
	}

if (startDate >= febFifteen && startDate <= decThirtyOne) {
	expireDate = dateAddMonths("04!15!" + startDate.getFullYear(),12);
	}

if (AInfo['APPLICANT TYPE.Enter Number of 30-Day Increments'] > 0) {
	expireDate = AInfo['APPLICANT TYPE.End Date'];
	}

licEditExpInfo(null, expireDate);
`^
CMN;Licenses!Vending!HighDensityVending!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['APPLICANT TYPE.Location'] == "Camp Randall - Football Season") {
	addFee("CRHD","LICHDVD","FINAL",1,"Y");
	} else {
	removeFee("CRHD","FINAL");
	}

if (AInfo['APPLICANT TYPE.Location'] == "Langdon Street Annual") {
	addFee("LSHDA","LICHDVD","FINAL",1,"Y");
	} else {
	removeFee("LSHDA","FINAL");
	}

if (AInfo['APPLICANT TYPE.Enter Number of 30-Day Increments'] > 0) {
	addFee("LSHDM","LICHDVD","FINAL",AInfo['APPLICANT TYPE.Enter Number of 30-Day Increments'],"Y");
	} else {
	removeFee("LSHDM","FINAL");
	}
`^
CMN;Licenses!Vending!HighDensityVending!Renewal;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	}

if (getAppSpecific("APPLICANT TYPE.Location", rnwCapId) == "Camp Randall - Football Season") {
	addFee("CRHD","LICHDVD","FINAL",1,"Y");
	} else {
	removeFee("CRHD","FINAL");
	}

if (getAppSpecific("APPLICANT TYPE.Location", rnwCapId) == "Langdon Street Annual") {
	addFee("LSHDA","LICHDVD","FINAL",1,"Y");
	} else {
	removeFee("LSHDA","FINAL");
	}

if (getAppSpecific("APPLICANT TYPE.Enter Number of 30-Day Increments", rnwCapId) > 0) {
	addFee("LSHDM","LICHDVD","FINAL",getAppSpecific("APPLICANT TYPE.Enter Number of 30-Day Increments", rnwCapId),"Y");
	} else {
	removeFee("LSHDM","FINAL");
	}
`^
CMN;Licenses!Vending!LateNightVendor!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
generator = AInfo['ELECTRICAL USE.Do you have, and will you be using, a generator?'];
elec1515Days = AInfo['ELECTRICAL USE.Number of days per week vendor will use electricity during April 15 to October 15 period'];
elec1614Days = AInfo['ELECTRICAL USE.Number of days per week vendor will use electricity during April 15 to October 15 period'];
if (parseInt(elec1515Days) > 0 && generator == "No") {
	addFee("ELEBASE","LICLNV","FINAL",1,"Y");
	addFee("EU","LICLNV","FINAL",parseInt(elec1515Days),"Y");
	} else {
	removeFee("ELEBASE","FINAL");
	removeFee("EU","FINAL");
	}

if (parseInt(elec1614Days) > 0 && generator == "No") {
	addFee("1416EU","LICLNV","FINAL",parseInt(elec1614Days),"Y");
	addFee("1416EB","LICLNV","FINAL",1,"Y");
	} else {
	removeFee("1416EU","FINAL");
	removeFee("1416EB","FINAL");
	}

if (AInfo['APPLICANT TYPE.Cart Size'] == "Large Cart") {
	addFee("LGT","LICLNV","FINAL",1,"Y");
	} else {
	removeFee("LGT","FINAL");
	}

if (AInfo['APPLICANT TYPE.Cart Size'] == "Small Push Cart") {
	addFee("PC","LICLNV","FINAL",1,"Y");
	} else {
	removeFee("PC","FINAL");
	}
`^
CMN;Licenses!Vending!LateNightVendor!Renewal;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	}

generator = getAppSpecific("ELECTRICAL USE.Do you have, and will you be using, a generator?", rnwCapId);
elec1515Days = getAppSpecific("ELECTRICAL USE.Number of days per week vendor will use electricity during April 15 to October 15 period", rnwCapId);
elec1614Days = getAppSpecific("ELECTRICAL USE.Number of days per week vendor will use electricity during April 15 to October 15 period", rnwCapId);
if (parseInt(elec1515Days) > 0 && generator == "No" > 0) {
	addFee("ELEBASE","LICLNV","FINAL",1,"Y");
	addFee("EU","LICLNV","FINAL",parseInt(elec1515Days),"Y");
	} else {
	removeFee("ELEBASE","FINAL");
	removeFee("EU","FINAL");
	}

if (parseInt(elec1614Days) > 0 && generator == "No" > 0) {
	addFee("1416EU","LICLNV","FINAL",parseInt(elec1614Days), rnwCapId),"Y");
	addFee("1416EB","LICLNV","FINAL",1,"Y");
	} else {
	removeFee("1416EU","FINAL");
	removeFee("1416EB","FINAL");
	}

if (getAppSpecific("APPLICANT TYPE.Cart Size", rnwCapId) == "Large Cart") {
	addFee("LGT","LICLNV","FINAL",1,"Y");
	} else {
	removeFee("LGT","FINAL");
	}

if (getAppSpecific("APPLICANT TYPE.Cart Size", rnwCapId) == "Small Push Cart") {
	addFee("PC","LICLNV","FINAL",1,"Y");
	} else {
	removeFee("PC","FINAL");
	}
`^
CMN;Licenses!Vending!MallCraftVendor!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['APPLICANT TYPE.Location'] == "Daily State Street - Annual" || AInfo['APPLICANT TYPE.Location'] == "Saturday Capitol Square - Annual") {
	addFee("MCA","LICMCV","FINAL",1,"Y");
	} else {
	removeFee("MCA","FINAL");
	}

if (AInfo['APPLICANT TYPE.Location'] == "Daily State Street - Annual") {
	addFee("MCDSS","LICMCV","FINAL",1,"Y");
	} else {
	removeFee("MCDSS","FINAL");
	}

if (AInfo['APPLICANT TYPE.Location'] == "Saturday Capitol Square - Annual") {
	addFee("MCRSA","LICMCV","FINAL",1,"Y");
	} else {
	removeFee("MCRSA","FINAL");
	}

if (AInfo['APPLICANT TYPE.Enter Number of 30-Day Increments'] > 0) {
	addFee("MCM","LICMCV","FINAL",AInfo['APPLICANT TYPE.Enter Number of 30-Day Increments'],"Y");
	} else {
	removeFee("MCM","FINAL");
	}
`^
CMN;Licenses!Vending!MallCraftVendor!NA;LoadTable^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
xTable = tGroupi.next();
totRecs =  xTable.getMaxIndex();
`^
CMN;Licenses!Vending!MallCraftVendor!Renewal;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	}

if (getAppSpecific("APPLICANT TYPE.Location", rnwCapId) == "Daily State Street - Annual" || getAppSpecific("APPLICANT TYPE.Location", rnwCapId) == "Saturday Capitol Square - Annual") {
	addFee("MCA","LICMCV","FINAL",1,"Y");
	} else {
	removeFee("MCA","FINAL");
	}

if (getAppSpecific("APPLICANT TYPE.Location", rnwCapId) == "Daily State Street - Annual") {
	addFee("MCRSA","LICMCV","FINAL",1,"Y");
	} else {
	removeFee("MCRSA","FINAL");
	}

if (getAppSpecific("APPLICANT TYPE.Location", rnwCapId) == "Saturday Capitol Square - Annual") {
	addFee("MCDSS","LICMCV","FINAL",1,"Y");
	} else {
	removeFee("MCDSS","FINAL");
	}

if (getAppSpecific("APPLICANT TYPE.Enter Number of 30-Day Increments", rnwCapId) > 0) {
	addFee("MCM","LICMCV","FINAL",getAppSpecific("APPLICANT TYPE.Enter Number of 30-Day Increments", rnwCapId),"Y");
	} else {
	removeFee("MCM","FINAL");
	}
`^
CMN;Licenses!Vending!MallFoodVendor!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
generator = AInfo['ELECTRICAL USE.Do you have, and will you be using, a generator?'];
elec1614Days = AInfo['ELECTRICAL USE.Number of days per week vendor will operate<BR>during October 16 to April 14 period'];
elec1515Days = AInfo['ELECTRICAL USE.Number of days per week vendor will operate<BR>during April 15 to October 15 period'];
if (parseInt(elec1515Days) > 0 && generator = "No") {
	addFee("ELEBASE","LICMCFV","FINAL",1,"Y");
	addFee("EU","LICMCFV","FINAL",parseInt(elec1515Days) ,"Y");
	} else {
	removeFee("ELEBASE","FINAL");
	removeFee("EU","FINAL");
	}

if (parseInt(elec1614Days) > 0 && generator = "No") {
	addFee("1416EB","LICMCFV","FINAL",1,"Y");
	addFee("1416EU","LICMCFV","FINAL",parseInt(elec1614Days),"Y");
	} else {
	removeFee("1416EU","FINAL");
	removeFee("1416EB","FINAL");
	}

if (halfPrice == "Yes") {
	addFee("MCAH","LICMCFV","FINAL",1,"Y");
	} else {
	addFee("MCA","LICMCFV","FINAL",1,"Y");
	}
`^
CMN;Licenses!Vending!MallFoodVendor!Renewal;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	}

generator = getAppSpecific("ELECTRICAL USE.Do you have, and will you be using, a generator?", rnwCapId);
elec1515Days = getAppSpecific("ELECTRICAL USE.Number of days per week vendor will operate<BR>during April 15 to October 15 period", rnwCapId);
elec1614Days = getAppSpecific("ELECTRICAL USE.Number of days per week vendor will operate<BR>during October 16 to April 14 period", rnwCapId);
if (parseInt(elec1515Days) > 0 && generator == "No") {
	addFee("ELEBASE","LICMCFV","FINAL",1,"Y");
	addFee("EU","LICMCFV","FINAL",parseInt(elec1515Days) ,"Y");
	} else {
	removeFee("ELEBASE","FINAL");
	removeFee("EU","FINAL");
	}

if (parseInt(elec1614Days) > 0 && generator == "No") {
	addFee("1416EB","LICMCFV","FINAL",1,"Y");
	addFee("1416EU","LICMCFV","FINAL",parseInt(elec1614Days),"Y");
	} else {
	removeFee("1416EU","FINAL");
	removeFee("1416EB","FINAL");
	}

addFee("MCA","LICMCFV","FINAL",1,"Y");
`^
CMN;Licenses!Vending!MerchantVendor!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
addFee("MV","LICMV","FINAL",1,"Y");
`^
CMN;Licenses!Vending!MerchantVendor!Renewal;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
addFee("MV","LICMV","FINAL",1,"Y");
`^
CMN;Licenses!Vending!SidewalkCafe!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
calcLengthIn = 0;
calcWidthIn = 0;
newLength = 0;
newWidth = 0;
squareFoot = 0;
calcWidthIn = parseInt(AInfo['OPERATIONS.Width Feet']) ~ 12;
calcLengthIn = parseInt(AInfo['OPERATIONS.Length Feet']) ~ 12;
newWidth = calcWidthIn + parseInt(AInfo['OPERATIONS.Width Inches']);
newLength =  calcLengthIn + parseInt(AInfo['OPERATIONS.Length Inches']);
squareFoot = (newWidth ~ newLength)!144;
if (AInfo['OPERATIONS.Are you on the Mall Concourse?'] == 'Yes') {
	addFee("SCMALL","LICSCC","FINAL",squareFoot,"Y");
	}

if (AInfo['OPERATIONS.Are you on the Mall Concourse?'] == 'No') {
	addFee("SCNM","LICSCC","FINAL",squareFoot,"Y");
	}
`^
CMN;Licenses!Vending!SidewalkCafe!Renewal;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	}

if (getAppSpecific("OPERATIONS.Number of Chairs", rnwCapId) <= 9) {
	addFee("SCA","LICSCC","FINAL",1,"Y");
	} else {
	removeFee("SCA","FINAL");
	}

if (getAppSpecific("OPERATIONS.Number of Chairs", rnwCapId) > 9 && getAppSpecific("OPERATIONS.Number of Chairs", rnwCapId) <= 15) {
	addFee("SCA15","LICSCC","FINAL",1,"Y");
	} else {
	removeFee("SCA15","FINAL");
	}

if (getAppSpecific("OPERATIONS.Number of Chairs", rnwCapId) > 15 && getAppSpecific("OPERATIONS.Number of Chairs", rnwCapId) <= 20) {
	addFee("SCA20","LICSCC","FINAL",1,"Y");
	} else {
	removeFee("SCA20","FINAL");
	}

if (getAppSpecific("OPERATIONS.Number of Chairs", rnwCapId) > 20) {
	addFee("SCAABV","LICSCC","FINAL",1,"Y");
	} else {
	removeFee("SCAABV","FINAL");
	}
`^
CMN;Licenses!Vending!SoutheastCampusVening!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
addFee("ANNUAL","LICSCV","FINAL",1,"Y");
`^
CMN;Licenses!Vending!SoutheastCampusVening!Renewal;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
addFee("ANNUAL","LICSCV","FINAL",1,"Y");
`^
CMN;Licenses!Vending!StreetVendor!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['APPLICANT TYPE.Type of License'] == "Annual" && (AInfo['APPLICANT TYPE.Umbrella License'] != "CHECKED" && (AInfo['APPLICANT TYPE.Meet and Eat 5 Hour Visits'] == 0 || AInfo['APPLICANT TYPE.Meet and Eat 5 Hour Visits'] == null))) {
	addFee("SVA","LICSV","FINAL",1,"Y");
	} else {
	removeFee("SVA","FINAL");
	}

if (AInfo['APPLICANT TYPE.Type of License'] == "Annual" && (AInfo['APPLICANT TYPE.Umbrella License'] == "CHECKED" && (AInfo['APPLICANT TYPE.Meet and Eat 5 Hour Visits'] == 0 || AInfo['APPLICANT TYPE.Meet and Eat 5 Hour Visits'] == null))) {
	addFee("UMB","LICSV","FINAL",1,"Y");
	} else {
	removeFee("UMB","FINAL");
	}

if (AInfo['APPLICANT TYPE.Type of License'] == "Annual" && AInfo['APPLICANT TYPE.Meet and Eat 5 Hour Visits'] > 0) {
	addFee("SVAME","LICSV","FINAL",AInfo['APPLICANT TYPE.Meet and Eat 5 Hour Visits'],"Y");
	} else {
	removeFee("SVAME","FINAL");
	}

if (AInfo['APPLICANT TYPE.Type of License'] != "Annual" && AInfo['APPLICANT TYPE.Enter Number of 30-Day Increments'] > 0) {
	addFee("SVM","LICSV","FINAL",AInfo['APPLICANT TYPE.Enter Number of 30-Day Increments'],"Y");
	} else {
	removeFee("SVM","FINAL");
	}
`^
CMN;Licenses!Vending!StreetVendor!Renewal;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	}

if (getAppSpecific("APPLICANT TYPE.Type of License", rnwCapId) == "Annual" && (getAppSpecific("APPLICANT TYPE.Meet and Eat 5 Hour Visits", capId) == 0 || getAppSpecific("APPLICANT TYPE.Meet and Eat 5 Hour Visits", capId) == null)) {
	addFee("SVA","LICSV","FINAL",1,"Y");
	} else {
	removeFee("SVA","FINAL");
	}

if (getAppSpecific("APPLICANT TYPE.Type of License", rnwCapId) == "Annual" && getAppSpecific("APPLICANT TYPE.Meet and Eat 5 Hour Visits", capId) > 0) {
	addFee("SVAME","LICSV","FINAL",getAppSpecific("APPLICANT TYPE.Meet and Eat 5 Hour Visits", capId),"Y");
	} else {
	removeFee("SVAME","FINAL");
	}

if (getAppSpecific("APPLICANT TYPE.Type of License", rnwCapId) != "Annual" && getAppSpecific("APPLICANT TYPE.Enter Number of 30-Day Increments", rnwCapId) > 0) {
	addFee("SVM","LICSV","FINAL",getAppSpecific("APPLICANT TYPE.Enter Number of 30-Day Increments", rnwCapId),"Y");
	} else {
	removeFee("SVM","FINAL");
	}
`^
CMN;Licenses!Vending!TOSVOD!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if ((AInfo['APPLICANT INFORMATION.Merchant Vending License'] == null || AInfo['APPLICANT INFORMATION.Merchant Vending License'] == "") && (AInfo['APPLICANT INFORMATION.Art and Craft Vending License'] == null || AInfo['APPLICANT INFORMATION.Art and Craft Vending License'] == "") && (AInfo['APPLICANT INFORMATION.Sidewalk Cafe License'] == null || AInfo['APPLICANT INFORMATION.Sidewalk Cafe License'] == "")) {
	addFee("TOS_ANNUAL","LICTOS","FINAL",1,"Y");
	} else {
	removeFee("TOS_ANNUAL","FINAL");
	}
`^
CMN;Licensing!Clerk!Beer Liquor!~;Email^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
emailText = "<p>New Madison Liquor License Application<!p>";
emailText += "<p><b>Application ID;<!b> " + capIDString + "<!p>";
emailText += "<p><b>Establishment Name; <!b>"+ getShortNotes() +"<!p>";
include("EML;AddressInformation");
email("cehagen@cityofmadison.com","noreply@cityofmadison.com","New Madison Liquor License Application",emailText);
`^
CMN;Licensing!Clerk!Class A Beer Liquor!~;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = true;
varPubFeeQty = 0;
if (AInfo['LICENSE TYPE REQUESTED.Class A Beer License'] == "CHECKED") {
	varPubFeeQty = varPubFeeQty + 1;
	}

if (AInfo['LICENSE TYPE REQUESTED.Class A Liquor License'] == "CHECKED") {
	varPubFeeQty = varPubFeeQty + 1;
	}

if (AInfo['LICENSE TYPE REQUESTED.Class A Cider License'] == "CHECKED") {
	varPubFeeQty = varPubFeeQty + 1;
	}

if (AInfo['LICENSE TYPE REQUESTED.Class A Grocery Convenience Store License'] == "CHECKED") {
	varPubFeeQty = varPubFeeQty + 1;
	}

if (varPubFeeQty >= 0) {
	updateFee ("PUBA","LICLIQA","FINAL",1,"N");
	}

include("CMN;Licensing!Clerk!Class A Beer Liquor!~;LicenseRenewalFee");
`^
CMN;Licensing!Clerk!Class A Beer Liquor!~;LicenseRenewalFee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
if (AInfo['LICENSE TYPE REQUESTED.Class A Beer License'] == "CHECKED") {
	if(feeExists("LIQABRNW") == false) updateFee("LIQABRNW","LICLIQA","FINAL",1,"N");
	} else {
	removeFee("LIQABRNW","FINAL");
	}

if (AInfo['LICENSE TYPE REQUESTED.Class A Liquor License'] == "CHECKED") {
	if(feeExists("LIQALRNW") == false) updateFee("LIQALRNW","LICLIQA","FINAL",1,"N");
	} else {
	removeFee("LIQALRNW","FINAL");
	}

if (AInfo['LICENSE TYPE REQUESTED.Class A Grocery Convenience Store License'] == "CHECKED") {
	if(feeExists("LIQAGRNW") == false) updateFee("LIQAGRNW","LICLIQA","FINAL",1,"N");
	} else {
	removeFee("LIQAGRNW","FINAL");
	}

updateFee("PUBAREN","LICLIQA","FINAL",1,"N");
`^
CMN;Licensing!Clerk!Class B Beer Liquor!~;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
varPubFeeQty = 0;
if (AInfo['LICENSE TYPE REQUESTED.Class B Combination'] == "CHECKED") {
	varPubFeeQty = varPubFeeQty + 1;
	}

if (AInfo['LICENSE TYPE REQUESTED.Class B Beer Only'] == "CHECKED") {
	varPubFeeQty = varPubFeeQty + 1;
	}

if (AInfo['LICENSE TYPE REQUESTED.Class C Wine'] == "CHECKED") {
	varPubFeeQty = varPubFeeQty + 1;
	}

if (AInfo['LICENSE TYPE REQUESTED.Wholesale Beer'] == "CHECKED") {
	varPubFeeQty = varPubFeeQty + 1;
	}

if (varPubFeeQty >= 0) {
	updateFee ("PUB","LICLIQB","FINAL",1,"N");
	}

if (AInfo['OFFICE USE ONLY.Reserve-Grandfathered'] == "Reserve") {
	if(feeExists("LIQBRESREF") == false) updateFee("LIQBRESREF","LICLIQB","FINAL",1,"N");
	if(feeExists("LIQBRESNOREF") == false) updateFee("LIQBRESNOREF","LICLIQB","FINAL",1,"N");
	} else {
	removeFee("LIQBRESREF","FINAL");
	removeFee("LIQBRESNOREF","FINAL");
	}

include("CMN;Licensing!Clerk!Class B Beer Liquor!~;LicenseRenewalFee");
`^
CMN;Licensing!Clerk!Class B Beer Liquor!~;LicenseRenewalFee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['LICENSE TYPE REQUESTED.Class B Combination'] == "CHECKED") {
	if(feeExists("LIQBLRNW") == false) updateFee("LIQBLRNW","LICLIQB","FINAL",1,"N");
	} else {
	removeFee("LIQBLRNW","FINAL");
	}

if (AInfo['LICENSE TYPE REQUESTED.Class B Beer Only'] == "CHECKED") {
	if(feeExists("LIQBBRNW") == false) updateFee("LIQBBRNW","LICLIQB","FINAL",1,"N");
	} else {
	removeFee("LIQBBRNW","FINAL");
	}

if (AInfo['LICENSE TYPE REQUESTED.Class C Wine'] == "CHECKED") {
	if(feeExists("LIQBWRNW") == false) updateFee("LIQBWRNW","LICLIQB","FINAL",1,"N");
	} else {
	removeFee("LIQBWRNW","FINAL");
	}

if (AInfo['LICENSE TYPE REQUESTED.Wholesale Beer'] == "CHECKED") {
	if(feeExists("LIQWHLR") == false) updateFee("LIQWHLR","LICLIQB","FINAL",1,"N");
	} else {
	removeFee("LIQWHLR","FINAL");
	}

updateFee("PUBREN","LICLIQB","FINAL",1,"N");
`^
CMN;Licensing!Health!Class B Beer Liquor!~;LicenseFee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (AInfo['OFFICE USE ONLY.Reserved-Grandfathered'] == "CHECKED") {
	updateFee ("LIQBGRFTHR","LICLIQB","FINAL",1,"N");
	}
`^
CMN;Licensing!Health!Food and Drink!~;HealthPenaltyFee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = true;
feeAry= loadFees();
logDebug("Fee Array"+feeAry);
`^
CMN;Licensing!Health!Food and Drink!~;LicenseFee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "A 0-10,000" && AInfo['PRIMARILY RESTAURANT.S; Meals prepared when food is ordered, limited food prep - mixing prepackaged foods'] == "CHECKED") {
	updateFee("201SPHMDC","LICFD201","FINAL",1,"N");
	updateFee("201SREIMB","LICFD201","FINAL",1,"N");
	updateFee("201SPI","LICFD201","FINAL",1,"N");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "A 0-10,000" && AInfo['PRIMARILY RESTAURANT.M; Raw food handled, buffet, drive through, delivery, food cooled or reheated, unlimited food prep'] == "CHECKED") {
	updateFee("201MPHMDC","LICFD201","FINAL",1,"N");
	updateFee("201MREIMB","LICFD201","FINAL",1,"N");
	updateFee("201MPI","LICFD201","FINAL",1,"N");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "A 0-10,000" && AInfo['PRIMARILY RESTAURANT.C; All of the above and also transport of food, banquet facilities'] == "CHECKED") {
	updateFee("201CPHMDC","LICFD201","FINAL",1,"N");
	updateFee("201CREIMB","LICFD201","FINAL",1,"N");
	updateFee("201CPI","LICFD201","FINAL",1,"N");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "B 10,001-100,000" && AInfo['PRIMARILY RESTAURANT.S; Meals prepared when food is ordered, limited food prep - mixing prepackaged foods'] == "CHECKED") {
	updateFee("202SPHMDC","LICFD202","FINAL",1,"N");
	updateFee("202SREIMB","LICFD202","FINAL",1,"N");
	updateFee("202SPI","LICFD202","FINAL",1,"N");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "B 10,001-100,000" && AInfo['PRIMARILY RESTAURANT.M; Raw food handled, buffet, drive through, delivery, food cooled or reheated, unlimited food prep'] == "CHECKED") {
	updateFee("202MPHMDC","LICFD202","FINAL",1,"N");
	updateFee("202MREIMB","LICFD202","FINAL",1,"N");
	updateFee("202MPI","LICFD202","FINAL",1,"N");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "B 10,001-100,000" && AInfo['PRIMARILY RESTAURANT.C; All of the above and also transport of food, banquet facilities'] == "CHECKED") {
	updateFee("202CPHMDC","LICFD202","FINAL",1,"N");
	updateFee("202CREIMB","LICFD202","FINAL",1,"N");
	updateFee("202CPI","LICFD202","FINAL",1,"N");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "C 100,001-250,000" && AInfo['PRIMARILY RESTAURANT.S; Meals prepared when food is ordered, limited food prep - mixing prepackaged foods'] == "CHECKED") {
	updateFee("203SPHMDC","LICFD203","FINAL",1,"N");
	updateFee("203SREIMB","LICFD203","FINAL",1,"N");
	updateFee("203SPI","LICFD203","FINAL",1,"N");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "C 100,001-250,000" && AInfo['PRIMARILY RESTAURANT.M; Raw food handled, buffet, drive through, delivery, food cooled or reheated, unlimited food prep'] == "CHECKED") {
	updateFee("203MPHMDC","LICFD203","FINAL",1,"N");
	updateFee("203MREIMB","LICFD203","FINAL",1,"N");
	updateFee("203MPI","LICFD203","FINAL",1,"N");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "C 100,001-250,000" && AInfo['PRIMARILY RESTAURANT.C; All of the above and also transport of food, banquet facilities'] == "CHECKED") {
	updateFee("203CPHMDC","LICFD203","FINAL",1,"N");
	updateFee("203CREIMB","LICFD203","FINAL",1,"N");
	updateFee("203CPI","LICFD203","FINAL",1,"N");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "D 250,001-500,000" && AInfo['PRIMARILY RESTAURANT.S; Meals prepared when food is ordered, limited food prep - mixing prepackaged foods'] == "CHECKED") {
	updateFee("204SPHMDC","LICFD204","FINAL",1,"N");
	updateFee("204SREIMB","LICFD204","FINAL",1,"N");
	updateFee("204SPI","LICFD204","FINAL",1,"N");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "D 250,001-500,000" && AInfo['PRIMARILY RESTAURANT.M; Raw food handled, buffet, drive through, delivery, food cooled or reheated, unlimited food prep'] == "CHECKED") {
	updateFee("204MPHMDC","LICFD204","FINAL",1,"N");
	updateFee("204MREIMB","LICFD204","FINAL",1,"N");
	updateFee("204MPI","LICFD204","FINAL",1,"N");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "D 250,001-500,000" && AInfo['PRIMARILY RESTAURANT.C; All of the above and also transport of food, banquet facilities'] == "CHECKED") {
	updateFee("204CPHMDC","LICFD204","FINAL",1,"N");
	updateFee("204CREIMB","LICFD204","FINAL",1,"N");
	updateFee("204CPI","LICFD204","FINAL",1,"N");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "F 1,000,000-5,000,000" && AInfo['PRIMARILY RESTAURANT.S; Meals prepared when food is ordered, limited food prep - mixing prepackaged foods'] == "CHECKED") {
	updateFee("205SPHMDC","LICFD205","FINAL",1,"N");
	updateFee("205SREIMB","LICFD205","FINAL",1,"N");
	updateFee("205SPI","LICFD205","FINAL",1,"N");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "F 1,000,000-5,000,000" && AInfo['PRIMARILY RESTAURANT.M; Raw food handled, buffet, drive through, delivery, food cooled or reheated, unlimited food prep'] == "CHECKED") {
	updateFee("205MPHMDC","LICFD205","FINAL",1,"N");
	updateFee("205MREIMB","LICFD205","FINAL",1,"N");
	updateFee("205MPI","LICFD205","FINAL",1,"N");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "F 1,000,000-5,000,000" && AInfo['PRIMARILY RESTAURANT.C; All of the above and also transport of food, banquet facilities'] == "CHECKED") {
	updateFee("205CPHMDC","LICFD205","FINAL",1,"N");
	updateFee("205CREIMB","LICFD205","FINAL",1,"N");
	updateFee("205CPI","LICFD205","FINAL",1,"N");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "G Over 5,000,000" && AInfo['PRIMARILY RESTAURANT.S; Meals prepared when food is ordered, limited food prep - mixing prepackaged foods'] == "CHECKED") {
	updateFee("206SPHMDC","LICFD206","FINAL",1,"N");
	updateFee("206SREIMB","LICFD206","FINAL",1,"N");
	updateFee("206SPI","LICFD206","FINAL",1,"N");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "G Over 5,000,000" && AInfo['PRIMARILY RESTAURANT.M; Raw food handled, buffet, drive through, delivery, food cooled or reheated, unlimited food prep'] == "CHECKED") {
	updateFee("206MPHMDC","LICFD206","FINAL",1,"N");
	updateFee("206MREIMB","LICFD206","FINAL",1,"N");
	updateFee("206MPI","LICFD206","FINAL",1,"N");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "G Over 5,000,000" && AInfo['PRIMARILY RESTAURANT.C; All of the above and also transport of food, banquet facilities'] == "CHECKED") {
	updateFee("206CPHMDC","LICFD206","FINAL",1,"N");
	updateFee("206CREIMB","LICFD206","FINAL",1,"N");
	updateFee("206CPI","LICFD206","FINAL",1,"N");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "A 0-10,000" && AInfo['RETAIL FOOD ESTABLISHMENT.No Food Processing - 55'] == "CHECKED") {
	updateFee("20155PHMDC","LICFD201","FINAL",1,"N");
	updateFee("20155REIMB","LICFD201","FINAL",1,"N");
	updateFee("20155PI","LICFD201","FINAL",1,"N");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "A 0-10,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing - Sales Less Than $25,000 - 44'] == "CHECKED") {
	updateFee("20144PHMDC","LICFD201","FINAL",1,"N");
	updateFee("20144REIMB","LICFD201","FINAL",1,"N");
	updateFee("20144PI","LICFD201","FINAL",1,"N");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "B 10,001-100,000" && AInfo['RETAIL FOOD ESTABLISHMENT.No Food Processing - 55'] == "CHECKED") {
	updateFee("20255PHMDC","LICFD202","FINAL",1,"N");
	updateFee("20255REIMB","LICFD202","FINAL",1,"N");
	updateFee("20255PI","LICFD202","FINAL",1,"N");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "B 10,001-100,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing Non-Hazardous - Sales Higher Than $25,000 - 33'] == "CHECKED") {
	updateFee("20233PHMDC","LICFD202","FINAL",1,"N");
	updateFee("20233REIMB","LICFD202","FINAL",1,"N");
	updateFee("20233PI","LICFD202","FINAL",1,"N");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "B 10,001-100,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing Potentially Hazardous - Sales Higher Than $25,000 but < $1,000,000 - 22'] == "CHECKED") {
	updateFee("20222PHMDC","LICFD202","FINAL",1,"N");
	updateFee("20222REIMB","LICFD202","FINAL",1,"N");
	updateFee("20222PI","LICFD202","FINAL",1,"N");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "C 100,001-250,000" && AInfo['RETAIL FOOD ESTABLISHMENT.No Food Processing - 55'] == "CHECKED") {
	updateFee("20355PHMDC","LICFD203","FINAL",1,"N");
	updateFee("20355REIMB","LICFD203","FINAL",1,"N");
	updateFee("20355PI","LICFD203","FINAL",1,"N");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "C 100,001-250,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing Non-Hazardous - Sales Higher Than $25,000 - 33'] == "CHECKED") {
	updateFee("20333PHMDC","LICFD203","FINAL",1,"N");
	updateFee("20333REIMB","LICFD203","FINAL",1,"N");
	updateFee("20333PI","LICFD203","FINAL",1,"N");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "C 100,001-250,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing Potentially Hazardous - Sales Higher Than $25,000 but < $1,000,000 - 22'] == "CHECKED") {
	updateFee("20322PHMDC","LICFD203","FINAL",1,"N");
	updateFee("20322REIMB","LICFD203","FINAL",1,"N");
	updateFee("20322PI","LICFD203","FINAL",1,"N");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "D 250,001-500,000" && AInfo['RETAIL FOOD ESTABLISHMENT.No Food Processing - 55'] == "CHECKED") {
	updateFee("20455PHMDC","LICFD204","FINAL",1,"N");
	updateFee("20455REIMB","LICFD204","FINAL",1,"N");
	updateFee("20455PI","LICFD204","FINAL",1,"N");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "D 250,001-500,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing Non-Hazardous - Sales Higher Than $25,000 - 33'] == "CHECKED") {
	updateFee("20433PHMDC","LICFD204","FINAL",1,"N");
	updateFee("20433REIMB","LICFD204","FINAL",1,"N");
	updateFee("20433PI","LICFD204","FINAL",1,"N");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "D 250,001-500,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing Potentially Hazardous - Sales Higher Than $25,000 but < $1,000,000 - 22'] == "CHECKED") {
	updateFee("20422PHMDC","LICFD204","FINAL",1,"N");
	updateFee("20422REIMB","LICFD204","FINAL",1,"N");
	updateFee("20422PI","LICFD204","FINAL",1,"N");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "F 1,000,001-5,000,000" && AInfo['RETAIL FOOD ESTABLISHMENT.No Food Processing - 55'] == "CHECKED") {
	updateFee("20555PHMDC","LICFD205","FINAL",1,"N");
	updateFee("20555REIMB","LICFD205","FINAL",1,"N");
	updateFee("20555PI","LICFD205","FINAL",1,"N");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "F 1,000,001-5,000,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing Non-Hazardous - Sales Higher Than $25,000 - 33'] == "CHECKED") {
	updateFee("20533PHMDC","LICFD205","FINAL",1,"N");
	updateFee("20533REIMB","LICFD205","FINAL",1,"N");
	updateFee("20533PI","LICFD205","FINAL",1,"N");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "F 1,000,001-5,000,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing Potentially Hazardous - Sales Higher Than $1,000,000 - 11'] == "CHECKED") {
	updateFee("20511PHMDC","LICFD205","FINAL",1,"N");
	updateFee("20511REIMB","LICFD205","FINAL",1,"N");
	updateFee("20511PI","LICFD205","FINAL",1,"N");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "G Over 5,000,000" && AInfo['RETAIL FOOD ESTABLISHMENT.No Food Processing - 55'] == "CHECKED") {
	updateFee("20655PHMDC","LICFD206","FINAL",1,"N");
	updateFee("20655REIMB","LICFD206","FINAL",1,"N");
	updateFee("20655PI","LICFD206","FINAL",1,"N");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "G Over 5,000,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing Non-Hazardous - Sales Higher Than $25,000 - 33'] == "CHECKED") {
	updateFee("20633PHMDC","LICFD206","FINAL",1,"N");
	updateFee("20633REIMB","LICFD206","FINAL",1,"N");
	updateFee("20633PI","LICFD206","FINAL",1,"N");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "G Over 5,000,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing Potentially Hazardous - Sales Higher Than $1,000,000 - 11'] == "CHECKED") {
	updateFee("20611PHMDC","LICFD206","FINAL",1,"N");
	updateFee("20611REIMB","LICFD206","FINAL",1,"N");
	updateFee("20611PI","LICFD206","FINAL",1,"N");
	}

if (AInfo['RESTAURANT MOBILE BASE ONLY.S; Meals prepared when food is ordered, limited food prep - mixing prepackaged foods'] == "CHECKED") {
	updateFee("215SPHMDC","LICFD215","FINAL",1,"N");
	updateFee("215SREIMB","LICFD215","FINAL",1,"N");
	updateFee("215SPI","LICFD215","FINAL",1,"N");
	}

if (AInfo['RESTAURANT MOBILE BASE ONLY.M; Raw food handled, buffet, drive through, delivery, food cooled or reheated, unlimited food prep'] == "CHECKED") {
	updateFee("215MPHMDC","LICFD215","FINAL",1,"N");
	updateFee("215MREIMB","LICFD215","FINAL",1,"N");
	updateFee("215MPI","LICFD215","FINAL",1,"N");
	}

if (AInfo['RESTAURANT MOBILE BASE ONLY.C; All of the above and also transport of food, banquet facilities'] == "CHECKED") {
	updateFee("215CPHMDC","LICFD215","FINAL",1,"N");
	updateFee("215CREIMB","LICFD215","FINAL",1,"N");
	updateFee("215CPI","LICFD215","FINAL",1,"N");
	}

if (AInfo['RETAIL MOBILE BASE ONLY.No Food Processing - 55'] == "CHECKED") {
	updateFee("21555PHMDC","LICFD215","FINAL",1,"N");
	updateFee("21555REIMB","LICFD215","FINAL",1,"N");
	updateFee("21555PI","LICFD215","FINAL",1,"N");
	}

if (AInfo['RETAIL MOBILE BASE ONLY.Food Processing - Sales Less Than $25,000 - 44'] == "CHECKED") {
	updateFee("21544PHMDC","LICFD215","FINAL",1,"N");
	updateFee("21544REIMB","LICFD215","FINAL",1,"N");
	updateFee("21544PI","LICFD215","FINAL",1,"N");
	}

if (AInfo['RETAIL MOBILE CART ONLY.Gross food sales per year'] == "0-10,000" && AInfo['RETAIL MOBILE CART ONLY.No Food Processing - 55'] == "CHECKED") {
	updateFee("21155PHMDC","LICFD211","FINAL",1,"N");
	updateFee("21155REIMB","LICFD211","FINAL",1,"N");
	updateFee("21155PI","LICFD211","FINAL",1,"N");
	}

if (AInfo['RETAIL MOBILE CART ONLY.Gross food sales per year'] == "0-10,000" && AInfo['RETAIL MOBILE CART ONLY.Food Processing - Sales Less Than $25,000 - 44'] == "CHECKED") {
	updateFee("21144PHMDC","LICFD211","FINAL",1,"N");
	updateFee("21144REIMB","LICFD211","FINAL",1,"N");
	updateFee("21144PI","LICFD211","FINAL",1,"N");
	}

if (AInfo['RETAIL MOBILE CART ONLY.Gross food sales per year'] == "10,001-100,000" && AInfo['RETAIL MOBILE CART ONLY.No Food Processing - 55'] == "CHECKED") {
	updateFee("21255PHMDC","LICFD212","FINAL",1,"N");
	updateFee("21255REIMB","LICFD212","FINAL",1,"N");
	updateFee("21255PI","LICFD212","FINAL",1,"N");
	}

if (AInfo['RETAIL MOBILE CART ONLY.Gross food sales per year'] == "10,001-100,000" && AInfo['RETAIL MOBILE CART ONLY.Food Processing Non-Hazardous - Sales Higher Than $25,000 - 33'] == "CHECKED") {
	updateFee("21233PHMDC","LICFD212","FINAL",1,"N");
	updateFee("21233REIMB","LICFD212","FINAL",1,"N");
	updateFee("21233PI","LICFD212","FINAL",1,"N");
	}

if (AInfo['RETAIL MOBILE CART ONLY.Gross food sales per year'] == "10,001-100,000" && AInfo['RETAIL MOBILE CART ONLY.Food Processing Potentially Hazardous - Sales Higher Than $25,000 but < $1,000,000 - 22'] == "CHECKED") {
	updateFee("21222PHMDC","LICFD212","FINAL",1,"N");
	updateFee("21222REIMB","LICFD212","FINAL",1,"N");
	updateFee("21222PI","LICFD212","FINAL",1,"N");
	}

if (AInfo['RETAIL MOBILE CART ONLY.Gross food sales per year'] == "100,001-250,000" && AInfo['RETAIL MOBILE CART ONLY.No Food Processing - 55'] == "CHECKED") {
	updateFee("21355PHMDC","LICFD213","FINAL",1,"N");
	updateFee("21355REIMB","LICFD213","FINAL",1,"N");
	updateFee("21355PI","LICFD213","FINAL",1,"N");
	}

if (AInfo['RETAIL MOBILE CART ONLY.Gross food sales per year'] == "100,001-250,000" && AInfo['RETAIL MOBILE CART ONLY.Food Processing Non-Hazardous - Sales Higher Than $25,000 - 33'] == "CHECKED") {
	updateFee("21333PHMDC","LICFD213","FINAL",1,"N");
	updateFee("21333REIMB","LICFD213","FINAL",1,"N");
	updateFee("21333PI","LICFD213","FINAL",1,"N");
	}

if (AInfo['RETAIL MOBILE CART ONLY.Gross food sales per year'] == "100,001-250,000" && AInfo['RETAIL MOBILE CART ONLY.Food Processing Potentially Hazardous - Sales Higher Than $25,000 but < $1,000,000 - 22'] == "CHECKED") {
	updateFee("21322PHMDC","LICFD213","FINAL",1,"N");
	updateFee("21322REIMB","LICFD213","FINAL",1,"N");
	updateFee("21322PI","LICFD213","FINAL",1,"N");
	}

if (AInfo['RESTAURANT MOBILE CART.Gross food sales per year'] == "0-10,000" && AInfo['RESTAURANT MOBILE CART.S; Meals prepared when food is ordered, limited food prep - mixing prepackaged foods'] == "CHECKED") {
	updateFee("211SPHMDC","LICFD211","FINAL",1,"n");
	updateFee("211SREIMB","LICFD211","FINAL",1,"n");
	updateFee("211SPI","LICFD211","FINAL",1,"n");
	}

if (AInfo['RESTAURANT MOBILE CART.Gross food sales per year'] == "0-10,000" && AInfo['RESTAURANT MOBILE CART.M; Raw food handled, buffet, drive through, delivery, food cooled or reheated, unlimited food prep'] == "CHECKED") {
	updateFee("211MPHMDC","LICFD211","FINAL",1,"n");
	updateFee("211MREIMB","LICFD211","FINAL",1,"n");
	updateFee("211MPI","LICFD211","FINAL",1,"n");
	}

if (AInfo['RESTAURANT MOBILE CART.Gross food sales per year'] == "0-10,000" && AInfo['RESTAURANT MOBILE CART.C; All of the above and also transport of food, banquet facilities'] == "CHECKED") {
	updateFee("211CPHMDC","LICFD211","FINAL",1,"n");
	updateFee("211CREIMB","LICFD211","FINAL",1,"n");
	updateFee("211CPI","LICFD211","FINAL",1,"n");
	}

if (AInfo['RESTAURANT MOBILE CART.Gross food sales per year'] == "10,001-100,000" && AInfo['RESTAURANT MOBILE CART.S; Meals prepared when food is ordered, limited food prep - mixing prepackaged foods'] == "CHECKED") {
	updateFee("212SPHMDC","LICFD212","FINAL",1,"n");
	updateFee("212SREIMB","LICFD212","FINAL",1,"n");
	updateFee("212SPI","LICFD212","FINAL",1,"n");
	}

if (AInfo['RESTAURANT MOBILE CART.Gross food sales per year'] == "10,001-100,000" && AInfo['RESTAURANT MOBILE CART.M; Raw food handled, buffet, drive through, delivery, food cooled or reheated, unlimited food prep'] == "CHECKED") {
	updateFee("212MPHMDC","LICFD212","FINAL",1,"n");
	updateFee("212MREIMB","LICFD212","FINAL",1,"n");
	updateFee("212MPI","LICFD212","FINAL",1,"n");
	}

if (AInfo['RESTAURANT MOBILE CART.Gross food sales per year'] == "10,001-100,000" && AInfo['RESTAURANT MOBILE CART.C; All of the above and also transport of food, banquet facilities'] == "CHECKED") {
	updateFee("212CPHMDC","LICFD212","FINAL",1,"n");
	updateFee("212CREIMB","LICFD212","FINAL",1,"n");
	updateFee("212CPI","LICFD212","FINAL",1,"n");
	}

if (AInfo['RESTAURANT MOBILE CART.Gross food sales per year'] == "100,001-250,000" && AInfo['RESTAURANT MOBILE CART.S; Meals prepared when food is ordered, limited food prep - mixing prepackaged foods'] == "CHECKED") {
	updateFee("213SPHMDC","LICFD213","FINAL",1,"n");
	updateFee("213SREIMB","LICFD213","FINAL",1,"n");
	updateFee("213SPI","LICFD213","FINAL",1,"n");
	}

if (AInfo['RESTAURANT MOBILE CART.Gross food sales per year'] == "100,001-250,000" && AInfo['RESTAURANT MOBILE CART.M; Raw food handled, buffet, drive through, delivery, food cooled or reheated, unlimited food prep'] == "CHECKED") {
	updateFee("213MPHMDC","LICFD213","FINAL",1,"N");
	updateFee("213MREIMB","LICFD213","FINAL",1,"N");
	updateFee("213MPI","LICFD213","FINAL",1,"N");
	}

if (AInfo['RESTAURANT MOBILE CART.Gross food sales per year'] == "100,001-250,000" && AInfo['RESTAURANT MOBILE CART.C; All of the above and also transport of food, banquet facilities'] == "CHECKED") {
	updateFee("213CPHMDC","LICFD213","FINAL",1,"N");
	updateFee("213CREIMB","LICFD213","FINAL",1,"N");
	updateFee("213CPI","LICFD213","FINAL",1,"N");
	}

if (AInfo['FARMERS MARKET.Gross food sales per year'] == "0-10,000") {
	updateFee("21655PHMDC","LICFD216","FINAL",1,"N");
	updateFee("21655REIMB","LICFD216","FINAL",1,"N");
	updateFee("21655PI","LICFD216","FINAL",1,"N");
	}

if (AInfo['FARMERS MARKET.Gross food sales per year'] == "10,001-100,000") {
	updateFee("21755PHMDC","LICFD217","FINAL",1,"N");
	updateFee("21755REIMB","LICFD217","FINAL",1,"N");
	updateFee("21755PI","LICFD217","FINAL",1,"N");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "A 0-10,000" && AInfo['PRIMARILY RESTAURANT.S; Meals prepared when food is ordered, limited food prep - mixing prepackaged foods'] != "CHECKED" && AInfo['PRIMARILY RESTAURANT.M; Raw food handled, buffet, drive through, delivery, food cooled or reheated, unlimited food prep'] != "CHECKED" && AInfo['PRIMARILY RESTAURANT.C; All of the above and also transport of food, banquet facilities'] != "CHECKED") {
	updateFee("201TAVPHMDC","LICFD201","FINAL",1,"N");
	updateFee("201LRPI","LICFD201","FINAL",1,"N");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "B 10,001-100,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing - Sales Less Than $25,000 - 44'] == "CHECKED") {
	updateFee("20244PHMDC","LICFD202","FINAL",1,"N");
	updateFee("20244REIMB","LICFD202","FINAL",1,"N");
	updateFee("20244PI","LICFD202","FINAL",1,"N");
	}

if (AInfo['RETAIL MOBILE CART ONLY.Gross food sales per year'] == "10,001-100,000" && AInfo['RETAIL MOBILE CART ONLY.Food Processing - Sales Less Than $25,000 - 44'] == "CHECKED") {
	updateFee("21244PHMDC","LICFD212","FINAL",1,"N");
	updateFee("21244REIMB","LICFD212","FINAL",1,"N");
	updateFee("21244PI","LICFD212","FINAL",1,"N");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "E 500,001-1,000,000" && AInfo['PRIMARILY RESTAURANT.S; Meals prepared when food is ordered, limited food prep - mixing prepackaged foods'] == "CHECKED") {
	updateFee("207SPHMDC","LICFD207","FINAL",1,"N");
	updateFee("207SREIMB","LICFD207","FINAL",1,"N");
	updateFee("207SPI","LICFD207","FINAL",1,"N");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "E 500,001-1,000,000" && AInfo['PRIMARILY RESTAURANT.M; Raw food handled, buffet, drive through, delivery, food cooled or reheated, unlimited food prep'] == "CHECKED") {
	updateFee("207MPHMDC","LICFD207","FINAL",1,"N");
	updateFee("207MREIMB","LICFD207","FINAL",1,"N");
	updateFee("207MPI","LICFD207","FINAL",1,"N");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "E 500,001-1,000,000" && AInfo['PRIMARILY RESTAURANT.C; All of the above and also transport of food, banquet facilities'] == "CHECKED") {
	updateFee("207CPHMDC","LICFD207","FINAL",1,"N");
	updateFee("207CREIMB","LICFD207","FINAL",1,"N");
	updateFee("207CPI","LICFD207","FINAL",1,"N");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "E 500,001-1,000,000" && AInfo['RETAIL FOOD ESTABLISHMENT.No Food Processing - 55'] == "CHECKED") {
	updateFee("20755PHMDC","LICFD207","FINAL",1,"N");
	updateFee("20755REIMB","LICFD207","FINAL",1,"N");
	updateFee("20755PI","LICFD207","FINAL",1,"N");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "E 500,001-1,000,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing Non-Hazardous - Sales Higher Than $25,000 - 33'] == "CHECKED") {
	updateFee("20733PHMDC","LICFD207","FINAL",1,"N");
	updateFee("20733REIMB","LICFD207","FINAL",1,"N");
	updateFee("20733PI","LICFD207","FINAL",1,"N");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "E 500,001-1,000,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing Potentially Hazardous - Sales Higher Than $25,000 but < $1,000,000 - 22'] == "CHECKED") {
	updateFee("20722PHMDC","LICFD207","FINAL",1,"N");
	updateFee("20722REIMB","LICFD207","FINAL",1,"N");
	updateFee("20722PI","LICFD207","FINAL",1,"N");
	}

if (AInfo['MICRO MARKET.No Food Processing - 55'] == "CHECKED") {
	updateFee("FDMM55PHMDC","LICFDMISC","FINAL",1,"N");
	updateFee("FDMM55REIMB","LICFDMISC","FINAL",1,"N");
	updateFee("FDMM55PI","LICFDMISC","FINAL",1,"N");
	}
`^
CMN;Licensing!Health!Food and Drink!~;LicenseRenewalFee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
logDebug("In CMN;Licensing!Health!Food and Drink!~;LicenseRenewalFee");
if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "A 0-10,000" && AInfo['PRIMARILY RESTAURANT.S; Meals prepared when food is ordered, limited food prep - mixing prepackaged foods'] == "CHECKED") {
	if(feeExists("201SPHMDC")==false) updateFee("201SPHMDC","LICFD201RNW","FINAL",1,"N");
	if(feeExists("201SREIMB")==false) updateFee("201SREIMB","LICFD201RNW","FINAL",1,"N");
	} else {
	removeFee("201SPHMDC","FINAL");
	removeFee("201SREIMB","FINAL");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "A 0-10,000" && AInfo['PRIMARILY RESTAURANT.M; Raw food handled, buffet, drive through, delivery, food cooled or reheated, unlimited food prep'] == "CHECKED") {
	if(feeExists("201MPHMDC")==false) updateFee("201MPHMDC","LICFD201RNW","FINAL",1,"N");
	if(feeExists("201MREIMB")==false) updateFee("201MREIMB","LICFD201RNW","FINAL",1,"N");
	} else {
	removeFee("201MPHMDC","FINAL");
	removeFee("201MREIMB","FINAL");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "A 0-10,000" && AInfo['PRIMARILY RESTAURANT.C; All of the above and also transport of food, banquet facilities'] == "CHECKED") {
	if(feeExists("201CPHMDC")==false) updateFee("201CPHMDC","LICFD201RNW","FINAL",1,"N");
	if(feeExists("201CREIMB")==false) updateFee("201CREIMB","LICFD201RNW","FINAL",1,"N");
	} else {
	removeFee("201CPHMDC","FINAL");
	removeFee("201CREIMB","FINAL");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "B 10,001-100,000" && AInfo['PRIMARILY RESTAURANT.S; Meals prepared when food is ordered, limited food prep - mixing prepackaged foods'] == "CHECKED") {
	if(feeExists("202SPHMDC")==false) updateFee("202SPHMDC","LICFD202","FINAL",1,"N");
	if(feeExists("202SREIMB")==false) updateFee("202SREIMB","LICFD202","FINAL",1,"N");
	} else {
	removeFee("202SPHMDC","FINAL");
	removeFee("202SREIMB","FINAL");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "B 10,001-100,000" && AInfo['PRIMARILY RESTAURANT.M; Raw food handled, buffet, drive through, delivery, food cooled or reheated, unlimited food prep'] == "CHECKED") {
	if(feeExists("202MPHMDC")==false) updateFee("202MPHMDC","LICFD202","FINAL",1,"N");
	if(feeExists("202MREIMB")==false) updateFee("202MREIMB","LICFD202","FINAL",1,"N");
	} else {
	removeFee("202MPHMDC","FINAL");
	removeFee("202MREIMB","FINAL");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "B 10,001-100,000" && AInfo['PRIMARILY RESTAURANT.C; All of the above and also transport of food, banquet facilities'] == "CHECKED") {
	if(feeExists("202CPHMDC")==false) updateFee("202CPHMDC","LICFD202","FINAL",1,"N");
	if(feeExists("202CREIMB")==false) updateFee("202CREIMB","LICFD202","FINAL",1,"N");
	} else {
	removeFee("202CPHMDC","FINAL");
	removeFee("202CREIMB","FINAL");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "C 100,001-250,000" && AInfo['PRIMARILY RESTAURANT.S; Meals prepared when food is ordered, limited food prep - mixing prepackaged foods'] == "CHECKED") {
	if(feeExists("203SPHMDC")==false) updateFee("203SPHMDC","LICFD203","FINAL",1,"N");
	if(feeExists("203SREIMB")==false) updateFee("203SREIMB","LICFD203","FINAL",1,"N");
	} else {
	removeFee("203SPHMDC","FINAL");
	removeFee("203SREIMB","FINAL");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "C 100,001-250,000" && AInfo['PRIMARILY RESTAURANT.M; Raw food handled, buffet, drive through, delivery, food cooled or reheated, unlimited food prep'] == "CHECKED") {
	if(feeExists("203MPHMDC")==false) updateFee("203MPHMDC","LICFD203","FINAL",1,"N");
	if(feeExists("203MREIMB")==false) updateFee("203MREIMB","LICFD203","FINAL",1,"N");
	} else {
	removeFee("203MPHMDC","FINAL");
	removeFee("203MREIMB","FINAL");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "C 100,001-250,000" && AInfo['PRIMARILY RESTAURANT.C; All of the above and also transport of food, banquet facilities'] == "CHECKED") {
	if(feeExists("203CPHMDC")==false) updateFee("203CPHMDC","LICFD203","FINAL",1,"N");
	if(feeExists("203CREIMB")==false) updateFee("203CREIMB","LICFD203","FINAL",1,"N");
	} else {
	removeFee("203CPHMDC","FINAL");
	removeFee("203CREIMB","FINAL");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "D 250,001-500,000" && AInfo['PRIMARILY RESTAURANT.S; Meals prepared when food is ordered, limited food prep - mixing prepackaged foods'] == "CHECKED") {
	if(feeExists("204SPHMDC")==false) updateFee("204SPHMDC","LICFD204","FINAL",1,"N");
	if(feeExists("204SREIMB")==false) updateFee("204SREIMB","LICFD204","FINAL",1,"N");
	} else {
	removeFee("204SPHMDC","FINAL");
	removeFee("204SREIMB","FINAL");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "D 250,001-500,000" && AInfo['PRIMARILY RESTAURANT.M; Raw food handled, buffet, drive through, delivery, food cooled or reheated, unlimited food prep'] == "CHECKED") {
	if(feeExists("204MPHMDC")==false) updateFee("204MPHMDC","LICFD204","FINAL",1,"N");
	if(feeExists("204MREIMB")==false) updateFee("204MREIMB","LICFD204","FINAL",1,"N");
	} else {
	removeFee("204MPHMDC","FINAL");
	removeFee("204MREIMB","FINAL");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "D 250,001-500,000" && AInfo['PRIMARILY RESTAURANT.C; All of the above and also transport of food, banquet facilities'] == "CHECKED") {
	if(feeExists("204CPHMDC")==false) updateFee("204CPHMDC","LICFD204","FINAL",1,"N");
	if(feeExists("204CREIMB")==false) updateFee("204CREIMB","LICFD204","FINAL",1,"N");
	} else {
	removeFee("204CPHMDC","FINAL");
	removeFee("204CREIMB","FINAL");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "F 1,000,000-5,000,000" && AInfo['PRIMARILY RESTAURANT.S; Meals prepared when food is ordered, limited food prep - mixing prepackaged foods'] == "CHECKED") {
	if(feeExists("205SPHMDC")==false) updateFee("205SPHMDC","LICFD205","FINAL",1,"N");
	if(feeExists("205SREIMB")==false) updateFee("205SREIMB","LICFD205","FINAL",1,"N");
	} else {
	removeFee("205SPHMDC","FINAL");
	removeFee("205SREIMB","FINAL");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "F 1,000,000-5,000,000" && AInfo['PRIMARILY RESTAURANT.M; Raw food handled, buffet, drive through, delivery, food cooled or reheated, unlimited food prep'] == "CHECKED") {
	if(feeExists("205MPHMDC")==false) updateFee("205MPHMDC","LICFD205","FINAL",1,"N");
	if(feeExists("205MREIMB")==false) updateFee("205MREIMB","LICFD205","FINAL",1,"N");
	} else {
	removeFee("205MPHMDC","FINAL");
	removeFee("205MREIMB","FINAL");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "F 1,000,000-5,000,000" && AInfo['PRIMARILY RESTAURANT.C; All of the above and also transport of food, banquet facilities'] == "CHECKED") {
	if(feeExists("205CPHMDC")==false) updateFee("205CPHMDC","LICFD205","FINAL",1,"N");
	if(feeExists("205CREIMB")==false) updateFee("205CREIMB","LICFD205","FINAL",1,"N");
	} else {
	removeFee("205CPHMDC","FINAL");
	removeFee("205CREIMB","FINAL");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "G Over 5,000,000" && AInfo['PRIMARILY RESTAURANT.S; Meals prepared when food is ordered, limited food prep - mixing prepackaged foods'] == "CHECKED") {
	if(feeExists("206SPHMDC")==false) updateFee("206SPHMDC","LICFD206","FINAL",1,"N");
	if(feeExists("206SREIMB")==false) updateFee("206SREIMB","LICFD206","FINAL",1,"N");
	} else {
	removeFee("206SPHMDC","FINAL");
	removeFee("206SREIMB","FINAL");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "G Over 5,000,000" && AInfo['PRIMARILY RESTAURANT.M; Raw food handled, buffet, drive through, delivery, food cooled or reheated, unlimited food prep'] == "CHECKED") {
	if(feeExists("206MPHMDC")==false) updateFee("206MPHMDC","LICFD206","FINAL",1,"N");
	if(feeExists("206MREIMB")==false) updateFee("206MREIMB","LICFD206","FINAL",1,"N");
	} else {
	removeFee("206MPHMDC","FINAL");
	removeFee("206MREIMB","FINAL");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "G Over 5,000,000" && AInfo['PRIMARILY RESTAURANT.C; All of the above and also transport of food, banquet facilities'] == "CHECKED") {
	if(feeExists("206CPHMDC")==false) updateFee("206CPHMDC","LICFD206","FINAL",1,"N");
	if(feeExists("206CREIMB")==false) updateFee("206CREIMB","LICFD206","FINAL",1,"N");
	} else {
	removeFee("206CPHMDC","FINAL");
	removeFee("206CREIMB","FINAL");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "A 0-10,000" && AInfo['RETAIL FOOD ESTABLISHMENT.No Food Processing - 55'] == "CHECKED") {
	if(feeExists("20155PHMDC")==false) updateFee("20155PHMDC","LICFD201RNW","FINAL",1,"N");
	if(feeExists("20155REIMBR")==false) updateFee("20155REIMBR","LICFD201RNW","FINAL",1,"N");
	} else {
	removeFee("20155PHMDC","FINAL");
	removeFee("20155REIMBR","FINAL");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "A 0-10,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing - Sales Less Than $25,000 - 44'] == "CHECKED") {
	if(feeExists("20144PHMDC")==false) updateFee("20144PHMDC","LICFD201RNW","FINAL",1,"N");
	if(feeExists("20144REIMB")==false) updateFee("20144REIMB","LICFD201RNW","FINAL",1,"N");
	} else {
	removeFee("20144PHMDC","FINAL");
	removeFee("20144REIMB","FINAL");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "B 10,001-100,000" && AInfo['RETAIL FOOD ESTABLISHMENT.No Food Processing - 55'] == "CHECKED") {
	if(feeExists("20255PHMDC")==false) updateFee("20255PHMDC","LICFD202","FINAL",1,"N");
	if(feeExists("20255REIMB")==false) updateFee("20255REIMB","LICFD202","FINAL",1,"N");
	} else {
	removeFee("20255PHMDC","FINAL");
	removeFee("20255REIMB","FINAL");
	logDebug("In else part of line 22.");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "B 10,001-100,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing Non-Hazardous - Sales Higher Than $25,000 - 33'] == "CHECKED") {
	if(feeExists("20233PHMDC")==false) updateFee("20233PHMDC","LICFD202","FINAL",1,"N");
	if(feeExists("20233REIMB")==false) updateFee("20233REIMB","LICFD202","FINAL",1,"N");
	} else {
	removeFee("20233PHMDC","FINAL");
	removeFee("20233REIMB","FINAL");
	logDebug("In else part of line 23.");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "B 10,001-100,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing Potentially Hazardous - Sales Higher Than $25,000 but < $1,000,000 - 22'] == "CHECKED") {
	if(feeExists("20222PHMDC")==false) updateFee("20222PHMDC","LICFD202","FINAL",1,"N");
	if(feeExists("20222REIMB")==false) updateFee("20222REIMB","LICFD202","FINAL",1,"N");
	} else {
	removeFee("20222PHMDC","FINAL");
	removeFee("20222REIMB","FINAL");
	logDebug("In else part of line 24.");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "C 100,001-250,000" && AInfo['RETAIL FOOD ESTABLISHMENT.No Food Processing - 55'] == "CHECKED") {
	if(feeExists("20355PHMDC")==false) updateFee("20355PHMDC","LICFD203","FINAL",1,"N");
	if(feeExists("20355REIMB")==false) updateFee("20355REIMB","LICFD203","FINAL",1,"N");
	} else {
	removeFee("20355PHMDC","FINAL");
	removeFee("20355REIMB","FINAL");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "C 100,001-250,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing Non-Hazardous - Sales Higher Than $25,000 - 33'] == "CHECKED") {
	if(feeExists("20333PHMDC")==false) updateFee("20333PHMDC","LICFD203","FINAL",1,"N");
	if(feeExists("20333REIMB")==false) updateFee("20333REIMB","LICFD203","FINAL",1,"N");
	} else {
	removeFee("20333PHMDC","FINAL");
	removeFee("20333REIMB","FINAL");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "C 100,001-250,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing Potentially Hazardous - Sales Higher Than $25,000 but < $1,000,000 - 22'] == "CHECKED") {
	if(feeExists("20322PHMDC")==false) updateFee("20322PHMDC","LICFD203","FINAL",1,"N");
	if(feeExists("20322REIMB")==false) updateFee("20322REIMB","LICFD203","FINAL",1,"N");
	} else {
	removeFee("20322PHMDC","FINAL");
	removeFee("20322REIMB","FINAL");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "D 250,001-500,000" && AInfo['RETAIL FOOD ESTABLISHMENT.No Food Processing - 55'] == "CHECKED") {
	if(feeExists("20455PHMDC")==false) updateFee("20455PHMDC","LICFD204","FINAL",1,"N");
	if(feeExists("20455REIMB")==false) updateFee("20455REIMB","LICFD204","FINAL",1,"N");
	} else {
	removeFee("20455PHMDC","FINAL");
	removeFee("20455REIMB","FINAL");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "D 250,001-500,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing Non-Hazardous - Sales Higher Than $25,000 - 33'] == "CHECKED") {
	if(feeExists("20433PHMDC")==false) updateFee("20433PHMDC","LICFD204","FINAL",1,"N");
	if(feeExists("20433REIMB")==false) updateFee("20433REIMB","LICFD204","FINAL",1,"N");
	} else {
	removeFee("20433PHMDC","FINAL");
	removeFee("20433REIMB","FINAL");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "D 250,001-500,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing Potentially Hazardous - Sales Higher Than $25,000 but < $1,000,000 - 22'] == "CHECKED") {
	if(feeExists("20422PHMDC")==false) updateFee("20422PHMDC","LICFD204","FINAL",1,"N");
	if(feeExists("20422REIMB")==false) updateFee("20422REIMB","LICFD204","FINAL",1,"N");
	} else {
	removeFee("20422PHMDC","FINAL");
	removeFee("20422REIMB","FINAL");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "F 1,000,001-5,000,000" && AInfo['RETAIL FOOD ESTABLISHMENT.No Food Processing - 55'] == "CHECKED") {
	if(feeExists("20555PHMDC")==false) updateFee("20555PHMDC","LICFD205","FINAL",1,"N");
	if(feeExists("20555REIMB")==false) updateFee("20555REIMB","LICFD205","FINAL",1,"N");
	} else {
	removeFee("20555PHMDC","FINAL");
	removeFee("20555REIMB","FINAL");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "F 1,000,001-5,000,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing Non-Hazardous - Sales Higher Than $25,000 - 33'] == "CHECKED") {
	if(feeExists("20533PHMDC")==false) updateFee("20533PHMDC","LICFD205","FINAL",1,"N");
	if(feeExists("20533REIMB")==false) updateFee("20533REIMB","LICFD205","FINAL",1,"N");
	} else {
	removeFee("20533PHMDC","FINAL");
	removeFee("20533REIMB","FINAL");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "F 1,000,001-5,000,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing Potentially Hazardous - Sales Higher Than $1,000,000 - 11'] == "CHECKED") {
	if(feeExists("20511PHMDC")==false) updateFee("20511PHMDC","LICFD205","FINAL",1,"N");
	if(feeExists("20511REIMB")==false) updateFee("20511REIMB","LICFD205","FINAL",1,"N");
	} else {
	removeFee("20511PHMDC","FINAL");
	removeFee("20511REIMB","FINAL");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "G Over 5,000,000" && AInfo['RETAIL FOOD ESTABLISHMENT.No Food Processing - 55'] == "CHECKED") {
	if(feeExists("20655PHMDC")==false) updateFee("20655PHMDC","LICFD206","FINAL",1,"N");
	if(feeExists("20655REIMB")==false) updateFee("20655REIMB","LICFD206","FINAL",1,"N");
	} else {
	removeFee("20655PHMDC","FINAL");
	removeFee("20655REIMB","FINAL");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "G Over 5,000,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing Non-Hazardous - Sales Higher Than $25,000 - 33'] == "CHECKED") {
	if(feeExists("20633PHMDC")==false) updateFee("20633PHMDC","LICFD206","FINAL",1,"N");
	if(feeExists("20633REIMB")==false) updateFee("20633REIMB","LICFD206","FINAL",1,"N");
	} else {
	removeFee("20633PHMDC","FINAL");
	removeFee("20633REIMB","FINAL");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "G Over 5,000,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing Potentially Hazardous - Sales Higher Than $1,000,000 - 11'] == "CHECKED") {
	if(feeExists("20611PHMDC")==false) updateFee("20611PHMDC","LICFD206","FINAL",1,"N");
	if(feeExists("20611REIMB")==false) updateFee("20611REIMB","LICFD206","FINAL",1,"N");
	} else {
	removeFee("20611PHMDC","FINAL");
	removeFee("20611REIMB","FINAL");
	}

if (AInfo['RESTAURANT MOBILE BASE ONLY.S; Meals prepared when food is ordered, limited food prep - mixing prepackaged foods'] == "CHECKED") {
	if(feeExists("215SPHMDC")==false) updateFee("215SPHMDC","LICFD215RNW","FINAL",1,"N");
	if(feeExists("215SREIMB")==false) updateFee("215SREIMB","LICFD215RNW","FINAL",1,"N");
	} else {
	removeFee("215SPHMDC","FINAL");
	removeFee("215SREIMB","FINAL");
	}

if (AInfo['RESTAURANT MOBILE BASE ONLY.M; Raw food handled, buffet, drive through, delivery, food cooled or reheated, unlimited food prep'] == "CHECKED") {
	if(feeExists("215MPHMDC")==false) updateFee("215MPHMDC","LICFD215RNW","FINAL",1,"N");
	if(feeExists("215MREIMB")==false) updateFee("215MREIMB","LICFD215RNW","FINAL",1,"N");
	} else {
	removeFee("215MPHMDC","FINAL");
	removeFee("215MREIMB","FINAL");
	}

if (AInfo['RESTAURANT MOBILE BASE ONLY.C; All of the above and also transport of food, banquet facilities'] == "CHECKED") {
	if(feeExists("215MPHMD2")==false) updateFee("215MPHMD2","LICFD215RNW","FINAL",1,"N");
	if(feeExists("215CREIMB")==false) updateFee("215CREIMB","LICFD215RNW","FINAL",1,"N");
	} else {
	removeFee("215MPHMD2","FINAL");
	removeFee("215CREIMB","FINAL");
	}

if (AInfo['RETAIL MOBILE BASE ONLY.No Food Processing - 55'] == "CHECKED") {
	if(feeExists("21555PHMDC")==false) updateFee("21555PHMDC","LICFD215RNW","FINAL",1,"N");
	if(feeExists("21555REIMB")==false) updateFee("21555REIMB","LICFD215RNW","FINAL",1,"N");
	} else {
	removeFee("21555PHMDC","FINAL");
	removeFee("21555REIMB","FINAL");
	}

if (AInfo['RETAIL MOBILE BASE ONLY.Food Processing - Sales Less Than $25,000 - 44'] == "CHECKED") {
	if(feeExists("21544PHMDC")==false) updateFee("21544PHMDC","LICFD215RNW","FINAL",1,"N");
	if(feeExists("21544REIMB")==false) updateFee("21544REIMB","LICFD215RNW","FINAL",1,"N");
	} else {
	removeFee("21544PHMDC","FINAL");
	removeFee("21544REIMB","FINAL");
	}

if (AInfo['RETAIL MOBILE CART ONLY.Gross food sales per year'] == "0-10,000" && AInfo['RETAIL MOBILE CART ONLY.No Food Processing - 55'] == "CHECKED") {
	if(feeExists("21155PHMDC")==false) updateFee("21155PHMDC","LICFD211","FINAL",1,"N");
	if(feeExists("21155REIMB")==false) updateFee("21155REIMB","LICFD211","FINAL",1,"N");
	} else {
	removeFee("21155PHMDC","FINAL");
	removeFee("21155REIMB","FINAL");
	}

if (AInfo['RETAIL MOBILE CART ONLY.Gross food sales per year'] == "0-10,000" && AInfo['RETAIL MOBILE CART ONLY.Food Processing - Sales Less Than $25,000 - 44'] == "CHECKED") {
	if(feeExists("21144PHMDC")==false) updateFee("21144PHMDC","LICFD211","FINAL",1,"N");
	if(feeExists("21144REIMB")==false) updateFee("21144REIMB","LICFD211","FINAL",1,"N");
	} else {
	removeFee("21144PHMDC","FINAL");
	removeFee("21144REIMB","FINAL");
	}

if (AInfo['RETAIL MOBILE CART ONLY.Gross food sales per year'] == "10,001-100,000" && AInfo['RETAIL MOBILE CART ONLY.No Food Processing - 55'] == "CHECKED") {
	if(feeExists("21255PHMDC")==false) updateFee("21255PHMDC","LICFD212RNW","FINAL",1,"N");
	if(feeExists("21255REIMB")==false) updateFee("21255REIMB","LICFD212RNW","FINAL",1,"N");
	} else {
	removeFee("21255PHMDC","FINAL");
	removeFee("21255REIMB","FINAL");
	}

if (AInfo['RETAIL MOBILE CART ONLY.Gross food sales per year'] == "10,001-100,000" && AInfo['RETAIL MOBILE CART ONLY.Food Processing Non-Hazardous - Sales Higher Than $25,000 - 33'] == "CHECKED") {
	if(feeExists("21233PHMDC")==false) updateFee("21233PHMDC","LICFD212RNW","FINAL",1,"N");
	if(feeExists("21233REIMB")==false) updateFee("21233REIMB","LICFD212RNW","FINAL",1,"N");
	} else {
	removeFee("21233PHMDC","FINAL");
	removeFee("21233REIMB","FINAL");
	}

if (AInfo['RETAIL MOBILE CART ONLY.Gross food sales per year'] == "10,001-100,000" && AInfo['RETAIL MOBILE CART ONLY.Food Processing Potentially Hazardous - Sales Higher Than $25,000 but < $1,000,000 - 22'] == "CHECKED") {
	if(feeExists("21222PHMDC")==false) updateFee("21222PHMDC","LICFD212RNW","FINAL",1,"N");
	if(feeExists("21222REIMB")==false) updateFee("21222REIMB","LICFD212RNW","FINAL",1,"N");
	} else {
	removeFee("21222PHMDC","FINAL");
	removeFee("21222REIMB","FINAL");
	}

if (AInfo['RETAIL MOBILE CART ONLY.Gross food sales per year'] == "100,001-250,000" && AInfo['RETAIL MOBILE CART ONLY.No Food Processing - 55'] == "CHECKED") {
	if(feeExists("21355PHMDC")==false) updateFee("21355PHMDC","LICFD213RNW","FINAL",1,"N");
	if(feeExists("21355REIMB")==false) updateFee("21355REIMB","LICFD213RNW","FINAL",1,"N");
	} else {
	removeFee("21355PHMDC","FINAL");
	removeFee("21355REIMB","FINAL");
	}

if (AInfo['RETAIL MOBILE CART ONLY.Gross food sales per year'] == "100,001-250,000" && AInfo['RETAIL MOBILE CART ONLY.Food Processing Non-Hazardous - Sales Higher Than $25,000 - 33'] == "CHECKED") {
	if(feeExists("21333PHMDC")==false) updateFee("21333PHMDC","LICFD213RNW","FINAL",1,"N");
	if(feeExists("21333REIMB")==false) updateFee("21333REIMB","LICFD213RNW","FINAL",1,"N");
	} else {
	removeFee("21333PHMDC","FINAL");
	removeFee("21333REIMB","FINAL");
	}

if (AInfo['RETAIL MOBILE CART ONLY.Gross food sales per year'] == "100,001-250,000" && AInfo['RETAIL MOBILE CART ONLY.Food Processing Potentially Hazardous - Sales Higher Than $25,000 but < $1,000,000 - 22'] == "CHECKED") {
	if(feeExists("21322PHMDC")==false) updateFee("21322PHMDC","LICFD213RNW","FINAL",1,"N");
	if(feeExists("21322REIMB")==false) updateFee("21322REIMB","LICFD213RNW","FINAL",1,"N");
	} else {
	removeFee("21322PHMDC","FINAL");
	removeFee("21322REIMB","FINAL");
	}

if (AInfo['RESTAURANT MOBILE CART.Gross food sales per year'] == "0-10,000" && AInfo['RESTAURANT MOBILE CART.S; Meals prepared when food is ordered, limited food prep - mixing prepackaged foods'] == "CHECKED") {
	if(feeExists("211SPHMDC")==false) updateFee("211SPHMDC","LICFD211","FINAL",1,"n");
	if(feeExists("211SREIMB")==false) updateFee("211SREIMB","LICFD211","FINAL",1,"n");
	} else {
	removeFee("211SPHMDC","FINAL");
	removeFee("211SREIMB","FINAL");
	}

if (AInfo['RESTAURANT MOBILE CART.Gross food sales per year'] == "0-10,000" && AInfo['RESTAURANT MOBILE CART.M; Raw food handled, buffet, drive through, delivery, food cooled or reheated, unlimited food prep'] == "CHECKED") {
	if(feeExists("211MPHMDC")==false) updateFee("211MPHMDC","LICFD211","FINAL",1,"n");
	if(feeExists("211MREIMB")==false) updateFee("211MREIMB","LICFD211","FINAL",1,"n");
	} else {
	removeFee("211MPHMDC","FINAL");
	removeFee("211MREIMB","FINAL");
	}

if (AInfo['RESTAURANT MOBILE CART.Gross food sales per year'] == "0-10,000" && AInfo['RESTAURANT MOBILE CART.C; All of the above and also transport of food, banquet facilities'] == "CHECKED") {
	if(feeExists("211CPHMDC")==false) updateFee("211CPHMDC","LICFD211","FINAL",1,"n");
	if(feeExists("211CREIMB")==false) updateFee("211CREIMB","LICFD211","FINAL",1,"n");
	} else {
	removeFee("211CPHMDC","FINAL");
	removeFee("211CREIMB","FINAL");
	}

if (AInfo['RESTAURANT MOBILE CART.Gross food sales per year'] == "10,001-100,000" && AInfo['RESTAURANT MOBILE CART.S; Meals prepared when food is ordered, limited food prep - mixing prepackaged foods'] == "CHECKED") {
	if(feeExists("212SPHMDC")==false) updateFee("212SPHMDC","LICFD212RNW","FINAL",1,"n");
	if(feeExists("212SREIMB")==false) updateFee("212SREIMB","LICFD212RNW","FINAL",1,"n");
	} else {
	removeFee("212SPHMDC","FINAL");
	removeFee("212SREIMB","FINAL");
	}

if (AInfo['RESTAURANT MOBILE CART.Gross food sales per year'] == "10,001-100,000" && AInfo['RESTAURANT MOBILE CART.M; Raw food handled, buffet, drive through, delivery, food cooled or reheated, unlimited food prep'] == "CHECKED") {
	if(feeExists("212MPHMDC")==false) updateFee("212MPHMDC","LICFD212RNW","FINAL",1,"n");
	if(feeExists("212MREIMB")==false) updateFee("212MREIMB","LICFD212RNW","FINAL",1,"n");
	} else {
	removeFee("212MPHMDC","FINAL");
	removeFee("212MREIMB","FINAL");
	}

if (AInfo['RESTAURANT MOBILE CART.Gross food sales per year'] == "10,001-100,000" && AInfo['RESTAURANT MOBILE CART.C; All of the above and also transport of food, banquet facilities'] == "CHECKED") {
	if(feeExists("212CPHMDC")==false) updateFee("212CPHMDC","LICFD212RNW","FINAL",1,"n");
	if(feeExists("212CREIMB")==false) updateFee("212CREIMB","LICFD212RNW","FINAL",1,"n");
	} else {
	removeFee("212CPHMDC","FINAL");
	removeFee("212CREIMB","FINAL");
	}

if (AInfo['RESTAURANT MOBILE CART.Gross food sales per year'] == "100,001-250,000" && AInfo['RESTAURANT MOBILE CART.S; Meals prepared when food is ordered, limited food prep - mixing prepackaged foods'] == "CHECKED") {
	if(feeExists("213SPHMDC")==false) updateFee("213SPHMDC","LICFD213RNW","FINAL",1,"n");
	if(feeExists("213SREIMB")==false) updateFee("213SREIMB","LICFD213RNW","FINAL",1,"n");
	} else {
	removeFee("213SPHMDC","FINAL");
	removeFee("213SREIMB","FINAL");
	}

if (AInfo['RESTAURANT MOBILE CART.Gross food sales per year'] == "100,001-250,000" && AInfo['RESTAURANT MOBILE CART.M; Raw food handled, buffet, drive through, delivery, food cooled or reheated, unlimited food prep'] == "CHECKED") {
	if(feeExists("213MPHMDC")==false) updateFee("213MPHMDC","LICFD213RNW","FINAL",1,"n");
	if(feeExists("213MREIMB")==false) updateFee("213MREIMB","LICFD213RNW","FINAL",1,"n");
	} else {
	removeFee("213MPHMDC","FINAL");
	removeFee("213MREIMB","FINAL");
	}

if (AInfo['RESTAURANT MOBILE CART.Gross food sales per year'] == "100,001-250,000" && AInfo['RESTAURANT MOBILE CART.C; All of the above and also transport of food, banquet facilities'] == "CHECKED") {
	if(feeExists("213CPHMDC")==false) updateFee("213CPHMDC","LICFD213RNW","FINAL",1,"n");
	if(feeExists("213CREIMB")==false) updateFee("213CREIMB","LICFD213RNW","FINAL",1,"n");
	} else {
	removeFee("213CPHMDC","FINAL");
	removeFee("213CREIMB","FINAL");
	}

if (AInfo['FARMERS MARKET.Gross food sales per year'] == "0-10,000") {
	if(feeExists("21655PHMDC")==false) updateFee("21655PHMDC","LICFD216","FINAL",1,"n");
	if(feeExists("21655REIMB")==false) updateFee("21655REIMB","LICFD216","FINAL",1,"n");
	} else {
	removeFee("21655PHMDC","FINAL");
	removeFee("21655REIMB","FINAL");
	}

if (AInfo['FARMERS MARKET.Gross food sales per year'] == "10,001-100,000") {
	if(feeExists("21755PHMDC")==false) updateFee("21755PHMDC","LICFD217","FINAL",1,"n");
	if(feeExists("21755REIMB")==false) updateFee("21755REIMB","LICFD217","FINAL",1,"n");
	} else {
	removeFee("21755PHMDC","FINAL");
	removeFee("21755REIMB","FINAL");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "A 0-10,000" && AInfo['PRIMARILY RESTAURANT.S; Meals prepared when food is ordered, limited food prep - mixing prepackaged foods'] != "CHECKED" && AInfo['PRIMARILY RESTAURANT.M; Raw food handled, buffet, drive through, delivery, food cooled or reheated, unlimited food prep'] != "CHECKED" && AInfo['PRIMARILY RESTAURANT.C; All of the above and also transport of food, banquet facilities'] != "CHECKED") {
	if(feeExists("201TAVPHMDC")==false) updateFee("201TAVPHMDC","LICFD201RNW","FINAL",1,"N");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "B 10,001-100,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing - Sales Less Than $25,000 - 44'] == "CHECKED") {
	if(feeExists("20244PHMDC")==false) updateFee("20244PHMDC","LICFD202","FINAL",1,"N");
	if(feeExists("20244REIMB")==false) updateFee("20244REIMB","LICFD202","FINAL",1,"N");
	} else {
	removeFee("20244PHMDC","FINAL");
	removeFee("20244REIMB","FINAL");
	}

if (AInfo['RETAIL MOBILE CART ONLY.Gross food sales per year'] == "10,001-100,000" && AInfo['RETAIL MOBILE CART ONLY.Food Processing - Sales Less Than $25,000 - 44'] == "CHECKED") {
	if(feeExists("21244PHMDC")==false) updateFee("21244PHMDC","LICFD212RNW","FINAL",1,"N");
	if(feeExists("21244REIMB")==false) updateFee("21244REIMB","LICFD212RNW","FINAL",1,"N");
	} else {
	removeFee("21244PHMDC","FINAL");
	removeFee("21244REIMB","FINAL");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "E 500,001-1,000,000" && AInfo['PRIMARILY RESTAURANT.S; Meals prepared when food is ordered, limited food prep - mixing prepackaged foods'] == "CHECKED") {
	if(feeExists("207SPHMDC")==false) updateFee("207SPHMDC","LICFD207","FINAL",1,"N");
	if(feeExists("207SREIMB")==false) updateFee("207SREIMB","LICFD207","FINAL",1,"N");
	} else {
	removeFee("207SPHMDC","FINAL");
	removeFee("207SREIMB","FINAL");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "E 500,001-1,000,000" && AInfo['PRIMARILY RESTAURANT.M; Raw food handled, buffet, drive through, delivery, food cooled or reheated, unlimited food prep'] == "CHECKED") {
	if(feeExists("207MPHMDC")==false) updateFee("207MPHMDC","LICFD207","FINAL",1,"N");
	if(feeExists("207MREIMB")==false) updateFee("207MREIMB","LICFD207","FINAL",1,"N");
	} else {
	removeFee("207MPHMDC","FINAL");
	removeFee("207MREIMB","FINAL");
	}

if (AInfo['PRIMARILY RESTAURANT.Gross Food Sales Per Year'] == "E 500,001-1,000,000" && AInfo['PRIMARILY RESTAURANT.C; All of the above and also transport of food, banquet facilities'] == "CHECKED") {
	if(feeExists("207CPHMDC")==false) updateFee("207CPHMDC","LICFD207","FINAL",1,"N");
	if(feeExists("207CREIMB")==false) updateFee("207CREIMB","LICFD207","FINAL",1,"N");
	} else {
	removeFee("207CPHMDC","FINAL");
	removeFee("207CREIMB","FINAL");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "E 500,001-1,000,000" && AInfo['RETAIL FOOD ESTABLISHMENT.No Food Processing - 55'] == "CHECKED") {
	if(feeExists("20755PHMDC")==false) updateFee("20755PHMDC","LICFD207","FINAL",1,"N");
	if(feeExists("20755REIMB")==false) updateFee("20755REIMB","LICFD207","FINAL",1,"N");
	} else {
	removeFee("20755PHMDC","FINAL");
	removeFee("20755REIMB","FINAL");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "E 500,001-1,000,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing Non-Hazardous - Sales Higher Than $25,000 - 33'] == "CHECKED") {
	if(feeExists("20733PHMDC")==false) updateFee("20733PHMDC","LICFD207","FINAL",1,"N");
	if(feeExists("20733REIMB")==false) updateFee("20733REIMB","LICFD207","FINAL",1,"N");
	} else {
	removeFee("20733PHMDC","FINAL");
	removeFee("20733REIMB","FINAL");
	}

if (AInfo['RETAIL FOOD ESTABLISHMENT.Retail gross food sales per year'] == "E 500,001-1,000,000" && AInfo['RETAIL FOOD ESTABLISHMENT.Food Processing Potentially Hazardous - Sales Higher Than $25,000 but < $1,000,000 - 22'] == "CHECKED") {
	if(feeExists("20722PHMDC")==false) updateFee("20722PHMDC","LICFD207","FINAL",1,"N");
	if(feeExists("20722REIMB")==false) updateFee("20722REIMB","LICFD207","FINAL",1,"N");
	} else {
	removeFee("20722PHMDC","FINAL");
	removeFee("20722REIMB","FINAL");
	}

if (AInfo['MICRO MARKET.No Food Processing - 55'] == "CHECKED") {
	if(feeExists("FDMM55PHMDC")==false) updateFee("FDMM55PHMDC","LICFDMISC","FINAL",1,"N");
	if(feeExists("FDMM55REIMB")==false) updateFee("FDMM55REIMB","LICFDMISC","FINAL",1,"N");
	} else {
	removeFee("FDMM55PHMDC","FINAL");
	removeFee("FDMM55REIMB","FINAL");
	}
`^
CMN;Licensing!Health!School!Dane County;LicenseFee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if ((AInfo['PREPARATION TYPE.Food Service Type'] == "Full Service" || AInfo['PREPARATION TYPE.Food Service Type'] == "Production")) {
	updateFee("PRODPHMDC","LICSCHMDC","FINAL",1,"N");
	} else {
	removeFee("PRODPHMDC","FINAL");
	}

if ((AInfo['PREPARATION TYPE.Food Service Type'] == "Prepackaged Heat and Serve" || AInfo['PREPARATION TYPE.Food Service Type'] == "Satellite")) {
	updateFee("SATPHMDC","LICSCHMDC","FINAL",1,"N");
	} else {
	removeFee("SATPHMDC","FINAL");
	}
`^
CMN;Licensing!Health!School!Madison;LicenseFee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if ((AInfo['PREPARATION TYPE.Food Service Type'] == "Full Service" || AInfo['PREPARATION TYPE.Food Service Type'] == "Production")) {
	updateFee("PRODPHMDC","LICSCHMDC","FINAL",1,"N");
	} else {
	removeFee("PRODPHMDC","FINAL");
	}

if ((AInfo['PREPARATION TYPE.Food Service Type'] == "Prepackaged Heat and Serve" || AInfo['PREPARATION TYPE.Food Service Type'] == "Satellite")) {
	updateFee("SATPHMDC","LICSCHMDC","FINAL",1,"N");
	} else {
	removeFee("SATPHMDC","FINAL");
	}
`^
CMN;Licensing!Health!Tattoo and Body Piercing!~;LicenseFee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL INFORMATION.Type of Business'] == "Tattoo Establishment" && feeExists("TATPHMDC") == false) {
	updateFee ("TATPHMDC","LICTBP","FINAL",1,"N");
	updateFee ("TATREIMB","LICTBP","FINAL",1,"N");
	if(isTaskActive("Intake")==true) updateFee ("TATPI","LICTBP","FINAL",1,"N");
	}

if (AInfo['GENERAL INFORMATION.Type of Business'] == "Body Piercing Establishment" && feeExists("BPPHMDC") == false) {
	updateFee ("BPPHMDC","LICTBP","FINAL",1,"N");
	updateFee ("BPREIMB","LICTBP","FINAL",1,"N");
	if(isTaskActive("Intake")==true) updateFee ("BPPI","LICTBP","FINAL",1,"N");
	}

if (AInfo['GENERAL INFORMATION.Type of Business'] == "Combination Establishment" && feeExists("COMBPHMDC") == false) {
	updateFee ("COMBPHMDC","LICTBP","FINAL",1,"N");
	updateFee ("COMBREIMB","LICTBP","FINAL",1,"N");
	if(isTaskActive("Intake")==true) updateFee ("COMBPI","LICTBP","FINAL",1,"N");
	}

if (AInfo['GENERAL INFORMATION.Type of Business'] == "Ear Piercing Establishment" && feeExists("EPPHMDC") == false) {
	updateFee ("EPPHMDC","LICTBP","FINAL",1,"N");
	if(isTaskActive("Intake")==true) updateFee ("EPPI","LICTBP","FINAL",1,"N");
	}

if (AInfo['GENERAL INFORMATION.Type of Business'] != "Tattoo Establishment" && feeExists("TATPHMDC")) {
	removeFee("TATPHMDC","FINAL");
	removeFee("TATREIMB","FINAL");
	removeFee("TATPI","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Type of Business'] != "Body Piercing Establishment" && feeExists("BPPHMDC")) {
	removeFee("BPPHMDC","FINAL");
	removeFee("BPREIMB","FINAL");
	removeFee("BPPI","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Type of Business'] != "Combination Establishment" && feeExists("COMBPHMDC")) {
	removeFee("COMBPHMDC","FINAL");
	removeFee("COMBREIMB","FINAL");
	removeFee("COMBPI","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Type of Business'] != "Ear Piercing Establishment" && feeExists("EPPHMDC")) {
	removeFee("EPPHMDC","FINAL");
	removeFee("EPREIMB","FINAL");
	removeFee("EPPI","FINAL");
	}
`^
CMN;Licensing!Health!Tattoo and Body Piercing!~;LicenseRenewalFee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (AInfo['GENERAL INFORMATION.Type of Business'] == "Tattoo Establishment" && feeExists("TATPHMDC") == false) {
	updateFee ("TATPHMDC","LICBARNW","FINAL",1,"N");
	updateFee ("TATREIMB","LICBARNW","FINAL",1,"N");
	}

if (AInfo['GENERAL INFORMATION.Type of Business'] == "Body Piercing Establishment" && feeExists("BPPHMDC") == false) {
	updateFee ("BPPHMDC","LICBARNW","FINAL",1,"N");
	updateFee ("BPREIMB","LICBARNW","FINAL",1,"N");
	}

if (AInfo['GENERAL INFORMATION.Type of Business'] == "Combination Establishment" && feeExists("COMBPHMDC") == false) {
	updateFee ("COMBPHMDC","LICBARNW","FINAL",1,"N");
	updateFee ("COMBREIMB","LICBARNW","FINAL",1,"N");
	}

if (AInfo['GENERAL INFORMATION.Type of Business'] == "Ear Piercing Establishment" && feeExists("EPPHMDC") == false) {
	updateFee ("EPPHMDC","LICBARNW","FINAL",1,"N");
	}

if (AInfo['GENERAL INFORMATION.Type of Business'] != "Tattoo Establishment" && feeExists("TATPHMDC")) {
	removeFee("TATPHMDC","FINAL");
	removeFee("TATREIMB","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Type of Business'] != "Body Piercing Establishment" && feeExists("BPPHMDC")) {
	removeFee("BPPHMDC","FINAL");
	removeFee("BPREIMB","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Type of Business'] != "Combination Establishment" && feeExists("COMBPHMDC")) {
	removeFee("COMBPHMDC","FINAL");
	removeFee("COMBREIMB","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Type of Business'] != "Ear Piercing Establishment" && feeExists("EPPHMDC")) {
	removeFee("EPPHMDC","FINAL");
	removeFee("EPREIMB","FINAL");
	}
`^
CMN;Licensing!Police!Taxi Driver!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['OFFICE USE ONLY.License Type Approved'] == "Provisional") {
	if(feeExists ("PROV") == false) updateFee("PROV","POLTDL","FINAL",1,"N");
	} else {
	if(feeExists("PROV") == true) removeFee("PROV","FINAL");
	}

if (AInfo['OFFICE USE ONLY.License Type Approved'] == "Original") {
	if(feeExists ("ORIG") == false) updateFee("ORIG","POLTDL","FINAL",1,"N");
	} else {
	if(feeExists("ORIG") == true) removeFee("ORIG","FINAL");
	}

if (AInfo['OFFICE USE ONLY.License Type Approved'] == "Renewal") {
	if(feeExists ("RENEWAL") == false) updateFee("RENEWAL","POLTDL","FINAL",1,"N");
	} else {
	if(feeExists("RENEWAL") == true) removeFee("RENEWAL","FINAL");
	}

if (AInfo['APPLICATION TYPE.Submitting Change of Employer Notice?'] == "Yes") {
	if(feeExists (“CHG”) == false) updateFee("CHG","POLTDL","FINAL",1,"N");
	} else {
	if(feeExists("CHG") == true) removeFee("CHG","FINAL");
	}
`^
CMN;LMAgencyVer;Rev^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
editTaskNote("Planning Review",wfRev);
editTaskNote("Zoning Review",wfRev);
editTaskNote("Fire Review",wfRev);
editTaskNote("Engineering Review Main Office",wfRev);
editTaskNote("Traffic Engineering Review",wfRev);
editTaskNote("Real Estate Review",wfRev);
editTaskNote("Recycling Coordinator",wfRev);
editTaskNote("Urban Design Commission Review",wfRev);
editTaskNote("Landmarks Commission Review",wfRev);
editTaskNote("Lighting Review",wfRev);
editTaskNote("Police Review",wfRev);
editTaskNote("Parks!Forestry Review",wfRev);
editTaskNote("Metro Review",wfRev);
editTaskNote("Water Utility Review",wfRev);
editTaskNote("Architectural Review",wfRev);
editTaskNote("Assessor Review",wfRev);
editTaskNote("City Eng. Review Mapping",wfRev);
editTaskNote("Engineering Mapping",wfRev);
`^
CMN;LoadFireASITConditions^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var aryRow = new Array();
var aryItem = new Array();
var sCount = "";
var sCondType = "";
if (cmnSubType == "Alarm") {
	sCondType = "FIRE ALARM PERMIT CONDITIONS";
	}

if (cmnSubType == "Sprinkler") {
	sCondType = "FIRE SPRINKLER PERMIT COND";
	}

if (cmnSubType == "KitchenHood") {
	sCondType = "FIRE KITCHEN HOOD PERMIT COND";
	}

if (cmnSubType == "ControlledEgress") {
	sCondType = "FIRE CONTROLLED EGRESS COND";
	}

if (cmnSubType == "AltFireSuppression") {
	sCondType = "FIRE ALT SUPPRESSION COND";
	}

logDebug("sub type is ; " + cmnSubType);
logDebug("ASIT Conditions lookup = " + sCondType);
iCnt++;
sCount = iCnt.toString();
logDebug("Integer Cnt = " + iCnt + ";
String Count = " + sCount);
if (iCnt < 10) {
	sItemVal = "0" + iCnt;
	} else {
	sItemVal = iCnt.toString();
	}

logDebug("ItemVal = " + sItemVal);
valDescr = lookup(sCondType, sItemVal);
logDebug("Value Description = " + valDescr);
if (valDescr != undefined && valDescr != null) {
	aryItem["Sort Order"] = sCount;
	aryItem["Condition"] = valDescr;
	aryRow.push(aryItem);
	}

if (aryRow.length > 0) {
	addASITable(sCondType, aryRow);
	}

bFireCondFlag = true;
logDebug("bFireCondFlag is used in ASA and CRCA for Fire Alarm and Sprinkler.");
`^
CMN;LoadTaskStatusHistory^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
iCnt++;
aTaskStatuses[iCnt] = oTaskStatusHist[item].taskItem.disposition;
`^
CMN;LOCALHISTDISTRICT^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (proximity("agis_madison","Local Historic District",-1,"feet") && appHasCondition("LOCAL HISTORIC DISTRICT","APPLIED","LocalHistDist",null) == false) {
	addAppCondition("LOCAL HISTORIC DISTRICT","APPLIED","LocalHistDist","Permit applications in this area may require Landmarks Commission Approval","Notice");
	include("EML;LOCALHISTDIST");
	}
`^
CMN;LOCALHISTDISTRICTENFORCEMENT^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (proximity("agis_madison","Local Historic District",-1,"feet") && appHasCondition("LOCAL HISTORIC DISTRICT","APPLIED","LocalHistDist",null) == false) {
	addAppCondition("LOCAL HISTORIC DISTRICT","APPLIED","LocalHistDist","This Property resides within a Historical District","Notice");
	include("EML;LOCALHISTDISTENFORCEMENT");
	}
`^
CMN;LOCALLANDMARK^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = true;
var landmark = null;
landmark = getGISInfo("agis_madison","Planning Parcels", "LANDMARK");
if (landmark== "L" && appHasCondition("LANDMARK SITE","APPLIED","Landmark Site",null) == false) {
	addAppCondition("LANDMARK SITE","APPLIED","LANDMARK SITE","This Property is a landmark","Notice");
	}

if (landmark== "L") {
	include("EML;LOCALLANDMARKSITE");
	}

if (landmark== "A" && appHasCondition("ADJACENT TO LANDMARK","APPLIED","Adjacent to Landmark",null) == false) {
	addAppCondition("ADJACENT TO LANDMARK","APPLIED","Adjacent to Landmark","This Property is adjacent to a landmark","Notice");
	}

if (landmark== "A") {
	include("EML;LOCALLANDMARK");
	}

logDebug("Landmark = " + landmark);
currentUserID == "ITBJP";
`^
CMN;LOCALLANDMARKENFORCEMENT^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var islandmark = false;
var isadjacent = false;
if (proximityToAttribute("agis_madison","Planning Parcels", -10,"feet","LANDMARK","L") && appHasCondition("LANDMARK SITE","APPLIED","Landmark Site",null) == false) {
	addAppCondition("LANDMARK SITE","APPLIED","LANDMARK SITE","This Property is a landmark","Notice");
	include("EML;LOCALLANDMARKSITEENFORCEMENT");
	islandmark = true;
	comment("The parcel the application is being submitted for is a landmark.");
	}

if (islandmark == false) {
	isadjacent = proximityToAttribute("agis_madison","Planning Parcels", 10,"feet","LANDMARK","L");
	}

if (isadjacent && appHasCondition("ADJACENT TO LANDMARK","APPLIED","Adjacent to Landmark",null) == false) {
	addAppCondition("ADJACENT TO LANDMARK","APPLIED","Adjacent to Landmark","This Property is adjacent to a landmark","Notice");
	}

if (isadjacent) {
	include("EML;LOCALLANDMARKENFORCEMENT");
	comment("The parcel the application is being submitted for is adjacent to a landmark.");
	}
`^
CMN;LOCALLANDMARKSITE^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (proximityToAttribute("agis_madison","Planning Parcels", -10,"feet","LANDMARK","L") && appHasCondition("LANDMARK SITE","APPLIED","Landmark Site",null) == false) {
	addAppCondition("LANDMARK SITE","APPLIED","LANDMARK SITE","This Property is a landmark","Notice");
	include("EML;LOCALLANDMARKSITE");
	islandmark =true;
	}
`^
CMN;LOCALURBANDESIGN^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (proximity("agis_madison","Urban Design District",-1,"feet") && appHasCondition("URBAN DESIGN DISTRICT","APPLIED","UrbanDesignDist",null) == false) {
	addAppCondition("URBAN DESIGN DISTRICT","APPLIED","UrbanDesignDist","Permit application on address within an Urban Design District","Notice");
	include("EML;LOCALURBANDESIGN");
	}
`^
CMN;LOCALURBANDESIGNENFORCEMENT^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (proximity("agis_madison","Urban Design District",-1,"feet") && appHasCondition("URBAN DESIGN DISTRICT","APPLIED","UrbanDesignDist",null) == false) {
	addAppCondition("URBAN DESIGN DISTRICT","APPLIED","UrbanDesignDist","Enforcement action on an address within an Urban Design District","Notice");
	include("EML;LOCALURBANDESIGNENFORCEMENT");
	}
`^
CMN;LoopThroughAddressAndCompare^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
match = false;
refStreetNumber = refAdd[r].getHouseNumberStart();
refStreetName = refAdd[r].getStreetName();
refStreetSuffix = refAdd[r].getStreetSuffix();
refStreetUnit = refAdd[r].getUnitStart();
if (refStreetName != null) {
	refStreetName = refStreetName.toUpperCase();
	}

if (refStreetSuffix != null) {
	refStreetSuffix = refStreetSuffix.toUpperCase();
	} else {
	refStreetSuffix = "";
	}

if (refStreetUnit != null) {
	refStreetUnit = refStreetUnit.toUpperCase();
	} else {
	refStreetUnit = "";
	}

if (refStreetNumber.equals(addStreetNumber)) {
	match = true;
	} else {
	match = false;
	}

if (match == true && refStreetName.equals(addStreetName)) {
	match = true;
	} else {
	match = false;
	}

if (match == true && refStreetSuffix.equals(addStreetSuffix)) {
	match = true;
	} else {
	match = false;
	}

if (match == true && refStreetUnit.equals(addStreetUnit)) {
	match = true;
	} else {
	match = false;
	}

if (match == true) {
	refAddress = aa.address.getRefAddressByPK(refAdd[r].getRefAddressId()).getOutput().getRefAddressModel();
	}
`^
CMN;NUMBER_ASIT^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
logDebug("table name is;"+tableName);
aTable = aa.appSpecificTableScript.getAppSpecificTableModel(capId, tableName).getOutput();
if (aTable.getRowIndex() != "[]") {
	aModel = aTable.getAppSpecificTableModel();
	logDebug("GOT SOMETHING!!!");
	}

if (aTable.getRowIndex() != "[]") {
	tblFieldi = aModel.getTableField().iterator();
	tblField = aModel.getTableField();
	logDebug("GOT FIELDS!");
	}

if (aTable.getRowIndex() != "[]") {
	tblColi = aModel.getColumns().iterator();
	fieldCount = 0;
	colCount = 0;
	rowCount = 1;
	}

if (aTable.getRowIndex() != "[]") {
	while (tblFieldi.hasNext()) include("CMN;ASIT_PROCESS");
	}

if (aTable.getRowIndex() != "[]") {
	aModel.setTableField(tblField);
	}

if (aTable.getRowIndex() != "[]") {
	addResult = aa.appSpecificTableScript.editAppSpecificTableInfos(aModel, capId, currentUserID);
	}
`^
CMN;PARK HOLDS^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if ((wfTask == "Permit Issuance" || wfTask == "Issuance" || wfTask == "Certificate of Occupancy") && wfStatus == "Issued" && parcelConditionStatusExists("PARK HOLDS","APPLIED")) {
	message="Permit cannot be issued due to Park Holds currently on the Parcel";
	showMessage = true;
	cancel = true;
	}

if ((wfTask == "Permit Issuance" || wfTask == "Issuance" || wfTask == "Certificate of Occupancy") && wfStatus == "Issued" && appHasCondition("PARK HOLDS","APPLIED",null,null)) {
	message="Permit cannot be issued due to Park Holds currently on the Application";
	showMessage = true;
	cancel = true;
	}

if ((wfTask == "Permit Issuance" || wfTask == "Issuance" || wfTask == "Certificate of Occupancy") && wfStatus == "Issued" && addressConditionStatusExists("PARK HOLDS","APPLIED",null,null)) {
	message="Permit cannot be issued due to Park Holds currently on the Address";
	showMessage = true;
	cancel = true;
	}
`^
CMN;PermFireAddParcelACA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
addparcel = parcelExistsOnCap(capId) == false;
logDebug("addparcel = " + addparcel);
if (addparcel) {
	include("CMN;AddParcelAndOwner");
	logDebug("CMN;AddParcelAndOwner should have run.");
	}
`^
CMN;Permitting!~!~!~;Unpaid Balance^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if ((wfTask == "Permit Issuance" || wfTask == "Issuance" || wfTask == "Certificate of Occupancy") && wfStatus == "Issued" && (balanceDue > 0 || feesInvoicedTotal == 0) && (appTypeString != "Permitting!Engineering!ROW!NA" && appTypeString != "Permitting!Engineering!Street Terrace!NA")) {
	message="Workflow Task Can't Be Updated Because fees due or have not been assessed";
	showMessage = true;
	cancel = true;
	}

if ((appTypeString == "Permitting!Engineering!Sewer Plug!NA") && (wfTask == "Review") && wfStatus == "Application Accepted" && (balanceDue > 0 || feesInvoicedTotal == 0)) {
	message="Workflow Task Can't Be Updated Because fees due or have not been assessed";
	showMessage = true;
	cancel = true;
	}
`^
CMN;Permitting!Building!~!~;CheckHeatElecBond^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
var dtBondEndDate = new Date();
var dtToday = new Date();
LicProfType = "";
heatElec = false;
LicProfType = aa.env.getValue("CAELienseType").toUpperCase();
if (AInfo['CAEAttribute.BOND END DATE'] != undefined && AInfo['CAEAttribute.BOND END DATE'] != null) {
	dtBondEndDate = new Date(AInfo['CAEAttribute.BOND END DATE']);
	}

if (LicProfType != "" && LicProfType != null) {
	if(LicProfType.substring(0,3) == "HTG" || LicProfType.substring(0,4) == "ELEC") heatElec = true;
	}

if (heatElec && dtToday > dtBondEndDate) {
	message = "The Licensed Professional you selected has an expired bond.";
	showMessage = true;
	cancel = true;
	}
`^
CMN;Permitting!Building!~!~;Final Inspection Fee Balance^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (inspType.equals("FINAL") && balanceDue > 0) {
	message="Can't schedule " + inspType + ", Balance Due of $" + balanceDue;
	showMessage = true;
	cancel = false;
	}
`^
CMN;Permitting!Building!~!~;LoadLPHomeOwner^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emptyLicProf = cap.getLicenseProfessionalModel();
peep = cap.getContactsGroup().iterator().next();
if (!checkCapForLicensedProfessionalType("HOME OWNER")) {
	emptyLicProf.setContactFirstName(peep.getFirstName());
	}

if (!checkCapForLicensedProfessionalType("HOME OWNER")) {
	emptyLicProf.setContactLastName(peep.getLastName());
	}

if (!checkCapForLicensedProfessionalType("HOME OWNER")) {
	emptyLicProf.setAddress1(peep.getAddressLine1());
	emptyLicProf.setCity(peep.getCity());
	}

if (!checkCapForLicensedProfessionalType("HOME OWNER")) {
	emptyLicProf.setState(peep.getState());
	emptyLicProf.setZip(peep.getZip());
	}

if (!checkCapForLicensedProfessionalType("HOME OWNER")) {
	emptyLicProf.setEmail(peep.getEmail());
	emptyLicProf.setPhone1(peep.getPhone1());
	}

if (!checkCapForLicensedProfessionalType("HOME OWNER")) {
	emptyLicProf.setPhone2(peep.getPhone2());
	emptyLicProf.setFax(peep.getFax());
	}

if (!checkCapForLicensedProfessionalType("HOME OWNER")) {
	emptyLicProf.setLicenseType("HOME OWNER");
	emptyLicProf.setLicenseNbr("000000");
	}

if (!checkCapForLicensedProfessionalType("HOME OWNER")) {
	cap.setLicenseProfessionalModel(emptyLicProf);
	}
`^
CMN;Permitting!Building!~!~;LPLoop^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
tLicType = licProf[lp].getLicenseType();
tLicNbr = licProf[lp].getStateLicense();
if (lpArray[checkValue].equals(tLicType) && !correctType && (capLPNumber.equals(tLicNbr) || capLPNumber.equals("000000"))) {
	correctType = true;
	licNumber = tLicNbr;
	licType = tLicType;
	}
`^
CMN;Permitting!Building!~!~;Permit Required^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (capStatus != "Issued") {
	message="Cannot schedule an inspection until permit status is ISSUED.";
	showMessage = true;
	cancel = true;
	}
`^
CMN;Permitting!Building!~!~;ResubmitTimeLimit^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfProcess == "BLDPERMIT" && wfTask == "Plan Review" && wfStatus == "Resubmit") {
	include("EML;Permitting!Building!~!~;ResubmitTimeLimit");
	}

if (wfProcess == "BLDPERMIT" && wfTask == "Plan Review" && wfStatus == "Resubmit") {
	editTaskDueDate("Plan Review",nextWorkDay(dateAdd(null,60)));
	}
`^
CMN;Permitting!Building!~!~;ValidateLP^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
isLicProf = false;
correctType = false;
licNumber = "";
isExpired = false;
capLPType = "none";
licExpired = false;
insExpired = false;
busExpired = false;
licType = "";
selectedType = "none";
homeOwner = getAppSpecific("HOMEOWNER QUESTION.I am the home owner and I will be doing the work.");
for (checkValue in lpArray) include("CMN;Permitting!Building!~!~;ValidateLPLoop");
if (isLicProf && !correctType && selectedType == "notSame" && homeOwner == "No") {
	cancel = true;
	showMessage = true;
	comment("The license selected is not an approved " + permitType + " contractor license.  You need to first associate your " + permitType + " contractor license information with your account before you can apply for this permit online. This is a one-time process and this must be approved by building inspection staff prior to submitting a permit online. If you are a homeowner doing this work on your own residence, then please select 'Yes' to the homeowner question on the previous screen in order to proceed.");
	}

if (isLicProf && !correctType && selectedType == "none" && homeOwner == "No") {
	cancel = true;
	showMessage = true;
	comment("Please select a(n) " + permitType + " contractor license associated with your account.  If you need to first associate your " + permitType + " contractor license information with your account please visit the Account Management section of this site.  This is a one-time process and this must be approved by the building inspection staff prior to submitting a permit online. If you are a homeowner doing this work on your own residence, then please select 'Yes' to the homeowner question on the previous screen in order to proceed.");
	}

if (isLicProf && !correctType && selectedType == "notSame" && homeOwner == "Yes" && capLPType != "HOME OWNER") {
	cancel = true;
	showMessage = true;
	comment("You selected that you are the homeowner doing this work on your own residence on the previous screen.  The license selected is not an approved " + permitType + " contractor license. You need to first associate your " + permitType + " contractor license information with your account before you can apply for this permit online. This is a one-time process and this must be approved by building inspection staff prior to submitting a permit online.  If you are the homeowner doing the work on your own residence, please click 'Apply for a Permit' to begin the process again and do not select a license on the 'Select a License' screen.");
	}

if (isLicProf && !correctType && selectedType == "none" && homeOwner == "Yes") {
	include("CMN;Permitting!Building!~!~;LoadLPHomeOwner");
	}

if (isLicProf && correctType && selectedType == "none" && homeOwner == "No") {
	cancel = true;
	showMessage = true;
	comment("Please select a(n) " + permitType + " contractor license associated with your account. If you need to first associate your " + permitType + " license information with your account please visit the Account Management section of this site. This is a one-time process and this must be approved by building inspection staff prior to submitting a permit on line. If you are a homeowner doing this work on your own residence, then please select 'Yes' to the homeowner question on the previous screen in order to proceed.");
	}

if (isLicProf && correctType && selectedType == "notSame" && homeOwner == "No") {
	cancel = true;
	showMessage = true;
	comment("The " + permitType + " contractor license associated with your account was not selected.  Please click on 'Remove' then 'Select from Account' below to to select your " + permitType + " contractor license. If you are a homeowner doing this work on your own residence, then please select 'Yes' to the homeowner question on the previous screen in order to proceed.");
	}

if (isLicProf && correctType && selectedType == "notSame" && homeOwner == "Yes") {
	cancel = true;
	showMessage = true;
	comment("The " + permitType + " contractor license associated with your account was not selected.  Please click on 'Remove' then 'Select from Account' below to to select your " + permitType + " contractor license. If you are a homeowner doing this work on your own residence, then please select 'Yes' to the homeowner question on the previous screen in order to proceed.");
	}

if (isLicProf && correctType && selectedType == "none" && isExpired) {
	cancel = true;
	showMessage = true;
	comment("Some credentials for your " + licType + "(" + licNumber + ") have expired.  You must correct this issue before continuing.  Please make sure State credentials are up to date - you can check your State Credentials at <a href='https;!!app.wi.gov!licensesearch' target='_blank'>https;!!app.wi.gov!licensesearch<!a>.  Then, please call 608-266-5902 so we can update our records. Thank you.");
	}

if (!isLicProf && !correctType && selectedType == "none" && homeOwner == "No") {
	cancel = true;
	showMessage = true;
	comment("You must first associate your " + permitType + " contractor license information with your account before you can apply for this permit online. This is a one-time process and this must be approved by building inspection staff prior to submitting a permit online. If you are a homeowner doing this work on your own residence, then please select 'Yes' to the homeowner question on the previous screen in order to proceed.");
	}

if (!isLicProf && !correctType && selectedType == "notSame" && homeOwner == "No") {
	cancel = true;
	showMessage = true;
	comment("You must first associate your " + permitType + " contractor license information with your account before you can apply for this permit online. This is a one-time process and this must be approved by building inspection staff prior to submitting a permit online. If you are a homeowner doing this work on your own residence, then please select 'Yes' to the homeowner question on the previous screen in order to proceed.");
	}

if (!isLicProf && !correctType && selectedType == "none" && homeOwner == "Yes") {
	include("CMN;Permitting!Building!~!~;LoadLPHomeOwner");
	}

if (!isLicProf && !correctType && selectedType == "notSame" && homeOwner == "Yes") {
	include("CMN;Permitting!Building!~!~;LoadLPHomeOwner");
	}

if (!isLicProf && !correctType && selectedType == "notSame" && homeOwner == "Yes" && capLPType != "HOME OWNER") {
	cancel = true;
	showMessage = true;
	comment("You must first associate your " + permitType + " contractor license information with your account before you can apply for this permit online. This is a one-time process and this must be approved by building inspection staff prior to submitting a permit online. If you are a homeowner doing this work on your own residence, then please select 'Yes' to the homeowner question on the previous screen in order to proceed.");
	}
`^
CMN;Permitting!Building!~!~;ValidateLPLoop^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showMessage = false;
showDebug = false;
tLicNbr = null;
tLicType = null;
capLicProf = null;
capLPNumber = "noNumber";
puser = aa.publicUser.getPublicUserByEmail(aa.person.getCurrentUser().getOutput().getEmail()).getOutput();
userSeqNum = puser.getUserSeqNum();
licProfList = aa.licenseScript.getRefLicProfByOnlineUser(userSeqNum);
if (licProfList.getSuccess()) {
	licProf = licProfList.getOutput();
	}

if (licProf[0] != null) {
	isLicProf = true;
	} else {
	isLicProf = false;
	}

capLicProfList = cap.getLicenseProfessionalList();
if (capLicProfList != null) {
	capLicProf = capLicProfList.iterator().next();
	capLPNumber = capLicProf.getLicenseNbr();
	}

if (licProf[0] != null) {
	for (lp in licProf) include("CMN;Permitting!Building!~!~;LPLoop");
	}

if (capLicProf != null) {
	capLPType = capLicProf.getLicenseType();
	} else {
	selectedType = "none";
	}

licExpired = hasExpiredLicense("EXPIRE", licNumber);
insExpired = hasExpiredLicense("INSURANCE", licNumber);
busExpired = hasExpiredLicense("BUSINESS", licNumber);
if ((licExpired || insExpired || busExpired)) {
	isExpired = true;
	}

if (capLicProf != null && lpArray[checkValue].equals(capLPType)) {
	selectedType = "same";
	} else {
	selectedType = "notSame";
	}

if (capLicProf != null && licNumber.equals(capLPNumber)) {
	selectedType = "same";
	} else {
	selectedType = "notSame";
	}

if (capLicProf == null && selectedType == "notSame") {
	selectedType = "none";
	}
`^
CMN;Permitting!Building!~!~;Workflow Checks Inspections and Balance^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
childBalance = 0;
childDetail = "";
childDetailObjResult = aa.cap.getCapDetail(childA[x]);
if (capDetailObjResult.getSuccess()) {
	childDetail = childDetailObjResult.getOutput();
	childBalance = childDetail.getBalance();
	}

if (childBalance > 0) {
	feesOwed = true;
	comment("...Balance Due On Related Permit" + childA[x].getCustomID() + " is $" + childBalance);
	cancel = true;
	}

holdId = capId;
capId = childA[x];
finalPassed = false;
finalPassed = checkInspectionResult("Final","Passed");
capId = holdId;
`^
CMN;Permitting!Building!~!NewConstruction;ShellOnlyFeeAdjustment^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['Shell Only to be Constructed']) {
	email("poleary@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","shell","shell");
	}

email("poleary@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","newcon","newcon " + AInfo['Shell Only to be Constructed'] + " is so");
`^
CMN;Permitting!Building!~!Raze;ProcessTimeLimit^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
scheduleInspectDate("FINAL",dateAdd(wfDateMMDDYYYY,30),null,null,workDescGet(capId));
autoAssignInspection(getScheduledInspId("FINAL"));
`^
CMN;Permitting!Building!Commercial!Construction;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['PLAN REVIEW.Total Alteration & Remodeling Area'] != null) {
	if(feeExists("ALTPLNRVWCTY") == false) updateFee("ALTPLNRVWCTY","BLDNCC","FINAL",1,"N");
	} else {
	if(feeExists("ALTPLNRVWCTY") == true) removeFee("ALTPLNRVWCTY","FINAL");
	}

if (AInfo['PLAN REVIEW.Total Alteration & Remodeling Area'] >= 10000) {
	if(feeExists("ALTPLNRVWS") == false) updateFee("ALTPLNRVWS","BLDNCC","FINAL",1,"N");
	} else {
	if(feeExists("ALTPLNRVWS") == true) removeFee("ALTPLNRVWS","FINAL");
	}

if (AInfo['AUX BLDGS.Awnings'] != null) {
	if(feeExists("AWNINSP") == false) updateFee("AWNINSP","BLDNCC","FINAL",1,"N");
	} else {
	if(feeExists("AWNINSP") == true) removeFee("AWNINSP","FINAL");
	}

if (AInfo['PLAN REVIEW.Total New Const. Floor Area'] != null) {
	if(feeExists("BLDPLNRVWCTY") == false) updateFee("BLDPLNRVWCTY","BLDNCC","FINAL",1,"N");
	} else {
	if(feeExists("BLDPLNRVWCTY") == true) removeFee("BLDPLNRVWCTY","FINAL");
	}

if (AInfo['PLAN REVIEW.Total New Const. Floor Area'] != null) {
	if(feeExists("BLDPLNRVWST") == false) updateFee("BLDPLNRVWST","BLDNCC","FINAL",1,"N");
	} else {
	if(feeExists("BLDPLNRVWST") == true) removeFee("BLDPLNRVWST","FINAL");
	}

if (AInfo['ADDITIONAL BUILDING AREA.Total New or Additional Commercial Area'] != null) {
	if(feeExists("COMCONIN") == false) updateFee("COMCONIN","BLDNCC","FINAL",1,"N");
	} else {
	if(feeExists("COMCONIN") == true) removeFee("COMCONIN","FINAL");
	}

if (AInfo['OCCUPANCY TYPE.First Certificate of Occupancy Requested - Enter 1'] != null) {
	if(feeExists("COO1") == false) updateFee("COO1","BLDNCC","FINAL",1,"N");
	} else {
	if(feeExists("COO1") == true) removeFee("COO1","FINAL");
	}

if (AInfo['OCCUPANCY TYPE.Additional Certificates of Occupancy Requested'] != null) {
	if(feeExists("COO2") == false) updateFee("COO2","BLDNCC","FINAL",1,"N");
	} else {
	if(feeExists("COO2") == true) removeFee("COO2","FINAL");
	}

if (AInfo['PLAN REVIEW.Plan Review for Items Not On Schedule'] != null) {
	if(feeExists("MISCPLNRVW") == false) updateFee("MISCPLNRVW","BLDNCC","FINAL",1,"N");
	} else {
	if(feeExists("MISCPLNRVW") == true) removeFee("MISCPLNRVW","FINAL");
	}

if (AInfo['PLAN REVIEW.Revisions to Prev. Reviewed Plans'] != null) {
	if(feeExists("PLNRIVISION") == false) updateFee("PLNRIVISION","BLDNCC","FINAL",1,"N");
	} else {
	if(feeExists("PLNRIVISION") == true) removeFee("PLNRIVISION","FINAL");
	}

if (AInfo['GENERAL_INFORMATION.Solar Panel or Collector'] != null) {
	if(feeExists("SOLPNLCOLIN") == false) updateFee("SOLPNLCOLIN","BLDNCC","FINAL",1,"N");
	} else {
	if(feeExists("SOLPNLCOLIN") == true) removeFee("SOLPNLCOLIN","FINAL");
	}

if (AInfo['OCCUPANCY TYPE.Certificate of Occupancy for Zoning Change of Use'] != null) {
	if(feeExists("ZNCOO") == false) updateFee("ZNCOO","BLDNCC","FINAL",1,"N");
	} else {
	if(feeExists("ZNCOO") == true) removeFee("ZNCOO","FINAL");
	}

if (AInfo['ADDITIONAL BUILDING AREA.Total New or Additional Residential Area'] != null) {
	if(feeExists("RESCONIN") == false) updateFee("RESCONIN","BLDNCC","FINAL",1,"N");
	} else {
	if(feeExists("RESCONIN") == true) removeFee("RESCONIN","FINAL");
	}

if (AInfo['ADDITIONAL BUILDING AREA.Total New or Additional Industrial Area'] != null) {
	if(feeExists("INDCONIN") == false) updateFee("INDCONIN","BLDNCC","FINAL",1,"N");
	} else {
	if(feeExists("INDCONIN") == true) removeFee("INDCONIN","FINAL");
	}

if (AInfo['ADDITIONAL BUILDING AREA.Total Value of Alterations or Remodeling Work'] != null) {
	updateFee("ALTERATION","BLDNCC","FINAL",parseInt(AInfo['ADDITIONAL BUILDING AREA.Total Value of Alterations or Remodeling Work']),"N");
	} else {
	if(feeExists("ALTERATION") == true) removeFee("ALTERATION","FINAL");
	}

if (AInfo['PLAN REVIEW.Total New Const. Floor Area'] != null) {
	if(feeExists("ZONAPPNEW") == false) updateFee("ZONAPPNEW","BLDNCC","FINAL",1,"N");
	} else {
	if(feeExists("ZONAPPNEW") == true) removeFee("ZONAPPNEW","FINAL");
	}

if (AInfo['PLAN REVIEW.Total Alteration & Remodeling Area'] != null) {
	if(feeExists("ZONAPPALT") == false) updateFee("ZONAPPALT","BLDNCC","FINAL",1,"N");
	} else {
	if(feeExists("ZONAPPALT") == true) removeFee("ZONAPPALT","FINAL");
	}

if (AInfo['PLAN REVIEW.Estimated Cost - New Parking Lot'] != null) {
	updateFee("PL","BLDNCC","FINAL",Math.ceil(AInfo['PLAN REVIEW.Estimated Cost - New Parking Lot'] ! 1000),"N");
	} else {
	if(feeExists("PL") == true) removeFee("PL","FINAL");
	}

if (AInfo['GENERAL_INFORMATION.Project Type'] == "New Building" &&  (AInfo['OCCUPANCY TYPE.Storage'] != "CHECKED" || AInfo['OCCUPANCY TYPE.Utility'] != "CHECKED")) {
	if(feeExists("SC") == false) updateFee("SC","BLDNCC","FINAL",1,"N");
	} else {
	if(feeExists("SC") == true) removeFee("SC","FINAL");
	}

if (AInfo['PLAN REVIEW.Plan Review Type'] != null && AInfo['PLAN REVIEW.Plan Review for Items Not On Schedule'] == 1) {
	if(feeExists("STRRVW1COM") == false) updateFee("STRRVW1COM","BLDNCC","FINAL",1,"N");
	} else {
	if(feeExists("STRRVW1COM") == true) removeFee("STRRVW1COM","FINAL");
	}

if (AInfo['PLAN REVIEW.Plan Review Type'] != null && AInfo['PLAN REVIEW.Plan Review for Items Not On Schedule'] > 1) {
	if(feeExists("STRRVW2COM") == false) updateFee("STRRVW2COM","BLDNCC","FINAL",1,"N");
	} else {
	if(feeExists("STRRVW2COM") == true) removeFee("STRRVW2COM","FINAL");
	}

if (AInfo['GENERAL_INFORMATION.Antenna'] != null) {
	if(feeExists("ANTENNA") == false) updateFee("ANTENNA","BLDNCC","FINAL",parseInt(AInfo['GENERAL_INFORMATION.Antenna']),"N");
	} else {
	if(feeExists("ANTENNA") == true) removeFee("ANTENNA","FINAL");
	}
`^
CMN;Permitting!Building!Commercial!New Electrical;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL INFORMATION.Total New or Additional Commercial Area'] != null) {
	if(feeExists("COMELEIN") == false) updateFee("COMELEIN","BLDNCE","FINAL",1,"N");
	} else {
	if(feeExists("COMELEIN") == true) removeFee("COMELEIN","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Total New or Additional Residential Area'] != null) {
	if(feeExists("RESELEIN") == false) updateFee("RESELEIN","BLDNCE","FINAL",1,"N");
	} else {
	if(feeExists("RESELEIN") == true) removeFee("RESELEIN","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Total New or Additional Industrial Area'] != null) {
	if(feeExists("INDELEIN") == false) updateFee("INDELEIN","BLDNCE","FINAL",1,"N");
	} else {
	if(feeExists("INDELEIN") == true) removeFee("INDELEIN","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Number of Openings Added or Moved'] != null) {
	if(feeExists("NUMOPENADD") == false) updateFee("NUMOPENADD","BLDNIE","FINAL",1,"N");
	} else {
	if(feeExists("NUMOPENADD") == true) removeFee("NUMOPENADD","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Number of Service Entrances'] != null) {
	if(feeExists("SRVENTR") == false) updateFee("SRVENTR","BLDNIE","FINAL",1,"N");
	} else {
	if(feeExists("SRVENTR") == true) removeFee("SRVENTR","FINAL");
	}
`^
CMN;Permitting!Building!Commercial!New HVAC;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL INFORMATION.Total New or Additional Commercial Area'] != null) {
	if(feeExists("COMHVACIN") == false) updateFee("COMHVACIN","BLDNCH","FINAL",1,"N");
	} else {
	if(feeExists("COMHVACIN") == true) removeFee("COMHVACIN","FINAL");
	}

if ((AInfo['GENERAL INFORMATION.Project Type'] == "New" || AInfo['GENERAL INFORMATION.Project Type'] == "Addition") && AInfo['GENERAL INFORMATION.Total HVAC Area'] != null) {
	if(feeExists("HVACPLNRVWCT") == false) updateFee("HVACPLNRVWCT","BLDNCH","FINAL",1,"N");
	} else {
	if(feeExists("HVACPLNRVWCT") == true) removeFee("HVACPLNRVWCT","FINAL");
	}

if ((AInfo['GENERAL INFORMATION.Project Type'] == "Alteration" || AInfo['GENERAL INFORMATION.Project Type'] == "Addition & Alteration") && AInfo['GENERAL INFORMATION.Total HVAC Area'] != null) {
	if(feeExists("HVACPLNRVWC2") == false) updateFee("HVACPLNRVWC2","BLDNCH","FINAL",1,"N");
	} else {
	if(feeExists("HVACPLNRVWC2") == true) removeFee("HVACPLNRVWC2","FINAL");
	}

if ((AInfo['GENERAL INFORMATION.Project Type'] == "New" || AInfo['GENERAL INFORMATION.Project Type'] == "Addition") && AInfo['GENERAL INFORMATION.Total HVAC Area'] >= 5000) {
	if(feeExists("HVACPLNRVWS") == false) updateFee("HVACPLNRVWS","BLDNCH","FINAL",1,"N");
	} else {
	if(feeExists("HVACPLNRVWS") == true) removeFee("HVACPLNRVWS","FINAL");
	}

if ((AInfo['GENERAL INFORMATION.Project Type'] == "Alteration" || AInfo['GENERAL INFORMATION.Project Type'] == "Addition & Alteration") && AInfo['GENERAL INFORMATION.Total HVAC Area'] >= 10000) {
	if(feeExists("HVACPLNRVW2") == false) updateFee("HVACPLNRVW2","BLDNCH","FINAL",1,"N");
	} else {
	if(feeExists("HVACPLNRVW2") == true) removeFee("HVACPLNRVW2","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Total New or Additional Residential Area'] != null) {
	if(feeExists("RESHVACIN") == false) updateFee("RESHVACIN","BLDNCH","FINAL",1,"N");
	} else {
	if(feeExists("RESHVACIN") == true) removeFee("RESHVACIN","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Total New or Additional Industrial Area'] != null) {
	if(feeExists("INDHVACIN") == false) updateFee("INDHVACIN","BLDNCH","FINAL",1,"N");
	} else {
	if(feeExists("INDHVACIN") == true) removeFee("INDHVACIN","FINAL");
	}

if (AInfo['ALTERATION INFORMATION.Est. Cost of Alterations to Existing System (dollar amt)'] != null) {
	if(feeExists("ALTEXVNTSYS") == false) updateFee("ALTEXVNTSYS","BLDNCH","FINAL",parseInt(AInfo['ALTERATION INFORMATION.Est. Cost of Alterations to Existing System (dollar amt)']),"N");
	} else {
	if(feeExists("ALTEXVNTSYS") == true) removeFee("ALTEXVNTSYS","FINAL");
	}

if (AInfo['ALTERATION INFORMATION.Replace Oil Tank'] != null) {
	if(feeExists("OILTANK") == false) updateFee("OILTANK","BLDNCH","FINAL",1,"N");
	} else {
	if(feeExists("OILTANK") == true) removeFee("OILTANK","FINAL");
	}

if (AInfo['ALTERATION INFORMATION.Replace Oil or Wood Burning Stoves'] != null) {
	if(feeExists("OILWDBRNSTV") == false) updateFee("OILWDBRNSTV","BLDNCH","FINAL",1,"N");
	} else {
	if(feeExists("OILWDBRNSTV") == true) removeFee("OILWDBRNSTV","FINAL");
	}

if (AInfo['ALTERATION INFORMATION.Repair Chimney installed with wood burning equipment'] != null) {
	if(feeExists("WDBRNCHIM") == false) updateFee("WDBRNCHIM","BLDNCH","FINAL",1,"N");
	} else {
	if(feeExists("WDBRNCHIM") == true) removeFee("WDBRNCHIM","FINAL");
	}

if (AInfo['ALTERATION INFORMATION.Chimney Installed Separately'] != null) {
	if(feeExists("CHIMNEY") == false) updateFee("CHIMNEY","BLDNCH","FINAL",1,"N");
	} else {
	if(feeExists("CHIMNEY") == true) removeFee("CHIMNEY","FINAL");
	}

if (AInfo['ALTERATION INFORMATION.Repair Solar Collectors'] != null) {
	if(feeExists("SOLCOLL") == false) updateFee("SOLCOLL","BLDNCH","FINAL",1,"N");
	} else {
	if(feeExists("SOLCOLL") == true) removeFee("SOLCOLL","FINAL");
	}

if (AInfo['ALTERATION BTU LOSS. 60,000'] == "CHECKED") {
	if(feeExists("6K") == false) updateFee("6K","BLDNCH","FINAL",1,"N");
	} else {
	if(feeExists("6K") == true) removeFee("6K","FINAL");
	}

if (AInfo['ALTERATION BTU LOSS.165,000'] == "CHECKED") {
	if(feeExists("165K") == false) updateFee("165K","BLDNCH","FINAL",1,"N");
	} else {
	if(feeExists("165K") == true) removeFee("165K","FINAL");
	}

if (AInfo['ALTERATION BTU LOSS.300,000'] == "CHECKED") {
	if(feeExists("300K") == false) updateFee("300K","BLDNCH","FINAL",1,"N");
	} else {
	if(feeExists("300K") == true) removeFee("300K","FINAL");
	}

if (AInfo['ALTERATION BTU LOSS.500,000'] == "CHECKED") {
	if(feeExists("500K") == false) updateFee("500K","BLDNCH","FINAL",1,"N");
	} else {
	if(feeExists("500K") == true) removeFee("500K","FINAL");
	}

if (AInfo['ALTERATION BTU LOSS.3,000,000'] == "CHECKED") {
	if(feeExists("3M") == false) updateFee("3M","BLDNCH","FINAL",1,"N");
	} else {
	if(feeExists("3M") == true) removeFee("3M","FINAL");
	}

if (AInfo['ALTERATION BTU LOSS.4,000,000'] == "CHECKED") {
	if(feeExists("4M") == false) updateFee("4M","BLDNCH","FINAL",1,"N");
	} else {
	if(feeExists("4M") == true) removeFee("4M","FINAL");
	}

if (AInfo['ALTERATION BTU LOSS.5,000,000'] == "CHECKED") {
	if(feeExists("5M") == false) updateFee("5M","BLDNCH","FINAL",1,"N");
	} else {
	if(feeExists("5M") == true) removeFee("5M","FINAL");
	}

if (AInfo['ALTERATION BTU LOSS.6,000,000'] == "CHECKED") {
	if(feeExists("6M") == false) updateFee("6M","BLDNCH","FINAL",1,"N");
	} else {
	if(feeExists("6M") == true) removeFee("6M","FINAL");
	}
`^
CMN;Permitting!Building!Commercial!New Plumbing;ASITotal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
editAppSpecific("Total Number of Appliances and Fixtures",0);
totalitems = 0;
if (typeof(PLUMBINGFIXTURES) == "object") {
	for (eachrow in PLUMBINGFIXTURES) totalitems = totalitems + parseInt(PLUMBINGFIXTURES[eachrow]["Quantity"]);
	}

editAppSpecific("Total Number of Appliances and Fixtures",totalitems);
`^
CMN;Permitting!Building!Commercial!New Plumbing;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL INFORMATION.Total New or Additional Commercial Area'] != null) {
	if(feeExists("COMPLMIN") == false) updateFee("COMPLMIN","BLDNCP","FINAL",1,"N");
	} else {
	if(feeExists("COMPLMIN") == true) removeFee("COMPLMIN","FINAL");
	}

if (AInfo['ADD REMOD PLM PLAN REVIEW.Bldg Storm Drainage (Sum Storm Swr dia)'] != null) {
	if(feeExists("PRBSD") == false) updateFee("PRBSD","BLDNCP","FINAL",1,"N");
	} else {
	if(feeExists("PRBSD") == true) removeFee("PRBSD","FINAL");
	}

if (AInfo['NEW CONST PLM PLAN REVIEW.Bldg. Storm Drainage (Sum Storm Swr Dia.)'] != null) {
	if(feeExists("PRBSD") == false) updateFee("PRBSD","BLDNCP","FINAL",1,"N");
	} else {
	if(feeExists("PRBSD") == true) removeFee("PRBSD","FINAL");
	}

if (AInfo['NEW CONST PLM PLAN REVIEW.Car Wash Interceptor'] != null) {
	if(feeExists("PRCWI") == false) updateFee("PRCWI","BLDNCP","FINAL",1,"N");
	} else {
	if(feeExists("PRCWI") == true) removeFee("PRCWI","FINAL");
	}

if (AInfo['NEW CONST PLM PLAN REVIEW.Garage Catch Basin'] != null) {
	if(feeExists("PRGCB") == false) updateFee("PRGCB","BLDNCP","FINAL",1,"N");
	} else {
	if(feeExists("PRGCB") == true) removeFee("PRGCB","FINAL");
	}

if (AInfo['NEW CONST PLM PLAN REVIEW.Grease Interceptor'] != null) {
	if(feeExists("PRGI") == false) updateFee("PRGI","BLDNCP","FINAL",1,"N");
	} else {
	if(feeExists("PRGI") == true) removeFee("PRGI","FINAL");
	}

if (AInfo['ADD REMOD PLM PLAN REVIEW.Bldg. Water Dist. System'] != null) {
	if(feeExists("PRGPM") == false) updateFee("PRGPM","BLDNCP","FINAL",1,"N");
	} else {
	if(feeExists("PRGPM") == true) removeFee("PRGPM","FINAL");
	}

if (AInfo['NEW CONST PLM PLAN REVIEW.Oil Interceptor'] != null) {
	if(feeExists("PROI") == false) updateFee("PROI","BLDNCP","FINAL",1,"N");
	} else {
	if(feeExists("PROI") == true) removeFee("PROI","FINAL");
	}

if (AInfo['NEW CONST PLM PLAN REVIEW.Private Interceptor Mn. Swr. (Sum Lgst Dia.)'] != null) {
	if(feeExists("PRPIMS") == false) updateFee("PRPIMS","BLDNCP","FINAL",1,"N");
	} else {
	if(feeExists("PRPIMS") == true) removeFee("PRPIMS","FINAL");
	}

if (AInfo['NEW CONST PLM PLAN REVIEW.Plan Revision (Enter 1)'] != null) {
	if(feeExists("PRREV") == false) updateFee("PRREV","BLDNCP","FINAL",1,"N");
	} else {
	if(feeExists("PRREV") == true) removeFee("PRREV","FINAL");
	}

if (AInfo['NEW CONST PLM PLAN REVIEW.San. Bldg. Sewer Only (Dia. Inches)'] != null) {
	if(feeExists("PRSBSO") == false) updateFee("PRSBSO","BLDNCP","FINAL",1,"N");
	} else {
	if(feeExists("PRSBSO") == true) removeFee("PRSBSO","FINAL");
	}

if (AInfo['ADD REMOD PLM PLAN REVIEW.Sanitary Drain and Vent (Diameter)'] != null) {
	if(feeExists("PRSDV") == false) updateFee("PRSDV","BLDNCP","FINAL",1,"N");
	} else {
	if(feeExists("PRSDV") == true) removeFee("PRSDV","FINAL");
	}

if (AInfo['NEW CONST PLM PLAN REVIEW.Sanitary Drain and Vent (Dia. Inches)'] != null) {
	if(feeExists("PRSDV") == false) updateFee("PRSDV","BLDNCP","FINAL",1,"N");
	} else {
	if(feeExists("PRSDV") == true) removeFee("PRSDV","FINAL");
	}

if (AInfo['NEW CONST PLM PLAN REVIEW.Water Distribution Sys. (Dia. Inches)'] != null) {
	if(feeExists("PRWDS") == false) updateFee("PRWDS","BLDNCP","FINAL",1,"N");
	} else {
	if(feeExists("PRWDS") == true) removeFee("PRWDS","FINAL");
	}

if (AInfo['NEW CONST PLM PLAN REVIEW.Private Water Main (# of Wtr. Mn. Systems)'] != null) {
	if(feeExists("PRWM") == false) updateFee("PRWM","BLDNCP","FINAL",1,"N");
	} else {
	if(feeExists("PRWM") == true) removeFee("PRWM","FINAL");
	}

if (AInfo['NEW CONST PLM PLAN REVIEW.Water Service Only (Dia. Inches)'] != null) {
	if(feeExists("PRWSO") == false) updateFee("PRWSO","BLDNCP","FINAL",1,"N");
	} else {
	if(feeExists("PRWSO") == true) removeFee("PRWSO","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Total New or Additional Residential Area'] != null) {
	if(feeExists("RESPLMIN") == false) updateFee("RESPLMIN","BLDNCP","FINAL",1,"N");
	} else {
	if(feeExists("RESPLMIN") == true) removeFee("RESPLMIN","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Total New or Additional Industrial Area'] != null) {
	if(feeExists("INDPLMIN") == false) updateFee("INDPLMIN","BLDNCP","FINAL",1,"N");
	} else {
	if(feeExists("INDPLMIN") == true) removeFee("INDPLMIN","FINAL");
	}

if (AInfo['ALTERATION INFORMATION.Total Number of Appliances and Fixtures'] != null) {
	if(feeExists("APPLFXTINST") == false) updateFee("APPLFXTINST","BLDNCP","FINAL",1,"N");
	} else {
	if(feeExists("APPLFXTINST") == true) removeFee("APPLFXTINST","FINAL");
	}

if (AInfo['ALTERATION INFORMATION.New Private Main'] != null) {
	if(feeExists("NEWPVTMAIN") == false) updateFee("NEWPVTMAIN","BLDNCP","FINAL",parseInt(AInfo['ALTERATION INFORMATION.New Private Main']),"Y");
	}

if (AInfo['ALTERATION INFORMATION.Total Linear Feet of Drain'] != null) {
	if(feeExists("SWRSANSTRYBP") == false) updateFee("SWRSANSTRYBP","BLDNCP","FINAL",1,"N");
	} else {
	if(feeExists("SWRSANSTRYBP") == true) removeFee("SWRSANSTRYBP","FINAL");
	}

if (AInfo['ALTERATION INFORMATION.Water Main - private or services'] != null) {
	if(feeExists("WATERMAIN") == false) updateFee("WATERMAIN","BLDNCP","FINAL",1,"N");
	} else {
	if(feeExists("WATERMAIN") == true) removeFee("WATERMAIN","FINAL");
	}
`^
CMN;Permitting!Building!Commercial!Raze;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL INFORMATION.Total Volume of Building'] != null) {
	if(feeExists("BLDCIRAZ") == false) updateFee("BLDCIRAZ","BLDCOMRAZ","FINAL",1,"N");
	} else {
	if(feeExists("BLDCIRAZ") == true) removeFee("BLDCIRAZ","FINAL");
	}
`^
CMN;Permitting!Building!Industrial!Construction;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['ADDITIONAL BUILDING AREA.Total Value of Alterations or Remodeling Work'] != null) {
	if(feeExists("ALTERATION") == false) updateFee("ALTERATION","BLDNIC","FINAL",parseInt(AInfo['ADDITIONAL BUILDING AREA.Total Value of Alterations or Remodeling Work']),"N");
	} else {
	if(feeExists("ALTERATION") == true) removeFee("ALTERATION","FINAL");
	}

if (AInfo['PLAN REVIEW.Total Alteration & Remodeling Area'] != null) {
	if(feeExists("ALTPLNRVWCTY") == false) updateFee("ALTPLNRVWCTY","BLDNIC","FINAL",1,"N");
	}

if (AInfo['PLAN REVIEW.Total Alteration & Remodeling Area'] != null) {
	if(feeExists("ALTPLNRVWST") == false) updateFee("ALTPLNRVWST","BLDNIC","FINAL",1,"N");
	}

if (AInfo['PLAN REVIEW.Total New Const. Floor Area'] != null) {
	if(feeExists("BLDPLNRVWCT") == false) updateFee("BLDPLNRVWCT","BLDNIC","FINAL",1,"N");
	}

if (AInfo['PLAN REVIEW.Total New Const. Floor Area'] != null) {
	if(feeExists("BLDPLNRVWST") == false) updateFee("BLDPLNRVWST","BLDNIC","FINAL",1,"N");
	}

if (AInfo['OCCUPANCY TYPE.First Certificate of Occupancy Requested (Enter 1)'] != null) {
	if(feeExists("COO1") == false) updateFee("COO1","BLDNIC","FINAL",1,"N");
	} else {
	if(feeExists("COO1") == true) removeFee("COO1","FINAL");
	}

if (AInfo['OCCUPANCY TYPE.Additional Certificates of Occupancy Requested'] != null) {
	if(feeExists("COO2") == false) updateFee("COO2","BLDNIC","FINAL",1,"N");
	} else {
	if(feeExists("COO2") == true) removeFee("COO2","FINAL");
	}

if (AInfo['ADDITIONAL BUILDING AREA.Total New or Additional Area'] != null) {
	if(feeExists("INDCONIN") == false) updateFee("INDCONIN","BLDNIC","FINAL",1,"N");
	} else {
	if(feeExists("INDCONIN") == true) removeFee("INDCONIN","FINAL");
	}

if (AInfo['PLAN REVIEW.Plan Review for Items Not On Schedule'] != null) {
	if(feeExists("MISCPLNRVW") == false) updateFee("MISCPLNRVW","BLDNIC","FINAL",1,"N");
	} else {
	if(feeExists("MISCPLNRVW") == true) removeFee("MISCPLNRVW","FINAL");
	}

if (AInfo['PLAN REVIEW.Rev. to Prev. Reviewed Plans (Enter 1)'] != null) {
	if(feeExists("PLNRIVISION") == false) updateFee("PLNRIVISION","BLDNIC","FINAL",1,"N");
	} else {
	if(feeExists("PLNRIVISION") == true) removeFee("PLNRIVISION","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Solar Panel or Collector (Enter Qty)'] != null) {
	if(feeExists("SOLPNLCOLIN") == false) updateFee("SOLPNLCOLIN","BLDNIC","FINAL",1,"N");
	} else {
	if(feeExists("SOLPNLCOLIN") == true) removeFee("SOLPNLCOLIN","FINAL");
	}

if (AInfo['OCCUPANCY TYPE.CoO for Zoning Chg. of Use Or Occupancy'] != null) {
	if(feeExists("ZNCOO") == false) updateFee("ZNCOO","BLDNIC","FINAL",1,"N");
	} else {
	if(feeExists("ZNCOO") == true) removeFee("ZNCOO","FINAL");
	}

if (AInfo['PLAN REVIEW.Total New Const. Floor Area'] != null) {
	if(feeExists("ZONAPPNEW") == false) updateFee("ZONAPPNEW","BLDNIC","FINAL",1,"N");
	} else {
	if(feeExists("ZONAPPNEW") == true) removeFee("ZONAPPNEW","FINAL");
	}

if (AInfo['PLAN REVIEW.Total Alteration & Remodeling Area'] != null) {
	if(feeExists("ZONAPPALT") == false) updateFee("ZONAPPALT","BLDNIC","FINAL",1,"N");
	} else {
	if(feeExists("ZONAPPALT") == true) removeFee("ZONAPPALT","FINAL");
	}

if (AInfo['PLAN REVIEW.Estimated Cost - New Parking Lot'] != null) {
	updateFee("PL","BLDNIC","FINAL",Math.ceil(AInfo['PLAN REVIEW.Estimated Cost - New Parking Lot'] ! 1000),"N");
	} else {
	if(feeExists("PL") == true) removeFee("PL","FINAL");
	}

if (AInfo['GENERAL_INFORMATION.Project Type'] == "New Building") {
	if(feeExists("SC") == false) updateFee("SC","BLDNIC","FINAL",1,"N");
	} else {
	if(feeExists("SC") == true) removeFee("SC","FINAL");
	}
`^
CMN;Permitting!Building!Industrial!New Electrical;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL INFORMATION.Number of Openings Added or Moved'] != null) {
	if(feeExists("NUMOPENADD") == false) updateFee("NUMOPENADD","BLDNIE","FINAL",1,"N");
	} else {
	if(feeExists("NUMOPENADD") == true) removeFee("NUMOPENADD","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Number of Service Entrances'] != null) {
	if(feeExists("SRVENTR") == false) updateFee("SRVENTR","BLDNIE","FINAL",1,"N");
	} else {
	if(feeExists("SRVENTR") == true) removeFee("SRVENTR","FINAL");
	}
`^
CMN;Permitting!Building!Industrial!New HVAC;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL INFORMATION.Total HVAC Area'] != null) {
	if(feeExists("HVACPLNRVWCT") == false) updateFee("HVACPLNRVWCT","BLDNIH","FINAL",1,"N");
	} else {
	if(feeExists("HVACPLNRVWCT") == true) removeFee("HVACPLNRVWCT","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Total HVAC Area'] != null) {
	if(feeExists("HVACPLNRVWST") == false) updateFee("HVACPLNRVWST","BLDNIH","FINAL",1,"N");
	} else {
	if(feeExists("HVACPLNRVWST") == true) removeFee("HVACPLNRVWST","FINAL");
	}

if (AInfo['HVAC AREA.Total HVAC Area'] != null) {
	if(feeExists("INDHVACIN") == false) updateFee("INDHVACIN","BLDNIH","FINAL",1,"N");
	} else {
	if(feeExists("INDHVACIN") == true) removeFee("INDHVACIN","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Revisions to Previous Reviewed Plans (Enter 1)'] != null) {
	if(feeExists("PLNRIVISION") == false) updateFee("PLNRIVISION","BLDNIH","FINAL",1,"N");
	} else {
	if(feeExists("PLNRIVISION") == true) removeFee("PLNRIVISION","FINAL");
	}

if (AInfo['ALTERATION INFORMATION.Est. Cost of Alterations to Existing System (dollar amt)'] != null) {
	if(feeExists("ALTEXVNTSYS") == false) updateFee("ALTEXVNTSYS","BLDNCH","FINAL",parseInt(AInfo['ALTERATION INFORMATION.Est. Cost of Alterations to Existing System (dollar amt)']),"N");
	} else {
	if(feeExists("ALTEXVNTSYS") == true) removeFee("ALTEXVNTSYS","FINAL");
	}

if (AInfo['ALTERATION INFORMATION.Replace Oil Tank'] != null) {
	if(feeExists("OILTANK") == false) updateFee("OILTANK","BLDNCH","FINAL",1,"N");
	} else {
	if(feeExists("OILTANK") == true) removeFee("OILTANK","FINAL");
	}

if (AInfo['ALTERATION INFORMATION.Replace Oil or Wood Burning Stoves'] != null) {
	if(feeExists("OILWDBRNSTV") == false) updateFee("OILWDBRNSTV","BLDNCH","FINAL",1,"N");
	} else {
	if(feeExists("OILWDBRNSTV") == true) removeFee("OILWDBRNSTV","FINAL");
	}

if (AInfo['ALTERATION INFORMATION.Repair Chimney installed with wood burning equipment'] != null) {
	if(feeExists("WDBRNCHIM") == false) updateFee("WDBRNCHIM","BLDNCH","FINAL",1,"N");
	} else {
	if(feeExists("WDBRNCHIM") == true) removeFee("WDBRNCHIM","FINAL");
	}

if (AInfo['ALTERATION INFORMATION.Chimney Installed Separately'] != null) {
	if(feeExists("CHIMNEY") == false) updateFee("CHIMNEY","BLDNCH","FINAL",1,"N");
	} else {
	if(feeExists("CHIMNEY") == true) removeFee("CHIMNEY","FINAL");
	}

if (AInfo['ALTERATION INFORMATION.Repair Solar Collectors'] != null) {
	if(feeExists("SOLCOLL") == false) updateFee("SOLCOLL","BLDNCH","FINAL",1,"N");
	} else {
	if(feeExists("SOLCOLL") == true) removeFee("SOLCOLL","FINAL");
	}

if (AInfo['ALTERATION BTU LOSS. 60,000'] == "CHECKED") {
	if(feeExists("6K") == false) updateFee("6K","BLDNIH","FINAL",1,"N");
	} else {
	if(feeExists("6K") == true) removeFee("6K","FINAL");
	}

if (AInfo['ALTERATION BTU LOSS.165,000'] == "CHECKED") {
	if(feeExists("165K") == false) updateFee("165K","BLDNIH","FINAL",1,"N");
	} else {
	if(feeExists("165K") == true) removeFee("165K","FINAL");
	}

if (AInfo['ALTERATION BTU LOSS.300,000'] == "CHECKED") {
	if(feeExists("300K") == false) updateFee("300K","BLDNIH","FINAL",1,"N");
	} else {
	if(feeExists("300K") == true) removeFee("300K","FINAL");
	}

if (AInfo['ALTERATION BTU LOSS.500,000'] == "CHECKED") {
	if(feeExists("500K") == false) updateFee("500K","BLDNIH","FINAL",1,"N");
	} else {
	if(feeExists("500K") == true) removeFee("500K","FINAL");
	}

if (AInfo['ALTERATION BTU LOSS.3,000,000'] == "CHECKED") {
	if(feeExists("3M") == false) updateFee("3M","BLDNIH","FINAL",1,"N");
	} else {
	if(feeExists("3M") == true) removeFee("3M","FINAL");
	}

if (AInfo['ALTERATION BTU LOSS.4,000,000'] == "CHECKED") {
	if(feeExists("4M") == false) updateFee("4M","BLDNIH","FINAL",1,"N");
	} else {
	if(feeExists("4M") == true) removeFee("4M","FINAL");
	}

if (AInfo['ALTERATION BTU LOSS.5,000,000'] == "CHECKED") {
	if(feeExists("5M") == false) updateFee("5M","BLDNIH","FINAL",1,"N");
	} else {
	if(feeExists("5M") == true) removeFee("5M","FINAL");
	}

if (AInfo['ALTERATION BTU LOSS.6,000,000'] == "CHECKED") {
	if(feeExists("6M") == false) updateFee("6M","BLDNIH","FINAL",1,"N");
	} else {
	if(feeExists("6M") == true) removeFee("6M","FINAL");
	}
`^
CMN;Permitting!Building!Industrial!New Plumbing;ASITotal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
editAppSpecific("Total Number of Appliances and Fixtures",0);
if (typeof(PLUMBINGFIXTURES) == "object") {
	totalitems = 0;
	for (eachrow in PLUMBINGFIXTURES) totalitems = totalitems + parseInt(PLUMBINGFIXTURES[eachrow]["Quantity"]);
	}

editAppSpecific("Total Number of Appliances and Fixtures",totalitems);
`^
CMN;Permitting!Building!Industrial!New Plumbing;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL INFORMATION.Total New or Additional Area'] != null) {
	if(feeExists("INDPLMIN") == false) updateFee("INDPLMIN","BLDNIP","FINAL",1,"N");
	} else {
	if(feeExists("INDPLMIN") == true) removeFee("INDPLMIN","FINAL");
	}

if (AInfo['ADD REMOD PLM PLAN REVIEW.Bldg Storm Drainage (Sum Storm Swr dia)'] != null) {
	if(feeExists("PRBSD") == false) updateFee("PRBSD","BLDNIP","FINAL",1,"N");
	} else {
	if(feeExists("PRBSD") == true) removeFee("PRBSD","FINAL");
	}

if (AInfo['NEW CONST PLM PLAN REVIEW.Bldg. Storm Drainage (Sum Storm Swr Dia.)'] != null) {
	if(feeExists("PRBSD") == false) updateFee("PRBSD","BLDNIP","FINAL",1,"N");
	} else {
	if(feeExists("PRBSD") == true) removeFee("PRBSD","FINAL");
	}

if (AInfo['NEW CONST PLM PLAN REVIEW.Car Wash Interceptor'] != null) {
	if(feeExists("PRCWI") == false) updateFee("PRCWI","BLDNIP","FINAL",1,"N");
	} else {
	if(feeExists("PRCWI") == true) removeFee("PRCWI","FINAL");
	}

if (AInfo['NEW CONST PLM PLAN REVIEW.Garage Catch Basin'] != null) {
	if(feeExists("PRGCB") == false) updateFee("PRGCB","BLDNIP","FINAL",1,"N");
	} else {
	if(feeExists("PRGCB") == true) removeFee("PRGCB","FINAL");
	}

if (AInfo['NEW CONST PLM PLAN REVIEW.Grease Interceptor'] != null) {
	if(feeExists("PRGI") == false) updateFee("PRGI","BLDNIP","FINAL",1,"N");
	} else {
	if(feeExists("PRGI") == true) removeFee("PRGI","FINAL");
	}

if (AInfo['ADD REMOD PLM PLAN REVIEW.Bldg. Water Dist. System'] != null) {
	if(feeExists("PRGPM") == false) updateFee("PRGPM","BLDNIP","FINAL",1,"N");
	} else {
	if(feeExists("PRGPM") == true) removeFee("PRGPM","FINAL");
	}

if (AInfo['NEW CONST PLM PLAN REVIEW.Oil Interceptor'] != null) {
	if(feeExists("PROI") == false) updateFee("PROI","BLDNIP","FINAL",1,"N");
	} else {
	if(feeExists("PROI") == true) removeFee("PROI","FINAL");
	}

if (AInfo['NEW CONST PLM PLAN REVIEW.Private Interceptor Mn. Swr. (Sum Lgst Dia.)'] != null) {
	if(feeExists("PRPIMS") == false) updateFee("PRPIMS","BLDNIP","FINAL",1,"N");
	} else {
	if(feeExists("PRPIMS") == true) removeFee("PRPIMS","FINAL");
	}

if (AInfo['NEW CONST PLM PLAN REVIEW.San. Bldg. Sewer Only (Dia. Inches)'] != null) {
	if(feeExists("PRSBSO") == false) updateFee("PRSBSO","BLDNIP","FINAL",1,"N");
	} else {
	if(feeExists("PRSBSO") == true) removeFee("PRSBSO","FINAL");
	}

if (AInfo['ADD REMOD PLM PLAN REVIEW.Sanitary Drain and Vent (Diameter)'] != null) {
	if(feeExists("PRSDV") == false) updateFee("PRSDV","BLDNIP","FINAL",1,"N");
	} else {
	if(feeExists("PRSDV") == true) removeFee("PRSDV","FINAL");
	}

if (AInfo['NEW CONST PLM PLAN REVIEW.Sanitary Drain and Vent (Dia. Inches)'] != null) {
	if(feeExists("PRSDV") == false) updateFee("PRSDV","BLDNIP","FINAL",1,"N");
	} else {
	if(feeExists("PRSDV") == true) removeFee("PRSDV","FINAL");
	}

if (AInfo['NEW CONST PLM PLAN REVIEW.Water Distribution Sys. (Dia. Inches)'] != null) {
	if(feeExists("PRWDS") == false) updateFee("PRWDS","BLDNIP","FINAL",1,"N");
	} else {
	if(feeExists("PRWDS") == true) removeFee("PRWDS","FINAL");
	}

if (AInfo['NEW CONST PLM PLAN REVIEW.Private Water Main (# of Wtr. Mn. Systems)'] != null) {
	if(feeExists("PRWM") == false) updateFee("PRWM","BLDNIP","FINAL",1,"N");
	} else {
	if(feeExists("PRWM") == true) removeFee("PRWM","FINAL");
	}

if (AInfo['NEW CONST PLM PLAN REVIEW.Water Service Only (Dia. Inches)'] != null) {
	if(feeExists("PRWSO") == false) updateFee("PRWSO","BLDNIP","FINAL",1,"N");
	} else {
	if(feeExists("PRWSO") == true) removeFee("PRWSO","FINAL");
	}

if (AInfo['ALTERATION INFORMATION.Total Number of Appliances and Fixtures'] != null) {
	if(feeExists("APPLFXTINST") == false) updateFee("APPLFXTINST","BLDNIP","FINAL",1,"N");
	} else {
	if(feeExists("APPLFXTINST") == true) removeFee("APPLFXTINST","FINAL");
	}

if (AInfo['ALTERATION INFORMATION.New Private Main'] != null) {
	if(feeExists("NEWPVTMAIN") == false) updateFee("NEWPVTMAIN","BLDNIP","FINAL",1,"N");
	} else {
	if(feeExists("NEWPVTMAIN") == true) removeFee("NEWPVTMAIN","FINAL");
	}

if (AInfo['ALTERATION INFORMATION.Total Linear Feet of Drain'] != null) {
	if(feeExists("SWRSANSTRYBP") == false) updateFee("SWRSANSTRYBP","BLDNIP","FINAL",1,"N");
	} else {
	if(feeExists("SWRSANSTRYBP") == true) removeFee("SWRSANSTRYBP","FINAL");
	}

if (AInfo['ALTERATION INFORMATION.Water Main - private or services'] != null) {
	if(feeExists("WATERMAIN") == false) updateFee("WATERMAIN","BLDNIP","FINAL",1,"N");
	} else {
	if(feeExists("WATERMAIN") == true) removeFee("WATERMAIN","FINAL");
	}
`^
CMN;Permitting!Building!Industrial!Raze;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL INFORMATION.Total Volume of Building'] != null) {
	if(feeExists("BLDCIRAZ") == false) updateFee("BLDCIRAZ","BLDCOMRAZE","FINAL",1,"N");
	} else {
	if(feeExists("BLDCIRAZ") == true) removeFee("BLDCIRAZ","FINAL");
	}
`^
CMN;Permitting!Building!Moving!~;CompletionNotification^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
emailSubject = "Building Move Completed - " + capId;
include("CMN;GetAPOAddress");
emailBody = "The following building move was recorded as completed. <br>";
emailBody += "Please open a follow-up Code Enforcement case for this building at its new location.<br><br>";
emailBody += "Application number; " + capId + "<br>";
emailBody += "Original location; " + APOAddress + "<br>";
emailBody += "New location; " + AInfo['Proposed Location – Street Address (Enter Street Address)'] + "<br>";
emailBody += "Moving Date; " + AInfo['Moving Date'] + "<br>";
emailBody += "Recorded Completed on; " + wfDateMMDDYYYY + "<br>";
email("ptoleary@chorus.net","noreply@cityofmadisonDEV.com",emailSubject,emailBody );
`^
CMN;Permitting!Building!Moving!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['BUILDING INFORMATION.Total Cu. Ft. of Building'] != null) {
	if(feeExists("MOVEPMT") == false) updateFee("MOVEPMT","BLDMOVE","FINAL",1,"N");
	} else {
	if(feeExists("MOVEPMT") == true) removeFee("MOVEPMT","FINAL");
	}
`^
CMN;Permitting!Building!RepairReplace!Construction;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL INFORMATION.Solar Panel or Collector Repair'] != null) {
	if(feeExists("SOLPNLCOLIN") == false) updateFee("SOLPNLCOLIN","BLDREPAIR","FINAL",1,"Y","N");
	} else {
	if(feeExists("SOLPNLCOLIN") == true) removeFee("SOLPNLCOLIN","FINAL");
	}

if (AInfo['ADDITIONAL BUILDING AREA.Total New or Additional Commercial Area'] != null) {
	if(feeExists("COMCONIN") == false) updateFee("COMCONIN","BLDNCC","FINAL",1,"Y","N");
	} else {
	if(feeExists("COMCONIN") == true) removeFee("COMCONIN","FINAL");
	}

if (AInfo['OCCUPANCY TYPE.First Certificate of Occupancy Requested - Enter 1'] != null) {
	if(feeExists("COO1") == false) updateFee("COO1","BLDNCC","FINAL",1,"Y","N");
	} else {
	if(feeExists("COO1") == true) removeFee("COO1","FINAL");
	}

if (AInfo['OCCUPANCY TYPE.Additional Certificates of Occupancy Requested'] != null) {
	if(feeExists("COO2") == false) updateFee("COO2","BLDNCC","FINAL",1,"Y","N");
	} else {
	if(feeExists("COO2") == true) removeFee("COO2","FINAL");
	}

updateFee("ALTERATION","BLDREPAIR","FINAL",parseInt(AInfo['GENERAL INFORMATION.Total Job Value']),"Y","N");
`^
CMN;Permitting!Building!RepairReplace!Construction;FeeACA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var addfee = true;
addparcel = parcelExistsOnCap(capId) == false;
if (addparcel) {
	include("CMN;AddParcelAndOwner");
	}

if (addparcel) {
	include("CMN;LOCALHISTDISTRICT");
	}

if (addparcel) {
	include("CMN;LOCALLANDMARK");
	}

if (addparcel) {
	include("CMN;LOCALURBANDESIGN");
	}

if (addparcel && appHasCondition("URBAN DESIGN DISTRICT","APPLIED","UrbanDesignDist",null)) {
	addfee = false;
	}

if (addparcel && appHasCondition("LOCAL HISTORIC DISTRICT","APPLIED","LocalHistDist",null)) {
	addfee = false;
	}

if (addparcel && appHasCondition("ADJACENT TO LANDMARK","APPLIED","Adjacent to Landmark",null)) {
	addfee = false;
	}

if (addparcel && appHasCondition("LANDMARK SITE","APPLIED","Landmark Site",null)) {
	addfee = false;
	}

if (addparcel && addfee && AInfo['GENERAL INFORMATION.Solar Panel or Collector Repair'] != null) {
	if(feeExists("SOLPNLCOLIN") == false) updateFee("SOLPNLCOLIN","BLDREPAIR","FINAL",1,"Y");
	} else {
	if(feeExists("SOLPNLCOLIN") == true) removeFee("SOLPNLCOLIN","FINAL");
	&& AInfo['ADDITIONAL BUILDING AREA.Total New or Additional Commercial Area'] != null;
	}

if (addparcel && addfee && AInfo['ADDITIONAL BUILDING AREA.Total New or Additional Commercial Area'] != null) {
	if(feeExists("COMCONIN") == false) updateFee("COMCONIN","BLDNCC","FINAL",1,"Y");
	} else {
	if(feeExists("COMCONIN") == true) removeFee("COMCONIN","FINAL");
	}

if (addparcel && addfee && AInfo['OCCUPANCY TYPE.First Certificate of Occupancy Requested - Enter 1'] != null) {
	if(feeExists("COO1") == false) updateFee("COO1","BLDNCC","FINAL",1,"Y");
	} else {
	if(feeExists("COO1") == true) removeFee("COO1","FINAL");
	}

if (addparcel && addfee && AInfo['OCCUPANCY TYPE.Additional Certificates of Occupancy Requested'] != null) {
	if(feeExists("COO2") == false) updateFee("COO2","BLDNCC","FINAL",1,"Y");
	} else {
	if(feeExists("COO2") == true) removeFee("COO2","FINAL");
	}

if (addparcel && addfee) {
	updateFee("ALTERATION","BLDREPAIR","FINAL",parseInt(AInfo['GENERAL INFORMATION.Total Job Value']),"Y");
	}

if (addparcel && addfee == false) {
	dpcheck = 1;
	editAppSpecific("OFFICIAL USE ONLY.DPCheck", dpcheck);
	include("EML;Permitting!Building!RepairReplace!Construction;FeeACA");
	}
`^
CMN;Permitting!Building!RepairReplace!Construction;FeeACAReadyToPay^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var addfee = true;
feeExistsAlteration = false;
if (isTaskActive("Zoning Review") || isTaskActive("Plan Review") || isTaskActive("Local Historic Review") || isTaskActive("Urban Design Review") || isTaskActive("Landmark Review")) {
	addfee = false;
	}

if (addfee && AInfo['GENERAL INFORMATION.Solar Panel or Collector Repair'] != null) {
	if(feeExists("SOLPNLCOLIN") == false) updateFee("SOLPNLCOLIN","BLDREPAIR","FINAL",1,"Y");
	} else {
	if(feeExists("SOLPNLCOLIN") == true) removeFee("SOLPNLCOLIN","FINAL");
	}

if (addfee && AInfo['ADDITIONAL BUILDING AREA.Total New or Additional Commercial Area'] != null) {
	if(feeExists("COMCONIN") == false) updateFee("COMCONIN","BLDNCC","FINAL",1,"Y");
	} else {
	if(feeExists("COMCONIN") == true) removeFee("COMCONIN","FINAL");
	}

if (addfee && AInfo['OCCUPANCY TYPE.First Certificate of Occupancy Requested - Enter 1'] != null) {
	if(feeExists("COO1") == false) updateFee("COO1","BLDNCC","FINAL",1,"Y");
	} else {
	if(feeExists("COO1") == true) removeFee("COO1","FINAL");
	}

if (addfee && AInfo['OCCUPANCY TYPE.Additional Certificates of Occupancy Requested'] != null) {
	if(feeExists("COO2") == false) updateFee("COO2","BLDNCC","FINAL",1,"Y");
	} else {
	if(feeExists("COO2") == true) removeFee("COO2","FINAL");
	}

if (feeExists("ALTERATION", "NEW", "INVOICED")) {
	feeExistsAlteration = true;
	}

if (addfee && feeExistsAlteration == false) {
	updateFee("ALTERATION","BLDREPAIR","FINAL",parseInt(AInfo['GENERAL INFORMATION.Total Job Value']),"Y");
	}

if (addfee) {
	include("EML;Permitting!Building!RepairReplace!Construction;FeeACAReadyToPay");
	}

if (addfee) {
	updateAppStatus("Pending Payment", "Pending Payment");
	}
`^
CMN;Permitting!Building!RepairReplace!Construction;UpdateCAPDetail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var workDes = workDescGet(capId);
if (workDes.length() > 70) {
	workDes = workDes.substr(0,69);
	}

if (workDes != null) {
	updateShortNotes(workDes);
	}
`^
CMN;Permitting!Building!RepairReplace!Electrical;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL INFORMATION.Special Events Temporary Wiring'] == "Yes") {
	updateFee("SETMPWIRE","BLDELE","FINAL",1,"N","N");
	} else {
	removeFee("SETMPWIRE","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Number of Openings Added or Moved'] > 0) {
	updateFee("NUMOPENADD","BLDELE","FINAL",1,"N","N");
	} else {
	removeFee("NUMOPENADD","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Number of Service Entrances'] > 0) {
	updateFee("SRVENTR","BLDELE","FINAL",1,"N","N");
	} else {
	removeFee("SRVENTR","FINAL");
	}
`^
CMN;Permitting!Building!RepairReplace!Electrical;FeeEstimate^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (getAppSpecific("GENERAL INFORMATION.Special Events Temporary Wiring") == "Yes") {
	updateFee("SETMPWIRE","BLDELE","FINAL",1,"N");
	} else {
	removeFee("SETMPWIRE","FINAL");
	}

if (getAppSpecific("GENERAL INFORMATION.Number of Openings Added or Moved") > 0) {
	updateFee("NUMOPENADD","BLDELE","FINAL",1,"N");
	} else {
	removeFee("NUMOPENADD","FINAL");
	}

if (getAppSpecific("GENERAL INFORMATION.Number of Service Entrances") > 0) {
	updateFee("SRVENTR","BLDELE","FINAL",1,"N");
	} else {
	removeFee("SRVENTR","FINAL");
	}
`^
CMN;Permitting!Building!RepairReplace!Electrical;UpdateCAPDetail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var workDes = workDescGet(capId);
if (workDes.length() > 70) {
	workDes = workDes.substr(0,69);
	}

if (workDes != null) {
	updateShortNotes(workDes);
	}
`^
cmn;Permitting!Building!RepairReplace!HVAC;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL INFORMATION.Add On Air Conditioning (Residential Only)'] != null) {
	if(feeExists("HVACADDON") == false) updateFee("HVACADDON","BLDHVAC","FINAL",1,"N","N");
	} else {
	if(feeExists("HVACADDON") == true) removeFee("HVACADDON","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Est. Cost of Alterations to Existing System (dollar amt)'] != null) {
	if(feeExists("ALTEXVNTSYS") == false) updateFee("ALTEXVNTSYS","BLDHVAC","FINAL",parseInt(AInfo['GENERAL INFORMATION.Est. Cost of Alterations to Existing System (dollar amt)']),"N", "N");
	} else {
	if(feeExists("ALTEXVNTSYS") == true) removeFee("ALTEXVNTSYS","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Replace Oil Tank'] != null) {
	if(feeExists("OILTANK") == false) updateFee("OILTANK","BLDHVAC","FINAL",1,"N", "N");
	} else {
	if(feeExists("OILTANK") == true) removeFee("OILTANK","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Replace Oil or Wood Burning Stoves'] != null) {
	if(feeExists("OILWDBRNSTV") == false) updateFee("OILWDBRNSTV","BLDHVAC","FINAL",1,"N", "N");
	} else {
	if(feeExists("OILWDBRNSTV") == true) removeFee("OILWDBRNSTV","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Repair Chimney installed with wood burning equipment'] != null) {
	if(feeExists("WDBRNCHIM") == false) updateFee("WDBRNCHIM","BLDHVAC","FINAL",1,"N", "N");
	} else {
	if(feeExists("WDBRNCHIM") == true) removeFee("WDBRNCHIM","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Chimney Installed Separately'] != null) {
	if(feeExists("CHIMNEY") == false) updateFee("CHIMNEY","BLDHVAC","FINAL",1,"N", "N");
	} else {
	if(feeExists("CHIMNEY") == true) removeFee("CHIMNEY","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Repair Solar Collectors'] != null) {
	if(feeExists("SOLCOLL") == false) updateFee("SOLCOLL","BLDHVAC","FINAL",1,"N", "N");
	} else {
	if(feeExists("SOLCOLL") == true) removeFee("SOLCOLL","FINAL");
	}

if (AInfo['GENERAL INFORMATION.BTU Loss (Enter Value)'] != null) {
	if(feeExists("HVACHTLSCAL") == false) updateFee("HVACHTLSCAL","BLDHVAC","FINAL",1,"N", "N");
	} else {
	if(feeExists("HVACHTLSCAL") == true) removeFee("HVACHTLSCAL","FINAL");
	}

if (AInfo['ALTERATION BTU LOSS.60,000'] == "CHECKED") {
	if(feeExists("6K") == false) updateFee("6K","BLDNIH","FINAL",1,"N", "N");
	} else {
	if(feeExists("6K") == true) removeFee("6K","FINAL");
	}

if (AInfo['ALTERATION BTU LOSS.165,000'] == "CHECKED") {
	if(feeExists("165K") == false) updateFee("165K","BLDNIH","FINAL",1,"N", "N");
	} else {
	if(feeExists("165K") == true) removeFee("165K","FINAL");
	}

if (AInfo['ALTERATION BTU LOSS.300,000'] == "CHECKED") {
	if(feeExists("300K") == false) updateFee("300K","BLDNIH","FINAL",1,"N", "N");
	} else {
	if(feeExists("300K") == true) removeFee("300K","FINAL");
	}

if (AInfo['ALTERATION BTU LOSS.500,000'] == "CHECKED") {
	if(feeExists("500K") == false) updateFee("500K","BLDNIH","FINAL",1,"N", "N");
	} else {
	if(feeExists("500K") == true) removeFee("500K","FINAL");
	}

if (AInfo['ALTERATION BTU LOSS.3,000,000'] == "CHECKED") {
	if(feeExists("3M") == false) updateFee("3M","BLDNIH","FINAL",1,"N", "N");
	} else {
	if(feeExists("3M") == true) removeFee("3M","FINAL");
	}

if (AInfo['ALTERATION BTU LOSS.4,000,000'] == "CHECKED") {
	if(feeExists("4M") == false) updateFee("4M","BLDNIH","FINAL",1,"N", "N");
	} else {
	if(feeExists("4M") == true) removeFee("4M","FINAL");
	}

if (AInfo['ALTERATION BTU LOSS.5,000,000'] == "CHECKED") {
	if(feeExists("5M") == false) updateFee("5M","BLDNIH","FINAL",1,"N", "N");
	} else {
	if(feeExists("5M") == true) removeFee("5M","FINAL");
	}

if (AInfo['ALTERATION BTU LOSS.6,000,000'] == "CHECKED") {
	if(feeExists("6M") == false) updateFee("6M","BLDNIH","FINAL",1,"N", "N");
	} else {
	if(feeExists("6M") == true) removeFee("6M","FINAL");
	}
`^
CMN;Permitting!Building!RepairReplace!HVAC;UpdateCAPDetail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
var workDes = workDescGet(capId);
if (workDes.length() > 70) {
	workDes = workDes.substr(0,69);
	}

if (workDes != null) {
	updateShortNotes(workDes);
	}
`^
CMN;Permitting!Building!RepairReplace!Plumbing;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var fixturesTot=0;
if (typeof(PLUMBINGFIXTURES) == "object") {
	for (eachrow in PLUMBINGFIXTURES) fixturesTot = fixturesTot  + parseInt(PLUMBINGFIXTURES[eachrow]["Quantity"]);
	}

if (fixturesTot > 0) {
	updateFee("APPLFXTINST","BLDPLM","FINAL",fixturesTot,"N","N");
	} else {
	removeFee("APPLFXTINST","FINAL");
	}

if (AInfo['GENERAL INFORMATION.New Private Main'] > 0) {
	updateFee("NEWPVTMAIN","BLDPLM","FINAL",1,"N","N");
	} else {
	removeFee("NEWPVTMAIN","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Total Linear Feet of Drain'] > 0) {
	updateFee("SWRSANSTRYBP","BLDPLM","FINAL",1,"N","N");
	} else {
	removeFee("SWRSANSTRYBP","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Water Main - private or services'] != null) {
	if(feeExists("WATERMAIN") == false) updateFee("WATERMAIN","BLDPLM","FINAL",parseInt(AInfo['GENERAL INFORMATION.Water Main - private or services']),"Y");
	}

if (fixturesTot >= 0) {
	editAppSpecific("GENERAL INFORMATION.Total Number of Appliances and Fixtures", fixturesTot);
	}
`^
CMN;Permitting!Building!RepairReplace!Plumbing;FeeEstimate^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var fixturesTot=0;
if (typeof(PLUMBINGFIXTURES) == "object") {
	for (eachrow in PLUMBINGFIXTURES) fixturesTot = fixturesTot  + parseInt(PLUMBINGFIXTURES[eachrow]["Quantity"]);
	}

if (fixturesTot > 0) {
	updateFee("APPLFXTINST","BLDPLM","FINAL",fixturesTot,"N");
	} else {
	removeFee("APPLFXTINST","FINAL");
	}

if (getAppSpecific("GENERAL INFORMATION.New Private Main") > 0) {
	updateFee("NEWPVTMAIN","BLDPLM","FINAL",1,"N");
	} else {
	removeFee("NEWPVTMAIN","FINAL");
	}

if (getAppSpecific("GENERAL INFORMATION.Total Linear Feet of Drain") > 0) {
	updateFee("SWRSANSTRYBP","BLDPLM","FINAL",1,"N");
	} else {
	removeFee("SWRSANSTRYBP","FINAL");
	}

if (getAppSpecific("GENERAL INFORMATION.Water Main - private or services") > 0) {
	updateFee("WATERMAIN","BLDPLM","FINAL",1,"N");
	} else {
	removeFee("WATERMAIN","FINAL");
	}

if (fixturesTot >= 0) {
	editAppSpecific("GENERAL INFORMATION.Total Number of Appliances and Fixtures", fixturesTot);
	}
`^
CMN;Permitting!Building!RepairReplace!Plumbing;UpdateCAPDetail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
var workDes = workDescGet(capId);
if (workDes.length() > 70) {
	workDes = workDes.substr(0,69);
	}

if (workDes != null) {
	updateShortNotes(workDes);
	}
`^
CMN;Permitting!Building!Residential!Construction;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['AUXILIARY BUILDINGS.Awnings (Enter Qty)'] != null) {
	if(feeExists("AWNINSP") == false) updateFee("AWNINSP","BLDNRC","FINAL",1,"N");
	} else {
	if(feeExists("AWNINSP") == true) removeFee("AWNINSP","FINAL");
	}

if (AInfo['PLAN REVIEW.Single Family Residence (Enter 1)'] != null) {
	if(feeExists("BLDR1PLRVW") == false) updateFee("BLDR1PLRVW","BLDNRC","FINAL",1,"N");
	} else {
	if(feeExists("BLDR1PLRVW") == true) removeFee("BLDR1PLRVW","FINAL");
	}

if (AInfo['PLAN REVIEW.Two Family Residence (Enter 1)'] != null) {
	if(feeExists("BLDR2PLRVW") == false) updateFee("BLDR2PLRVW","BLDNRC","FINAL",1,"N");
	} else {
	if(feeExists("BLDR2PLRVW") == true) removeFee("BLDR2PLRVW","FINAL");
	}

if (AInfo['GENERAL INFORMATION.First Cert. of Occupancy (Enter 1)'] != null) {
	if(feeExists("COO1") == false) updateFee("COO1","BLDNRC","FINAL",1,"N");
	} else {
	if(feeExists("COO1") == true) removeFee("COO1","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Addl. Cert. of Occupancy Requested'] != null) {
	if(feeExists("COO2") == false) updateFee("COO2","BLDNRC","FINAL",1,"N");
	} else {
	if(feeExists("COO2") == true) removeFee("COO2","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Mobile Home'] != null) {
	if(feeExists("MFGHM") == false) updateFee("MFGHM","BLDNRC","FINAL",1,"N");
	} else {
	if(feeExists("MFGHM") == true) removeFee("MFGHM","FINAL");
	}

if (AInfo['PLAN REVIEW.Rev. to Prev. Reviewed Plans (Enter 1)'] != null) {
	if(feeExists("PLNRIVISION") == false) updateFee("PLNRIVISION","BLDNRC","FINAL",1,"N");
	} else {
	if(feeExists("PLNRIVISION") == true) removeFee("PLNRIVISION","FINAL");
	}

if (AInfo['NEW BUILDING AREA.Total New or Additional Area (incl. porches and decks)'] != null) {
	if(feeExists("RESCONIN") == false) updateFee("RESCONIN","BLDNRC","FINAL",1,"N");
	} else {
	if(feeExists("RESCONIN") == true) removeFee("RESCONIN","FINAL");
	}

if (AInfo['AUXILIARY BUILDINGS.In-Ground Pool (Enter Qty)'] != null) {
	if(feeExists("RESPOOLIN") == false) updateFee("RESPOOLIN","BLDNRC","FINAL",1,"N");
	} else {
	if(feeExists("RESPOOLIN") == true) removeFee("RESPOOLIN","FINAL");
	}

if (AInfo['AUXILIARY BUILDINGS.Detached Garage Area'] != null) {
	if(feeExists("RESUTILGARIN") == false) updateFee("RESUTILGARIN","BLDNRC","FINAL",1,"N");
	}

if (AInfo['AUXILIARY BUILDINGS.Storage Buildings'] != null) {
	if(feeExists("RESUTILGARIN") == false) updateFee("RESUTILGARIN","BLDNRC","FINAL",1,"N");
	}

if (AInfo['GENERAL INFORMATION.Solar Panel or Collector'] != null) {
	if(feeExists("SOLPNLCOLIN") == false) updateFee("SOLPNLCOLIN","BLDNRC","FINAL",1,"N");
	} else {
	if(feeExists("SOLPNLCOLIN") == true) removeFee("SOLPNLCOLIN","FINAL");
	}

if (AInfo['GENERAL INFORMATION.CoO for Zoning Chg. of Use or Occupancy (Enter Qty)'] != null) {
	if(feeExists("ZNCOO") == false) updateFee("ZNCOO","BLDNRC","FINAL",1,"N");
	} else {
	if(feeExists("ZNCOO") == true) removeFee("ZNCOO","FINAL");
	}

if (AInfo['LOT SIZE INFORMATION.Lot Area'] != null) {
	updateFee("ER","BLDNRC","FINAL",Math.ceil(AInfo['LOT SIZE INFORMATION.Lot Area'] ! 1000),"N");
	} else {
	if(feeExists("ER") == true) removeFee("ER","FINAL");
	}

if (AInfo['NEW BUILDING AREA.Total New or Additional Area (incl. porches and decks)'] != null) {
	if(feeExists("ZONAPP") == false) updateFee("ZONAPP","BLDNRC","FINAL",1,"N");
	} else {
	if(feeExists("ZONAPP") == true) removeFee("ZONAPP","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Project Type'] == "New Building" && AInfo['OCCUPANCY TYPE.Residential'] == "CHECKED") {
	if(feeExists("SEWCON") == false) updateFee("SEWCON","BLDNRC","FINAL",1,"N");
	} else {
	if(feeExists("SEWCON") == true) removeFee("SEWCON","FINAL");
	}

if (AInfo['GENERAL INFORMATION.State Seal Number'] != null) {
	if(feeExists("STSEAL") == false) updateFee("STSEAL","BLDNRC","FINAL",1,"N");
	} else {
	if(feeExists("STSEAL") == true) removeFee("STSEAL","FINAL");
	}

if (AInfo['PLAN REVIEW.Plan Review Project Type'] == "Alteration or Remodeling") {
	if(feeExists("RARPLANREV") == false) updateFee("RARPLANREV","BLDNRC","FINAL",1,"N");
	} else {
	if(feeExists("RARPLANREV") == true) removeFee("RARPLANREV","FINAL");
	}
`^
CMN;Permitting!Building!Residential!Construction;FeeACA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var dpcheck = parseInt(getAppSpecific("OFFICIAL USE ONLY.DPCheck"));
addparcel = parcelExistsOnCap(capId) == false;
if (addparcel) {
	include("CMN;AddParcelAndOwner");
	}

if (dpcheck != 1) {
	include("CMN;LOCALHISTDISTRICT");
	include("CMN;LOCALURBANDESIGN");
	dpcheck = 1;
	editAppSpecific("OFFICIAL USE ONLY.DPCheck", dpcheck);
	include("EML;Permitting!Building!Residential!Construction;FeeACA");
	difficultyfactor = 3;
	editAppSpecific("OFFICIAL USE ONLY.Difficulty Factor", difficultyfactor);
	}
`^
CMN;Permitting!Building!Residential!Construction;FeeACAReadyToPay^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var addfee = true;
if (isTaskActive("Zoning Review") || isTaskActive("Plan Review") || isTaskActive("Local Historic Review") || isTaskActive("Urban Design Review") || isTaskActive("Landmark Review")) {
	addfee = false;
	}

if (addfee && AInfo['GENERAL INFORMATION.Solar Panel or Collector'] != null) {
	if(feeExists("SOLPNLCOLIN", "NEW", "INVOICED") == false) updateFee("SOLPNLCOLIN","BLDNRC","FINAL",1,"Y");
	if(feeExists("ZONAPP", "NEW", "INVOICED") == false) updateFee("ZONAPP","BLDNRC","FINAL",1,"Y");
	} else {
	if(feeExists("SOLPNLCOLIN", "NEW", "INVOICED") == true) removeFee("SOLPNLCOLIN","FINAL");
	if(feeExists("ZONAPP", "NEW", "INVOICED") == true) removeFee("ZONAPP","FINAL");
	}

if (addfee) {
	include("EML;Permitting!Building!Residential!Construction;FeeACAReadyToPay");
	}

if (addfee) {
	updateAppStatus("Pending Payment", "Pending Payment");
	}
`^
CMN;Permitting!Building!Residential!New Electrical;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL INFORMATION.Total New or Additional Area'] != null) {
	if(feeExists("RESELEIN") == false) updateFee("RESELEIN","BLDRNE","FINAL",1,"N");
	} else {
	if(feeExists("RESELEIN") == true) removeFee("RESELEIN","FINAL");
	}
`^
CMN;Permitting!Building!Residential!New HVAC;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['HVAC AREA.Total HVAC Area'] != null) {
	if(feeExists("RESHVACIN") == false) updateFee("RESHVACIN","BLDNRH","FINAL",1,"N");
	} else {
	if(feeExists("RESHVACIN") == true) removeFee("RESHVACIN","FINAL");
	}
`^
CMN;Permitting!Building!Residential!New Plumbing;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL INFORMATION.Total New or Additional Area'] != null) {
	if(feeExists("RESPLMIN") == false) updateFee("RESPLMIN","BLDNRP","FINAL",1,"N");
	} else {
	if(feeExists("RESPLMIN") == true) removeFee("RESPLMIN","FINAL");
	}
`^
CMN;Permitting!Building!Residential!Raze;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL INFORMATION.Residential Acc. Bld. or Detached Gar. (Enter 1)'] != null) {
	if(feeExists("RESACCRAZ") == false) updateFee("RESACCRAZ","BLDRESRAZE","FINAL",1,"N");
	} else {
	if(feeExists("RESACCRAZ") == true) removeFee("RESACCRAZ","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Two Family Residence (Enter 1)'] != null) {
	if(feeExists("RES2FRAZ") == false) updateFee("RES2FRAZ","BLDRESRAZE","FINAL",1,"N");
	} else {
	if(feeExists("RES2FRAZ") == true) removeFee("RES2FRAZ","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Single Family Residence (Enter 1)'] != null) {
	if(feeExists("RESR1FRAZ") == false) updateFee("RESR1FRAZ","BLDRESRAZE","FINAL",1,"N");
	} else {
	if(feeExists("RESR1FRAZ") == true) removeFee("RESR1FRAZ","FINAL");
	}
`^
CMN;Permitting!Building!Variance!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL_INFORMATION.Commercial Application - Enter 1'] != null) {
	if(feeExists("COMVAR") == false) updateFee("COMVAR","BLDVARI","FINAL",1,"N");
	} else {
	if(feeExists("COMVAR") == true) removeFee("COMVAR","FINAL");
	}

if (AInfo['GENERAL_INFORMATION.1 and 2 Family Residential Application - Enter 1'] != null) {
	if(feeExists("RESVAR") == false) updateFee("RESVAR","BLDVARI","FINAL",1,"N");
	} else {
	if(feeExists("RESVAR") == true) removeFee("RESVAR","FINAL");
	}
`^
CMN;Permitting!Clerk!~!~;PermitIssueActions^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (feesInvoicedTotal >= 0 && balanceDue <= 0 && isTaskComplete("Intake") && isTaskComplete("Police Review")) {
	bPermitIssue = true;
	} else {
	bPermitIssue = false;
	}

if (bPermitIssue) {
	include("EML;GetContactEmail");
	}

if (bPermitIssue && (contactEmail == null || contactEmail == "")) {
	aa.set.add("CL LIC DAILY",capId);
	}

if (bPermitIssue && contactEmail != null && contactEmail != "") {
	include("EML;Permitting!Clerk!~!~;PermitIssued");
	}

if (bPermitIssue & isTaskActive("Issuance")) {
	closeTask("Issuance","Issued","Task closed by script","");
	}
`^
CMN;Permitting!Clerk!Close Out Sale!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL INFORMATION.Inventory value to be presented for sale in 1000 dollar increments'] != null) {
	if(feeExists("INV") == false) updateFee("INV","PERCOS","FINAL",1,"N");
	} else {
	if(feeExists("INV") == true) removeFee("INV","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Total number of days during sale period'] != null) {
	if(feeExists("LICFEE") == false) updateFee("LICFEE","PERCOS","FINAL",1,"N");
	} else {
	if(feeExists("LICFEE") == true) removeFee("LICFEE","FINAL");
	}
`^
CMN;Permitting!Clerk!Picnic Beer!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL INFORMATION.Number of Days Event to be Held'] != null) {
	if(feeExists("LICFEE") == false) updateFee("LICFEE","PERPB","FINAL",1,"N");
	} else {
	if(feeExists("LICFEE") == true) removeFee("LICFEE","FINAL");
	}
`^
CMN;Permitting!Clerk!Picnic Beer!NA;NoStreetProcess^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if ((isTaskStatus("City Attorney Review","Denied") || isTaskStatus("Risk Manager Review","Denied") || isTaskStatus("Parks Review","Denied") || isTaskStatus("Zoning Review","Denied") || isTaskStatus("Police Review","Denied"))) {
	branchTask("Reviews - No Street Use","Denied","","","PERCLKBER");
	} else {
	closeTask("Reviews - No Street Use","Granted","","","PERCLKBER");
	aa.set.add("CL LIC DAILY",capId);
	closeTask("Permit Issuance","Issued","Updated by Reviews completed","Note");
	}
`^
CMN;Permitting!Clerk!Picnic Beer!NA;StreetProcess^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (allTasksComplete(wfProcess,"ALRC Hearing","Common Council Hearing","Process Complete") && (isTaskStatus("Alcohol Policy Coordinator Review","Denied") || isTaskStatus("Fire Inspection","Denied") || isTaskStatus("Health Review","Denied") || isTaskStatus("Zoning Review","Denied") || isTaskStatus("Police Review","Denied"))) {
	deactivateTask("ALRC Hearing");
	closeTask("Process Complete","Denied");
	branchTask("Street Use Process","Denied","","","PERCLKBER");
	}

if ((wfTask == "ALRC Hearing" || wfTask == "Common Council Hearing") && wfStatus == "Denied") {
	closeTask("Process Complete","Denied");
	branchTask("Street Use Process","Denied","","","PERCLKBER");
	}

if (wfTask == "Common Council Hearing" && wfStatus == "Granted") {
	closeTask("Process Complete","Granted");
	closeTask("Street Use Process","Granted","","","PERCLKBER");
	aa.set.add("CL LIC DAILY",capId);
	closeTask("Permit Issuance","Issued","Updated by Reviews completed","Note");
	}
`^
CMN;Permitting!Clerk!Solicitor!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['LENGTH OF PERMIT.Or, Solicitor Permit Required – Enter 1'] != null) {
	if(feeExists("SOL") == false) updateFee("SOL","PERSOL","FINAL",1,"N");
	} else {
	if(feeExists("SOL") == true) removeFee("SOL","FINAL");
	}

if (AInfo['LENGTH OF PERMIT.Trucker or Peddler Annual Permit Requested – Enter 1'] != null) {
	if(feeExists("TRPEDA") == false) updateFee("TRPEDA","PERSOL","FINAL",1,"N");
	} else {
	if(feeExists("TRPEDA") == true) removeFee("TRPEDA","FINAL");
	}

if (AInfo['LENGTH OF PERMIT.Or, Number of Days Trucker or Peddler Permit Needed'] != null) {
	if(feeExists("TRPEDD") == false) updateFee("TRPEDD","PERSOL","FINAL",1,"N");
	} else {
	if(feeExists("TRPEDD") == true) removeFee("TRPEDD","FINAL");
	}
`^
CMN;Permitting!Engineering!~!~;ValidateLP^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
isLicProf = false;
correctType = false;
licNumber = "";
isExpired = false;
capLPType = "none";
licExpired = false;
insExpired = false;
busExpired = false;
licType = "";
selectedType = "none";
homeOwner = getAppSpecific("ALTERNATIVE BUILDER.Work to be performed by property owner if no Licensed Professional chosen");
for (checkValue in lpArray) include("CMN;Permitting!Engineering!~!~;ValidateLPLoop");
if (homeOwner == "Yes") {
	cancel = false;
	}

if (homeOwner == "No" && !isLicProf && !correctType && selectedType == "none") {
	cancel = true;
	showMessage = true;
	comment("You must first associate your " + permitType + " contractor license information with your account before you can apply for this permit online. This is a one-time process and this must be approved by building inspection staff prior to submitting a permit online. If you are a homeowner doing this work on your own residence, then please select 'Yes' to the homeowner question on the previous screen in order to proceed.");
	}

if (homeOwner == "No" && selectedType == "notSame") {
	cancel = true;
	showMessage = true;
	comment("The license selected is not an approved " + permitType + " contractor license.  Please select PREQUALIFIED TER as License Type.");
	}
`^
CMN;Permitting!Engineering!~!~;ValidateLPLoop^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showMessage = false;
showDebug = false;
tLicNbr = null;
tLicType = null;
capLicProf = null;
capLPNumber = "noNumber";
puser = aa.publicUser.getPublicUserByEmail(aa.person.getCurrentUser().getOutput().getEmail()).getOutput();
userSeqNum = puser.getUserSeqNum();
licProfList = aa.licenseScript.getRefLicProfByOnlineUser(userSeqNum);
if (licProfList.getSuccess()) {
	licProf = licProfList.getOutput();
	}

if (licProf[0] != null) {
	isLicProf = true;
	} else {
	isLicProf = false;
	}

capLicProfList = cap.getLicenseProfessionalList();
if (capLicProfList != null) {
	capLicProf = capLicProfList.iterator().next();
	capLPNumber = capLicProf.getLicenseNbr();
	}

if (licProf[0] != null) {
	for (lp in licProf) include("CMN;Permitting!Engineering!~!~;LPLoop");
	}

if (capLicProf != null) {
	capLPType = capLicProf.getLicenseType();
	} else {
	selectedType = "none";
	}

licExpired = hasExpiredLicense("EXPIRE", licNumber);
insExpired = hasExpiredLicense("INSURANCE", licNumber);
busExpired = hasExpiredLicense("BUSINESS", licNumber);
if ((licExpired || insExpired || busExpired)) {
	isExpired = true;
	}

if (capLicProf != null && capLPType ==  lpArray[checkValue]) {
	selectedType = "same";
	} else {
	selectedType = "notSame";
	}
`^
CMN;Permitting!Engineering!~!NA;CalculateExpireDate^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
pipingDate = AInfo['OWNER!PLUMBER INFORMATION.Estimated Date Piping will be Completed'];
permitExpireDate = dateAdd(pipingDate, 60, "Y");
editAppSpecific("OWNER!PLUMBER INFORMATION.Permit Expire Date", permitExpireDate, capId);
licEditExpInfo("Active", permitExpireDate);
`^
CMN;Permitting!Engineering!~!NA;createWO^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
workDesc = "Sewer Meter Inspection " + woCategory;
childId = createChild("AMS","Engineering", "Sewer Meter Inspection", woCategory, workDesc);
rscapModel = cap.getCapModel();
cd = aa.cap.getCapDetail(childId).getOutput().getCapDetailModel();
aa.asset.cloneAssets(rscapModel, childId);
newWorkDesModel = aa.cap.capWorkDesModel.getOutput();
newWorkDesModel.setCapID(childId);
newWorkDesModel.setAuditDate(aa.util.now());
newWorkDesModel.setAuditStatus("A");
newWorkDesModel.setAuditID(currentUserID);
newWorkDesModel.setDescription(workDesc);
newWorkDes = aa.cap.createCapWorkDes(newWorkDesModel);
copyAddresses(capId, childId);
updateAppStatus("Open","",childId);
if (cd) {
	assignCap("ENSMW", childId);
	}
`^
CMN;Permitting!Engineering!Attach to Bridge!~;Issued^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfStatus == "Issued" && wfTask == "Issuance") {
	editTaskDueDate("Inspection",nextWorkDay(dateAdd(null,182)));
	}
`^
CMN;Permitting!Engineering!Erosion Control!100LfDitchSwaleChannel;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['TYPE OF PERMIT.Total Disturbed Area'] != null) {
	if(feeExists("100L", "NEW", "INVOICED") == false) updateFee("100L","ENGER100L","FINAL",1,"N");
	} else {
	if(feeExists("100L") == true) removeFee("100L","FINAL");
	}

if (AInfo['TYPE OF PERMIT.Renewal of Expired Permit (Enter 1)'] != null) {
	if(feeExists("100LR", "NEW", "INVOICED") == false) updateFee("100LR","ENGER100L","FINAL",1,"N");
	} else {
	if(feeExists("100LR") == true) removeFee("100LR","FINAL");
	}
`^
CMN;Permitting!Engineering!Erosion Control!125LfNewPubPrivRoadDrive;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['TYPE OF PERMIT.Total Disturbed Area'] != null) {
	if(feeExists("125L", "NEW", "INVOICED") == false) updateFee("125L","ENGER125L","FINAL",1,"N");
	} else {
	if(feeExists("125L") == true) removeFee("125L","FINAL");
	}

if (AInfo['TYPE OF PERMIT.Renewal of Expired Permit (Enter 1)'] != null) {
	if(feeExists("125LR", "NEW", "INVOICED") == false) updateFee("125LR","ENGER125L","FINAL",1,"N");
	} else {
	if(feeExists("125LR") == true) removeFee("125LR","FINAL");
	}
`^
CMN;Permitting!Engineering!Erosion Control!12PercentSlope;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['TYPE OF PERMIT.Total Disturbed Area'] != null) {
	if(feeExists("12P", "NEW", "INVOICED") == false) updateFee("12P","ENGER12P","FINAL",1,"N");
	} else {
	if(feeExists("12P") == true) removeFee("12P","FINAL");
	}

if (AInfo['TYPE OF PERMIT.Renewal of Expired Permit (Enter 1)'] != null) {
	if(feeExists("12PR", "NEW", "INVOICED") == false) updateFee("12PR","ENGER12P","FINAL",1,"N");
	} else {
	if(feeExists("12PR") == true) removeFee("12PR","FINAL");
	}
`^
CMN;Permitting!Engineering!Erosion Control!300LfUtilityInstall;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['TYPE OF PERMIT.Total Disturbed Area'] != null) {
	if(feeExists("300L", "NEW", "INVOICED") == false) updateFee("300L","ENGER300L","FINAL",1,"N");
	} else {
	if(feeExists("300L") == true) removeFee("300L","FINAL");
	}

if (AInfo['TYPE OF PERMIT.Renewal of Expired Permit (Enter 1)'] != null) {
	if(feeExists("300LR", "NEW", "INVOICED") == false) updateFee("300LR","ENGER300L","FINAL",1,"N");
	} else {
	if(feeExists("300LR") == true) removeFee("300LR","FINAL");
	}
`^
CMN;Permitting!Engineering!Erosion Control!4000 Disturbed;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['TYPE OF PERMIT.Total Disturbed Area'] != null) {
	if(feeExists("4KDA", "NEW", "INVOICED") == false) updateFee("4KDA","ENGER4KD","FINAL",1,"N");
	} else {
	if(feeExists("4KDA") == true) removeFee("4KDA","FINAL");
	}

if (AInfo['TYPE OF PERMIT.Renewal of Expired Permit (Enter 1)'] != null) {
	if(feeExists("4KDR", "NEW", "INVOICED") == false) updateFee("4KDR","ENGER4KD","FINAL",1,"N");
	} else {
	if(feeExists("4KDR") == true) removeFee("4KDR","FINAL");
	}
`^
CMN;Permitting!Engineering!Erosion Control!400CyCutFill;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['TYPE OF PERMIT.Total Disturbed Area'] != null) {
	if(feeExists("4CYA", "NEW", "INVOICED") == false) updateFee("4CYA","ENGER4CY","FINAL",1,"N");
	} else {
	if(feeExists("4CYA") == true) removeFee("4CYA","FINAL");
	}

if (AInfo['TYPE OF PERMIT.Renewal of Expired Permit (Enter 1)'] != null) {
	if(feeExists("4CYAR", "NEW", "INVOICED") == false) updateFee("4CYAR","ENGER4CY","FINAL",1,"N");
	} else {
	if(feeExists("4CYAR") == true) removeFee("4CYAR","FINAL");
	}
`^
CMN;Permitting!Engineering!Erosion Control!HighRiskPerAdminAuth;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['TYPE OF PERMIT.Total Disturbed Area'] != null) {
	if(feeExists("HRPAA", "NEW", "INVOICED") == false) updateFee("HRPAA","ENGERHRPAA","FINAL",1,"N");
	} else {
	if(feeExists("HRPAA") == true) removeFee("HRPAA","FINAL");
	}

if (AInfo['TYPE OF PERMIT.Renewal of Expired Permit (Enter 1)'] != null) {
	if(feeExists("HRPAAR", "NEW", "INVOICED") == false) updateFee("HRPAAR","ENGERHRPAA","FINAL",1,"N");
	} else {
	if(feeExists("HRPAAR") == true) removeFee("HRPAAR","FINAL");
	}
`^
CMN;Permitting!Engineering!Erosion Control!Inspection;BMPCheck^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (tblBMP[eachrow]["Condition"] == "Failure") {
	BMPConditionFail = true;
	}

if (tblBMP[eachrow]["Condition"] == "Maintenance Needed") {
	BMPConditionMaintenance = true;
	}
`^
CMN;Permitting!Engineering!Erosion Control!Inspection;BMPFail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
BMPConditionFail = false;
BMPConditionMaintenance = false;
tblBMP = loadASITable("BMP");
if (tblBMP) {
	for (eachrow in tblBMP) include("CMN;Permitting!Engineering!Erosion Control!Inspection;BMPCheck");
	}

if (BMPConditionFail && isTaskActive("Review")) {
	closeTask("Review","Failed","","");
	}

if (!BMPConditionFail && BMPConditionMaintenance && isTaskActive("Review")) {
	closeTask("Review","Maintenance Needed","","");
	}

if (!BMPConditionFail && !BMPConditionMaintenance && isTaskActive("Review")) {
	closeTask("Review","Passed","","");
	}

closeTask("Closed","Closed","","");
`^
CMN;Permitting!Engineering!Erosion Control!Inspection;Clone^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (publicUser == false) {
	parentCapId = aa.cap.getProjectParents(capId,1).getOutput()[0].getCapID();
	}

if (parentCapId) {
	copyAddresses(parentCapId,capId);
	}

if (publicUser == false && parentCapId) {
	copyASITables(parentCapId,capId);
	}
`^
CMN;Permitting!Engineering!Erosion Control!Inspection;UpdateParent^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var bIsWinterDormant = false;
tblErosionPermit = loadASITable("EROSION");
if (tblErosionPermit[0] != undefined) {
	erosionPermit = tblErosionPermit[0]["PermitNumber"];
	}

if (tblErosionPermit[0] != undefined && aa.cap.getCap(getApplication(erosionPermit)).getOutput().getCapStatus() == "Winter Dormant") {
	bIsWinterDormant = true;
	}

if (!bIsWinterDormant && BMPConditionFail && tblErosionPermit[0] != undefined) {
	updateTask("Inspection","Ongoing","","","ENGEROSION",getApplication(erosionPermit));
	updateAppStatus("Inspection Failed","",getApplication(erosionPermit));
	}

if (!bIsWinterDormant && !BMPConditionFail && BMPConditionMaintenance && tblErosionPermit[0] != undefined) {
	updateTask("Inspection","Ongoing","","","ENGEROSION",getApplication(erosionPermit));
	updateAppStatus("Maintenance Needed","",getApplication(erosionPermit));
	}

if (!bIsWinterDormant && !BMPConditionFail && !BMPConditionMaintenance && tblErosionPermit[0] != undefined) {
	updateTask("Inspection","Ongoing","","","ENGEROSION",getApplication(erosionPermit));
	updateAppStatus("Inspection Passed","",getApplication(erosionPermit));
	}

if (tblErosionPermit[0] != undefined && publicUser == false) {
	addParent(erosionPermit);
	}

if (currentUserID == "ITJBS") {
	showDebug = true;
	}
`^
CMN;Permitting!Engineering!Erosion Control!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['TYPE OF PERMIT.Permit Type'] == "Simplified Checklist" && AInfo['TYPE OF PERMIT.Renewal of Expired Permit'] == "No") {
	if(feeExists("100LA", "NEW", "INVOICED") == false) updateFee("100LA","ENGER100L","FINAL",1,"N");
	} else {
	if(feeExists("100LA") == true) removeFee("100LA","FINAL");
	}

if (AInfo['TYPE OF PERMIT.Permit Type'] == "Simplified Checklist" && AInfo['TYPE OF PERMIT.Renewal of Expired Permit'] == "Yes") {
	if(feeExists("100LR", "NEW", "INVOICED") == false) updateFee("100LR","ENGER100L","FINAL",1,"N");
	} else {
	if(feeExists("100LR") == true) removeFee("100LR","FINAL");
	}

if (AInfo['TYPE OF PERMIT.Permit Type'] == "Full Plan" && AInfo['TYPE OF PERMIT.Renewal of Expired Permit'] == "No") {
	if(feeExists("FULLPLAN", "NEW", "INVOICED") == false) updateFee("FULLPLAN","ENGER100L","FINAL",1,"N");
	} else {
	if(feeExists("FULLPLAN") == true) removeFee("FULLPLAN","FINAL");
	}

if (AInfo['TYPE OF PERMIT.Permit Type'] == "Full Plan" && AInfo['TYPE OF PERMIT.Renewal of Expired Permit'] == "Yes") {
	if(feeExists("FULLPLANR", "NEW", "INVOICED") == false) updateFee("FULLPLANR","ENGER100L","FINAL",1,"N");
	} else {
	if(feeExists("FULLPLANR") == true) removeFee("FULLPLANR","FINAL");
	}

if (AInfo['TYPE OF PERMIT.Permit Type'] == "Full Plan" && AInfo['TYPE OF PERMIT.Total Disturbed Area'] > 0) {
	if(feeExists("100L", "NEW", "INVOICED") == false) updateFee("100L","ENGER100L","FINAL",1,"N");
	} else {
	if(feeExists("100L") == true) removeFee("100L","FINAL");
	}
`^
CMN;Permitting!Engineering!Erosion Control!PublicSRHConstReconst;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['TYPE OF PERMIT.Total Disturbed Area'] != null) {
	if(feeExists("PSRH", "NEW", "INVOICED") == false) updateFee("PSRH","ENGERPSRH","FINAL",1,"N");
	} else {
	if(feeExists("PSRH") == true) removeFee("PSRH","FINAL");
	}

if (AInfo['TYPE OF PERMIT.Renewal of Expired Permit (Enter 1)'] != null) {
	if(feeExists("PSRHR", "NEW", "INVOICED") == false) updateFee("PSRHR","ENGERPSRH","FINAL",1,"N");
	} else {
	if(feeExists("PSRHR") == true) removeFee("PSRHR","FINAL");
	}
`^
CMN;Permitting!Engineering!Erosion Control!SubdivisionPlatCSM;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['TYPE OF PERMIT.Total Disturbed Area'] != null) {
	if(feeExists("SBDV", "NEW", "INVOICED") == false) updateFee("SBDV","ENGERSBDV","FINAL",1,"N");
	} else {
	if(feeExists("SBDV") == true) removeFee("SBDV","FINAL");
	}

if (AInfo['TYPE OF PERMIT.Renewal of Expired Permit (Enter 1)'] != null) {
	if(feeExists("SBDVR", "NEW", "INVOICED") == false) updateFee("SBDVR","ENGERSBDV","FINAL",1,"N");
	} else {
	if(feeExists("SBDVR") == true) removeFee("SBDVR","FINAL");
	}
`^
CMN;Permitting!Engineering!ROW!~;DegradationFee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
varPDM = "0";
varPDOM = "0";
if (variable2 == "1") {
	varPDM = ".98";
	}

if (variable1 >= "5" && variable1 <= "7") {
	include("CMN;Permitting!Engineering!ROW!~;Type5");
	}

if (variable1 == "4") {
	include("CMN;Permitting!Engineering!ROW!~;Type4");
	}

if (variable1 <= "3") {
	include("CMN;Permitting!Engineering!ROW!~;Type3");
	}

if (variable2 == "38" && (variable1 >= "4" )) {
	varPDM = ".08";
	}

if (variable2 == "39") {
	varPDM = ".04";
	}

if (variable2 == "40") {
	varPDM = ".01";
	}

if (variable2 >= "41") {
	varPDM = "0";
	}

if (variable2 == "0") {
	varPDM = "1";
	varPDOM = "1";
	}
`^
CMN;Permitting!Engineering!ROW!~;GISCenterline^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
x = getGISCenterLine();
intx = (x.length);
if (intx >= 1) {
	editAppSpecific("OFFICE USE ONLY.MSLINK 1",x[0]["mslink"]);
	editAppSpecific("OFFICE USE ONLY.Last Surface Year 1",x[0]["surface_year"]);
	editAppSpecific("OFFICE USE ONLY.Initial Const Year 1",x[0]["init_const_yr"]);
	editAppSpecific("OFFICE USE ONLY.Funct. Class 1",x[0]["funct_class"]);
	}

if (intx >= 2) {
	editAppSpecific("OFFICE USE ONLY.MSLINK 2",x[1]["mslink"]);
	editAppSpecific("OFFICE USE ONLY.Last Surface Year 2",x[1]["surface_year"]);
	editAppSpecific("OFFICE USE ONLY.Initial Const Year 2",x[1]["init_const_yr"]);
	editAppSpecific("OFFICE USE ONLY.Funct. Class 2",x[1]["funct_class"]);
	}

if (intx >= 3) {
	editAppSpecific("OFFICE USE ONLY.MSLINK 3",x[2]["mslink"]);
	editAppSpecific("OFFICE USE ONLY.Last Surface Year 3",x[2]["surface_year"]);
	editAppSpecific("OFFICE USE ONLY.Initial Const Year 3",x[2]["init_const_yr"]);
	editAppSpecific("OFFICE USE ONLY.Funct. Class 3",x[2]["funct_class"]);
	}

if (intx >= 4) {
	editAppSpecific("OFFICE USE ONLY.MSLINK 4",x[3]["mslink"]);
	editAppSpecific("OFFICE USE ONLY.Last Surface Year 4",x[3]["surface_year"]);
	editAppSpecific("OFFICE USE ONLY.Initial Const Year 4",x[3]["init_const_yr"]);
	editAppSpecific("OFFICE USE ONLY.Funct. Class 4",x[3]["funct_class"]);
	}

if (intx >= 5) {
	editAppSpecific("OFFICE USE ONLY.MSLINK 5",x[4]["mslink"]);
	editAppSpecific("OFFICE USE ONLY.Last Surface Year 5",x[4]["surface_year"]);
	editAppSpecific("OFFICE USE ONLY.Initial Const Year 5",x[4]["init_const_yr"]);
	editAppSpecific("OFFICE USE ONLY.Funct. Class 5",x[4]["funct_class"]);
	}

if (intx >= 6) {
	editAppSpecific("OFFICE USE ONLY.MSLINK 6",x[5]["mslink"]);
	editAppSpecific("OFFICE USE ONLY.Last Surface Year 6",x[5]["surface_year"]);
	editAppSpecific("OFFICE USE ONLY.Initial Const Year 6",x[5]["init_const_yr"]);
	editAppSpecific("OFFICE USE ONLY.Funct. Class 6",x[5]["funct_class"]);
	}

if (intx >= 7) {
	editAppSpecific("OFFICE USE ONLY.MSLINK 7",x[6]["mslink"]);
	editAppSpecific("OFFICE USE ONLY.Last Surface Year 7",x[6]["surface_year"]);
	editAppSpecific("OFFICE USE ONLY.Initial Const Year 7",x[6]["init_const_yr"]);
	editAppSpecific("OFFICE USE ONLY.Funct. Class 7",x[6]["funct_class"]);
	}

if (intx >= 8) {
	editAppSpecific("OFFICE USE ONLY.MSLINK 8",x[7]["mslink"]);
	editAppSpecific("OFFICE USE ONLY.Last Surface Year 8",x[7]["surface_year"]);
	editAppSpecific("OFFICE USE ONLY.Initial Const Year 8",x[7]["init_const_yr"]);
	editAppSpecific("OFFICE USE ONLY.Funct. Class 8",x[7]["funct_class"]);
	}
`^
CMN;Permitting!Engineering!ROW!~;Schedule Reinspection^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
cd = aa.cap.getCapDetail(capId).getOutput().getCapDetailModel();
capAsgnStaff = cd.getAsgnStaff();
capAsgnDept = cd.getAsgnDept();
if ((inspType == "Initial" ||  inspType == "Re-Inspection") && inspResult == "Completed with Warranty Insp") {
	scheduleInspectDateGroup("ROWINSP","Warranty Inspection",nextWorkDay(dateAdd(null, 915)),capAsgnStaff);
	}

if ((inspType == "Initial") && (inspResult == "Stop Work" || inspResult == "Failed")) {
	scheduleInspectDateGroup("ROWINSP","Re-Inspection",nextWorkDay(dateAdd(null, 60)),capAsgnStaff);
	}

if ((inspType == "Re-Inspection") && (inspResult == "Stop Work" || inspResult == "Failed")) {
	scheduleInspectDateGroup("ROWINSP","Final",nextWorkDay(dateAdd(null, 10)),capAsgnStaff);
	}

if ((inspType == "Warranty Inspection" ||  inspType == "Warranty Re-Inspection") && inspResult == "Stop Work") {
	scheduleInspectDateGroup("ROWINSP","Warranty Re-Inspection",nextWorkDay(dateAdd(null, 7)),capAsgnStaff);
	}

if ((inspType == "Warranty Inspection" ||  inspType == "Warranty Re-Inspection") && inspResult == "Failed") {
	scheduleInspectDateGroup("ROWINSP","Warranty Re-Inspection",nextWorkDay(dateAdd(null, 28)),capAsgnStaff);
	}
`^
CMN;Permitting!Engineering!ROW!~;Type3^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (variable2 == "2") {
	varPDM = ".96";
	varPDOM = ".87";
	}

if (variable2 == "3") {
	varPDM = ".93";
	varPDOM = ".8";
	}

if (variable2 == "4") {
	varPDM = ".9";
	varPDOM = ".73";
	}

if (variable2 == "5") {
	varPDM = ".86";
	varPDOM = ".67";
	}

if (variable2 == "6") {
	varPDM = ".82";
	varPDOM = ".6";
	}

if (variable2 == "7") {
	varPDM = ".76";
	varPDOM = ".53";
	}

if (variable2 == "8") {
	varPDM = ".68";
	varPDOM = ".47";
	}

if (variable2 == "9") {
	varPDM = ".6";
	varPDOM = ".4";
	}

if (variable2 == "10") {
	varPDM = ".54";
	varPDOM = ".33";
	}

if (variable2 == "11") {
	varPDM = ".49";
	varPDOM = ".27";
	}

if (variable2 == "12") {
	varPDM = ".44";
	varPDOM = ".2";
	}

if (variable2 == "13") {
	varPDM = ".4";
	varPDOM = ".13";
	}

if (variable2 == "14") {
	varPDM = ".37";
	varPDOM = ".07";
	}

if (variable2 == "15") {
	varPDM = ".35";
	varPDOM = ".01";
	}

if (variable2 == "16") {
	varPDM = ".33";
	}

if (variable2 == "17") {
	varPDM = ".32";
	}

if (variable2 == "18") {
	varPDM = ".31";
	}

if ((variable2 == "19" || variable2 == "20")) {
	varPDM = ".3";
	}

if (variable2 == "21") {
	varPDM = ".29";
	}

if ((variable2 == "22" || variable2 == "23")) {
	varPDM = ".28";
	}

if ((variable2 == "24" || variable2 == "25" || variable2 == "26" || variable2 == "27")) {
	varPDM = ".27";
	}

if (variable2 == "28") {
	varPDM = ".26";
	}

if (variable2 == "29") {
	varPDM = ".25";
	}

if (variable2 == "30") {
	varPDM = ".24";
	}

if (variable2 == "31") {
	varPDM = ".22";
	}

if (variable2 == "32") {
	varPDM = ".21";
	}

if (variable2 == "33") {
	varPDM = ".19";
	}

if (variable2 == "34") {
	varPDM = ".17";
	}

if (variable2 == "35") {
	varPDM = ".14";
	}

if (variable2 == "36") {
	varPDM = ".12";
	}

if (variable2 == "37") {
	varPDM = ".1";
	}

if (variable2 == "38") {
	varPDM = ".07";
	}

if (variable2 == "1") {
	varPDM = ".98";
	varPDOM = ".93";
	}
`^
CMN;Permitting!Engineering!ROW!~;Type4^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (variable2 == "2") {
	varPDM = ".96";
	varPDOM = ".88";
	}

if (variable2 == "3") {
	varPDM = ".94";
	varPDOM = ".82";
	}

if (variable2 == "4") {
	varPDM = ".92";
	varPDOM = ".76";
	}

if (variable2 == "5") {
	varPDM = ".88";
	varPDOM = ".71";
	}

if (variable2 == "6") {
	varPDM = ".84";
	varPDOM = ".65";
	}

if (variable2 == "7") {
	varPDM = ".79";
	varPDOM = ".59";
	}

if (variable2 == "8") {
	varPDM = ".72";
	varPDOM = ".53";
	}

if (variable2 == "9") {
	varPDM = ".65";
	varPDOM = ".47";
	}

if (variable2 == "10") {
	varPDM = ".59";
	varPDOM = ".41";
	}

if (variable2 == "11") {
	varPDM = ".55";
	varPDOM = ".35";
	}

if (variable2 == "12") {
	varPDM = ".51";
	varPDOM = ".29";
	}

if (variable2 == "13") {
	varPDM = ".47";
	varPDOM = ".24";
	}

if (variable2 == "14") {
	varPDM = ".44";
	varPDOM = ".18";
	}

if (variable2 == "15") {
	varPDM = ".42";
	varPDOM = ".12";
	}

if (variable2 == "16") {
	varPDM = ".4";
	varPDOM = ".06";
	}

if (variable2 == "17") {
	varPDM = ".39";
	varPDOM = ".01";
	}

if (variable2 == "18") {
	varPDM = ".38";
	}

if ((variable2 == "19" || variable2 == "20")) {
	varPDM = ".37";
	}

if (variable2 == "21") {
	varPDM = ".36";
	}

if (variable2 == "22") {
	varPDM = ".36";
	}

if ((variable2 == "23" || variable2 == "24")) {
	varPDM = ".35";
	}

if ((variable2 == "25" || variable2 == "26")) {
	varPDM = ".34";
	}

if ((variable2 == "27" || variable2 == "28")) {
	varPDM = ".33";
	}

if (variable2 == "29") {
	varPDM = ".31";
	}

if (variable2 == "30") {
	varPDM = ".29";
	}

if (variable2 == "31") {
	varPDM = ".27";
	}

if (variable2 == "32") {
	varPDM = ".25";
	}

if (variable2 == "33") {
	varPDM = ".23";
	}

if (variable2 == "34") {
	varPDM = ".19";
	}

if (variable2 == "35") {
	varPDM = ".16";
	}

if (variable2 == "36") {
	varPDM = ".14";
	}

if (variable2 == "37") {
	varPDM = ".11";
	}

if (variable2 == "38") {
	varPDM = ".08";
	}

if (variable2 == "1") {
	varPDM = ".98";
	varPDOM = ".94";
	}
`^
CMN;Permitting!Engineering!ROW!~;Type5^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (variable2 == "2") {
	varPDM = ".97";
	varPDOM = ".9";
	}

if (variable2 == "3") {
	varPDM = ".95";
	varPDOM = ".85";
	}

if (variable2 == "4") {
	varPDM = ".93";
	varPDOM = ".8";
	}

if (variable2 == "5") {
	varPDM = ".90";
	varPDOM = ".75";
	}

if (variable2 == "6") {
	varPDM = ".87";
	varPDOM = ".7";
	}

if (variable2 == "7") {
	varPDM = ".83";
	varPDOM = ".65";
	}

if (variable2 == "8") {
	varPDM = ".76";
	varPDOM = ".6";
	}

if (variable2 == "9") {
	varPDM = ".69";
	varPDOM = ".55";
	}

if (variable2 == "10") {
	varPDM = ".64";
	varPDOM = ".5";
	}

if (variable2 == "11") {
	varPDM = ".61";
	varPDOM = ".45";
	}

if (variable2 == "12") {
	varPDM = ".58";
	varPDOM = ".4";
	}

if (variable2 == "13") {
	varPDM = ".54";
	varPDOM = ".35";
	}

if (variable2 == "14") {
	varPDM = ".51";
	varPDOM = ".3";
	}

if (variable2 == "15") {
	varPDM = ".49";
	varPDOM = ".25";
	}

if (variable2 == "16") {
	varPDM = ".47";
	varPDOM = ".2";
	}

if (variable2 == "17") {
	varPDM = ".46";
	varPDOM = ".15";
	}

if (variable2 == "18") {
	varPDM = ".45";
	varPDOM = ".1";
	}

if ((variable2 == "19" || variable2 == "20")) {
	varPDM = ".44";
	}

if (variable2 == "21") {
	varPDM = ".43";
	}

if (variable2 == "22") {
	varPDM = ".43";
	}

if ((variable2 == "23" || variable2 == "24")) {
	varPDM = ".42";
	}

if ((variable2 == "25" || variable2 == "26")) {
	varPDM = ".41";
	}

if ((variable2 == "27" || variable2 == "28")) {
	varPDM = ".4";
	}

if (variable2 == "29") {
	varPDM = ".37";
	}

if (variable2 == "30") {
	varPDM = ".34";
	}

if (variable2 == "31") {
	varPDM = ".32";
	}

if (variable2 == "32") {
	varPDM = ".29";
	}

if (variable2 == "33") {
	varPDM = ".26";
	}

if (variable2 == "34") {
	varPDM = ".22";
	}

if (variable2 == "35") {
	varPDM = ".18";
	}

if (variable2 == "36") {
	varPDM = ".15";
	}

if (variable2 == "37") {
	varPDM = ".12";
	}

if (variable2 == "38") {
	varPDM = ".08";
	}

if (variable2 == "1") {
	varPDM = ".98";
	varPDOM = ".95";
	}

if (variable2 == "19") {
	varPDOM = ".05";
	}

if (variable2 == "20") {
	varPDOM = ".01";
	}
`^
CMN;Permitting!Engineering!ROW!NA;CurrentDoc^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
isAsBuiltSketch = false;
docCategory = '';
doc = doci.next();
docCategory = doc.getDocCategory();
dt = doc.getFileUpLoadDate();
dt.setMinutes(dt.getMinutes() + 1);
upload = new Date(dt.toLocaleString());
if (docCategory == "As-Built Sketch") {
	isAsBuiltSketch = true;
	}

if (upload > curDate && isAsBuiltSketch && isOnlyAsBuiltSketch == "") {
	isOnlyAsBuiltSketch = "Y";
	}

if (upload > curDate && isAsBuiltSketch == false) {
	isOnlyAsBuiltSketch = "N";
	}

if (upload > curDate && isAsBuiltSketch == false) {
	strFileName += doc.getFileName() + "<br>";
	}
`^
CMN;Permitting!Engineering!ROW!NA;FailedInspCount^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
insp = insps[i];
iResult = insp.getInspectionStatus();
if (iResult == "Failed" || iResult == "Stop Work") {
	count++;
	}

if (count == 1) {
	countString = count + "st";
	}

if (count == 2) {
	countString = count + "nd";
	}

if (count == 3) {
	countString = count + "rd";
	}

if (count > 3) {
	countString = count + "th";
	}
`^
CMN;Permitting!Engineering!ROW!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
varYear = fileDateObj.getYear();
include("CMN;Permitting!Engineering!ROW!~;GISCenterline");
if(feeExists("ROWAPFE", "NEW", "INVOICED") == false) updateFee("ROWAPFE","ENGROW","FINAL",1,"N");
if (AInfo['4B TRENCH SIZE.Total Bore Length'] != null) {
	if(feeExists("BOREINSP", "NEW", "INVOICED") == false) updateFee("BOREINSP","ENGROW","FINAL",1,"N");
	} else {
	if(feeExists("BOREINSP") == true) removeFee("BOREINSP","FINAL");
	}

if (AInfo['4B TRENCH SIZE.Sod Area'] != null || AInfo['4B TRENCH SIZE.Concrete Sidewalk and!or Curb & Gutter'] != null) {
	if(feeExists("SWCGSDINSP", "NEW", "INVOICED") == false) updateFee("SWCGSDINSP","ENGROW","FINAL",1,"N");
	}

if (AInfo['3C SANITARY.Number of New Sanitary Connections'] != null) {
	if(feeExists("SANCONN", "NEW", "INVOICED") == false) updateFee("SANCONN","ENGROW","FINAL",1,"N");
	}

if (AInfo['3D STORM.Number of New Storm Connections'] != null) {
	if(feeExists("STORMCONN", "NEW", "INVOICED") == false) updateFee("STORMCONN","ENGROW","FINAL",1,"N");
	}

varPDM = null;
varPDOM = null;
varReCalc = "False";
variable3 = null;
variable4 = null;
variable1 = getAppSpecific("OFFICE USE ONLY.Funct. Class 1");
variable2 = varYear - getAppSpecific("OFFICE USE ONLY.Last Surface Year 1");
if (variable1 != null && variable2 >= 0 && variable2 != varYear) {
	include("CMN;Permitting!Engineering!ROW!~;DegradationFee");
	}

if (varPDOM != null && getAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Multiplier 1") != varPDOM && (varYear - getAppSpecific("OFFICE USE ONLY.Initial Const Year 1") != variable2)) {
	editAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Multiplier 1",varPDOM);
	varReCalc = "True";
	}

variable2 = varYear - getAppSpecific("OFFICE USE ONLY.Initial Const Year 1");
if (variable1 != null && variable2 >= 0 && variable2 != varYear) {
	include("CMN;Permitting!Engineering!ROW!~;DegradationFee");
	}

if (varPDM != null && getAppSpecific("OFFICE USE ONLY.Pavement Depreciation Multiplier 1") != varPDM) {
	editAppSpecific("OFFICE USE ONLY.Pavement Depreciation Multiplier 1",varPDM);
	varReCalc = "True";
	}

if (getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 1") > "0") {
	variable3 = getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 1")~4;
	variable4 = getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 1")~.83;
	}

if ((variable3 != null && getAppSpecific("OFFICE USE ONLY.Pavement Depreciation Base 1") != variable3) || varReCalc == "True") {
	editAppSpecific("OFFICE USE ONLY.Pavement Depreciation Base 1",getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 1")~4);
	updateFee("PAVDEPCHG1","ENGROW","FINAL",1,"N");
	}

if ((variable4 != null && getAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Base 1") != variable4) || varReCalc == "True") {
	editAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Base 1",getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 1")~.83);
	updateFee("POVDEPCHG1","ENGROW","FINAL",1,"N");
	}

if (AInfo['4B TRENCH SIZE.Trench Located w!in Pavement (Incl. Bore Pits!Potholes)'] != null) {
	if(feeExists("TRENCHINSP1", "NEW", "INVOICED") == false) updateFee("TRENCHINSP1","ENGROW","FINAL",1,"N");
	} else {
	if(feeExists("TRENCHINSP1") == true) removeFee("TRENCHINSP1","FINAL");
	}

varPDM = null;
varPDOM = null;
varReCalc = "False";
variable3 = null;
variable4 = null;
variable1 = getAppSpecific("OFFICE USE ONLY.Funct. Class 2");
variable2 = varYear - getAppSpecific("OFFICE USE ONLY.Last Surface Year 2");
if (variable1 != null && variable2 >= 0 && variable2 != varYear) {
	include("CMN;Permitting!Engineering!ROW!~;DegradationFee");
	}

if (varPDOM != null && getAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Multiplier 2") != varPDOM && (varYear - getAppSpecific("OFFICE USE ONLY.Initial Const Year 2") != variable2)) {
	editAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Multiplier 2",varPDOM);
	varReCalc = "True";
	}

variable2 = varYear - getAppSpecific("OFFICE USE ONLY.Initial Const Year 2");
if (variable1 != null && variable2 >= 0 && variable2 != varYear) {
	include("CMN;Permitting!Engineering!ROW!~;DegradationFee");
	}

if (varPDM != null && getAppSpecific("OFFICE USE ONLY.Pavement Depreciation Multiplier 2") != varPDM) {
	editAppSpecific("OFFICE USE ONLY.Pavement Depreciation Multiplier 2",varPDM);
	varReCalc = "True";
	}

if (getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 2") > "0") {
	variable3 = getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 2")~4;
	variable4 = getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 2")~.83;
	}

if ((variable3 != null && getAppSpecific("OFFICE USE ONLY.Pavement Depreciation Base 2") != variable3) || varReCalc == "True") {
	editAppSpecific("OFFICE USE ONLY.Pavement Depreciation Base 2",getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 2")~4);
	updateFee("PAVDEPCHG2","ENGROW","FINAL",1,"N");
	}

if ((variable4 != null && getAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Base 2") != variable4) || varReCalc == "True") {
	editAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Base 2",getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 2")~.83);
	updateFee("POVDEPCHG2","ENGROW","FINAL",1,"N");
	}

varPDM = null;
varPDOM = null;
varReCalc = "False";
variable3 = null;
variable4 = null;
variable1 = getAppSpecific("OFFICE USE ONLY.Funct. Class 3");
variable2 = varYear - getAppSpecific("OFFICE USE ONLY.Last Surface Year 3");
if (variable1 != null && variable2 >= 0 && variable2 != varYear) {
	include("CMN;Permitting!Engineering!ROW!~;DegradationFee");
	}

if (varPDOM != null && getAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Multiplier 3") != varPDOM && (varYear - getAppSpecific("OFFICE USE ONLY.Initial Const Year 3") != variable2)) {
	editAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Multiplier 3",varPDOM);
	varReCalc = "True";
	}

variable2 = varYear - getAppSpecific("OFFICE USE ONLY.Initial Const Year 3");
if (variable1 != null && variable2 >= 0 && variable2 != varYear) {
	include("CMN;Permitting!Engineering!ROW!~;DegradationFee");
	}

if (varPDM != null && getAppSpecific("OFFICE USE ONLY.Pavement Depreciation Multiplier 3") != varPDM) {
	editAppSpecific("OFFICE USE ONLY.Pavement Depreciation Multiplier 3",varPDM);
	varReCalc = "True";
	}

if (getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 3") > "0") {
	variable3 = getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 3")~4;
	variable4 = getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 3")~.83;
	}

if ((variable3 != null && getAppSpecific("OFFICE USE ONLY.Pavement Depreciation Base 3") != variable3) || varReCalc == "True") {
	editAppSpecific("OFFICE USE ONLY.Pavement Depreciation Base 3",getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 3")~4);
	updateFee("PAVDEPCHG3","ENGROW","FINAL",1,"N");
	}

if ((variable4 != null && getAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Base 3") != variable4) || varReCalc == "True") {
	editAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Base 3",getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 3")~.83);
	updateFee("POVDEPCHG3","ENGROW","FINAL",1,"N");
	}

varPDM = null;
varPDOM = null;
varReCalc = "False";
variable3 = null;
variable4 = null;
variable1 = getAppSpecific("OFFICE USE ONLY.Funct. Class 4");
variable2 = varYear - getAppSpecific("OFFICE USE ONLY.Last Surface Year 4");
if (variable1 != null && variable2 >= 0 && variable2 != varYear) {
	include("CMN;Permitting!Engineering!ROW!~;DegradationFee");
	}

if (varPDOM != null && getAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Multiplier 4") != varPDOM && (varYear - getAppSpecific("OFFICE USE ONLY.Initial Const Year 4") != variable2)) {
	editAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Multiplier 4",varPDOM);
	varReCalc = "True";
	}

variable2 = varYear - getAppSpecific("OFFICE USE ONLY.Initial Const Year 4");
if (variable1 != null && variable2 >= 0 && variable2 != varYear) {
	include("CMN;Permitting!Engineering!ROW!~;DegradationFee");
	}

if (varPDM != null && getAppSpecific("OFFICE USE ONLY.Pavement Depreciation Multiplier 4") != varPDM) {
	editAppSpecific("OFFICE USE ONLY.Pavement Depreciation Multiplier 4",varPDM);
	varReCalc = "True";
	}

if (getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 4") > "0") {
	variable3 = getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 4")~4;
	variable4 = getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 4")~.83;
	}

if ((variable3 != null && getAppSpecific("OFFICE USE ONLY.Pavement Depreciation Base 4") != variable3) || varReCalc == "True") {
	editAppSpecific("OFFICE USE ONLY.Pavement Depreciation Base 4",getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 4")~4);
	updateFee("PAVDEPCHG4","ENGROW","FINAL",1,"N");
	}

if ((variable4 != null && getAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Base 4") != variable4) || varReCalc == "True") {
	editAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Base 4",getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 4")~.83);
	updateFee("POVDEPCHG4","ENGROW","FINAL",1,"N");
	}

varPDM = null;
varPDOM = null;
varReCalc = "False";
variable3 = null;
variable4 = null;
variable1 = getAppSpecific("OFFICE USE ONLY.Funct. Class 5");
variable2 = varYear - getAppSpecific("OFFICE USE ONLY.Last Surface Year 5");
if (variable1 != null && variable2 >= 0 && variable2 != varYear) {
	include("CMN;Permitting!Engineering!ROW!~;DegradationFee");
	}

if (varPDOM != null && getAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Multiplier 5") != varPDOM && (varYear - getAppSpecific("OFFICE USE ONLY.Initial Const Year 5") != variable2)) {
	editAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Multiplier 5",varPDOM);
	varReCalc = "True";
	}

variable2 = varYear - getAppSpecific("OFFICE USE ONLY.Initial Const Year 5");
if (variable1 != null && variable2 >= 0 && variable2 != varYear) {
	include("CMN;Permitting!Engineering!ROW!~;DegradationFee");
	}

if (varPDM != null && getAppSpecific("OFFICE USE ONLY.Pavement Depreciation Multiplier 5") != varPDM) {
	editAppSpecific("OFFICE USE ONLY.Pavement Depreciation Multiplier 5",varPDM);
	varReCalc = "True";
	}

if (getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 5") > "0") {
	variable3 = getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 5")~4;
	variable4 = getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 5")~.83;
	}

if ((variable3 != null && getAppSpecific("OFFICE USE ONLY.Pavement Depreciation Base 5") != variable3) || varReCalc == "True") {
	editAppSpecific("OFFICE USE ONLY.Pavement Depreciation Base 5",getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 5")~4);
	updateFee("PAVDEPCHG5","ENGROW","FINAL",1,"N");
	}

if ((variable4 != null && getAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Base 5") != variable4) || varReCalc == "True") {
	editAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Base 5",getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 5")~.83);
	updateFee("POVDEPCHG5","ENGROW","FINAL",1,"N");
	}

varPDM = null;
varPDOM = null;
varReCalc = "False";
variable3 = null;
variable4 = null;
variable1 = getAppSpecific("OFFICE USE ONLY.Funct. Class 6");
variable2 = varYear - getAppSpecific("OFFICE USE ONLY.Last Surface Year 6");
if (variable1 != null && variable2 >= 0 && variable2 != varYear) {
	include("CMN;Permitting!Engineering!ROW!~;DegradationFee");
	}

if (varPDOM != null && getAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Multiplier 6") != varPDOM && (varYear - getAppSpecific("OFFICE USE ONLY.Initial Const Year 6") != variable2)) {
	editAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Multiplier 6",varPDOM);
	varReCalc = "True";
	}

variable2 = varYear - getAppSpecific("OFFICE USE ONLY.Initial Const Year 6");
if (variable1 != null && variable2 >= 0 && variable2 != varYear) {
	include("CMN;Permitting!Engineering!ROW!~;DegradationFee");
	}

if (varPDM != null && getAppSpecific("OFFICE USE ONLY.Pavement Depreciation Multiplier 6") != varPDM) {
	editAppSpecific("OFFICE USE ONLY.Pavement Depreciation Multiplier 6",varPDM);
	varReCalc = "True";
	}

if (getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 6") > "0") {
	variable3 = getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 6")~4;
	variable4 = getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 6")~.83;
	}

if ((variable3 != null && getAppSpecific("OFFICE USE ONLY.Pavement Depreciation Base 6") != variable3) || varReCalc == "True") {
	editAppSpecific("OFFICE USE ONLY.Pavement Depreciation Base 6",getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 6")~4);
	updateFee("PAVDEPCHG6","ENGROW","FINAL",1,"N");
	}

if ((variable4 != null && getAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Base 6") != variable4) || varReCalc == "True") {
	editAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Base 6",getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 6")~.83);
	updateFee("POVDEPCHG6","ENGROW","FINAL",1,"N");
	}

varPDM = null;
varPDOM = null;
varReCalc = "False";
variable3 = null;
variable4 = null;
variable1 = getAppSpecific("OFFICE USE ONLY.Funct. Class 7");
variable2 = varYear - getAppSpecific("OFFICE USE ONLY.Last Surface Year 7");
if (variable1 != null && variable2 >= 0 && variable2 != varYear) {
	include("CMN;Permitting!Engineering!ROW!~;DegradationFee");
	}

if (varPDOM != null && getAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Multiplier 7") != varPDOM && (varYear - getAppSpecific("OFFICE USE ONLY.Initial Const Year 7") != variable2)) {
	editAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Multiplier 7",varPDOM);
	varReCalc = "True";
	}

variable2 = varYear - getAppSpecific("OFFICE USE ONLY.Initial Const Year 7");
if (variable1 != null && variable2 >= 0 && variable2 != varYear) {
	include("CMN;Permitting!Engineering!ROW!~;DegradationFee");
	}

if (varPDM != null && getAppSpecific("OFFICE USE ONLY.Pavement Depreciation Multiplier 7") != varPDM) {
	editAppSpecific("OFFICE USE ONLY.Pavement Depreciation Multiplier 7",varPDM);
	varReCalc = "True";
	}

if (getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 7") > "0") {
	variable3 = getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 7")~4;
	variable4 = getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 7")~.83;
	}

if ((variable3 != null && getAppSpecific("OFFICE USE ONLY.Pavement Depreciation Base 7") != variable3) || varReCalc == "True") {
	editAppSpecific("OFFICE USE ONLY.Pavement Depreciation Base 7",getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 7")~4);
	updateFee("PAVDEPCHG7","ENGROW","FINAL",1,"N");
	}

if ((variable4 != null && getAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Base 7") != variable4) || varReCalc == "True") {
	editAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Base 7",getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 7")~.83);
	updateFee("POVDEPCHG7","ENGROW","FINAL",1,"N");
	}

varPDM = null;
varPDOM = null;
varReCalc = "False";
variable3 = null;
variable4 = null;
variable1 = getAppSpecific("OFFICE USE ONLY.Funct. Class 8");
variable2 = varYear - getAppSpecific("OFFICE USE ONLY.Last Surface Year 8");
if (variable1 != null && variable2 >= 0 && variable2 != varYear) {
	include("CMN;Permitting!Engineering!ROW!~;DegradationFee");
	}

if (varPDOM != null && getAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Multiplier 8") != varPDOM && (varYear - getAppSpecific("OFFICE USE ONLY.Initial Const Year 8") != variable2)) {
	editAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Multiplier 8",varPDOM);
	varReCalc = "True";
	}

variable2 = varYear - getAppSpecific("OFFICE USE ONLY.Initial Const Year 8");
if (variable1 != null && variable2 >= 0 && variable2 != varYear) {
	include("CMN;Permitting!Engineering!ROW!~;DegradationFee");
	}

if (varPDM != null && getAppSpecific("OFFICE USE ONLY.Pavement Depreciation Multiplier 8") != varPDM) {
	editAppSpecific("OFFICE USE ONLY.Pavement Depreciation Multiplier 8",varPDM);
	varReCalc = "True";
	}

if (getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 8") > "0") {
	variable3 = getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 8")~4;
	variable4 = getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 8")~.83;
	}

if ((variable3 != null && getAppSpecific("OFFICE USE ONLY.Pavement Depreciation Base 8") != variable3) || varReCalc == "True") {
	editAppSpecific("OFFICE USE ONLY.Pavement Depreciation Base 8",getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 8")~4);
	updateFee("PAVDEPCHG8","ENGROW","FINAL",1,"N");
	}

if ((variable4 != null && getAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Base 8") != variable4) || varReCalc == "True") {
	editAppSpecific("OFFICE USE ONLY.Pavement Overlay Depreciation Base 8",getAppSpecific("OFFICE USE ONLY.Total Square Feet to Resurface 8")~.83);
	updateFee("POVDEPCHG8","ENGROW","FINAL",1,"N");
	}
`^
CMN;Permitting!Engineering!ROW!NA;GetFeeExempt^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
isFeeExempt = "N";
var lpObj = null;
licProf = aa.licenseProfessional.getLicenseProf(capId).getOutput();
comment("lp is  " + licProf);
showComment = true;
if (licProf != null) {
	lpObj = licenseProfObject(licProf[0].getLicenseNbr(),"PREQUALIFIED ROW");
	}

if (!~~~ getAttribute requires the attribute LABEL (not the attribute NAME). Lovely.... ~~~!) {
	}

if (lpObj != null && lpObj.validAttrs) {
	isFeeExempt = lpObj.getAttribute("Fee Exempt?");
	}

if (isFeeExempt == null) {
	isFeeExempt = "N";
	}

comment("feeExempt is " + isFeeExempt);
showComment = true;
`^
CMN;Permitting!Engineering!ROW!NA;ListGuideSheetItems^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
gsComment = "";
gsStatus = "";
gsName = "";
foundString = Number(0);
gsCommentNew = "";
if (gsObj[gs].status != null) {
	gsStatus = gsObj[gs].status;
	}

if (gsObj[gs].comment != null) {
	gsComment = gsObj[gs].comment;
	foundString = Number(gsComment.search("Inspection Result;"));
	}

if ((gsStatus == "FAIL" || gsStatus == "Fail") && gsComment != "") {
	gsComment = gsComment.replaceAll(String.fromCharCode(13), "<br !>");
	}

if ((gsStatus == "FAIL" || gsStatus == "Fail") && gsComment != "" && foundString > -1) {
	findString = "Inspection Result;";
	commArray = gsComment.split(findString);
	for(commentLine in commArray) include("CMN;Permitting!Engineering!ROW!NA;ListGuideSheetItems;Format");
	}

if (gsCommentNew != "") {
	gsComment = gsCommentNew;
	gsCommentNew = "";
	}

if ((gsStatus == "FAIL" || gsStatus == "Fail")) {
	gsMessage += "<b>" + gsObj[gs].gsType + " - " + gsObj[gs].text + "<br !>" + gsName + "<!b><br !>" + gsComment + "<br !><br !>";
	}
`^
CMN;Permitting!Engineering!ROW!NA;ListGuideSheetItems;Format^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
lastBR = 0;
secondToLastBR = 0;
lastBR = commArray[commentLine].toLowerCase().lastIndexOf("<br");
leftString = commArray[commentLine].toLowerCase();
if (lastBR > -1) {
	leftString = leftString.substring(0, lastBR);
	secondToLastBR = leftString.lastIndexOf("<br");
	}

if (lastBR > -1) {
	commArray[commentLine] = commArray[commentLine].substring(0, lastBR) + "<!b>" + commArray[commentLine].substring(lastBR);
	}

if (lastBR > -1 && secondToLastBR < 0) {
	commArray[commentLine] = "<b>" + commArray[commentLine];
	}

if (lastBR > -1 && secondToLastBR > -1) {
	commArray[commentLine] = commArray[commentLine].substring(0, secondToLastBR) + "<b>" + commArray[commentLine].substring(secondToLastBR);
	}

gsCommentNew = gsCommentNew + commArray[commentLine] + findString;
`^
CMN;Permitting!Engineering!ROW!NA;ValidateLP^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showMessage = false;
showDebug = false;
owned = false;
correctType = false;
licProf = null;
var checkValue = "PREQUALIFIED ROW";
licProfList = cap.getLicenseProfessionalList();
if (licProfList != null) {
	licProf = licProfList.iterator().next();
	tLicNbr = licProf.getLicenseNbr();
	} else {
	licProf = cap.getLicenseProfessionalModel();
	tLicNbr = licProf.getLicenseNbr();
	}

if (licProf.getLicenseType().equals(checkValue)) {
	correctType = true;
	} else {
	correctType = false;
	}

if (correctType == false) {
	cancel = true;
	showMessage = true;
	comment("Please select a PREQUALIFIED ROW License Type.");
	}
`^
CMN;Permitting!Engineering!Sewer Addition Meter!NA;CreateFees^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if(feeExists("SAMAPP") == false) addFee("SAMAPP","ENGSMT","FINAL", 1,"Y");
if(feeExists("SAMISP") == false) addFee("SAMISP","ENGSMT","FINAL", 1,"Y");
if(feeExists("SAMINL") == false) addFee("SAMINL","ENGSMT","FINAL", 1,"Y");
`^
CMN;Permitting!Engineering!Sewer Deduct Meter!NA;CreateFees^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if(feeExists("SDMAPP") == false) addFee("SDMAPP","ENGSMT","FINAL", 1,"Y");
if(feeExists("SDMISP") == false) addFee("SDMISP","ENGSMT","FINAL", 1,"Y");
if(feeExists("SDMINL") == false) addFee("SDMINL","ENGSMT","FINAL", 1,"Y");
`^
CMN;Permitting!Engineering!Sewer Plug!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
autoInvFees = "Y";
include("CMN;Permitting!Engineering!Sewer Plug!NA;GetCounts");
if (varTotNumSans == 0) {
	removeFee("SANSWRABINSP","FINAL");
	removeFee("SANSWRDEP","FINAL");
	} else {
	updateFee("SANSWRABINSP","ENGSWRPLG","FINAL",varTotNumSans,autoInvFees);
	updateFee("SANSWRDEP","ENGSWRPLG","FINAL",varTotNumSans,autoInvFees);
	}

if (varNumPermSans == 0) {
	removeFee("SANMAINADMIN","FINAL");
	removeFee("SANMAININSP","FINAL");
	} else {
	updateFee ("SANMAINADMIN","ENGSWRPLG","FINAL",varNumPermSans,autoInvFees);
	if(varTotNumPermSansNotStruct > 0) updateFee("SANMAININSP","ENGSWRPLG","FINAL",varTotNumPermSansNotStruct,autoInvFees);
	}

if (varTotNumStorms == 0) {
	removeFee("STRMSWRINSP","FINAL");
	removeFee("STRMSWRDEP","FINAL");
	} else {
	updateFee("STRMSWRINSP","ENGSWRPLG","FINAL",varTotNumStorms,autoInvFees);
	updateFee("STRMSWRDEP","ENGSWRPLG","FINAL",varTotNumStorms,autoInvFees);
	}

if (varTotNumPermSansNotStruct == 0) {
	removeFee("SANMAININSP","FINAL");
	} else {
	logDebug("varTotSansNotStruct;"+ varTotSansNotStruct);
	}

comment("Nmpermsans");
comment(varNumPermSans);
if (AInfo['NUMBER OF ABANDONMENTS.Permanent on 6 Inch Sanitary Main'] == 0) {
	removeFee("SANMAIN06","FINAL");
	} else {
	updateFee("SANMAIN06","ENGSWRPLG","FINAL",AInfo['NUMBER OF ABANDONMENTS.Permanent on 6 Inch Sanitary Main'],autoInvFees);
	}

if (AInfo['NUMBER OF ABANDONMENTS.Permanent on 8 Inch Sanitary Main'] == 0) {
	removeFee("SANMAIN08","FINAL");
	} else {
	updateFee("SANMAIN08","ENGSWRPLG","FINAL",AInfo['NUMBER OF ABANDONMENTS.Permanent on 8 Inch Sanitary Main'],autoInvFees);
	}

if (AInfo['NUMBER OF ABANDONMENTS.Permanent on 10 Inch Sanitary Main'] == 0) {
	removeFee("SANMAIN10","FINAL");
	} else {
	updateFee("SANMAIN10","ENGSWRPLG","FINAL",AInfo['NUMBER OF ABANDONMENTS.Permanent on 10 Inch Sanitary Main'],autoInvFees);
	}

if (AInfo['NUMBER OF ABANDONMENTS.Permanent on 12 Inch Sanitary Main'] == 0) {
	removeFee("SANMAIN12","FINAL");
	} else {
	updateFee("SANMAIN12","ENGSWRPLG","FINAL",AInfo['NUMBER OF ABANDONMENTS.Permanent on 12 Inch Sanitary Main'],autoInvFees);
	}

if (AInfo['NUMBER OF ABANDONMENTS.Permanent on 15 Inch Sanitary Main'] == 0) {
	removeFee("SANMAIN15","FINAL");
	} else {
	updateFee("SANMAIN15","ENGSWRPLG","FINAL",AInfo['NUMBER OF ABANDONMENTS.Permanent on 15 Inch Sanitary Main'],autoInvFees);
	}

if (AInfo['NUMBER OF ABANDONMENTS.Permanent on 18 Inch Sanitary Main'] == 0) {
	removeFee("SANMAIN18","FINAL");
	} else {
	updateFee("SANMAIN18","ENGSWRPLG","FINAL",AInfo['NUMBER OF ABANDONMENTS.Permanent on 18 Inch Sanitary Main'],autoInvFees);
	}

if (AInfo['NUMBER OF ABANDONMENTS.Permanent on 21 Inch Sanitary Main'] == 0) {
	removeFee("SANMAIN21","FINAL");
	} else {
	updateFee("SANMAIN21","ENGSWRPLG","FINAL",AInfo['NUMBER OF ABANDONMENTS.Permanent on 21 Inch Sanitary Main'],autoInvFees);
	}

if (AInfo['NUMBER OF ABANDONMENTS.Permanent on 24 Inch Sanitary Main'] == 0) {
	removeFee("SANMAIN24","FINAL");
	} else {
	updateFee("SANMAIN24","ENGSWRPLG","FINAL",AInfo['NUMBER OF ABANDONMENTS.Permanent on 24 Inch Sanitary Main'],autoInvFees);
	}

if (AInfo['NUMBER OF ABANDONMENTS.Permanent Plug at Structure'] == null || AInfo['NUMBER OF ABANDONMENTS.Permanent Plug at Structure'] == 0) {
	removeFee("PLGSTRCT","FINAL");
	} else {
	updateFee("PLGSTRCT","ENGSWRPLG","FINAL",AInfo['NUMBER OF ABANDONMENTS.Permanent Plug at Structure'],autoInvFees);
	}
`^
CMN;Permitting!Engineering!Sewer Plug!NA;GetCounts^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (AInfo['NUMBER OF ABANDONMENTS.Permanent Plug at Structure'] != null) {
	var numPlugStruct = parseInt(AInfo['NUMBER OF ABANDONMENTS.Permanent Plug at Structure']);
	} else {
	var numPlugStruct = 0;
	}

varNumPermSans = parseInt(AInfo['NUMBER OF ABANDONMENTS.Permanent on 6 Inch Sanitary Main'])+parseInt(AInfo['NUMBER OF ABANDONMENTS.Permanent on 8 Inch Sanitary Main'])+parseInt(AInfo['NUMBER OF ABANDONMENTS.Permanent on 10 Inch Sanitary Main'])+parseInt(AInfo['NUMBER OF ABANDONMENTS.Permanent on 12 Inch Sanitary Main'])+parseInt(AInfo['NUMBER OF ABANDONMENTS.Permanent on 15 Inch Sanitary Main'])+parseInt(AInfo['NUMBER OF ABANDONMENTS.Permanent on 18 Inch Sanitary Main'])+parseInt(AInfo['NUMBER OF ABANDONMENTS.Permanent on 21 Inch Sanitary Main'])+parseInt(AInfo['NUMBER OF ABANDONMENTS.Permanent on 24 Inch Sanitary Main'])+numPlugStruct;
varTotNumStorms = parseInt(AInfo['NUMBER OF ABANDONMENTS.Permanent on Storm Main'])+parseInt(AInfo['NUMBER OF ABANDONMENTS.Temporary on Storm Main']);
varTotNumSans = varNumPermSans + parseInt(AInfo['NUMBER OF ABANDONMENTS.Temporary on Sanitary Main']);
varTotNumPermSansNotStruct = varNumPermSans - numPlugStruct;
varTotSansNotStruct = varTotNumSans - numPlugStruct;
varTotNumPerms = varNumPermSans + parseInt(AInfo['NUMBER OF ABANDONMENTS.Permanent on Storm Main']);
varTotAll = varTotNumSans + varTotNumStorms;
`^
CMN;Permitting!Engineering!StormWaterManagement!~;Inspection^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
`^
CMN;Permitting!Engineering!StormWaterManagement!AcreDistLess20kImpvsArea;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['TYPE OF PERMIT.Total New and Replaced Impervious Area Noted Above'] != null) {
	if(feeExists("SWLT20K", "NEW", "INVOICED") == false) updateFee("SWLT20K","ENGSWLT20K","FINAL",1,"N");
	} else {
	if(feeExists("SWLT20K") == true) removeFee("SWLT20K","FINAL");
	}
`^
CMN;Permitting!Engineering!StormWaterManagement!Addn20kImperviousArea;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['TYPE OF PERMIT.Total New and Replaced Impervious Area Noted Above'] != null) {
	if(feeExists("SWA20K", "NEW", "INVOICED") == false) updateFee("SWA20K","ENGSWA20K","FINAL",1,"N");
	} else {
	if(feeExists("SWA20K") == true) removeFee("SWA20K","FINAL");
	}
`^
CMN;Permitting!Engineering!StormWaterManagement!HighRskExcCapPerAdmAuth;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['TYPE OF PERMIT.Total New and Replaced Impervious Area Noted Above'] != null) {
	if(feeExists("SWHREC", "NEW", "INVOICED") == false) updateFee("SWHREC","ENGSWHREC","FINAL",1,"N");
	} else {
	if(feeExists("SWHREC") == true) removeFee("SWHREC","FINAL");
	}
`^
CMN;Permitting!Engineering!StormWaterManagement!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if(feeExists("SWLT20KA", "NEW", "INVOICED") == false) updateFee("SWLT20KA","ENGSWLT20K","FINAL",1,"N");
if (AInfo['TYPE OF PERMIT.New Impervious Area (Outside footprint of existing impervious area)'] > 0) {
	if(feeExists("SWLT20K", "NEW", "INVOICED") == false) updateFee("SWLT20K","ENGSWLT20K","FINAL",1,"N");
	} else {
	if(feeExists("SWLT20K") == true) removeFee("SWLT20K","FINAL");
	}

if (AInfo['TYPE OF PERMIT.Redeveloped Impervious Area (inside original impervious footprint)'] > 0) {
	if(feeExists("RIAFEE", "NEW", "INVOICED") == false) updateFee("RIAFEE","ENGSWLT20K","FINAL",1,"N");
	} else {
	if(feeExists("RIAFEE") == true) removeFee("RIAFEE","FINAL");
	}
`^
CMN;Permitting!Engineering!StormWaterManagement!NewSt20kImpvsNoPlatCSM;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['TYPE OF PERMIT.Total New and Replaced Impervious Area Noted Above'] != null) {
	if(feeExists("SWNS20K", "NEW", "INVOICED") == false) updateFee("SWNS20K","ENGSWNS20K","FINAL",1,"N");
	} else {
	if(feeExists("SWNS20K") == true) removeFee("SWNS20K","FINAL");
	}
`^
CMN;Permitting!Engineering!StormWaterManagement!Redevelopment;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['TYPE OF PERMIT.Total New and Replaced Impervious Area Noted Above'] != null) {
	if(feeExists("SWRDEV", "NEW", "INVOICED") == false) updateFee("SWRDEV","ENGSWRDEV","FINAL",1,"N");
	} else {
	if(feeExists("SWRDEV") == true) removeFee("SWRDEV","FINAL");
	}
`^
CMN;Permitting!Engineering!StormWaterManagement!SubdivisionPlatCSM;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['TYPE OF PERMIT.Total New and Replaced Impervious Area Noted Above'] != null) {
	if(feeExists("SWSBDV", "NEW", "INVOICED") == false) updateFee("SWSBDV","ENGSWSBDV","FINAL",1,"N");
	} else {
	if(feeExists("SWSBDV") == true) removeFee("SWSBDV","FINAL");
	}
`^
CMN;Permitting!Engineering!Street Occupancy!NA;BiEmail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
emailSubject = "Street Occupancy Permit Review Required" + capId + "";
emailBody = "Please be advised that Street Occupancy Permit " + capId + "has been applied for and requires your review.";
email("mvanerem@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailBody);
email("aharper@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailBody);
`^
CMN;Permitting!Engineering!Street Occupancy!NA;ErocEmail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
emailSubject = "Street Occupancy Permit Review Required" + capId + "";
emailBody = "Please be advised that Street Occupancy Permit " + capId + "has been applied for and requires your review.";
email("ttroester@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailBody);
email("jbenedict@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailBody);
`^
CMN;Permitting!Engineering!Street Occupancy!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL INFORMATION.Days of Occupancy Requested'] != null) {
	variable1 = Math.ceil(AInfo['GENERAL INFORMATION.Length of Occupancy Requested']!100) ~ Math.ceil(AInfo['GENERAL INFORMATION.Days of Occupancy Requested']!30);
	updateFee("STROCCPMT","ENGSTROCC","FINAL",variable1,"N");
	} else {
	if(feeExists("STROCCPMT") == true) removeFee("STROCCPMT","FINAL");
	}
`^
CMN;Permitting!Engineering!Street Occupancy!NA;ForestryEmail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
emailSubject = "Street Occupancy Permit Review Required" + capId + "";
emailBody = "Please be advised that Street Occupancy Permit " + capId + "has been applied for and requires your review.";
email("meddy@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailBody);
email("dkahl@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailBody);
`^
CMN;Permitting!Engineering!Street Terrace!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (AInfo['PROJECT INFORMATION.Has work started without taking out a permit?'] == "Yes") {
	updateFee("PENALTY","ENGSTRTERR","FINAL",1,"N");
	} else {
	removeFee("PENALTY","FINAL");
	}

if (genAppFee) {
	updateFee("STRTERRACE","ENGSTRTERR","FINAL",1,"Y");
	}
`^
CMN;Permitting!Engineering!TemporarySign!~;FutureInsp^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfStatus == "Issue" && wfTask == "Issuance") {
	scheduleInspectDate("Initial Inspection",nextWorkDay(dateAdd(AInfo['Permit Expiration Date'],1)));
	}
`^
CMN;Permitting!Engineering;Inspection;Citation^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
citationNo = Number(lookup("CitationSeq","ENLastNbr"));
citationSeries = lookup("CitationSeq","ENSeries");
citationNo = citationNo + 1;
editLookup("CitationSeq","ENLastNbr",citationNo.toString());
editTaskSpecific("Inspection","Citation Number",citationSeries + Right(("00000" + citationNo.toString()),5) );
`^
CMN;Permitting!Fire!~!~;AlarmSprinklerPlansRequiredCheck^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var cbACA = true;
var bStatePlans = false;
if (cap.isCreatedByACA() == false) {
	cbACA = false;
	}

if (cbACA && appMatch("Permitting!Fire!Alarm!NA") && AInfo['PROJECT INFORMATION.State Approved Plans?'] == "CHECKED") {
	bStatePlans = true;
	}

if (cbACA && appMatch("Permitting!Fire!Sprinkler!NA") && AInfo['PROJECT INFORMATION.State Approved Plans'] == "CHECKED") {
	bStatePlans = true;
	}

if (cbACA && bStatePlans && isTaskActive("Intake", "FIRSPRNK") && (appMatch("Permitting!Fire!Alarm!NA") || appMatch("Permitting!Fire!Sprinkler!NA"))) {
	closeTask("Intake", "Submittal Accepted for Review", "Progressed to Plan Review automatically because payment made and has State Approved Plans.", "", "FIRSPRNK");
	editTaskDueDate("~",dateAdd(null,5));
	}

if (cbACA && !bStatePlans && appMatch("Permitting!Fire!Alarm!NA") && isTaskActive("Intake", "FIRSPRNK") && AInfo['PROJECT INFORMATION.Project Area'] <= 0 && AInfo['PROJECT INFORMATION.New DACT Only?'] != "CHECKED") {
	closeTask("Intake", "Submittal Accepted for Review", "Progressed to Plan Review automatically because payment made and no plans required", "", "FIRSPRNK");
	editTaskDueDate("~",dateAdd(null,5));
	}

if (cbACA && !bStatePlans && appMatch("Permitting!Fire!Sprinkler!NA") && isTaskActive("Intake", "FIRSPRNK") && AInfo['PROJECT INFORMATION.Project Area'] <= 0 && AInfo['PROJECT INFORMATION.New Fire Pump'] != "CHECKED" && AInfo['PROJECT INFORMATION.New Backflow Prevention Valve'] != "CHECKED" && AInfo['PROJECT INFORMATION.Private Fire Hydrant!Main'] != "CHECKED") {
	closeTask("Intake", "Submittal Accepted for Review", "Progressed to Plan Review automatically because payment made and no plans required", "", "FIRSPRNK");
	editTaskDueDate("~",dateAdd(null,5));
	}

if (cbACA && isTaskActive("Intake", "FIRSPRNK") && (appMatch("Permitting!Fire!Alarm!NA") || appMatch("Permitting!Fire!Sprinkler!NA"))) {
	updateTask("Intake", "Payment Rec'd;
	Plan Pending", "Updated by PRA script after online payment received.", "");
	}

if (updateAppStatus("Payment rec’d, Pending Plan Submittal", "Updated due to payment received");) {
	}
`^
CMN;Permitting!Fire!~!~;InspectionCompletion^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (inspResult == "Reinspection Failed" && countIdenticalInspections() > 1) {
	addFee("PITE","FIRELEV","FINAL",1,"Y");
	}
`^
CMN;Permitting!Fire!~!~;InspectionStatused^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (inspResult == "Failed") {
	addFeeWithExtraData("REINSP","FIRALSYS","FINAL",1,"Y",capId,inspId);
	aa.set.add("FPREINSP",capId);
	}

if (inspResult == "Revision Resubmittal") {
	activateTask("Intake");
	}

if (inspResult == "Approved" && inspType.toUpperCase() == "FINAL") {
	closeTask("Fire Inspection", "Final Approval", "Updated by Fire Permit inspectionStatused script","");
	}
`^
CMN;Permitting!Fire!~!~;KitchenHoodPlansRequiredCheck^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var cbACA = true;
var bStatePlans = false;
if (cap.isCreatedByACA() == false) {
	cbACA = false;
	}

if (cbACA && isTaskActive("Intake", "FIRSPRNK")) {
	updateTask("Intake", "Payment Rec'd;
	Plan Pending", "Updated by PRA script after online payment received.", "");
	}

if (updateAppStatus("Payment rec’d, Pending Plan Submittal", "Updated due to payment received");) {
	}
`^
CMN;Permitting!Fire!~!~;PlanReviewAutoAssign^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
logDebug("In CMN;Permitting!Fire!~!~;PlanReviewAutoAssign.");
if (validateGisObjects() == undefined) {
	copyParcelGisObjects();
	}

assignTask("Plan Review", "FDAPB");
assignCap("FDAPB");
if (isTaskActive("Plan Review") == true && (appMatch("Permitting!Fire!SmokeControlPanels!NA") || appMatch("Permitting!Fire!FireCommandCenter!NA") || appMatch("Permitting!Fire!ControlledEgress!NA") )) {
	assignTask("Plan Review", "FDWDS");
	assignCap("FDWDS");
	}

if (validateGisObjects() && (isTaskActive("Plan Review") == true) && appMatch("Permitting!Fire!HighPiledStorage!NA")) {
	var varInsp = getGISInfo("agis_madison","Fire Inspect Dist","UserID");
	if(varInsp != undefined) assignTask("Plan Review",varInsp.toUpperCase());
	if(varInsp != undefined) assignCap(varInsp.toUpperCase());
	if(varInsp != undefined) userId = varInsp.toUpperCase();
	}

if ((isTaskActive("Plan Review") == true) && appMatch("Permitting!Fire!KitchenHood!NA") && (AInfo['SCOPE OF WORK.New Kitchen Hood Extinguishing System - Enter 1'] > 0 ||AInfo['SCOPE OF WORK.Alter Kitchen Hood Extinguishing System - Enter 1'] > 0 )) {
	var varInsp = "FDSAS";
	assignTask("Plan Review",varInsp);
	assignCap(varInsp);
	userId = varInsp;
	}

if ((isTaskActive("Plan Review") == true) && appMatch("Permitting!Fire!KitchenHood!NA") && (AInfo['SCOPE OF WORK.Repair to Kitchen Hood Extinguishing System - Enter 1'] > 0)) {
	var varInsp = "FDJRS";
	assignTask("Plan Review",varInsp);
	assignCap(varInsp);
	userId = varInsp;
	}

if (isTaskActive("Plan Review") == true && appMatch("Permitting!Fire!AltFireSuppression!NA") && (AInfo['SCOPE OF WORK.New Alternate Fire Suppression System - Enter 1'] > 0 ||AInfo['SCOPE OF WORK.Alter Alternate Fire Suppression System - Enter 1'] > 0 )) {
	var varInsp = "FDWDS";
	assignTask("Plan Review",varInsp);
	assignCap(varInsp);
	userId = varInsp;
	}

if (isTaskActive("Plan Review") == true && appMatch("Permitting!Fire!AltFireSuppression!NA") && (AInfo['SCOPE OF WORK.Repair to Alternate Fire Supp System - Enter 1'] > 0 )) {
	var varInsp = "FDJRS";
	assignTask("Plan Review",varInsp);
	assignCap(varInsp);
	userId = varInsp;
	}

if (isTaskActive("Plan Review") == true && appMatch("Permitting!Fire!Standpipe!NA") && (AInfo['SCOPE OF WORK.New Standpipe Project - Enter 1'] > 0 )) {
	var varInsp = "FDWDS";
	assignTask("Plan Review",varInsp);
	assignCap(varInsp);
	userId = varInsp;
	}

if (isTaskActive("Plan Review") == true && appMatch("Permitting!Fire!Standpipe!NA") && (AInfo['SCOPE OF WORK.Alter Standpipe Project - Enter 1'] > 0 )) {
	var varInsp = "FDBFK";
	assignTask("Plan Review",varInsp);
	assignCap(varInsp);
	userId = varInsp;
	}

if (isTaskActive("Plan Review") == true && appMatch("Permitting!Fire!Standpipe!NA") && (AInfo['SCOPE OF WORK.Repair to Existing Standpipe - Enter 1'] > 0 )) {
	var varInsp = "FDJRS";
	assignTask("Plan Review",varInsp);
	assignCap(varInsp);
	userId = varInsp;
	}

if (isTaskActive("Plan Review") == true && appMatch("Permitting!Fire!SmokeHeatVents!NA") && (AInfo['SCOPE OF WORK.New Smoke and Heat Vent - Enter 1'] > 0 )) {
	var varInsp = "FDWDS";
	assignTask("Plan Review",varInsp);
	assignCap(varInsp);
	userId = varInsp;
	}

if (isTaskActive("Plan Review") == true && appMatch("Permitting!Fire!SmokeHeatVents!NA") && (AInfo['SCOPE OF WORK.Alter Smoke and Heat Vent - Enter 1'] > 0 ||AInfo['SCOPE OF WORK. Repair to Smoke and Heat Vent - Enter 1'] > 0 )) {
	var varInsp = "FDJRS";
	assignTask("Plan Review",varInsp);
	assignCap(varInsp);
	userId = varInsp;
	}

if ((isTaskActive("Plan Review") == true && appMatch("Permitting!Fire!Alarm!NA") && AInfo['PROJECT INFORMATION.Project Area'] <= 0 && AInfo['PROJECT INFORMATION.New DACT Only?'] == "CHECKED")) {
	var varInsp = "FDJRS";
	assignTask("Plan Review",varInsp);
	assignCap(varInsp);
	userId = varInsp;
	}

if ((isTaskActive("Plan Review") == true && appMatch("Permitting!Fire!Alarm!NA") && AInfo['PROJECT INFORMATION.Project Area'] <= 0 && AInfo['PROJECT INFORMATION.New DACT Only?'] != "CHECKED")) {
	var varInsp = "FDJRS";
	assignTask("Plan Review",varInsp);
	assignCap(varInsp);
	userId = varInsp;
	}

if ((isTaskActive("Plan Review") == true && appMatch("Permitting!Fire!Sprinkler!NA") && AInfo['PROJECT INFORMATION.Project Area'] <= 0 && (AInfo['PROJECT INFORMATION.New Fire Pump'] == "CHECKED" || AInfo['PROJECT INFORMATION.New Backflow Prevention Valve'] == "CHECKED"))) {
	var varInsp = "FDWDS";
	assignTask("Plan Review",varInsp);
	assignCap(varInsp);
	userId = varInsp;
	}

if ((isTaskActive("Plan Review") == true && appMatch("Permitting!Fire!Sprinkler!NA") && AInfo['PROJECT INFORMATION.Project Area'] <= 0 && (AInfo['PROJECT INFORMATION.New Fire Pump'] != "CHECKED" && AInfo['PROJECT INFORMATION.New Backflow Prevention Valve'] != "CHECKED" && AInfo['PROJECT INFORMATION.Private Fire Hydrant!Main'] != "CHECKED"))) {
	var varInsp = "FDJRS";
	assignTask("Plan Review",varInsp);
	assignCap(varInsp);
	userId = varInsp;
	}

if ((isTaskActive("Plan Review") == true && appMatch("Permitting!Fire!Alarm!NA") && balanceDue <= 0 && AInfo['PROJECT INFORMATION.State Approved Plans?'] == "CHECKED")) {
	var varInsp = "FDJRS";
	assignTask("Plan Review",varInsp);
	assignCap(varInsp);
	userId = varInsp;
	}

if ((isTaskActive("Plan Review") == true && appMatch("Permitting!Fire!Sprinkler!NA") && balanceDue <= 0 && AInfo['PROJECT INFORMATION.State Approved Plans'] == "CHECKED")) {
	var varInsp = "FDJRS";
	assignTask("Plan Review",varInsp);
	assignCap(varInsp);
	userId = varInsp;
	}
`^
CMN;Permitting!Fire!~!~;Schedule Reinspection^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
cd = aa.cap.getCapDetail(capId).getOutput().getCapDetailModel();
capAsgnStaff = cd.getAsgnStaff();
capAsgnDept = cd.getAsgnDept();
if ((inspType == "Routine" || inspType == "Special") && inspResult == "Written Orders") {
	scheduleInspectDateGroup(inspGroup,"Reinspection",nextWorkDay(dateAdd(null,30)),capAsgnStaff);
	aa.set.add("FPWRITTEN",capId);
	}

if ((inspType == "Routine" || inspType == "Special") && inspResult == "Verbal Orders") {
	aa.set.add("FPVERBAL",capId);
	}

if (inspType != "Routine" && inspType != "Special") {
	var varInsp = getGISInfo("agis_madison","Fire Inspect Dist","UserID");
	if(varInsp != undefined) userId = varInsp.toUpperCase();
	}

if ((inspType == "Reinspection" || inspType == "10 Day Notice Reinspection" || inspType == "Prevention Reinspection") && inspResult == "Not Corrected") {
	scheduleInspectDateGroup(inspGroup,"Prevention Review",nextWorkDay(dateAdd(null,1)),userId);
	include("EML;AssignInspectorNoASI");
	}

if (inspType == "Prevention Review" && inspResult == "Re-Issue Orders") {
	scheduleInspectDateGroup(inspGroup,"Prevention Reinspection",nextWorkDay(dateAdd(null,30)),userId);
	aa.set.add("FPWRITTEN",capId);
	}

if (inspType == "Prevention Review" && inspResult == "10 Day Notice") {
	scheduleInspectDateGroup(inspGroup,"10 Day Notice Reinspection",nextWorkDay(dateAdd(null,10)),userId);
	addFeeWithExtraData("CEFIRREINSP","CEFIR","FINAL",1,"Y",capId,inspId);
	aa.set.add("FPREINSP",capId);
	aa.set.add("FP10DAY",capId);
	}
`^
CMN;Permitting!Fire!AccessControlEgress!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['Resubmission of Previously Approved Plans?'] == "CHECKED") {
	if(feeExists("RESUBPAP") == false) updateFee("RESUBPAP","FIRACCEGR","FINAL",1,"N");
	} else {
	if(feeExists("RESUBPAP") == true) removeFee("RESUBPAP","FINAL");
	}
`^
CMN;Permitting!Fire!Alarm!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (parseInt(AInfo['PROJECT INFORMATION.Project Area']) > 0 && AInfo['PROJECT INFORMATION.State Approved Plans?'] != "CHECKED") {
	if(feeExists("PAWOSAP") == false) updateFee("PAWOSAP","FIRALSYS","FINAL",parseInt(AInfo['PROJECT INFORMATION.Project Area']),"N");
	} else {
	if(feeExists("PAWOSAP") == true) removeFee("PAWOSAP","FINAL");
	}

if (parseInt(AInfo['PROJECT INFORMATION.Project Area']) > 0 && AInfo['PROJECT INFORMATION.State Approved Plans?'] == "CHECKED") {
	if(feeExists("PAWSAP") == false) updateFee("PAWSAP","FIRALSYS","FINAL",parseInt(AInfo['PROJECT INFORMATION.Project Area']),"N");
	} else {
	if(feeExists("PAWSAP") == true) removeFee("PAWSAP","FINAL");
	}

if (AInfo['PROJECT INFORMATION.Revision to Previously Approved Plans?'] == "CHECKED") {
	if(feeExists("RESUBPAP") == false) updateFee("RESUBPAP","FIRALSYS","FINAL",1,"N");
	} else {
	if(feeExists("RESUBPAP") == true) removeFee("RESUBPAP","FINAL");
	}

if (AInfo['PROJECT INFORMATION.Resubmission of Previously Denied Plans?'] == "CHECKED" && ( AInfo['PROJECT INFORMATION.Project Area'] >0 && AInfo['PROJECT INFORMATION.Project Area'] != null)) {
	if(feeExists("RESUBPRP") == false) updateFee("RESUBPRP","FIRALSYS","FINAL",1,"N");
	} else {
	if(feeExists("RESUBPRP") == true) removeFee("RESUBPRP","FINAL");
	}

if (AInfo['PROJECT INFORMATION.Fire Alarm Control Panel or DACT Replacement Only?'] == "CHECKED") {
	if(feeExists("FACU") == false) updateFee("FACU","FIRALSYS","FINAL",1,"N");
	} else {
	if(feeExists("FACU") == true) removeFee("FACU","FINAL");
	}

if (AInfo['PROJECT INFORMATION.New DACT Only?']== "CHECKED" || AInfo['PROJECT INFORMATION.Alter DACT Only?']== "CHECKED") {
	if(feeExists("INDACT") == false) updateFee("INDACT","FIRALSYS","FINAL",1,"N");
	} else {
	if(feeExists("INDACT") == true) removeFee("INDACT","FINAL");
	}

if (AInfo['PROJECT INFORMATION.Alter Fire Alarm Control Panel'] == "CHECKED") {
	if(feeExists("ADACT") == false) updateFee("ADACT","FIRALSYS","FINAL",1,"N");
	} else {
	if(feeExists("ADACT") == true) removeFee("ADACT","FINAL");
	}

if (AInfo['PROJECT INFORMATION.Replacement of 3+ Fire Alarm Devices?'] == "CHECKED") {
	if(feeExists("FAID") == false) updateFee("FAID","FIRALSYS","FINAL",1,"N");
	} else {
	if(feeExists("FAID") == true) removeFee("FAID","FINAL");
	}

if (AInfo['PROJECT INFORMATION.Alter 3 or Less Fire Alarm Devices?'] == "CHECKED") {
	if(feeExists("FILD") == false) updateFee("FILD","FIRALSYS","FINAL",1,"N");
	} else {
	if(feeExists("FILD") == true) removeFee("FILD","FINAL");
	}

if (AInfo['PROJECT INFORMATION.New Fire Detection Device that Actuates Fire Doors?'] == "CHECKED" || AInfo['PROJECT INFORMATION.Alter Fire Detection Device that Actuates Fire Doors?'] == "CHECKED") {
	if(feeExists("NFDD") == false) updateFee("NFDD","FIRALSYS","FINAL",1,"N");
	} else {
	if(feeExists("NFDD") == true) removeFee("NFDD","FINAL");
	}

if (AInfo['PROJECT INFORMATION.Replace Fire Detection Device that Actuates Fire Doors?'] == "CHECKED") {
	if(feeExists("RFDD") == false) updateFee("RFDD","FIRALSYS","FINAL",1,"N");
	} else {
	if(feeExists("RFDD") == true) removeFee("RFDD","FINAL");
	}

if (AInfo['PROJECT INFORMATION.Demolition'] == "CHECKED") {
	if(feeExists("DEMO") == false) updateFee("DEMO","FIRALSYS","FINAL",1,"N");
	} else {
	if(feeExists("DEMO") == true) removeFee("DEMO","FINAL");
	}

if (AInfo['PROJECT INFORMATION.Has Installation of Fire Protection System Started Yet?'] == "Yes") {
	if(feeExists("PENALTY") == false) updateFee("PENALTY","FIRALSYS","FINAL",1,"N");
	} else {
	if(feeExists("PENALTY") == true) removeFee("PENALTY","FINAL");
	}
`^
CMN;Permitting!Fire!AltFireSuppression!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
if (AInfo['SCOPE OF WORK.Repair to Alternate Fire Supp System'] == "CHECKED") {
	if(feeExists("ALTAFSS") == false) updateFee("ALTAFSS","FIRSUPP","FINAL",1,"N");
	} else {
	if(feeExists("ALTAFSS") == true) removeFee("ALTAFSS","FINAL");
	}

if (AInfo['SCOPE OF WORK.New Alternate Fire Suppression System'] == "CHECKED" || AInfo['SCOPE OF WORK.Alter Alternate Fire Suppression System'] == "CHECKED") {
	if(feeExists("NAFSS") == false) updateFee("NAFSS","FIRSUPP","FINAL",1,"N");
	} else {
	if(feeExists("NAFSS") == true) removeFee("NAFSS","FINAL");
	}

if (AInfo['SCOPE OF WORK.Demolition'] == "CHECKED") {
	if(feeExists("DEMO") == false) updateFee("DEMO","FIRSUPP","FINAL",1,"N");
	} else {
	if(feeExists("DEMO") == true) removeFee("DEMO","FINAL");
	}

if (AInfo['PROJECT INFORMATION.Has Installation of Fire Protection System Started Yet?'] == "Yes") {
	if(feeExists("PENALTY") == false) updateFee("PENALTY","FIRSUPP","FINAL",1,"N");
	} else {
	if(feeExists("PENALTY") == true) removeFee("PENALTY","FINAL");
	}
`^
CMN;Permitting!Fire!AltFireSuppression!NA;FeeACA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
addparcel = parcelExistsOnCap(capId) == false;
if (addparcel) {
	include("CMN;AddParcelAndOwner");
	include("EML;Permitting!Fire!~!~;FeeACA");
	}
`^
CMN;Permitting!Fire!AltFireSuppression!NA;PlansRequiredCheck^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var cbACA = true;
var bStatePlans = false;
if (cap.isCreatedByACA() == false) {
	cbACA = false;
	}

if (cbACA && isTaskActive("Intake", "FIRSPRNK")) {
	updateTask("Intake", "Payment Rec'd;
	Plan Pending", "Updated by PRA script after online payment received.", "");
	}

if (updateAppStatus("Payment rec’d, Pending Plan Submittal", "Updated due to payment received");) {
	}
`^
CMN;Permitting!Fire!BlastingNotice!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (if(feeExists("BLASTAPP") == false) updateFee("BLASTAPP","FIRBLAST","FINAL",1,"N");) {
	if(feeExists("BLASTAPP") == true) removeFee("BLASTAPP","FINAL");
	}
`^
CMN;Permitting!Fire!ControlledEgress!NA;ControlledEgressPlansRequiredCheck^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var cbACA = true;
var bStatePlans = false;
if (cap.isCreatedByACA() == false) {
	cbACA = false;
	}

if (cbACA && isTaskActive("Intake", "FIRSPRNK")) {
	updateTask("Intake", "Payment Rec'd;
	Plan Pending", "Updated by PRA script after online payment received.", "");
	}
`^
CMN;Permitting!Fire!ControlledEgress!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (AInfo['SCOPE OF WORK.New Controlled Egress'] == "CHECKED" || AInfo['SCOPE OF WORK.Alter Controlled Egress'] == "CHECKED") {
	if(feeExists("NACES") == false) updateFee("NACES","FIRCONEGR","FINAL",1,"N");
	} else {
	if(feeExists("NACES") == true) removeFee("NACES","FINAL");
	}

if (AInfo['PROJECT INFORMATION.Has Installation of Fire Protection System Started Yet?'] == "Yes") {
	if(feeExists("PENALTY") == false) updateFee("PENALTY","FIRCONEGR","FINAL",1,"N");
	} else {
	if(feeExists("PENALTY") == true) removeFee("PENALTY","FINAL");
	}
`^
CMN;Permitting!Fire!ControlledEgress!NA;FeeACA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
addparcel = parcelExistsOnCap(capId) == false;
if (addparcel) {
	include("CMN;AddParcelAndOwner");
	include("EML;Permitting!Fire!~!~;FeeACA");
	}
`^
CMN;Permitting!Fire!CoveredMall!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['TYPE OF USE.Type of Use'] != null) {
	if(feeExists("CVDMLINSP") == false) updateFee("CVDMLINSP","FIRCVDMAL","FINAL",1,"N");
	} else {
	if(feeExists("CVDMLINSP") == true) removeFee("CVDMLINSP","FINAL");
	}
`^
CMN;Permitting!Fire!DelayedEgress!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['SCOPE OF WORK.New Delayed Egress System - Enter 1'] != null) {
	if(feeExists("NDES") == false) updateFee("NDES","FIRDELEGG","FINAL",1,"N");
	} else {
	if(feeExists("NDES") == true) removeFee("NDES","FINAL");
	}

if (AInfo['PROJECT INFORMATION.Resubmission of Previously Approved Plans – Enter 1'] != null) {
	if(feeExists("RESUBPAP") == false) updateFee("RESUBPAP","FIRDELEGG","FINAL",1,"N");
	} else {
	if(feeExists("RESUBPAP") == true) removeFee("RESUBPAP","FINAL");
	}
`^
CMN;Permitting!Fire!Elevator!~;Conveyance^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['Application Type'] == "Alt or Repair of Chair Lift") {
	addFee("PRRDMWTR","FIRELEV", "FINAL", 1 , "N");
	addFee("INRDMWTR", "FIRELEV", "FINAL", 1 , "N");
	addFee("PTO","FIRELEV","FINAL", 1 ,"N");
	}

if (AInfo['Application Type'] == "Alt or Repair of Dumbwaiter") {
	addFee("PRRDMWTR","FIRELEV", "FINAL",  1  , "N");
	addFee("INRDMWTR", "FIRELEV","FINAL", 1 , "N");
	addFee("PTO","FIRELEV","FINAL", 1 ,"N");
	}

if (AInfo['Application Type'] == "Alt or Repair of Escalator") {
	addFee("PRRESCMOV","FIRELEV", "FINAL",  1  , "N");
	addFee("INRESCMOV", "FIRELEV","FINAL", 1 , "N");
	addFee("PTO","FIRELEV","FINAL", 1 ,"N");
	}

if (AInfo['Application Type'] == "Alt or Repair of Hydraulic Elevator") {
	addFee("PRRIHE","FIRELEV", "FINAL",  1  , "N");
	addFee("INRIHE", "FIRELEV","FINAL", 1 , "N");
	addFee("PTO","FIRELEV","FINAL", 1 ,"N");
	}

if (AInfo['Application Type'] == "Alt or Repair of Moving Sidewalk") {
	addFee("PRRESCMOV","FIRELEV", "FINAL",  1  , "N");
	addFee("INRESCMOV", "FIRELEV","FINAL", 1 , "N");
	addFee("PTO","FIRELEV","FINAL", 1 ,"N");
	}

if (AInfo['Application Type'] == "Alt or Repair of Other Elev Drv Mach") {
	addFee("PRRITE","FIRELEV", "FINAL",  1  , "N");
	addFee("INRITE", "FIRELEV","FINAL", 1 , "N");
	addFee("PTO","FIRELEV","FINAL", 1 ,"N");
	}

if (AInfo['Application Type'] == "Alt or Repair of Platform Lift") {
	addFee("PRRDMWTR","FIRELEV", "FINAL",  1  , "N");
	addFee("INRDMWTR", "FIRELEV","FINAL", 1 , "N");
	addFee("PTO","FIRELEV","FINAL", 1 ,"N");
	}

if (AInfo['Application Type'] == "Alt or Repair of Special App Elev") {
	addFee("PRRDMWTR","FIRELEV", "FINAL",  1  , "N");
	addFee("INRDMWTR", "FIRELEV","FINAL", 1 , "N");
	addFee("PTO","FIRELEV","FINAL", 1 ,"N");
	}

if (AInfo['Application Type'] == "Alt or Repair of Traction Elevator") {
	addFee("PRRITE","FIRELEV", "FINAL",  1  , "N");
	addFee("INRITE", "FIRELEV","FINAL", 1 , "N");
	addFee("PTO","FIRELEV","FINAL", 1 ,"N");
	}

if (AInfo['Application Type'] == "New Escalator") {
	addFee("PRNESCMOV","FIRELEV", "FINAL", 1 , "N");
	addFee("INNESCMOV", "FIRELEV","FINAL", 1 , "N");
	addFee("PTO","FIRELEV","FINAL", 1 ,"N");
	}

if (AInfo['Application Type'] == "New Chair Lift") {
	addFee("PRNDMWTR","FIRELEV", "FINAL", 1 , "N");
	addFee("INNDMWTR", "FIRELEV","FINAL", 1 , "N");
	addFee("PTO","FIRELEV","FINAL", 1 ,"N");
	}

if (AInfo['Application Type'] == "New Dumbwaiter") {
	addFee("PRNDMWTR","FIRELEV", "FINAL", 1 , "N");
	addFee("INNDMWTR", "FIRELEV","FINAL", 1 , "N");
	addFee("PTO","FIRELEV","FINAL", 1 ,"N");
	}

if (AInfo['Application Type'] == "New Hydraulic Elevator") {
	addFee("PRNIHE","FIRELEV", "FINAL", 1 , "N");
	addFee("INNIHE", "FIRELEV","FINAL", 1 , "N");
	addFee("PTO","FIRELEV","FINAL", 1 ,"N");
	}

if (AInfo['Application Type'] == "New Inst of Other Elev Driving Mach") {
	addFee("PRNITE","FIRELEV", "FINAL", 1 , "N");
	addFee("INNITE", "FIRELEV","FINAL", 1 , "N");
	addFee("PTO","FIRELEV","FINAL", 1 ,"N");
	}

if (AInfo['Application Type'] == "New Platform Lift") {
	addFee("PRNDMWTR","FIRELEV", "FINAL", 1 , "N");
	addFee("INNDMWTR", "FIRELEV","FINAL", 1 , "N");
	addFee("PTO","FIRELEV","FINAL", 1 ,"N");
	}

if (AInfo['Application Type'] == "New Special App Elevator") {
	addFee("PRNDMWTR","FIRELEV", "FINAL", 1 , "N");
	addFee("INNDMWTR", "FIRELEV","FINAL", 1 , "N");
	addFee("PTO","FIRELEV","FINAL", 1 ,"N");
	}

if (AInfo['Application Type'] == "New Traction Elevator") {
	addFee("PRNITE","FIRELEV", "FINAL", 1 , "N");
	addFee("INNITE", "FIRELEV","FINAL", 1 , "N");
	addFee("PTO","FIRELEV","FINAL", 1 ,"N");
	}

if (AInfo['Application Type'] == "New Moving Sidewalk") {
	addFee("PRNESCMOV","FIRELEV", "FINAL", 1 , "N");
	addFee("INNESCMOV", "FIRELEV","FINAL", 1 , "N");
	addFee("PTO","FIRELEV","FINAL", 1 ,"N");
	}
`^
CMN;Permitting!Fire!Elevator!~;PTOIssued^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
inspt = "No Inspector";
if (wfStatus == "Revision Requested" && wfTask == "Inspection") {
	activateTask("Plan Review");
	}

if (wfStatus == "Notice Sent" && (wfTask == "Inspection" || wfTask == "Annual Inspection") && capStatus == "PTO Issued - Ready to Invoice") {
	updateAppStatus("PTO Issued");
	if(wfTask == "Inspection") loopTask("Inspection","Notice Sent", "","");
	}

if (wfStatus == "Notice Sent" && capStatus == "PTO Denied - Ready to Invoice") {
	updateAppStatus("Not Issued - Reinspection");
	if(wfTask == "Inspection") closeTask("Inspection","Notice Sent","","");
	else if (wfTask == "Annual Inspection") closeTask("Annual Inspection","Notice Sent","","");
	}

if (wfStatus == "Notice Sent" && wfTask == "Annual Reinspection" && capStatus == "PTO Issued - Ready to Invoice") {
	updateAppStatus("PTO Issued");
	loopTask("Annual Reinspection","Notice Sent","","");
	}

if (wfStatus == "Notice Sent" && wfTask == "Reinspection" && capStatus == "PTO Issued - Ready to Invoice") {
	updateAppStatus("PTO Issued");
	closeTask("Reinspection","Notice Sent","","");
	}
`^
CMN;Permitting!Fire!Elevator!~;ResultInspection^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var vehicleId = "";
var cd = null;
sAssignStaff = "";
vehicleId = aa.inspection.getInspection(capId, inspId).getOutput().inspection.getActivity().getVehicleID();
if (vehicleId != null && vehicleId != "") {
	updateShortNotes(vehicleId);
	}

cd = aa.cap.getCapDetail(capId).getOutput().getCapDetailModel();
if (cd != null) {
	sAssignStaff = cd.asgnStaff;
	}

if ((inspType == "Installation" || inspType == "Annual" || inspType == "Reinspection")) {
	reportName = "3. Official Notice";
	reportFile = reportViewAttachEmail(true, false, reportName);
	}

if ((inspType == "Annual" || inspType == "Reinspection") && (isTaskActive("Annual Inspection") || isTaskActive("Annual Reinspection")) && (inspResult == "No Violations Found" || inspResult == "Violations - PTO Issued")) {
	scheduleInspectDate("Annual",nextWorkDay(dateAddMonths(getAppSpecific("OFFICE USE ONLY.PTO Expiration Date"), 10)),sAssignStaff,"AM","Scheduled for Annual Inspection");
	}

if ((inspType == "Installation" || inspType == "Reinspection") &&  (isTaskActive("Inspection") || isTaskActive("Reinspection")) && (inspResult == "No Violations Found" || inspResult == "Violations - PTO Issued")) {
	scheduleInspectDate("Annual",nextWorkDay(dateAddMonths(startDate, 10)),sAssignStaff,"AM","Scheduled for Annual Inspection");
	dateAddMonths(startDate, -10);
	logDebug("startDate is;"+startDate);
	}

if ((inspType == "Annual" || (inspType == "Reinspection" && isTaskActive("Annual Reinspection"))) && (inspResult == "No Violations Found" || inspResult == "Violations - PTO Issued")) {
	if(getAppSpecific("OFFICE USE ONLY.PTO Expiration Date") != null || getAppSpecific("OFFICE USE ONLY.PTO Expiration Date") != "") editAppSpecific("OFFICE USE ONLY.PTO Expiration Date", dateAddMonths(getAppSpecific("OFFICE USE ONLY.PTO Expiration Date"), 12));
	}

if ((inspType == "Installation" || inspType == "Annual" || inspType == "Reinspection") && (inspResult == "Violations - PTO Not Issued")) {
	scheduleInspectDate("Reinspection",nextWorkDay(dateAdd(null,29)),sAssignStaff,"AM","Scheduled for "+inspType+" Inspection");
	}

if (inspType == "Installation" && inspResult == "No Violations Found") {
	updateTask("Inspection","No Violations","","Updated by Inspection Result");
	} else {
	if(inspType == "Annual" && inspResult == "No Violations Found") updateTask("Inspection", "No Violations","","Updated by Inspection Result");
	}

if (inspType == "Installation" && inspResult == "Violations - PTO Issued") {
	updateTask("Inspection","Approved with Violations","","Updated by Inspection Result");
	} else {
	if(inspType == "Annual" && inspResult == "Violations - PTO Issued") updateTask("Annual Inspection", "Approved with Violations","","Updated by Inspection Result");
	}

if (inspType == "Installation" && inspResult == "Violations - PTO Not Issued") {
	updateTask("Inspection","Violations","","Updated by Inspection Result");
	} else {
	if(inspType == "Annual" && inspResult == "Violations - PTO Not Issued") updateTask("Annual Inspection","Violations","","Updated by Inspection Result");
	}

if (inspType == "Reinspection" && isTaskActive("Reinspection") && (inspResult == "No Violations Found" || inspResult == "Violations - PTO Issued")) {
	updateTask("Reinspection", "Corrected","","Updated by Reinspection Result");
	}

if (inspType == "Reinspection" && isTaskActive("Annual Reinspection") && (inspResult == "No Violations Found" || inspResult == "Violations - PTO Issued")) {
	updateTask("Annual Reinspection", "Corrected","","Updated by Reinspection Result");
	}

if (inspType == "Reinspection" && isTaskActive("Reinspection") && inspResult == "Violations - PTO Not Issued") {
	updateTask("Reinspection", "Not Corrected", "","Updated by Reinspection Result");
	}

if (inspType == "Reinspection" && isTaskActive("Annual Reinspection") && inspResult == "Violations - PTO Not Issued") {
	updateTask("Annual Reinspection", "Not Corrected","","Updated by Reinspection Result");
	}

if ((inspType == "Installation" || (inspType == "Reinspection" && isTaskActive("Reinspection"))) && (inspResult == "No Violations Found" || inspResult == "Violations - PTO Issued")) {
	editAppSpecific("OFFICE USE ONLY.PTO Expiration Date", dateAddMonths(startDate, 12));
	}
`^
CMN;Permitting!Fire!Elevator!~;WfkFlowAnnualInsp^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
`^
CMN;Permitting!Fire!FireCommandCenter!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['PROJECT INFORMATION.New Fire Command Center - Enter 1'] !=null || AInfo['PROJECT INFORMATION.Alter Fire Command Center - Enter 1'] !=null) {
	if(feeExists("NFCOM") == false) updateFee("NFCOM","FIRCOMCTR","FINAL",1,"N");
	} else {
	if(feeExists("NFCOM") == true) removeFee("NFCOM","FINAL");
	}
`^
CMN;Permitting!Fire!HighPiledStorage!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['SCOPE OF WORK.Alt or Repair to High Piled Storage System – Enter 1'] != null) {
	if(feeExists("ALTHPSS") == false) updateFee("ALTHPSS","FIRHPS","FINAL",1,"N");
	} else {
	if(feeExists("ALTHPSS") == true) removeFee("ALTHPSS","FINAL");
	}

if (AInfo['SCOPE OF WORK.New High Piled Storage System - Enter 1'] != null || AInfo['SCOPE OF WORK.Alter High Piled Storage System - Enter 1'] != null) {
	if(feeExists("NHPSS") == false) updateFee("NHPSS","FIRHPS","FINAL",1,"N");
	} else {
	if(feeExists("NHPSS") == true) removeFee("NHPSS","FINAL");
	}
`^
CMN;Permitting!Fire!KitchenHood!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
if (AInfo['SCOPE OF WORK.New Kitchen Hood Extinguishing System'] == "CHECKED"  || AInfo['SCOPE OF WORK.Alter Kitchen Hood Extinguishing System'] == "CHECKED") {
	if(feeExists("NKHES") == false) updateFee("NKHES","FIRKHD","FINAL",1,"N");
	} else {
	if(feeExists("NKHES") == true) removeFee("NKHES","FINAL");
	}

if (AInfo['SCOPE OF WORK.Repair to Kitchen Hood Extinguishing System'] == "CHECKED") {
	if(feeExists("ALTKHES") == false) updateFee("ALTKHES","FIRKHD","FINAL",1,"N");
	} else {
	if(feeExists("ALTKHES") == true) removeFee("ALTKHES","FINAL");
	}

if (AInfo['SCOPE OF WORK.Demolition'] == "CHECKED") {
	if(feeExists("DEMO") == false) updateFee("DEMO","FIRKHD","FINAL",1,"N");
	} else {
	if(feeExists("DEMO") == true) removeFee("DEMO","FINAL");
	}

if (AInfo['PROJECT INFORMATION.Has Installation of Fire Protection System Started Yet?'] == "Yes") {
	if(feeExists("PENALTY") == false) updateFee("PENALTY","FIRKHD","FINAL",1,"N");
	} else {
	if(feeExists("PENALTY") == true) removeFee("PENALTY","FINAL");
	}
`^
CMN;Permitting!Fire!KitchenHood!NA;FeeACA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
addparcel = parcelExistsOnCap(capId) == false;
if (addparcel) {
	include("CMN;AddParcelAndOwner");
	}

if (include("EML;Permitting!Fire!~!~;FeeACA");) {
	}
`^
CMN;Permitting!Fire!SmokeControlPanels!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['SCOPE OF WORK.Repair Smoke Control Panel - Enter 1'] != null) {
	if(feeExists("ALTSCP") == false) updateFee("ALTSCP","FIRSMCTRPNL","FINAL",1,"N");
	} else {
	if(feeExists("ALTSCP") == true) removeFee("ALTSCP","FINAL");
	}

if (AInfo['SCOPE OF WORK.New Smoke Control Panel - Enter 1'] != null || AInfo['SCOPE OF WORK.Alter Smoke Control Panel - Enter 1'] != null) {
	if(feeExists("NSCP") == false) updateFee("NSCP","FIRSMCTRPNL","FINAL",1,"N");
	} else {
	if(feeExists("NSCP") == true) removeFee("NSCP","FINAL");
	}

if (AInfo['PROJECT INFORMATION.Has Installation of Fire Protection System Started Yet?'] == "Yes") {
	if(feeExists("PENALTY") == false) updateFee("PENALTY","FIRSMCTRPNL","FINAL",1,"N");
	} else {
	if(feeExists("PENALTY") == true) removeFee("PENALTY","FINAL");
	}
`^
CMN;Permitting!Fire!SmokeHeatVents!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['SCOPE OF WORK.Repair to Smoke and Heat Vent - Enter 1'] != null) {
	if(feeExists("ALTSHV") == false) updateFee("ALTSHV","FIRSMHTV","FINAL",1,"N");
	} else {
	if(feeExists("ALTSHV") == true) removeFee("ALTSHV","FINAL");
	}

if (AInfo['SCOPE OF WORK.New Smoke and Heat Vent - Enter 1'] != null || AInfo['SCOPE OF WORK.Alter Smoke and Heat Vent - Enter 1'] != null) {
	if(feeExists("NSHV") == false) updateFee("NSHV","FIRSMHTV","FINAL",1,"N");
	} else {
	if(feeExists("NSHV") == true) removeFee("NSHV","FINAL");
	}

if (AInfo['SCOPE OF WORK.Demolition'] == "CHECKED") {
	if(feeExists("DEMO") == false) updateFee("DEMO","FIRSMHTV","FINAL",1,"N");
	} else {
	if(feeExists("DEMO") == true) removeFee("DEMO","FINAL");
	}

if (AInfo['PROJECT INFORMATION.Has Installation of Fire Protection System Started Yet?'] == "Yes") {
	if(feeExists("PENALTY") == false) updateFee("PENALTY","FIRSMHTV","FINAL",1,"N");
	} else {
	if(feeExists("PENALTY") == true) removeFee("PENALTY","FINAL");
	}
`^
CMN;Permitting!Fire!Sprinkler!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['PROJECT INFORMATION.Project Area'] > 0 && AInfo['PROJECT INFORMATION.State Approved Plans'] != "CHECKED") {
	if(feeExists("PAWOSAP") == false) updateFee("PAWOSAP","FIRSPRNK","FINAL",1,"N");
	} else {
	if(feeExists("PAWOSAP") == true) removeFee("PAWOSAP","FINAL");
	}

if (AInfo['PROJECT INFORMATION.Project Area'] > 0 && AInfo['PROJECT INFORMATION.State Approved Plans'] == "CHECKED") {
	if(feeExists("PAWSAP") == false) updateFee("PAWSAP","FIRSPRNK","FINAL",1,"N");
	} else {
	if(feeExists("PAWSAP") == true) removeFee("PAWSAP","FINAL");
	}

if (AInfo['PROJECT INFORMATION.Revision to Previously Approved Plans'] == "CHECKED") {
	if(feeExists("RESUBPAP") == false) updateFee("RESUBPAP","FIRSPRNK","FINAL",1,"N");
	} else {
	if(feeExists("RESUBPAP") == true) removeFee("RESUBPAP","FINAL");
	}

if (AInfo['PROJECT INFORMATION.Resubmission of Previously Denied Plans'] == "CHECKED" && (AInfo['PROJECT INFORMATION.Project Area'] != null && AInfo['PROJECT INFORMATION.Project Area'] >0)) {
	if(feeExists("RESUBPRP") == false) updateFee("RESUBPRP","FIRSPRNK","FINAL",1,"N");
	} else {
	if(feeExists("RESUBPRP") == true) removeFee("RESUBPRP","FINAL");
	}

if (AInfo['PROJECT INFORMATION.Alter Existing Sprinkler System - 20 Heads or Less'] == "CHECKED") {
	if(feeExists("SPSYSALT") == false) updateFee("SPSYSALT","FIRSPRNK","FINAL",1,"N");
	} else {
	if(feeExists("SPSYSALT") == true) removeFee("SPSYSALT","FINAL");
	}

if (AInfo['PROJECT INFORMATION.Replace 3+ Sprinkler Heads or Nozzles']== "CHECKED") {
	if(feeExists("SPRHDREP") == false) updateFee("SPRHDREP","FIRSPRNK","FINAL",1,"N");
	} else {
	if(feeExists("SPRHDREP") == true) removeFee("SPRHDREP","FINAL");
	}

if (AInfo['PROJECT INFORMATION.Replace Dry Pipe Pre-Action, Deluge Valve or Similar Only'] == "CHECKED") {
	if(feeExists("DRYPIPE") == false) updateFee("DRYPIPE","FIRSPRNK","FINAL",1,"N");
	} else {
	if(feeExists("DRYPIPE") == true) removeFee("DRYPIPE","FINAL");
	}

if (AInfo['PROJECT INFORMATION.New Fire Pump'] == "CHECKED" || AInfo['PROJECT INFORMATION.Alter Fire Pump'] == "CHECKED") {
	if(feeExists("FPSI") == false) updateFee("FPSI","FIRSPRNK","FINAL",1,"N");
	} else {
	if(feeExists("FPSI") == true) removeFee("FPSI","FINAL");
	}

if (AInfo['PROJECT INFORMATION.New Backflow Prevention Valve'] == "CHECKED" || AInfo['PROJECT INFORMATION.Alter Backflow Prevention Valve'] == "CHECKED") {
	if(feeExists("BFPVNEW") == false) updateFee("BFPVNEW","FIRSPRNK","FINAL",1,"N");
	} else {
	if(feeExists("BFPVNEW") == true) removeFee("BFPVNEW","FINAL");
	}

if (AInfo['PROJECT INFORMATION.Replace Backflow Prevention Valve'] == "CHECKED") {
	if(feeExists("BFPVALT") == false) updateFee("BFPVALT","FIRSPRNK","FINAL",1,"N");
	} else {
	if(feeExists("BFPVALT") == true) removeFee("BFPVALT","FINAL");
	}

if (AInfo['PROJECT INFORMATION.Replace Fire Pump'] == "CHECKED") {
	if(feeExists("FPSREP") == false) updateFee("FPSREP","FIRSPRNK","FINAL",1,"N");
	} else {
	if(feeExists("FPSREP") == true) removeFee("FPSREP","FINAL");
	}

if (AInfo['PROJECT INFORMATION.Demolition'] == "CHECKED") {
	if(feeExists("DEMO") == false) updateFee("DEMO","FIRSPRNK","FINAL",1,"N");
	} else {
	if(feeExists("DEMO") == true) removeFee("DEMO","FINAL");
	}

if (AInfo['PROJECT INFORMATION.Private Fire Hydrant!Main'] == "CHECKED") {
	if(feeExists("PRIVHYMN") == false) updateFee("PRIVHYMN","FIRSPRNK","FINAL",1,"N");
	} else {
	if(feeExists("PRIVHYMN") == true) removeFee("PRIVHYMN","FINAL");
	}

if (AInfo['PROJECT INFORMATION.Has Installation of Fire Protection System Started Yet?'] == "Yes") {
	if(feeExists("PENALTY") == false) updateFee("PENALTY","FIRSPRNK","FINAL",1,"N");
	} else {
	if(feeExists("PENALTY") == true) removeFee("PENALTY","FINAL");
	}
`^
CMN;Permitting!Fire!Sprinkler!NA;FeeACA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
addparcel = parcelExistsOnCap(capId) == false;
if (addparcel) {
	include("CMN;AddParcelAndOwner");
	include("EML;Permitting!Fire!~!~;FeeACA");
	}
`^
CMN;Permitting!Fire!Standpipe!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['SCOPE OF WORK.Repair to Existing Standpipe - Enter 1'] != null) {
	if(feeExists("ALTSP") == false) updateFee("ALTSP","FIRSTNDP","FINAL",1,"N");
	} else {
	if(feeExists("ALTSP") == true) removeFee("ALTSP","FINAL");
	}

if (AInfo['SCOPE OF WORK.New Standpipe Project - Enter 1'] != null || AInfo['SCOPE OF WORK.Alter Standpipe Project - Enter 1'] != null) {
	if(feeExists("NSPP") == false) updateFee("NSPP","FIRSTNDP","FINAL",1,"N");
	} else {
	if(feeExists("NSPP") == true) removeFee("NSPP","FINAL");
	}

if (AInfo['SCOPE OF WORK.Demolition'] == "CHECKED") {
	if(feeExists("DEMO") == false) updateFee("DEMO","FIRSTNDP","FINAL",1,"N");
	} else {
	if(feeExists("DEMO") == true) removeFee("DEMO","FINAL");
	}

if (AInfo['PROJECT INFORMATION.Has Installation of Fire Protection System Started Yet?'] == "Yes") {
	if(feeExists("PENALTY") == false) updateFee("PENALTY","FIRSTNDP","FINAL",1,"N");
	} else {
	if(feeExists("PENALTY") == true) removeFee("PENALTY","FINAL");
	}
`^
CMN;Permitting!Fire!Tank!Install;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['SYSTEM UPGRADE.Non-SIR Leak Detection System Upgrade - Enter 1'] != null) {
	if(feeExists("LDSUINSP") == false) updateFee("LDSUINSP","FIRTNKN","FINAL",1,"N");
	} else {
	if(feeExists("LDSUINSP") == true) removeFee("LDSUINSP","FINAL");
	}

if (AInfo['SYSTEM UPGRADE.Non-SIR Leak Detection System Upgrade - Enter 1'] != null) {
	if(feeExists("LDSUPLRVW") == false) updateFee("LDSUPLRVW","FIRTNKN","FINAL",1,"N");
	} else {
	if(feeExists("LDSUPLRVW") == true) removeFee("LDSUPLRVW","FINAL");
	}

if (AInfo['AGRICULTURAL TANKS.Tanks Inspected 2 Days or Less After Installation – Enter 1'] != null) {
	if(feeExists("ATINSP2D") == false) updateFee("ATINSP2D","FIRTNKN","FINAL",1,"N");
	} else {
	if(feeExists("ATINSP2D") == true) removeFee("ATINSP2D","FINAL");
	}

if (AInfo['AGRICULTURAL TANKS.Tanks Inspected 5 Days or Less After Installation – Enter 1'] != null) {
	if(feeExists("ATINSP5D") == false) updateFee("ATINSP5D","FIRTNKN","FINAL",1,"N");
	} else {
	if(feeExists("ATINSP5D") == true) removeFee("ATINSP5D","FINAL");
	}

if (AInfo['AGRICULTURAL TANKS.Number of New Tank(s)'] != null) {
	if(feeExists("AUSTPLINSP") == false) updateFee("AUSTPLINSP","FIRTNKN","FINAL",1,"N");
	} else {
	if(feeExists("AUSTPLINSP") == true) removeFee("AUSTPLINSP","FINAL");
	}

if (AInfo['SYSTEM UPGRADE.Corrosion System Upgrade – Enter 1'] != null) {
	if(feeExists("CSUINSP") == false) updateFee("CSUINSP","FIRTNKN","FINAL",1,"N");
	} else {
	if(feeExists("CSUINSP") == true) removeFee("CSUINSP","FINAL");
	}

if (AInfo['SYSTEM UPGRADE.Plan Revision for Corrosion System Upgrade – Enter 1'] != null) {
	if(feeExists("CSUPLREV") == false) updateFee("CSUPLREV","FIRTNKN","FINAL",1,"N");
	} else {
	if(feeExists("CSUPLREV") == true) removeFee("CSUPLREV","FINAL");
	}

if (AInfo['SYSTEM UPGRADE.Corrosion System Upgrade – Enter 1'] != null) {
	if(feeExists("CSUPLRVW") == false) updateFee("CSUPLRVW","FIRTNKN","FINAL",1,"N");
	} else {
	if(feeExists("CSUPLRVW") == true) removeFee("CSUPLRVW","FINAL");
	}

if (AInfo['SYSTEM UPGRADE.Install or Modify Existing Vent Piping – Enter 1'] != null) {
	if(feeExists("IMEVPINSP") == false) updateFee("IMEVPINSP","FIRTNKN","FINAL",1,"N");
	} else {
	if(feeExists("IMEVPINSP") == true) removeFee("IMEVPINSP","FINAL");
	}

if (AInfo['SYSTEM UPGRADE.Plan Revision for Install or Modification of Existing Vent Piping – Enter 1'] != null) {
	if(feeExists("IMEVPPLREV") == false) updateFee("IMEVPPLREV","FIRTNKN","FINAL",1,"N");
	} else {
	if(feeExists("IMEVPPLREV") == true) removeFee("IMEVPPLREV","FINAL");
	}

if (AInfo['SYSTEM UPGRADE.Install or Modify Existing Vent Piping – Enter 1'] != null) {
	if(feeExists("IMEVPPLRVW") == false) updateFee("IMEVPPLRVW","FIRTNKN","FINAL",1,"N");
	} else {
	if(feeExists("IMEVPPLRVW") == true) removeFee("IMEVPPLRVW","FINAL");
	}

if (AInfo['SYSTEM UPGRADE.Plan Revision for Leak Detection System Upgrade – Enter 1'] != null) {
	if(feeExists("LDSUPLREV") == false) updateFee("LDSUPLREV","FIRTNKN","FINAL",1,"N");
	} else {
	if(feeExists("LDSUPLREV") == true) removeFee("LDSUPLREV","FINAL");
	}

if (AInfo['NON-AGRICULTURAL TANKS.Aggregate Tank Capacity'] != null) {
	if(feeExists("NATINSP") == false) updateFee("NATINSP","FIRTNKN","FINAL",1,"N");
	} else {
	if(feeExists("NATINSP") == true) removeFee("NATINSP","FINAL");
	}

if (AInfo['NON-AGRICULTURAL TANKS.Tank Plan Revision – Enter Aggregate Tank Capacity'] != null) {
	if(feeExists("NATPLREV") == false) updateFee("NATPLREV","FIRTNKN","FINAL",1,"N");
	} else {
	if(feeExists("NATPLREV") == true) removeFee("NATPLREV","FINAL");
	}

if (AInfo['NON-AGRICULTURAL TANKS.Aggregate Tank Capacity'] != null) {
	if(feeExists("NATPLRVW") == false) updateFee("NATPLRVW","FIRTNKN","FINAL",1,"N");
	} else {
	if(feeExists("NATPLRVW") == true) removeFee("NATPLRVW","FINAL");
	}

if (AInfo['VAPOR RECOVERY.Addition or Upgrade of Stage II Vapor Recovery System – Enter 1'] != null) {
	if(feeExists("S2VPRINSP") == false) updateFee("S2VPRINSP","FIRTNKN","FINAL",1,"N");
	} else {
	if(feeExists("S2VPRINSP") == true) removeFee("S2VPRINSP","FINAL");
	}

if (AInfo['VAPOR RECOVERY.Plan Revision for Add or Upgrd of Stage II Vapor Rec. System – Enter 1'] != null) {
	if(feeExists("S2VPRPLREV") == false) updateFee("S2VPRPLREV","FIRTNKN","FINAL",1,"N");
	} else {
	if(feeExists("S2VPRPLREV") == true) removeFee("S2VPRPLREV","FINAL");
	}

if (AInfo['SYSTEM UPGRADE.Plan Revision for Spill or Overfill Protection System Upgrade – Enter 1'] != null) {
	if(feeExists("SOFPSPLREV") == false) updateFee("SOFPSPLREV","FIRTNKN","FINAL",1,"N");
	} else {
	if(feeExists("SOFPSPLREV") == true) removeFee("SOFPSPLREV","FINAL");
	}

if (AInfo['SYSTEM UPGRADE.Point of Sale'] == "Yes") {
	if(feeExists("POSINSP") == false) updateFee("POSINSP","FIRTNKN","FINAL",1,"N");
	} else {
	if(feeExists("POSINSP") == true) removeFee("POSINSP","FINAL");
	}

if (AInfo['SYSTEM UPGRADE.Point of Sale'] == "Yes") {
	if(feeExists("POSPLNRVW") == false) updateFee("POSPLNRVW","FIRTNKN","FINAL",1,"N");
	} else {
	if(feeExists("POSPLNRVW") == true) removeFee("POSPLNRVW","FINAL");
	}
`^
CMN;Permitting!Fire!Tank!Removal;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['TANK INFORMATION.Additional Number of Tanks Being Closed - Do Not Include First Tank'] != null) {
	if(feeExists("TNKREMINSP") == false) updateFee("TNKREMINSP","FIRTNKREM","FINAL",1,"N");
	} else {
	if(feeExists("TNKREMINSP") == true) removeFee("TNKREMINSP","FINAL");
	}
`^
CMN;Permitting!Health!POWTS!~;SanitaryPermitExistsCheck^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var sSanPermitNbr = "";
var sanitaryCap = null;
var sanitaryRec = null;
var oSanAppTypeResult = null;
var strSanAppType  = "";
var msg = 0;
var isTaskOperational  = "";
if (AInfo['Sanitary Permit Number'] == undefined) {
	sSanPermitNbr = AInfo['INSPECTION RESULTS.Sanitary Permit Number'];
	} else {
	sSanPermitNbr = AInfo['Sanitary Permit Number'];
	logDebug("Sanitary Permit Number = " + AInfo['Sanitary Permit Number']);
	logDebug("INSPECTION RESULTS.Sanitary Permit Number = " + AInfo['INSPECTION RESULTS.Sanitary Permit Number']);
	}

sanitaryCap = aa.cap.getCapID(sSanPermitNbr);
logDebug("sSanPermitNbr = " + sSanPermitNbr);
if (sanitaryCap) {
	if(sanitaryCap.getSuccess()) sanitaryRec = aa.cap.getCap(sanitaryCap.getOutput()).getOutput();
	}

if (sanitaryRec) {
	oSanAppTypeResult = sanitaryRec.getCapType();
	}

if (oSanAppTypeResult) {
	strSanAppType = oSanAppTypeResult.toString();
	}

if ((strSanAppType == "Permitting!Health!POWTS!Sanitary" || strSanAppType == "Permitting!Health!POWTS!Old Sanitary")) {
	bIsSanRec = true;
	}

if ((sanitaryRec == null || bIsSanRec == false)) {
	msg = 2;
	}

if (publicUser == false && msg == 2) {
	cancel = true;
	showMessage = true;
	comment("The Sanitary Permit Number you entered doesn't exist. Please enter a valid Sanitary Permit Number.");
	}

if (publicUser == true && msg == 2) {
	cancel = true;
	showMessage = true;
	comment("The Sanitary Permit Number you entered doesn't exist.<br>Please re-enter a valid Sanitary Permit Number in the Sanitary Permit Number box.<br>Thank you.");
	}

if (publicUser == true && msg == 0 && (sanitaryRec.capStatus == "Abandoned" || sanitaryRec.capStatus == "Closed" || sanitaryRec.capStatus == "Failing System" || sanitaryRec.capStatus == "Failing System With Pumping" || sanitaryRec.capStatus == "Void")) {
	bIsSanRec = false;
	cancel = true;
	showMessage = true;
	comment("This Sanitary Permit is inactive, because the septic system has been abandoned or replaced.");
	}

if (publicUser == true && msg == 0) {
	isTaskOperational = aa.workflow.getTask(sanitaryCap.getOutput(), "Operational").getOutput().getTaskItem().getActiveFlag();
	}

if (publicUser == true && msg == 0 && isTaskOperational == "N") {
	cancel = true;
	showMessage = true;
	comment("The system you selected is not operational.");
	}
`^
CMN;Permitting!Health!POWTS!~;SanPermitHoldingTankCheck^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var sSanPermitNbr = "";
var sanitaryCap = null;
var objSanASI = null;
var arySanASI = null;
var indx = null;
var ASIvalue = null;
var msg = 0;
if (AInfo['Sanitary Permit Number'] == undefined) {
	sSanPermitNbr = AInfo['INSPECTION RESULTS.Sanitary Permit Number'];
	} else {
	sSanPermitNbr = AInfo['Sanitary Permit Number'];
	}

sanitaryCap = aa.cap.getCapID(sSanPermitNbr);
if (sanitaryCap) {
	if(sanitaryCap.getSuccess() == true) objSanASI = aa.appSpecificInfo.getByCapID(sanitaryCap.getOutput());
	}

if (objSanASI) {
	if (objSanASI.getSuccess() == true) arySanASI = objSanASI.getOutput();
	}

if (arySanASI) {
	for(fld in arySanASI) if(arySanASI[fld].checkboxType == "POWTS TYPE" && arySanASI[fld].fieldLabel == "Holding Tank") indx = fld;
	}

if (indx) {
	ASIvalue  = arySanASI[indx].checklistComment;
	logDebug("ASI Holding Tank value = " + ASIvalue);
	}

if (sanitaryCap.getSuccess() && ASIvalue != "CHECKED") {
	msg = 2;
	}

if (publicUser == false && msg == 2) {
	cancel = true;
	showMessage = true;
	comment("The Sanitary Permit Number you entered is not a Holding Tank. Please verify and re-enter a different Sanitary Permit Number that is.");
	}

if (publicUser == true && msg == 2) {
	comment("The Sanitary Permit Number you entered is not a Holding Tank.<br>Please re-enter a Sanitary Permit Number for a Holding Tank in the Sanitary Permit Number box.<br>Thank you.");
	}
`^
CMN;Permitting!Health!POWTS!~;SanPermitTAMCheck^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var sSanPermitNbr = "";
var sanitaryCap = null;
var objSanASI = null;
var arySanASI = null;
var indx = null;
var ASIvalue = null;
var bIsHoldTank = false;
var msg = 0;
if (AInfo['Sanitary Permit Number'] == undefined) {
	sSanPermitNbr = AInfo['INSPECTION RESULTS.Sanitary Permit Number'];
	} else {
	sSanPermitNbr = AInfo['Sanitary Permit Number'];
	}

sanitaryCap = aa.cap.getCapID(sSanPermitNbr);
if (sanitaryCap) {
	if(sanitaryCap.getSuccess() == true) objSanASI = aa.appSpecificInfo.getByCapID(sanitaryCap.getOutput());
	}

if (objSanASI) {
	if (objSanASI.getSuccess() == true) arySanASI = objSanASI.getOutput();
	}

if (arySanASI) {
	for(fld in arySanASI) if(arySanASI[fld].checkboxType == "POWTS TYPE" && arySanASI[fld].fieldLabel == "Holding Tank") indx = fld;
	}

if (arySanASI && indx != null) {
	ASIvalue  = arySanASI[indx].checklistComment;
	logDebug("ASI Holding Tank value = " + ASIvalue);
	}

if (ASIvalue != null && ASIvalue != "") {
	if(ASIvalue.toString().toUpperCase() == "CHECKED") bIsHoldTank = true;
	}

if (bIsHoldTank == true) {
	msg = 3;
	}

if (publicUser == false && msg == 3) {
	cancel = true;
	showMessage = true;
	comment("The Sanitary Permit Number you entered is a Holding Tank. Please verify and re-enter a different non-Holding Tank Sanitary Permit Number.");
	}

if (publicUser == true && msg == 3) {
	cancel = true;
	showMessage = true;
	comment("The Sanitary Permit Number you entered is a Holding Tank.<br>Please re-enter a Sanitary Permit Number that is not for a Holding Tank.<br>Thank you.");
	}
`^
CMN;Permitting!Health!POWTS!Holding Tank;UpdateLastServiceDate^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
parentCapId = getParent();
dtServiced = new Date(AInfo['INSPECTION RESULTS.Date Serviced']);
dtlastServiceDate = new Date(getAppSpecific("OFFICE USE ONLY.Last Service Date", parentCapId));
if (dtlastServiceDate == null || dtServiced > dtlastServiceDate) {
	editAppSpecific("OFFICE USE ONLY.Last Service Date", AInfo['INSPECTION RESULTS.Date Serviced'], parentCapId);
	}
`^
CMN;Permitting!Health!POWTS!Sanitary;PermitFee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (AInfo['POWTS TYPE.At Grade'] == "CHECKED") {
	if(feeExists("AGCOMM") == false) addFee("AGCOMM","PERPOWTS","FINAL",1,"N");
	if(feeExists("AGWDNR") == false) addFee("AGWDNR","PERPOWTS","FINAL",1,"N");
	if(feeExists("AGHMDC") == false) addFee("AGHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("AGCOMM") == true) removeFee("AGCOMM","FINAL");
	if(feeExists("AGWDNR") == true) removeFee("AGWDNR","FINAL");
	if(feeExists("AGHMDC") == true) removeFee("AGHMDC","FINAL");
	}

if (AInfo['POWTS TYPE.At Grade plus ATU'] == "CHECKED") {
	if(feeExists("AGATUCOMM") == false) addFee("AGATUCOMM","PERPOWTS","FINAL",1,"N");
	if(feeExists("AGATUWDNR") == false) addFee("AGATUWDNR","PERPOWTS","FINAL",1,"N");
	if(feeExists("AGATUHMDC") == false) addFee("AGATUHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("AGATUCOMM") == true) removeFee("AGATUCOMM","FINAL");
	if(feeExists("AGATUWDNR") == true) removeFee("AGATUWDNR","FINAL");
	if(feeExists("AGATUHMDC") == true) removeFee("AGATUHMDC","FINAL");
	}

if (AInfo['POWTS TYPE.At Grade Plus ATU with downsized absorbtion area'] == "CHECKED") {
	if(feeExists("AGATUAACOMM") == false) addFee("AGATUAACOMM","PERPOWTS","FINAL",1,"N");
	if(feeExists("AGATUAAWDNR") == false) addFee("AGATUAAWDNR","PERPOWTS","FINAL",1,"N");
	if(feeExists("AGATUAAHMDC") == false) addFee("AGATUAAHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("AGATUAACOMM") == true) removeFee("AGATUAACOMM","FINAL");
	if(feeExists("AGATUAAWDNR") == true) removeFee("AGATUAAWDNR","FINAL");
	if(feeExists("AGATUAAHMDC") == true) removeFee("AGATUAAHMDC","FINAL");
	}

if (AInfo['POWTS TYPE.ATU'] == "CHECKED") {
	if(feeExists("ATUCOMM") == false) addFee("ATUCOMM","PERPOWTS","FINAL",1,"N");
	if(feeExists("ATUWDNR") == false) addFee("ATUWDNR","PERPOWTS","FINAL",1,"N");
	if(feeExists("ATUHMDC") == false) addFee("ATUHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("ATUCOMM") == true) removeFee("ATUCOMM","FINAL");
	if(feeExists("ATUWDNR") == true) removeFee("ATUWDNR","FINAL");
	if(feeExists("ATUHMDC") == true) removeFee("ATUHMDC","FINAL");
	}

if (AInfo['POWTS TYPE.Conventional Gravity-Fed Dose System'] == "CHECKED") {
	if(feeExists("CGFDSCOMM") == false) addFee("CGFDSCOMM","PERPOWTS","FINAL",1,"N");
	if(feeExists("CGFDSWDNR") == false) addFee("CGFDSWDNR","PERPOWTS","FINAL",1,"N");
	if(feeExists("CGFDSHMDC") == false) addFee("CGFDSHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("CGFDSCOMM") == true) removeFee("CGFDSCOMM","FINAL");
	if(feeExists("CGFDSWDNR") == true) removeFee("CGFDSWDNR","FINAL");
	if(feeExists("CGFDSHMDC") == true) removeFee("CGFDSHMDC","FINAL");
	}

if (AInfo['POWTS TYPE.Conventional Gravity-Fed System'] == "CHECKED") {
	if(feeExists("CGFSCOMM") == false) addFee("CGFSCOMM","PERPOWTS","FINAL",1,"N");
	if(feeExists("CGFSWDNR") == false) addFee("CGFSWDNR","PERPOWTS","FINAL",1,"N");
	if(feeExists("CGFSHMDC") == false) addFee("CGFSHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("CGFSCOMM") == true) removeFee("CGFSCOMM","FINAL");
	if(feeExists("CGFSWDNR") == true) removeFee("CGFSWDNR","FINAL");
	if(feeExists("CGFSHMDC") == true) removeFee("CGFSHMDC","FINAL");
	}

if (AInfo['POWTS TYPE.Custom System'] == "CHECKED") {
	if(feeExists("CSCOMM") == false) addFee("CSCOMM","PERPOWTS","FINAL",1,"N");
	if(feeExists("CSWDNR") == false) addFee("CSWDNR","PERPOWTS","FINAL",1,"N");
	if(feeExists("CSHMDC") == false) addFee("CSHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("CSCOMM") == true) removeFee("CSCOMM","FINAL");
	if(feeExists("CSWDNR") == true) removeFee("CSWDNR","FINAL");
	if(feeExists("CSHMDC") == true) removeFee("CSHMDC","FINAL");
	}

if (AInfo['POWTS TYPE.Drip Line Effluent Dispersal Component'] == "CHECKED") {
	if(feeExists("DLECOMM") == false) addFee("DLECOMM","PERPOWTS","FINAL",1,"N");
	if(feeExists("DLEWDNR") == false) addFee("DLEWDNR","PERPOWTS","FINAL",1,"N");
	if(feeExists("DLEHMDC") == false) addFee("DLEHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("DLECOMM") == true) removeFee("DLECOMM","FINAL");
	if(feeExists("DLEWDNR") == true) removeFee("DLEWDNR","FINAL");
	if(feeExists("DLEHMDC") == true) removeFee("DLEHMDC","FINAL");
	}

if (AInfo['POWTS TYPE.Holding Tank'] == "CHECKED") {
	if(feeExists("HTCOMM") == false) addFee("HTCOMM","PERPOWTS","FINAL",1,"N");
	if(feeExists("HTWDNR") == false) addFee("HTWDNR","PERPOWTS","FINAL",1,"N");
	if(feeExists("HTHMDC") == false) addFee("HTHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("HTCOMM") == true) removeFee("HTCOMM","FINAL");
	if(feeExists("HTWDNR") == true) removeFee("HTWDNR","FINAL");
	if(feeExists("HTHMDC") == true) removeFee("HTHMDC","FINAL");
	}

if (AInfo['POWTS TYPE.In Ground Pressure'] == "CHECKED") {
	if(feeExists("GPCOMM") == false) addFee("GPCOMM","PERPOWTS","FINAL",1,"N");
	if(feeExists("GPWDNR") == false) addFee("GPWDNR","PERPOWTS","FINAL",1,"N");
	if(feeExists("GPHMDC") == false) addFee("GPHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("GPCOMM") == true) removeFee("GPCOMM","FINAL");
	if(feeExists("GPWDNR") == true) removeFee("GPWDNR","FINAL");
	if(feeExists("GPHMDC") == true) removeFee("GPHMDC","FINAL");
	}

if (AInfo['POWTS TYPE.In Ground Pressure plus ATU'] == "CHECKED") {
	if(feeExists("GPATUCOMM") == false) addFee("GPATUCOMM","PERPOWTS","FINAL",1,"N");
	if(feeExists("GPATUWDNR") == false) addFee("GPATUWDNR","PERPOWTS","FINAL",1,"N");
	if(feeExists("GPATUHMDC") == false) addFee("GPATUHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("GPATUCOMM") == true) removeFee("GPATUCOMM","FINAL");
	if(feeExists("GPATUWDNR") == true) removeFee("GPATUWDNR","FINAL");
	if(feeExists("GPATUHMDC") == true) removeFee("GPATUHMDC","FINAL");
	}

if (AInfo['POWTS TYPE.In Ground Pressure plus ATU with downsized absorption area'] == "CHECKED") {
	if(feeExists("GPATUAACOMM") == false) addFee("GPATUAACOMM","PERPOWTS","FINAL",1,"N");
	if(feeExists("GPATUAAWDNR") == false) addFee("GPATUAAWDNR","PERPOWTS","FINAL",1,"N");
	if(feeExists("GPATUAAHMDC") == false) addFee("GPATUAAHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("GPATUAACOMM") == true) removeFee("GPATUAACOMM","FINAL");
	if(feeExists("GPATUAAWDNR") == true) removeFee("GPATUAAWDNR","FINAL");
	if(feeExists("GPATUAAHMDC") == true) removeFee("GPATUAAHMDC","FINAL");
	}

if (AInfo['POWTS TYPE.Modification Mound - State Fees'] == "CHECKED") {
	if(feeExists("MMCOMM") == false) addFee("MMCOMM","PERPOWTS","FINAL",1,"N");
	if(feeExists("MMWDNR") == false) addFee("MMWDNR","PERPOWTS","FINAL",1,"N");
	if(feeExists("MMHMDC") == false) addFee("MMHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("MMCOMM") == true) removeFee("MMCOMM","FINAL");
	if(feeExists("MMWDNR") == true) removeFee("MMWDNR","FINAL");
	if(feeExists("MMHMDC") == true) removeFee("MMHMDC","FINAL");
	}

if (AInfo['POWTS TYPE.Mound Plus ATU'] == "CHECKED") {
	if(feeExists("MATUCOMM") == false) addFee("MATUCOMM","PERPOWTS","FINAL",1,"N");
	if(feeExists("MATUWDNR") == false) addFee("MATUWDNR","PERPOWTS","FINAL",1,"N");
	if(feeExists("MATUHMDC") == false) addFee("MATUHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("MATUCOMM") == true) removeFee("MATUCOMM","FINAL");
	if(feeExists("MATUWDNR") == true) removeFee("MATUWDNR","FINAL");
	if(feeExists("MATUHMDC") == true) removeFee("MATUHMDC","FINAL");
	}

if (AInfo['POWTS TYPE.Mound plus ATU with downsized absorption area'] == "CHECKED") {
	if(feeExists("MATUAACOMM") == false) addFee("MATUAACOMM","PERPOWTS","FINAL",1,"N");
	if(feeExists("MATUAAWDNR") == false) addFee("MATUAAWDNR","PERPOWTS","FINAL",1,"N");
	if(feeExists("MATUAAHMDC") == false) addFee("MATUAAHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("MATUAACOMM") == true) removeFee("MATUAACOMM","FINAL");
	if(feeExists("MATUAAWDNR") == true) removeFee("MATUAAWDNR","FINAL");
	if(feeExists("MATUAAHMDC") == true) removeFee("MATUAAHMDC","FINAL");
	}

if (AInfo['POWTS TYPE.Mound less than 24 inches'] == "CHECKED") {
	if(feeExists("MLT24COMM") == false) addFee("MLT24COMM","PERPOWTS","FINAL",1,"N");
	if(feeExists("MLT24WDNR") == false) addFee("MLT24WDNR","PERPOWTS","FINAL",1,"N");
	if(feeExists("MLT24HMDC") == false) addFee("MLT24HMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("MLT24COMM") == true) removeFee("MLT24COMM","FINAL");
	if(feeExists("MLT24WDNR") == true) removeFee("MLT24WDNR","FINAL");
	if(feeExists("MLT24HMDC") == true) removeFee("MLT24HMDC","FINAL");
	}

if (AInfo['POWTS TYPE.Mound less than 24 inches recore'] == "CHECKED") {
	if(feeExists("MLT24RCOMM") == false) addFee("MLT24RCOMM","PERPOWTS","FINAL",1,"N");
	if(feeExists("MLT24RWDNR") == false) addFee("MLT24RWDNR","PERPOWTS","FINAL",1,"N");
	if(feeExists("MLT24RHMDC") == false) addFee("MLT24RHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("MLT24RCOMM") == true) removeFee("MLT24RCOMM","FINAL");
	if(feeExists("MLT24RWDNR") == true) removeFee("MLT24RWDNR","FINAL");
	if(feeExists("MLT24RHMDC") == true) removeFee("MLT24RHMDC","FINAL");
	}

if (AInfo['POWTS TYPE.Mound greater than or equal to 24 inches'] == "CHECKED") {
	if(feeExists("MGT24COMM") == false) addFee("MGT24COMM","PERPOWTS","FINAL",1,"N");
	if(feeExists("MGT24WDNR") == false) addFee("MGT24WDNR","PERPOWTS","FINAL",1,"N");
	if(feeExists("MGT24HMDC") == false) addFee("MGT24HMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("MGT24COMM") == true) removeFee("MGT24COMM","FINAL");
	if(feeExists("MGT24WDNR") == true) removeFee("MGT24WDNR","FINAL");
	if(feeExists("MGT24HMDC") == true) removeFee("MGT24HMDC","FINAL");
	}

if (AInfo['POWTS TYPE.Mound greater than or equal to 24 inches recore'] == "CHECKED") {
	if(feeExists("MGT24RCOMM") == false) addFee("MGT24RCOMM","PERPOWTS","FINAL",1,"N");
	if(feeExists("MGT24RWDNR") == false) addFee("MGT24RWDNR","PERPOWTS","FINAL",1,"N");
	if(feeExists("MGT24RHMDC") == false) addFee("MGT24RHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("MGT24RCOMM") == true) removeFee("MGT24RCOMM","FINAL");
	if(feeExists("MGT24RWDNR") == true) removeFee("MGT24RWDNR","FINAL");
	if(feeExists("MGT24RHMDC") == true) removeFee("MGT24RHMDC","FINAL");
	}

if (AInfo['POWTS TYPE.Privy'] == "CHECKED") {
	if(feeExists("PRHMDC") == false) addFee("PRHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("PRHMDC") == true) removeFee("PRHMDC","FINAL");
	}

if (AInfo['POWTS TYPE.Reconnection'] == "CHECKED") {
	if(feeExists("RECONHMDC") == false) addFee("RECONHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("RECONHMDC") == true) removeFee("RECONHMDC","FINAL");
	}

if (AInfo['POWTS TYPE.Repair'] == "CHECKED") {
	if(feeExists("REPHMDC") == false) addFee("REPHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("REPHMDC") == true) removeFee("REPHMDC","FINAL");
	}

if (AInfo['POWTS TYPE.Sand Filter - Recirculating'] == "CHECKED") {
	if(feeExists("SFRCOMM") == false) addFee("SFRCOMM","PERPOWTS","FINAL",1,"N");
	if(feeExists("SFRWDNR") == false) addFee("SFRWDNR","PERPOWTS","FINAL",1,"N");
	if(feeExists("SFRHMDC") == false) addFee("SFRHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("SFRCOMM") == true) removeFee("SFRCOMM","FINAL");
	if(feeExists("SFRWDNR") == true) removeFee("SFRWDNR","FINAL");
	if(feeExists("SFRHMDC") == true) removeFee("SFRHMDC","FINAL");
	}

if (AInfo['POWTS TYPE.Sand Filter - Single Pass'] == "CHECKED") {
	if(feeExists("SFSPCOMM") == false) addFee("SFSPCOMM","PERPOWTS","FINAL",1,"N");
	if(feeExists("SFSPWDNR") == false) addFee("SFSPWDNR","PERPOWTS","FINAL",1,"N");
	if(feeExists("SFSPHMDC") == false) addFee("SFSPHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("SFSPCOMM") == true) removeFee("SFSPCOMM","FINAL");
	if(feeExists("SFSPWDNR") == true) removeFee("SFSPWDNR","FINAL");
	if(feeExists("SFSPHMDC") == true) removeFee("SFSPHMDC","FINAL");
	}

if (AInfo['POWTS TYPE.Sand Filter - Split Bed'] == "CHECKED") {
	if(feeExists("SFSBCOMM") == false) addFee("SFSBCOMM","PERPOWTS","FINAL",1,"N");
	if(feeExists("SFSBWDNR") == false) addFee("SFSBWDNR","PERPOWTS","FINAL",1,"N");
	if(feeExists("SFSBHMDC") == false) addFee("SFSBHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("SFSBCOMM") == true) removeFee("SFSBCOMM","FINAL");
	if(feeExists("SFSBWDNR") == true) removeFee("SFSBWDNR","FINAL");
	if(feeExists("SFSBHMDC") == true) removeFee("SFSBHMDC","FINAL");
	}

if (AInfo['POWTS TYPE.Terralift'] == "CHECKED") {
	if(feeExists("TERHMDC") == false) addFee("TERHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("TERHMDC") == true) removeFee("TERHMDC","FINAL");
	}

if (AInfo['PLAN REVIEW CONDITIONS.Design Flow - All Other Components'] != null) {
	if(feeExists("PWTSDSGNFLW") == false) updateFee("PWTSDSGNFLW","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("PWTSDSGNFLW") == true) removeFee("PWTSDSGNFLW","FINAL");
	}

if ((AInfo['COMPONENT MODULE.Holding Tank Component Manual'] == "CHECKED" || AInfo['COMPONENT MODULE.Holding Tank Component Manual'] == "CHECKED")) {
	if(feeExists("PWTSTNK") == false) addFee("PWTSTNK","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("PWTSTNK") == true) removeFee("PWTSTNK","FINAL");
	}

if (AInfo['TYPE OF PERMIT.Permit Revision'] == "CHECKED") {
	if(feeExists("PRERVWPLN") == false) addFee("PRERVWPLN","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("PRERVWPLN") == true) removeFee("PRERVWPLN","FINAL");
	}

if (AInfo['PLAN REVIEW SYSTEM TYPE.Revision to Previously Reviewed Plan'] == "CHECKED") {
	if(feeExists("AGPLNRVW") == false) addFee("AGPLNRVW","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("AGPLNRVW") == true) removeFee("AGPLNRVW","FINAL");
	}

if (AInfo['TYPE OF PERMIT.Application Type'] == "Reconn. Of Exist. Sys") {
	if(feeExists("RECONHMDC") == false) addFee("RECONHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("RECONHMDC") == true) removeFee("RECONHMDC","FINAL");
	}

if (AInfo['TYPE OF PERMIT.Application Type'] == "Repair of Exist. Sys") {
	if(feeExists("REPHMDC") == false) addFee("REPHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("REPHMDC") == true) removeFee("REPHMDC","FINAL");
	}

if (AInfo['TYPE OF PERMIT.Application Type'] == "Treatment!Holding Tank Repl Only") {
	if(feeExists("STOHMDC") == false) addFee("STOHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("STOHMDC") == true) removeFee("STOHMDC","FINAL");
	}

if (AInfo['TYPE OF PERMIT.Application Type'] == "Treatment!Holding Tank Repl Only") {
	if(feeExists("STOCOMM") == false) addFee("STOCOMM","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("STOCOMM") == true) removeFee("STOCOMM","FINAL");
	}

if (AInfo['TYPE OF PERMIT.Application Type'] == "Treatment!Holding Tank Repl Only") {
	if(feeExists("STOWDNR") == false) addFee("STOWDNR","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("STOWDNR") == true) removeFee("STOWDNR","FINAL");
	}

if (AInfo['POWTS TYPE.Conventional Dose Plus ATU'] == "CHECKED") {
	if(feeExists("CDPAHMDC") == false) addFee("CDPAHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("CDPAHMDC") == true) removeFee("CDPAHMDC","FINAL");
	}

if (AInfo['POWTS TYPE.Conventional Dose Plus ATU'] == "CHECKED") {
	if(feeExists("CDPAWDNR") == false) addFee("CDPAWDNR","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("CDPAWDNR") == true) removeFee("CDPAWDNR","FINAL");
	}

if (AInfo['POWTS TYPE.Conventional Dose Plus ATU'] == "CHECKED") {
	if(feeExists("CDPACOMM") == false) addFee("CDPACOMM","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("CDPACOMM") == true) removeFee("CDPACOMM","FINAL");
	}

if (AInfo['POWTS TYPE.Conventional Plus ATU'] == "CHECKED") {
	if(feeExists("CPAHMDC") == false) addFee("CPAHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("CPAHMDC") == true) removeFee("CPAHMDC","FINAL");
	}

if (AInfo['POWTS TYPE.Conventional Plus ATU'] == "CHECKED") {
	if(feeExists("CPAWDNR") == false) addFee("CPAWDNR","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("CPAWDNR") == true) removeFee("CPAWDNR","FINAL");
	}

if (AInfo['POWTS TYPE.Conventional Plus ATU'] == "CHECKED") {
	if(feeExists("CPACOMM") == false) addFee("CPACOMM","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("CPACOMM") == true) removeFee("CPACOMM","FINAL");
	}

if (AInfo['POWTS TYPE.Mound Less Than 24 Plus ATU'] == "CHECKED") {
	if(feeExists("MLTAHMDC") == false) addFee("MLTAHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("MLTAHMDC") == true) removeFee("MLTAHMDC","FINAL");
	}

if (AInfo['POWTS TYPE.Mound Less Than 24 Plus ATU'] == "CHECKED") {
	if(feeExists("MLTAWDNR") == false) addFee("MLTAWDNR","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("MLTAWDNR") == true) removeFee("MLTAWDNR","FINAL");
	}

if (AInfo['POWTS TYPE.Mound Less Than 24 Plus ATU'] == "CHECKED") {
	if(feeExists("MLTACOMM") == false) addFee("MLTACOMM","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("MLTACOMM") == true) removeFee("MLTACOMM","FINAL");
	}

if (AInfo['POWTS TYPE.Mound Greater Than 24 Plus ATU'] == "CHECKED") {
	if(feeExists("MGTAHMDC") == false) addFee("MGTAHMDC","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("MGTAHMDC") == true) removeFee("MGTAHMDC","FINAL");
	}

if (AInfo['POWTS TYPE.Mound Greater Than 24 Plus ATU'] == "CHECKED") {
	if(feeExists("MGTAWDNR") == false) addFee("MGTAWDNR","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("MGTAWDNR") == true) removeFee("MGTAWDNR","FINAL");
	}

if (AInfo['POWTS TYPE.Mound Greater Than 24 Plus ATU'] == "CHECKED") {
	if(feeExists("MGTACOMM") == false) addFee("MGTACOMM","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("MGTACOMM") == true) removeFee("MGTACOMM","FINAL");
	}

if (AInfo['TYPE OF PERMIT.Add Pump!Pump Chamber'] == "CHECKED") {
	if(feeExists("REVPUMPREVW") == false) addFee("REVPUMPREVW","PERPOWTS","FINAL",1,"N");
	} else {
	if(feeExists("REVPUMPREVW") == true) removeFee("REVPUMPREVW","FINAL");
	}
`^
CMN;Permitting!Health!POWTS!Sanitary;UpdateCAPDetail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
var projName = getAppSpecific("ADDL PROPERTY INFORMATION.Project - Site Name");
if (projName != null) {
	updateShortNotes(projName);
	}
`^
CMN;Permitting!Health!POWTS!Sanitary;WIFundAppFee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if(feeExists("WIFUNDAPPFIL", "NEW", "INVOICED") == false) updateFee("WIFUNDAPPFIL","PERPOWTS","FINAL",1,"Y");
`^
CMN;Permitting!Health!POWTS!TAM;GetASIFields^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
field = asiFieldi.next();
fName = field.getFieldLabel();
if (fName == "Sanitary Permit Number") {
	vField = field.getChecklistComment();
	}
`^
CMN;Permitting!Health!Temp Food Establishment!~;UpdateCAPDetail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
ca = getContactArray();
var applicantOrgName = "";
if (ca != null && ca.length > 0) {
	for(rec in ca) if (ca[rec]["contactType"] == "Applicant" || ca[rec]["contactType"] == "Applicant or Organization") applicantOrgName = ca[rec]["businessName"];
	}

if ((applicantOrgName != null || applicantOrgName == "NA")) {
	updateShortNotes(applicantOrgName);
	}

if (AInfo['EVENT INFORMATION.Name of Event'] != null) {
	updateWorkDesc(AInfo['EVENT INFORMATION.Name of Event']);
	}
`^
CMN;Permitting!Health!Temp Food Establishment!Dane County Restaurant;EventDatesCalc^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
eDatesArray.push(new Date(eventDates[x]["Date(s) of Event - Enter all dates of Event"].fieldValue));
dateCount += 1;
`^
CMN;Permitting!Health!Temp Food Establishment!Dane County Restaurant;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var invoiceFee = "N";
var type = null;
eDatesArray = new Array();
dateCount = 0;
var earliestDate = null;
var firstEvent = "N";
firstEvent = getAppSpecific("EVENT INFORMATION.Is this first event for calendar year?");
if (getAppSpecific("FOOD SERVICE.Primarily Restaurant") == "CHECKED") {
	type = "Rest";
	} else {
	type = "Retail";
	}

eventDates = loadASITable("DATE(S) OF EVENT");
if (eventDates) {
	for(x in eventDates) include("CMN;Permitting!Health!Temp Food Establishment!Dane County Restaurant;EventDatesCalc");
	}

eDatesArray.sort(date_sort_asc);
earliestDate = new Date(eDatesArray[0]);
if (firstEvent == "Yes" && type == "Rest") {
	updateFee("TRLF", "PERHLTTR", "FINAL", 1, invoiceFee);
	} else {
	removeFee("TRLF", "FINAL");
	}

if (firstEvent == "Yes" && type == "Rest" && dateCount > 1) {
	updateFee("TRLFADD", "PERHLTTR", "FINAL", dateCount - 1, invoiceFee);
	} else {
	removeFee("TRLFADD", "FINAL");
	}

if (firstEvent == "No" && type == "Rest" && dateCount > 0) {
	updateFee("TRLFADD", "PERHLTTR", "FINAL", dateCount, invoiceFee);
	}

if (firstEvent == "Yes" && type == "Retail") {
	updateFee("RTRLF", "PERHLTTR", "FINAL", 1, invoiceFee);
	} else {
	removeFee("RTRLF", "FINAL");
	}

if (firstEvent == "Yes" && type == "Retail" && dateCount > 1) {
	updateFee("RTRLFADD", "PERHLTTR", "FINAL", dateCount - 1, invoiceFee);
	} else {
	removeFee("RTRLFADD", "FINAL");
	}

if (firstEvent == "No" && type == "Retail" && dateCount > 0) {
	updateFee("RTRLFADD", "PERHLTTR", "FINAL", dateCount, invoiceFee);
	}

if (dateDiff(startDate, earliestDate) < 6) {
	if(feeExists("TFELF") == false) updateFee("TFELF","PERHLTTR","FINAL",1,invoiceFee);
	} else {
	if(feeExists("TFELF") == true) removeFee("TFELF","FINAL");
	}
`^
CMN;Permitting!Health!Temp Tattoo And Or Piercing!Dane County;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL INFORMATION.First Day Event Held - Enter 1'] != null) {
	if(feeExists("LICFEE") == false) updateFee("LICFEE","PERTMPBA","FINAL",1,"N");
	} else {
	if(feeExists("LICFEE") == true) removeFee("LICFEE","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Additional Days Event Held - Enter Number of Days'] != null) {
	if(feeExists("LICFEEADDL") == false) updateFee("LICFEEADDL","PERTMPBA","FINAL",1,"N");
	} else {
	if(feeExists("LICFEEADDL") == true) removeFee("LICFEEADDL","FINAL");
	}
`^
CMN;Permitting!Health!Temporary Restaurant!Dane County Retail;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['FOOD PREPARATION.First day in calendar year retail temporary food establishment to be permitted - Enter 1'] != null) {
	if(feeExists("RTRLF") == false) updateFee("RTRLF","PERHLTTR","FINAL",1,"N");
	} else {
	if(feeExists("RTRLF") == true) removeFee("RTRLF","FINAL");
	}

if (AInfo['FOOD PREPARATION.Additional days in calendar year Retail temporary food establishment to be permitted - Enter Qty'] != null) {
	if(feeExists("RTRLFADD") == false) updateFee("RTRLFADD","PERHLTTR","FINAL",1,"N");
	} else {
	if(feeExists("RTRLFADD") == true) removeFee("RTRLFADD","FINAL");
	}

if (AInfo['FOOD PREPARATION.First day in calendar year Restaurant temporary food establishment to be permitted - Enter 1'] != null) {
	if(feeExists("TRLF") == false) updateFee("TRLF","PERHLTTR","FINAL",1,"N");
	} else {
	if(feeExists("TRLF") == true) removeFee("TRLF","FINAL");
	}

if (AInfo['FOOD PREPARATION.Additional days in calendar year Restaurant temporary food establishment to be permitted - Enter Qty'] != null) {
	if(feeExists("TRLFADD") == false) updateFee("TRLFADD","PERHLTTR","FINAL",1,"N");
	} else {
	if(feeExists("TRLFADD") == true) removeFee("TRLFADD","FINAL");
	}
`^
CMN;Permitting!Health;SanitaryHealthLicense^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
capsText = "";
emailText = "<html><body><p>" + "A " + appTypeString + " license; <a href='https;!!av.cityofmadison.com!portlets!cap!capDetail.do?mode=view&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2() + "&ID3=" + capId.getID3() + "&requireNotice=YES&clearForm=clearForm&module=" + cmnGroup + "&isGeneralCAP=Y'>" + capIDString + "<!a> has been submitted at an address that has a septic system or well.  Details below;<br !>";
relatedCaps = getRelatedCapsByParcel("Permitting!Health!~!~");
if ((relatedCaps[0] != null && relatedCaps[0].toString().length()>0 )) {
	for (rc in relatedCaps) include("CMN;Permitting!Health;SanitaryHealthLicenseDetail");
	}

capsTextLen = capsText.length;
if (capsTextLen > 0) {
	emailText += capsText + "<!html>";
	}

if (capsTextLen > 0) {
	aa.sendEmail("noreply@cityofmadisonDEV.com", "jschneider@cityofmadisonDEV.com", "kgrittner@cityofmadisonDEV.com", "Notice of a New Health License that has a septic system or well", emailText, "");
	}
`^
CMN;Permitting!Health;SanitaryHealthLicenseDetail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
includeCap = true;
ad = null;
rcapType = null;
rcapid = relatedCaps[rc].getCapID();
rCap = aa.cap.getCap(rcapid).getOutput();
if (rCap.capStatus == "Void" || rCap.capStatus == "Inactive" || rCap.capStatus == "Closed") {
	includeCap = false;
	}

if (includeCap) {
	rCapModel = rCap.getCapModel();
	rcapType = rCapModel.getCapType();
	}

if (includeCap) {
	ad = aa.address.getAddressByCapId(rcapid).getOutput();
	addressText = "";
	}

if (includeCap && ad  != null && ad[0].getHouseNumberStart() != null) {
	addressText += ad[0].getHouseNumberStart();
	}

if (includeCap && ad  != null && ad[0].getStreetDirection() != null) {
	addressText += " " + ad[0].getStreetDirection();
	}

if (includeCap && ad  != null && ad[0].getStreetName() != null) {
	addressText += " " + ad[0].getStreetName();
	}

if (includeCap && ad  != null && ad[0].getStreetSuffix() != null) {
	addressText += " " + ad[0].getStreetSuffix();
	}

if (includeCap && ad != null && ad[0].getUnitStart() != null) {
	addressText += " 
	" + ad[0].getUnitStart();
	}

if (includeCap && ad != null && ad[0].getCity() != null) {
	addressText += " 
	" + ad[0].getCity();
	}

if (includeCap && ad != null && ad[0].getState() != null) {
	addressText += " " + ad[0].getState();
	}

if (includeCap && ad != null && ad[0].getZip() != null) {
	addressText += " " + ad[0].getZip();
	}

if (includeCap && (rcapType != "Permitting!Health!POWTS!Sanitary" && rcapType != "Permitting!Health!TNC Well!NA" && rcapType != "Permitting!Health!Well!NA")) {
	includeCap = false;
	}

if (includeCap) {
	capsText += "<a href='https;!!av.cityofmadison.com!portlets!cap!capDetail.do?mode=view&serviceProviderCode=MADISON&ID1=" + rcapid.getID1() + "&ID2=" + rcapid.getID2() + "&ID3=" + rcapid.getID3() + "&requireNotice=YES&clearForm=clearForm&module=" + cmnGroup + "&isGeneralCAP=Y'>" + rCapModel.getAltID() + "<!a> - " + rCapModel.getAppTypeAlias() + " - " + addressText + "<br>";
	}
`^
CMN;Permitting!Land Management!Privilege In Streets!Privilege In Streets;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['APPLICATION VALUES.Multiple Wells to be Monitored'] != null) {
	if(feeExists("PRINSTMW") == false) updateFee("PRINSTMW","LMPRINST","FINAL",1,"N");
	} else {
	if(feeExists("PRINSTMW") == true) removeFee("PRINSTMW","FINAL");
	}

if (AInfo['APPLICATION VALUES.3% of Assessed Sq. Ft. Value of Structure'] != null) {
	if(feeExists("PRINSTSF") == false) updateFee("PRINSTSF","LMPRINST","FINAL",1,"N");
	} else {
	if(feeExists("PRINSTSF") == true) removeFee("PRINSTSF","FINAL");
	}

if (AInfo['APPLICATION VALUES.Single Well to be Monitored (Enter 1)'] != null) {
	if(feeExists("PRINSTSW") == false) updateFee("PRINSTSW","LMPRINST","FINAL",1,"N");
	} else {
	if(feeExists("PRINSTSW") == true) removeFee("PRINSTSW","FINAL");
	}

if (AInfo['APPLICATION VALUES.Non-Public Use 2" Duct'] != null) {
	if(feeExists("PRSTFO2") == false) updateFee("PRSTFO2","LMPRINST","FINAL",1,"N");
	} else {
	if(feeExists("PRSTFO2") == true) removeFee("PRSTFO2","FINAL");
	}

if (AInfo['APPLICATION VALUES.Non-Public Use 4" Duct'] != null) {
	if(feeExists("PRSTFO4") == false) updateFee("PRSTFO4","LMPRINST","FINAL",1,"N");
	} else {
	if(feeExists("PRSTFO4") == true) removeFee("PRSTFO4","FINAL");
	}
`^
CMN;Permitting!LandManagement!Privilege In Streets!Privilege In Streets;NotifyEngineering^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
emailSubject = "Privilege in Streets - " + capId + " - Approval Letter Sent";
emailBody = "This is to notify you that an Approval Letter for the following<br>";
emailBody += "Privilege in Streets permit application was sent to the Applicant.<br>";
emailBody += "Please make sure the applicant applies for an <br>";
emailBody += "Engineering Excavation in the Right of Way.<br><br>";
emailBody += "Application Number; " + capId + "<br>";
emailBody += "Letter Sent on; " + wfDateMMDDYYYY + "<br>";
ca = getContactArray();
for (ca1 in ca) if (ca[ca1]["contactType"] == "Applicant") for (ca2 in ca[ca1]) if (ca[ca1][ca2] != null) emailBody += "Applicant " + ca2 + "; " + ca[ca1][ca2] + "<br>";
email("poleary@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailBody );
`^
CMN;Permitting!Miscellaneous!Edible Landscape!NA;SetWorkflow^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var ownerObj = null;
var aryOwner = null;
sOwnerName = "";
var iPosPark = -1;
var iPosEng = -1;
var iPosWater = -1;
var iPosCda = -1;
sDept = "";
wfObj = "";
ownerObj = aa.owner.getOwnerByCapId(capId);
if (ownerObj.getSuccess()) {
	aryOwner = ownerObj.getOutput();
	}

if (aryOwner != null) {
	sOwnerName = aryOwner[0].getOwnerFullName();
	logDebug("OwnerName = " + sOwnerName);
	}

if (sOwnerName != null && sOwnerName != "") {
	iPosPark = sOwnerName.toUpperCase().indexOf("PARKS");
	logDebug("iPosPark  = " + iPosPark);
	}

if (sOwnerName != null && sOwnerName != "") {
	iPosEng = sOwnerName.toUpperCase().indexOf("ENGINEER");
	logDebug("iPosEng  = " + iPosEng);
	}

if (sOwnerName != null && sOwnerName != "") {
	iPosWater = sOwnerName.toUpperCase().indexOf("WATER");
	logDebug("iPosWater = " + iPosWater);
	}

if (sOwnerName != null && sOwnerName != "") {
	iPosCda = sOwnerName.toUpperCase().indexOf("CDA");
	logDebug("iPosCda = " + iPosCda);
	}

if (iPosPark >= 0) {
	sDept = "Parks";
	deactivateTask("Water Utility Review");
	deactivateTask("City Engineering Review");
	deactivateTask("CDA Review");
	deactivateTask("Other Property Review");
	}

if (iPosEng >= 0) {
	sDept = "Engineering";
	deactivateTask("Water Utility Review");
	deactivateTask("Parks Review");
	deactivateTask("CDA Review");
	deactivateTask("Other Property Review");
	}

if (iPosWater >= 0) {
	sDept = "Water";
	deactivateTask("Parks Review");
	deactivateTask("City Engineering Review");
	deactivateTask("CDA Review");
	deactivateTask("Other Property Review");
	}

if (iPosCda >= 0) {
	sDept = "CDA";
	deactivateTask("Parks Review");
	deactivateTask("City Engineering Review");
	deactivateTask("Water Utility Review");
	deactivateTask("Other Property Review");
	}

if (iPosPark == -1 && iPosEng == -1 && iPosWater == -1 && iPosCda == -1) {
	sDept = "Other";
	deactivateTask("Parks Review");
	deactivateTask("City Engineering Review");
	deactivateTask("Water Utility Review");
	deactivateTask("CDA Review");
	}

logDebug("The parcel is owned by the " + sDept + " department.");
if (sOwnerName != null) {
	updateShortNotes(sOwnerName);
	}

if (sOwnerName != null) {
	updateWorkDesc(sOwnerName);
	}

wfObj = aa.workflow.getTasks(capId).getOutput();
for (i in wfObj) include("CMN;EmailAssignedAndAssignCap");
`^
CMN;Permitting!Parking!ParkingReadyToIssue^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (capStatus == "Open" || capStatus == "Online Submittal" || capStatus == "Pending Applicant Action" || capStatus == "Additional Info Required" || capStatus == "Pending Payment and!or Lease" || capStatus == "Pending Sticker Return") {
	aa.set.add ("PARKINGISSUANCE",capId);
	}

if (capStatus == "Open" || capStatus == "Online Submittal" || capStatus == "Pending Applicant Action" || capStatus == "Additional Info Required" || capStatus == "Pending Payment and!or Lease" || capStatus == "Pending Sticker Return") {
	updateAppStatus("In Process" ,"Updated because a permit number was assigned.", capId);
	}
`^
CMN;Permitting!Parking!Residential Parking!~;SetRenewalInfo^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
UpdateExpStatus = "";
if (capStatus == "Revoked" || capStatus == "Closed" || capStatus == "Inactive" || capStatus == "Withdrawn" || capStatus == "Surrendered" || capStatus == "Void" || capStatus == "Rejected") {
	UpdateExpStatus = "Inactive";
	}

if (capStatus == "Expired") {
	UpdateExpStatus = "Expired";
	}

if (UpdateExpStatus != "") {
	licEditExpInfo(UpdateExpStatus, null);
	}
`^
CMN;Permitting!Parking!Residential Parking!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['APPLICANT INFORMATION.Type of Application'] == "New Application") {
	if(feeExists("RPP", "NEW", "INVOICED") == false) updateFee("RPP","TPURPP","FINAL",1,"N");
	} else {
	if(feeExists("RPP") == true) removeFee("RPP","FINAL");
	}

if (AInfo['APPLICANT INFORMATION.Type of Application'] == "Replacement") {
	if(feeExists("REPL", "NEW", "INVOICED") == false) updateFee("REPL","TPURPP","FINAL",1,"N");
	} else {
	if(feeExists("REPL") == true) removeFee("REPL","FINAL");
	}

if (AInfo['APPLICANT INFORMATION.Type of Application'] == "Renewal") {
	if(feeExists("LIC_RENEWAL", "NEW", "INVOICED") == false) updateFee("LIC_RENEWAL","TPURPP","FINAL",1,"N");
	} else {
	if(feeExists("LIC_RENEWAL") == true) removeFee("LIC_RENEWAL","FINAL");
	}
`^
CMN;Permitting!Parks!~!~;ASITableRowCnt^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var oldRowCnt = 0;
var newRowCnt = 0;
var hasNext = false;
if (cmnSubType == "DiscGolf" && typeof(PERMITHOLDER) == "object") {
	for (eachrow in PERMITHOLDER) rowCount++;
	}

if (cmnSubType == "DogPark" && typeof(PERMITS) == "object") {
	for (eachrow in PERMITS) rowCount++;
	}

if (cmnSubType == "Lake Access" && typeof(ADDITIONALLICENSEPLATES) == "object") {
	for (eachrow in ADDITIONALLICENSEPLATES) rowCount++;
	}

if (cmnSubType == "SkiTrail" && typeof(PERMITHOLDER) == "object") {
	for (eachrow in PERMITHOLDER) rowCount++;
	}

oldRowCnt = rowCount;
rowCount = 0;
gm =  aa.env.getValue("AppSpecificTableGroupModel");
ta = gm.getTablesMap().values();
if (ta.empty == false) {
	tai = ta.iterator();
	tbl = tai.next();
	rows = tbl.getRowIndex();
	ri = rows.iterator();
	hasNext = ri.hasNext();
	}

if (hasNext == true) {
	while (ri.hasNext())  rowCount = parseInt(ri.next());
	}

if (hasNext == true) {
	rowCount = rowCount + 1;
	newRowCnt = rowCount;
	}

logDebug("oldRowCnt = " + oldRowCnt);
logDebug("newRowCnt = " + newRowCnt);
if (ta.empty == true) {
	rowCount = oldRowCnt;
	} else {
	rowCount = newRowCnt;
	}
`^
CMN;Permitting!Parks!~!~;CreateContactfromASI^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var rsContact = aa.people.createPeopleModel().getOutput();
rsContact.setServiceProviderCode("MADISON");
rsContact.setContactType("Applicant");
rsContact.setEmail(AInfo['MAILING INFORMATION.Email']);
rsContactModel = rsContact.getPeopleModel();
rsContactModel.setFirstName(AInfo['MAILING INFORMATION.First Name']);
rsContactModel.setLastName(AInfo['MAILING INFORMATION.Last Name']);
rsContactModel.setPhone1(AInfo['MAILING INFORMATION.Primary Phone']);
rsContactModel.setPhone2(AInfo['MAILING INFORMATION.Secondary Phone']);
rsContactModel.setPhone3(AInfo['MAILING INFORMATION.Other Phone']);
rsContactAddress = rsContact.getPeopleModel().getCompactAddress();
rsContactAddress.setAddressLine1(AInfo['MAILING INFORMATION.Address line 1']);
if (AInfo['MAILING INFORMATION.Address Line 2'] != "null") {
	rsContactAddress.setAddressLine2(AInfo['MAILING INFORMATION.Address Line 2']);
	}

rsContactAddress.setCity(AInfo['MAILING INFORMATION.City']);
rsContactAddress.setState(AInfo['MAILING INFORMATION.State']);
rsContactAddress.setZip(AInfo['MAILING INFORMATION.Zip']);
rsContactModel.setCompactAddress(rsContactAddress);
debugObject(rsContactModel);
contactResult = aa.people.createCapContactWithRefPeopleModel(capId, rsContactModel);
`^
CMN;Permitting!Parks!Block Party!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
feeCalc = 0;
if (AInfo['EVENT INFORMATION.Event Type'] == "One Day") {
	feeCalc = 1;
	}

updateFee("ONEDAY","PRKBLKPRTY","FINAL", feeCalc,"Y");
`^
CMN;Permitting!Parks!Dailies!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
row = "";
permitType = "";
skiTotal = 0;
lakeTotal = 0;
discTotal = 0;
dogTotal = 0;
for(oLoop in PERMITSSOLD) include("CMN;Permitting!Parks!Dailies!NA;Fee;Row");
if (lakeTotal > 0) {
	updateFee("LAKE ACCESS","PRKDLY","FINAL", lakeTotal,"N","N");
	}

if (discTotal > 0) {
	updateFee("DISC GOLF","PRKDLY","FINAL", discTotal,"N","N");
	logDebug("DISC TOTAL;"+discTotal);
	}

if (dogTotal > 0) {
	updateFee("DOG PARK","PRKDLY","FINAL", dogTotal,"N","N");
	}

if (skiTotal > 0) {
	updateFee("SKI TRAIL","PRKDLY","FINAL", skiTotal,"N","N");
	}
`^
CMN;Permitting!Parks!Dailies!NA;Fee;Row^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
permitType = PERMITSSOLD[oLoop]["Permit Type"];
TotalFee = Number(PERMITSSOLD[oLoop]["Total Fee"]);
if (PERMITSSOLD[oLoop]["Permit Type"] == "Lake Access") {
	lakeTotal += TotalFee;
	}

if (PERMITSSOLD[oLoop]["Permit Type"] == "Disc Golf") {
	discTotal += TotalFee;
	}

if (PERMITSSOLD[oLoop]["Permit Type"] == "Dog Park") {
	dogTotal += TotalFee;
	}

if (PERMITSSOLD[oLoop]["Permit Type"] == "Ski Trail") {
	skiTotal += TotalFee;
	}
`^
CMN;Permitting!Parks!DiscGolf!NA;ASITotalInternal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
bDoCancel = true;
rowCount = 0;
sPermitType = null;
sAnnualPermits = 0;
sReplacePermits = 0;
sDailyPermits = 0;
sDailyDate = null;
totalPermits =  0;
if (callEvent == "ASIUB") {
	bDoCancel = false;
	sPermitType = AInfo['GENERAL INFORMATION.Permit Type'];
	sAnnualPermits = AInfo['GENERAL INFORMATION.Annual Permits Requested'];
	sReplacePermits = AInfo['GENERAL INFORMATION.Replacement Permits Requested'];
	sDailyPermits = AInfo['GENERAL INFORMATION.Daily Permits Requested'];
	sDailyDate = AInfo['GENERAL INFORMATION.Daily Permit Date'];
	}

if (callEvent == "ASB") {
	sPermitType = AInfo['Permit Type'];
	sAnnualPermits = AInfo['Annual Permits Requested'];
	sReplacePermits = AInfo['Replacement Permits Requested'];
	sDailyPermits = AInfo['Daily Permits Requested'];
	sDailyDate = AInfo['Daily Permit Date'];
	}

include("CMN;Permitting!Parks!~!~;ASITableRowCnt");
if ((sAnnualPermits == null || sAnnualPermits == "")) {
	sAnnualPermits = 0;
	}

if ((sReplacePermits == null || sReplacePermits == "")) {
	sReplacePermits = 0;
	}

if ((sDailyPermits == null || sDailyPermits == "")) {
	sDailyPermits = 0;
	}

if (sPermitType == "Annual") {
	totalPermits =  parseInt(sAnnualPermits) + parseInt(sReplacePermits);
	}

if (sPermitType == "Daily") {
	totalPermits = parseInt(sDailyPermits);
	}

if (totalPermits <= 0) {
	cancel = bDoCancel;
	showMessage = true;
	comment("You need to request at least one permit in order to proceed.");
	}

if (sPermitType == "Daily" && (sDailyDate == null || sDailyDate == "")) {
	cancel = bDoCancel;
	showMessage = true;
	comment("You need to select a Daily Permit Date for Permit Type = Daily.");
	}

if (totalPermits > 0 && totalPermits > rowCount) {
	cancel = bDoCancel;
	showMessage = true;
	comment("You have indicated that " + totalPermits + " permits are being ordered.  Please add additional Permit Holder(s) to the table in order to proceed.");
	comment("There are currently " + rowCount + " Permit Holder(s) listed in the table.");
	}

if (totalPermits > 0 && totalPermits < rowCount) {
	cancel = bDoCancel;
	showMessage = true;
	comment("You have indicated that " + totalPermits + " permits are being ordered.  Please remove additional Permit Holder(s) from the table in order to proceed.");
	comment("There are currently " + rowCount + " Permit Holder(s) listed in the table.");
	}
`^
CMN;Permitting!Parks!DiscGolf!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL INFORMATION.Permit Type'] == "Annual" && AInfo['GENERAL INFORMATION.Annual Permits Requested'] > 0) {
	updateFee("ANNUAL","PRKDGP","FINAL",parseInt(AInfo['GENERAL INFORMATION.Annual Permits Requested']),"Y","N");
	} else {
	removeFee("ANNUAL","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Permit Type'] == "Annual" && AInfo['GENERAL INFORMATION.Replacement Permits Requested'] > 0) {
	updateFee("REPLACE","PRKDGP","FINAL",parseInt(AInfo['GENERAL INFORMATION.Replacement Permits Requested']),"Y", "N");
	} else {
	removeFee("REPLACE","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Permit Type'] == "Daily" && AInfo['GENERAL INFORMATION.Daily Permits Requested'] > 0) {
	updateFee("DAILY","PRKDGP","FINAL",parseInt(AInfo['GENERAL INFORMATION.Daily Permits Requested']),"Y", "N");
	} else {
	removeFee("DAILY","FINAL");
	}
`^
CMN;Permitting!Parks!DiscGolf!NA;PermitHolderValidation^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
rowCount = 0;
totalpermits =  0;
if (typeof(PERMITHOLDER) == "object") {
	for (eachrow in PERMITHOLDER) rowCount = rowCount + 1;
	}

if (AInfo['GENERAL INFORMATION.Permit Type'] == "Annual") {
	totalpermits = parseInt(AInfo['GENERAL INFORMATION.Annual Permits Requested']) +  parseInt(AInfo['GENERAL INFORMATION.Replacement Permits Requested']);
	}

if (AInfo['GENERAL INFORMATION.Permit Type'] == "Daily") {
	totalpermits = parseInt(AInfo['GENERAL INFORMATION.Daily Permits Requested']);
	}

if (totalpermits > rowCount) {
	cancel = true;
	showMessage = true;
	comment("You have indicated that you are ordering " + totalpermits + " permits.  Please add additional Permit Holders in the table below in order to proceed.");
	comment("Currently you have " + rowCount + " Permit Holder(s) defined.");
	}

if (totalpermits < rowCount) {
	cancel = true;
	showMessage = true;
	comment("You have indicated that you are ordering " + totalpermits + " permits.  Please remove additional Permit Holders in the table below in order to proceed.");
	comment("Currently you have " + rowCount + " Permit Holder(s) defined.");
	}
`^
CMN;Permitting!Parks!DogPark!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
regPay = false;
if (AInfo['GENERAL INFORMATION.Permit Type'] == "Annual" && AInfo['GENERAL INFORMATION.Permit already issued for the current year on another dog'] != "CHECKED" && AInfo['GENERAL INFORMATION.Annual Permits Requested'] != null && AInfo['GENERAL INFORMATION.Annual Permits Requested'] > 0 && AInfo['GENERAL INFORMATION.Senior!Disabled (65 or older)'] != "CHECKED") {
	updateFee("REGANN","PRKDGPRK","FINAL",1,"Y", "N");
	updateFee("ADDLPERM","PRKDGPRK","FINAL",AInfo['GENERAL INFORMATION.Annual Permits Requested']-1,"Y","N");
	regPay = true;
	} else {
	removeFee("REGANN","FINAL");
	removeFee("ADDLPERM","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Permit Type'] == "Annual" && AInfo['GENERAL INFORMATION.Permit already issued for the current year on another dog'] != "CHECKED" && AInfo['GENERAL INFORMATION.Annual Permits Requested'] != null && AInfo['GENERAL INFORMATION.Annual Permits Requested'] > 0 && AInfo['GENERAL INFORMATION.Senior!Disabled (65 or older)'] == "CHECKED") {
	updateFee("SENDIS","PRKDGPRK","FINAL",1,"Y", "N");
	updateFee("ADDLPERM","PRKDGPRK","FINAL",AInfo['GENERAL INFORMATION.Annual Permits Requested']-1,"Y","N");
	regPay = true;
	} else {
	removeFee("SENDIS","FINAL");
	if (AInfo['GENERAL INFORMATION.Senior!Disabled (65 or older)'] == "CHECKED") removeFee("ADDLPERM","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Permit Type'] == "Annual" && AInfo['GENERAL INFORMATION.Permit already issued for the current year on another dog'] == "CHECKED" && AInfo['GENERAL INFORMATION.Annual Permits Requested'] != null && AInfo['GENERAL INFORMATION.Annual Permits Requested'] > 0) {
	updateFee("ADDLPERM","PRKDGPRK","FINAL",AInfo['GENERAL INFORMATION.Annual Permits Requested'],"Y","N");
	} else {
	if(regPay == false) removeFee("ADDLPERM","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Permit Type'] == "Annual" && AInfo['GENERAL INFORMATION.Replacements Requested'] != null && AInfo['GENERAL INFORMATION.Replacements Requested'] > 0) {
	updateFee("REPL","PRKDGPRK","FINAL",AInfo['GENERAL INFORMATION.Replacements Requested'],"Y","N");
	} else {
	removeFee("REPL","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Permit Type'] == "Daily" && AInfo['GENERAL INFORMATION.Daily Permits Requested'] > 0) {
	updateFee("DAILY","PRKDGP","FINAL",parseInt(AInfo['GENERAL INFORMATION.Daily Permits Requested']),"Y", "N");
	} else {
	removeFee("DAILY","FINAL");
	}

if (false) {
	logDebug("IMPORTANT; Line 07b MUST be the last active line in this script.");
	}

if (AInfo['GENERAL INFORMATION.Service Dog'] == "CHECKED") {
	removeAllFees(capId);
	}
`^
CMN;Permitting!Parks!DogPark!NA;PermitQtyValidation^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
bDoCancel = true;
rowCount = 0;
sPermitType = null;
sAnnualPermits = 0;
sReplacePermits = 0;
sDailyPermits = 0;
sDailyDate = null;
totalPermits =  0;
if (callEvent == "ASIUB") {
	bDoCancel = false;
	sPermitType = AInfo['GENERAL INFORMATION.Permit Type'];
	sAnnualPermits = AInfo['GENERAL INFORMATION.Annual Permits Requested'];
	sReplacePermits = AInfo['GENERAL INFORMATION.Replacements Requested'];
	sDailyPermits = AInfo['GENERAL INFORMATION.Daily Permits Requested'];
	sDailyDate = AInfo['GENERAL INFORMATION.Daily Permit Date'];
	}

if (callEvent == "ASB") {
	sPermitType = AInfo['Permit Type'];
	sAnnualPermits = AInfo['Annual Permits Requested'];
	sReplacePermits = AInfo['Replacements Requested'];
	sDailyPermits = AInfo['Daily Permits Requested'];
	sDailyDate = AInfo['Daily Permit Date'];
	}

include("CMN;Permitting!Parks!~!~;ASITableRowCnt");
if ((sAnnualPermits == null || sAnnualPermits == "")) {
	sAnnualPermits = 0;
	}

if ((sReplacePermits == null || sReplacePermits == "")) {
	sReplacePermits = 0;
	}

if ((sDailyPermits == null || sDailyPermits == "")) {
	sDailyPermits = 0;
	}

if (sPermitType == "Annual") {
	totalPermits =  parseInt(sAnnualPermits) + parseInt(sReplacePermits);
	}

if (sPermitType == "Daily") {
	totalPermits = parseInt(sDailyPermits);
	}

if (totalPermits <= 0) {
	cancel = bDoCancel;
	showMessage = true;
	comment("You need to request at least one permit in order to proceed.");
	}

if (sPermitType == "Daily" && (sDailyDate == null || sDailyDate == "")) {
	cancel = bDoCancel;
	showMessage = true;
	comment("You need to select a Daily Permit Date for Permit Type = Daily.");
	}

if (totalPermits > 0 && totalPermits > rowCount) {
	cancel = bDoCancel;
	showMessage = true;
	comment("You have indicated that " + totalPermits + " permits are being ordered.  Please add additional Tag Number(s) to the PERMITS table in order to proceed.");
	comment("There are currently " + rowCount + " Tag Number(s) listed in the table.");
	}

if (totalPermits > 0 && totalPermits < rowCount) {
	cancel = bDoCancel;
	showMessage = true;
	comment("You have indicated that " + totalPermits + " permits are being ordered.  Please remove the extra Tag Number(s) from the PERMITS  table in order to proceed.");
	comment("There are currently " + rowCount + " Tag Number(s) listed in the table.");
	}
`^
CMN;Permitting!Parks!Electrical Amplification!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
cityContractor = undefined;
cityContractor =  lookup("ParksContractorEmails", AInfo['MAILING INFORMATION.Email']);
if (cityContractor != "No Fee") {
	updateFee("APPFEE","PRKELEAMP","FINAL",1,"Y");
	} else {
	removeFee("APPFEE","PRKELEAMP","FINAL",1,"Y");
	}

if (cityContractor != "No Fee" && (AInfo['EVENT INFORMATION.Site Times'] == "12;30 to 1;30 PM Daily" || AInfo['EVENT INFORMATION.Site Times'] == "12;30 PM to 1;30 Sun - Fri")) {
	updateFee("ELEAMP", "PRKELEAMP", "FINAL", 1, "Y");
	} else {
	removeFee("ELEAMP","PRKELEAMP","FINAL",1,"Y");
	}

if (cityContractor != "No Fee" && (AInfo['EVENT INFORMATION.Site Times'] == "9;30 to 11;00 AM Saturday" || AInfo['EVENT INFORMATION.Site Times'] == "11;30 to 1;00 PM Saturday")) {
	updateFee("ELEAMP", "PRKELEAMP", "FINAL", 2, "Y");
	} else {
	removeFee("ELEAMP","PRKELEAMP","FINAL",1,"Y");
	}

if (cityContractor != "No Fee" && AInfo['EVENT INFORMATION.Site Times'] == "5;00 PM to 7;00 PM Daily") {
	updateFee("ELEAMP", "PRKELEAMP", "FINAL", 2, "Y");
	} else {
	removeFee("ELEAMP","PRKELEAMP","FINAL",1,"Y");
	}
`^
CMN;Permitting!Parks!Farmers Market Electric!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
feeCalc = 0;
updateFee("FMELE","PRKFMELE","FINAL",1,"Y");
feeCalc = parseInt(AInfo['EVENT INFORMATION.Number of Weeks']) ~ 6;
if (feeCalc > 0) {
	updateFee("HOURLY","PRKFMELE","FINAL", feeCalc,"Y");
	} else {
	removeFee("HOURLY","FINAL");
	}
`^
CMN;Permitting!Parks!Lake Access!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
taSize = 0;
if (AInfo['GENERAL INFORMATION.Permit Type'] == "Dane County Resident") {
	updateFee("DCOR","PRKLAKE","FINAL",1,"Y","N");
	} else {
	removeFee("DCOR","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Permit Type'] == "Dane County Senior (65+) Resident") {
	updateFee("DCOS","PRKLAKE","FINAL",1,"Y","N");
	} else {
	removeFee("DCOS","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Permit Type'] == "Non Dane County Resident") {
	updateFee("NONR","PRKLAKE","FINAL",1,"Y","N");
	} else {
	removeFee("NONR","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Permit Type'] == "Non Dane County Senior (65+) Resident") {
	updateFee("NORSNR","PRKLAKE","FINAL",1,"Y","N");
	} else {
	removeFee("NORSNR","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Permit Type'] == "Disabled") {
	updateFee("DISAB","PRKLAKE","FINAL",1,"Y","N");
	} else {
	removeFee("DISAB","FINAL");
	}

if (AInfo['GENERAL INFORMATION.How many Replacements or Duplicates'] > 0) {
	updateFee("ADDL","PRKLAKE","FINAL",1,"Y","N");
	} else {
	removeFee("ADDL","FINAL");
	}

licPlateNumbers = loadASITable("ADDITIONAL LICENSE PLATES");
for(x in licPlateNumbers) taSize ++;
if (AInfo['GENERAL INFORMATION.Permit Type'] != "Replacement!Duplicate" && taSize != 0) {
	editAppSpecific("GENERAL INFORMATION.How many Replacements or Duplicates", taSize);
	updateFee("ADDL","PRKLAKE","FINAL",1,"Y","N");
	} else {
	if(AInfo['GENERAL INFORMATION.Permit Type'] != "Replacement!Duplicate") removeFee("ADDL","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Permit Type'] != "Replacement!Duplicate" && taSize == 0) {
	editAppSpecific("GENERAL INFORMATION.How many Replacements or Duplicates", 0);
	}
`^
CMN;Permitting!Parks!Lake Access!NA;FeeEstimate^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (getAppSpecific("GENERAL INFORMATION.Permit Type") == "Resident") {
	updateFee("DCOR","PRKLAKE","FINAL",1,"N");
	} else {
	removeFee("DCOR","FINAL");
	}

if (getAppSpecific("GENERAL INFORMATION.Permit Type") == "Senior (65+) Resident") {
	updateFee("DCOS","PRKLAKE","FINAL",1,"N");
	} else {
	removeFee("DCOS","FINAL");
	}

if (getAppSpecific("GENERAL INFORMATION.Permit Type") == "Non-Resident") {
	updateFee("NONR","PRKLAKE","FINAL",1,"N");
	} else {
	removeFee("NONR","FINAL");
	}

if (getAppSpecific("GENERAL INFORMATION.Permit Type") == "Senior (65+) Non-Resident") {
	updateFee("NORSNR","PRKLAKE","FINAL",1,"N");
	} else {
	removeFee("NORSNR","FINAL");
	}

if (getAppSpecific("GENERAL INFORMATION.Permit Type") == "Disabled") {
	updateFee("DISAB","PRKLAKE","FINAL",1,"N");
	} else {
	removeFee("DISAB","FINAL");
	}

if (getAppSpecific("GENERAL INFORMATION.How many Replacements or Duplicates") > 0) {
	updateFee("ADDL","PRKLAKE","FINAL",1,"N");
	} else {
	removeFee("ADDL","FINAL");
	}
`^
CMN;Permitting!Parks!Lake Access!NA;LicPlateValid^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
bDoCancel = true;
rowCount = 0;
sPermitType = null;
replaceDupCnt = 0;
IsReplaceDup = false;
if (callEvent == "ASIUB") {
	bDoCancel = false;
	sPermitType = AInfo['GENERAL INFORMATION.Permit Type'];
	replaceDupCnt = AInfo['GENERAL INFORMATION.How many Replacements or Duplicates'];
	}

if (callEvent == "ASB") {
	sPermitType = AInfo['Permit Type'];
	replaceDupCnt = AInfo['How many Replacements or Duplicates'];
	}

include("CMN;Permitting!Parks!~!~;ASITableRowCnt");
if (sPermitType == "Replacement!Duplicate") {
	IsReplaceDup = true;
	}

if (IsReplaceDup == true && replaceDupCnt <= 0) {
	cancel = bDoCancel;
	showMessage = true;
	comment("You have indicated that 0 Replacement or Duplicate permits are being ordered;
	you must enter at least 1.");
	}

if (IsReplaceDup == true && replaceDupCnt > 0 && replaceDupCnt > rowCount + 1) {
	cancel = bDoCancel;
	showMessage = true;
	comment("You have indicated that " + replaceDupCnt + " permits are being ordered.  Please add Additional License Plate(s) in order to proceed.");
	comment("There are currently " + rowCount + " Additional License Plate(s) defined.");
	}

if (IsReplaceDup == true && replaceDupCnt > 0 && replaceDupCnt < rowCount + 1) {
	cancel = bDoCancel;
	showMessage = true;
	comment("You have indicated that " + replaceDupCnt + " permits are being ordered.  Please remove Additional License Plate(s) in order to proceed.");
	comment("There are currently " + rowCount + " Additional License Plate(s) defined.");
	}
`^
CMN;Permitting!Parks!SkiTrail!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL INFORMATION.Permit Type'] == "Annual" && AInfo['GENERAL INFORMATION.Annual Passes Requested'] > 0) {
	updateFee("SKIANN","PRKSKITRAIL","FINAL",1,"Y","N");
	} else {
	removeFee("SKIANN","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Permit Type'] == "Annual" && AInfo['GENERAL INFORMATION.Replacement Passes Requested'] > 0) {
	updateFee("REP","PRKSKITRAIL","FINAL",1,"Y","N");
	} else {
	removeFee("REP","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Permit Type'] == "Annual" && AInfo['GENERAL INFORMATION.Senior Passes Requested'] > 0) {
	updateFee("SNR","PRKSKITRAIL","FINAL",1,"Y","N");
	} else {
	removeFee("SNR","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Permit Type'] == "Annual" && AInfo['GENERAL INFORMATION.Disabled Passes Requested'] > 0) {
	updateFee("DIS","PRKSKITRAIL","FINAL",1,"Y","N");
	} else {
	removeFee("DIS","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Permit Type'] == "Daily" && AInfo['GENERAL INFORMATION.Daily Passes Requested'] > 0) {
	updateFee("DAILY","PRKSKITRAIL","FINAL",1,"Y","N");
	} else {
	removeFee("DAILY","FINAL");
	}
`^
CMN;Permitting!Parks!SkiTrail!NA;FeeEstimate^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (getAppSpecific("GENERAL INFORMATION.Permit Type") == "Annual" && getAppSpecific("GENERAL INFORMATION.Annual Passes Requested") > 0) {
	updateFee("SKIANN","PRKSKITRAIL","FINAL",1,"N");
	} else {
	removeFee("SKIANN","FINAL");
	}

if (getAppSpecific("GENERAL INFORMATION.Permit Type") == "Annual" && getAppSpecific("GENERAL INFORMATION.Replacement Passes Requested") > 0) {
	updateFee("REP","PRKSKITRAIL","FINAL",1,"N");
	} else {
	removeFee("REP","FINAL");
	}

if (getAppSpecific("GENERAL INFORMATION.Permit Type") == "Annual" && getAppSpecific("GENERAL INFORMATION.Senior Passes Requested") > 0) {
	updateFee("SNR","PRKSKITRAIL","FINAL",1,"N");
	} else {
	removeFee("SNR","FINAL");
	}

if (getAppSpecific("GENERAL INFORMATION.Permit Type") == "Annual" && getAppSpecific("GENERAL INFORMATION.Disabled Passes Requested") > 0) {
	updateFee("DIS","PRKSKITRAIL","FINAL",1,"N");
	} else {
	removeFee("DIS","FINAL");
	}

if (getAppSpecific("GENERAL INFORMATION.Permit Type") == "Daily" && getAppSpecific("GENERAL INFORMATION.Daily Passes Requested") > 0) {
	updateFee("DAILY","PRKSKITRAIL","FINAL",1,"N");
	} else {
	removeFee("DAILY","FINAL");
	}
`^
CMN;Permitting!Parks!SkiTrail!NA;InternalPermitValid^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
bDoCancel = true;
rowCount = 0;
sPermitType = null;
sAnnualPermits = 0;
sReplacePermits = 0;
sSeniorPermits = 0;
sDisabledPermits = 0;
sDailyPermits = 0;
sDailyDate = null;
totalPermits =  0;
if (callEvent == "ASIUB") {
	bDoCancel = false;
	sPermitType = AInfo['GENERAL INFORMATION.Permit Type'];
	sAnnualPermits = AInfo['GENERAL INFORMATION.Annual Passes Requested'];
	sReplacePermits = AInfo['GENERAL INFORMATION.Replacement Passes Requested'];
	sSeniorPermits = AInfo['GENERAL INFORMATION.Senior Passes Requested'];
	sDisabledPermits = AInfo['GENERAL INFORMATION.Disabled Passes Requested'];
	sDailyPermits = AInfo['GENERAL INFORMATION.Daily Passes Requested'];
	sDailyDate = AInfo['GENERAL INFORMATION.Daily Pass Date'];
	}

if (callEvent == "ASB") {
	sPermitType = AInfo['Permit Type'];
	sAnnualPermits = AInfo['Annual Passes Requested'];
	sReplacePermits = AInfo['Replacement Passes Requested'];
	sSeniorPermits = AInfo['Senior Passes Requested'];
	sDisabledPermits = AInfo['Disabled Passes Requested'];
	sDailyPermits = AInfo['Daily Passes Requested'];
	sDailyDate = AInfo['Daily Pass Date'];
	}

include("CMN;Permitting!Parks!~!~;ASITableRowCnt");
if ((sAnnualPermits == null || sAnnualPermits == "")) {
	sAnnualPermits = 0;
	}

if ((sReplacePermits == null || sReplacePermits == "")) {
	sReplacePermits = 0;
	}

if ((sSeniorPermits == null || sSeniorPermits == "")) {
	sSeniorPermits = 0;
	}

if ((sDisabledPermits == null || sDisabledPermits == "")) {
	sDisabledPermits = 0;
	}

if ((sDailyPermits == null || sDailyPermits == "")) {
	sDailyPermits = 0;
	}

if (sPermitType == "Annual") {
	totalPermits = parseInt(sAnnualPermits) +  parseInt(sReplacePermits) +  parseInt(sSeniorPermits) +  parseInt(sDisabledPermits);
	}

if (sPermitType == "Daily") {
	totalPermits = parseInt(sDailyPermits);
	}

if (totalPermits <=0) {
	cancel = bDoCancel;
	showMessage = true;
	comment("You must enter at least one permit.");
	}

if (sPermitType == "Daily" && (sDailyDate == null || sDailyDate == "")) {
	cancel = bDoCancel;
	showMessage = true;
	comment("You need to select a Daily Permit Date for Permit Type = Daily.");
	}

if (totalPermits > rowCount) {
	cancel = bDoCancel;
	showMessage = true;
	comment("You have indicated that you are ordering " + totalPermits + " permits.  Please add additional Permit Holders in the table below in order to proceed.");
	comment("Currently you have " + rowCount + " Permit Holder(s) defined.");
	}

if (totalPermits < rowCount) {
	cancel = bDoCancel;
	showMessage = true;
	comment("You have indicated that you are ordering " + totalPermits + " permits.  Please remove additional Permit Holders in the table below in order to proceed.");
	comment("Currently you have " + rowCount + " Permit Holder(s) defined.");
	}
`^
CMN;Permitting!Parks!SkiTrail!NA;PermitHolderValidation^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
rowCount = 0;
totalpermits =  0;
if (typeof(PERMITHOLDER) == "object") {
	for (eachrow in PERMITHOLDER) rowCount = rowCount + 1;
	}

if (AInfo['GENERAL INFORMATION.Permit Type'] == "Annual") {
	totalpermits = parseInt(AInfo['GENERAL INFORMATION.Annual Passes Requested']) +  parseInt(AInfo['GENERAL INFORMATION.Replacement Passes Requested']) +  parseInt(AInfo['GENERAL INFORMATION.Senior Passes Requested']) +  parseInt(AInfo['GENERAL INFORMATION.Disabled Passes Requested']);
	}

if (AInfo['GENERAL INFORMATION.Permit Type'] == "Daily") {
	totalpermits = parseInt(AInfo['GENERAL INFORMATION.Daily Passes Requested']);
	}

if (totalpermits > rowCount) {
	cancel = true;
	showMessage = true;
	comment("You have indicated that you are ordering " + totalpermits + " permits.  Please add additional Permit Holders in the table below in order to proceed.");
	comment("Currently you have " + rowCount + " Permit Holder(s) defined.");
	}

if (totalpermits < rowCount) {
	cancel = true;
	showMessage = true;
	comment("You have indicated that you are ordering " + totalpermits + " permits.  Please remove additional Permit Holders in the table below in order to proceed.");
	comment("Currently you have " + rowCount + " Permit Holder(s) defined.");
	}
`^
CMN;Permitting!Parks!Special Event!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['PERMITS REQUIRED.Fireworks'] == "Yes") {
	updateFee("FIREWKS","PRKSPECEVENT","FINAL",1,"N");
	} else {
	removeFee("FIREWKS","FINAL");
	}

if (AInfo['EVENT TYPE.Full Day Commercial Shoot (Enter # of Days)'] > 0) {
	updateFee("FDCOMSHT","PRKSPECEVENT","FINAL",1,"N");
	} else {
	removeFee("FDCOMSHT","FINAL");
	}

if (AInfo['EVENT TYPE.Half Day Commercial Shoot (Enter # of Half-Days)'] > 0) {
	updateFee("HDCOMSHT","PRKSPECEVENT","FINAL",1,"N");
	} else {
	removeFee("HDCOMSHT","FINAL");
	}

if (AInfo['EQUIPMENT RENTAL.Number of Dumpsters Required'] > 0) {
	updateFee("DUMPSTER","PRKSPECEVENT","FINAL",1,"N");
	} else {
	removeFee("DUMPSTER","FINAL");
	}

if (AInfo['EQUIPMENT RENTAL.Number of Trash Barrels Required'] > 0) {
	updateFee("TRSHBRL","PRKSPECEVENT","FINAL",1,"N");
	} else {
	removeFee("TRSHBRL","FINAL");
	}
`^
CMN;Permitting!Parks!Special Event!NA;FeeEstimate^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (getAppSpecific("PERMITS REQUIRED.Fireworks") == "Yes") {
	updateFee("FIREWKS","PRKSPECEVENT","FINAL",1,"N");
	} else {
	removeFee("FIREWKS","FINAL");
	}

if (getAppSpecific("EVENT TYPE.Full Day Commercial Shoot (Enter # of Days)") > 0) {
	updateFee("FDCOMSHT","PRKSPECEVENT","FINAL",1,"N");
	} else {
	removeFee("FDCOMSHT","FINAL");
	}

if (getAppSpecific("EVENT TYPE.Half Day Commercial Shoot (Enter # of Half-Days)") > 0) {
	updateFee("HDCOMSHT","PRKSPECEVENT","FINAL",1,"N");
	} else {
	removeFee("HDCOMSHT","FINAL");
	}

if (getAppSpecific("EQUIPMENT RENTAL.Number of Dumpsters Required") > 0) {
	updateFee("DUMPSTER","PRKSPECEVENT","FINAL",1,"N");
	} else {
	removeFee("DUMPSTER","FINAL");
	}

if (getAppSpecific("EQUIPMENT RENTAL.Number of Trash Barrels Required") > 0) {
	updateFee("TRSHBRL","PRKSPECEVENT","FINAL",1,"N");
	} else {
	removeFee("TRSHBRL","FINAL");
	}
`^
CMN;Permitting!Parks!Street Use!~_FindDocumentsToEmail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = true;
if (var reportParmHash = aa.env.getValue("ReportParms");) {
	}

if (wfTask ==  "Final Review" && wfStatus == "Notify Approved List") {
	generateReport("Parks Permit", repParams , reportModule);
	}

if (wfTask ==  "Final Review" && wfStatus == "Notify Approved List") {
	aa.sleep(5000);
	}

getDocs = aa.document.getDocumentListByEntity(capId, "CAP");
if (getDocs.getSuccess()) {
	docList = getDocs.getOutput().toArray();
	}

fileNames = new Array();
docListNames = "";
if (getDocs.getSuccess()) {
	for (d in docList) include("CMN;Permitting!Parks!Street Use!~_FindDocumentsToEmail_loop1");
	}

addParameter(params, "$$fileAattachMsg$$", "");
emailList = "";
lookupEmailList = aa.bizDomain.getBizDomain("Parks Street Use Distribution List");
if (lookupEmailList.getSuccess()) {
	lookupEmailArray = lookupEmailList.getOutput().toArray();
	}

if (lookupEmailList.getSuccess()) {
	for (e in lookupEmailArray) emailList += lookupEmailArray[e].bizdomainValue + ";
	";
	}

logDebug(emailList);
if (docListNames != "") {
	addParameter(params, "$$fileAattachMsg$$", "Attached documents; " + docListNames);
	}
`^
CMN;Permitting!Parks!Street Use!~_FindDocumentsToEmail_loop1^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var found = "";
if (docList[d].getDocCategory() == "Route Map" || docList[d].getDocCategory() == "Site Map" || docList[d].getDocCategory() == "Parks Permit") {
	found = "True";
	}

if (found == "True") {
	var downloadResult = aa.document.downloadFile2Disk(docList[d],docList[d].getModuleName(),"","",true);
	}

if (found == "True") {
	fileNames.push(downloadResult.getOutput());
	}

if (found == "True" && docListNames != "") {
	docListNames += ", ";
	}

if (found == "True") {
	docListNames += docList[d].getDocName();
	}
`^
CMN;Permitting!Parks!Street Use!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['EVENT INFORMATION.Event Type'] == "One Day") {
	updateFee("OTE","PRKSTRUSE","FINAL",1,"Y");
	} else {
	removeFee("OTE","FINAL");
	}

if (AInfo['EVENT INFORMATION.Event Type'] == "Multi-Day") {
	updateFee("MULTDAYEVENT","PRKSTRUSE","FINAL",1,"Y");
	} else {
	removeFee("MULTDAYEVENT","FINAL");
	}

if (AInfo['EVENT INFORMATION.Event Type'] == "Recurring One Day") {
	updateFee("SEREVENT","PRKSTRUSE","FINAL",1,"Y");
	} else {
	removeFee("SEREVENT","FINAL");
	}

if (AInfo['EQUIPMENT RENTAL.Number of Dumpsters Required'] > 0) {
	updateFee("DMPSTR","PRKSTRUSE","FINAL",parseInt(AInfo['EQUIPMENT RENTAL.Number of Dumpsters Required']),"Y");
	} else {
	removeFee("DMPSTR","FINAL");
	}

if (AInfo['EQUIPMENT RENTAL.Number of Trash Barrels Required'] > 0) {
	updateFee("TRSHBRLS","PRKSTRUSE","FINAL",parseInt(AInfo['EQUIPMENT RENTAL.Number of Trash Barrels Required']),"N");
	} else {
	removeFee("TRSHBRLS","FINAL");
	}

if (AInfo['EQUIPMENT RENTAL.Recycling Barrels'] > 0) {
	updateFee("RECBRLS","PRKSTRUSE","FINAL",parseInt(AInfo['EQUIPMENT RENTAL.Recycling Barrels']),"N");
	} else {
	removeFee("RECBRLS","FINAL");
	}

if (AInfo['EQUIPMENT RENTAL.Electrical Adapters Needed'] > 0) {
	updateFee("ELECADAPT","PRKSTRUSE","FINAL",parseInt(AInfo['EQUIPMENT RENTAL.Electrical Adapters Needed']),"N");
	} else {
	removeFee("ELECADAPT","FINAL");
	}

if (AInfo['PERMITS REQUIRED.Will Public Amplification be needed?'] == "Yes") {
	updateFee("PUBAMP","PRKSTRUSE","FINAL",1,"N");
	} else {
	removeFee("PUBAMP","FINAL");
	}

if (AInfo['PERMITS REQUIRED - VENDING.Number of Vendors'] <= 25) {
	updateFee("UMBVEND","PRKSTRVEND","FINAL",1,"N","N");
	} else {
	removeFee("UMBVEND","FINAL");
	}

if (AInfo['PERMITS REQUIRED - VENDING.Number of Vendors'] > 25 && AInfo['PERMITS REQUIRED - VENDING.Number of Vendors'] <= 100) {
	updateFee("26UMBVEND","PRKSTRVEND","FINAL",1,"N");
	} else {
	removeFee("26UMBVEND","FINAL");
	}

if (AInfo['PERMITS REQUIRED - VENDING.Number of Vendors'] > 300) {
	updateFee("301UMBVEND","PRKSTRVEND","FINAL",1,"N");
	} else {
	removeFee("301UMBVEND","FINAL");
	}
`^
CMN;Permitting!Parks!Street Use!NA;WFFee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['EQUIPMENT RENTAL.Number of Bus Routes Disrupted'] > 0) {
	updateFee("BUSROUTE","PRKSTRUSE","FINAL",parseInt(AInfo['EQUIPMENT RENTAL.Number of Bus Routes Disrupted']),"Y");
	} else {
	removeFee("BUSROUTE","FINAL");
	}
`^
CMN;Permitting!Parks!Temporary Structure!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['TEMP STRUCTURE INFORMATION.Number of Structures in Designated Sites'] != null) {
	if(feeExists("TSDESSITE") == false) updateFee("TSDESSITE","PRKTMPSTR","FINAL",1,"N");
	} else {
	if(feeExists("TSDESSITE") == true) removeFee("TSDESSITE","FINAL");
	}

if (AInfo['TEMP STRUCTURE INFORMATION.Additional Days Structure to Remain on Site'] != null) {
	if(feeExists("TSSUCCDAY") == false) updateFee("TSSUCCDAY","PRKTMPSTR","FINAL",1,"N");
	} else {
	if(feeExists("TSSUCCDAY") == true) removeFee("TSSUCCDAY","FINAL");
	}

if (AInfo['TEMP STRUCTURE INFORMATION.Number of Structures in Non-Designated Sites'] != null) {
	if(feeExists("TSUDESSTE") == false) updateFee("TSUDESSTE","PRKTMPSTR","FINAL",1,"N");
	} else {
	if(feeExists("TSUDESSTE") == true) removeFee("TSUDESSTE","FINAL");
	}
`^
CMN;Permitting!Parks!Vending!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['VENDING PERMIT TYPE.Annual Non-Profit Vendor Permit'] != null) {
	if(feeExists("ANNUNP") == false) updateFee("ANNUNP","PRKVEND","FINAL",1,"N");
	} else {
	if(feeExists("ANNUNP") == true) removeFee("ANNUNP","FINAL");
	}

if (AInfo['VENDING PERMIT TYPE.Annual Commercial Vendor Permit'] != null) {
	if(feeExists("ANNUPR") == false) updateFee("ANNUPR","PRKVEND","FINAL",1,"N");
	} else {
	if(feeExists("ANNUPR") == true) removeFee("ANNUPR","FINAL");
	}

if (AInfo['VENDING PERMIT TYPE.Daily Commercial Vendor Permit (Enter # Days Required)'] != null) {
	if(feeExists("COMVEND") == false) updateFee("COMVEND","PRKVEND","FINAL",1,"N");
	} else {
	if(feeExists("COMVEND") == true) removeFee("COMVEND","FINAL");
	}

if (AInfo['VENDING PERMIT TYPE.Daily Non-Profit Vendor Permit (Enter # Days Required)'] != null) {
	if(feeExists("NCOMVEND") == false) updateFee("NCOMVEND","PRKVEND","FINAL",1,"N");
	} else {
	if(feeExists("NCOMVEND") == true) removeFee("NCOMVEND","FINAL");
	}
`^
CMN;Permitting!Traffic Engineering!Bicycle Registration!~;UpdateB1Expiration^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var lic = new licenseObject(capIDString);
if (lic) {
	var renStatus = lic.getStatus();
	}

var expDate = getAppSpecific("DECAL INFORMATION.Expiration Date");
if (renStatus == "Pending") {
	licEditExpInfo("Active",expDate);
	} else {
	licEditExpInfo(null,expDate);
	}
`^
CMN;Permitting!Traffic Engineering!Bicycle Registration!~DcalDuplicateCheck^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
check = 0;
checkType = "DECAL INFORMATION";
checkDesc = "Decal Number";
if (callType == "ASBCRCB") {
	asiValue = AInfo['Decal Number'];
	}

if (callType == "ASIUB") {
	asiValue = AInfo['DECAL INFORMATION.Decal Number'];
	}

bDate =  "1!1!" + (startDate.getFullYear() + 5);
eDate =  "12!31!" + (startDate.getFullYear() + 5);
if (callType == "ASIUB" && cmnCategory == "NA") {
	check = findDuplicateASIValues(callType, checkType, checkDesc, asiValue, 'Expire', bDate, eDate, true);
	}

if (callType == "ASIUB" && cmnCategory == "Renewal") {
	check = findDuplicateASIValues(callType, checkType, checkDesc, asiValue, 'Expire', bDate, eDate, false);
	}

if (callType == "ASBCRCB") {
	check = findDuplicateASIValues(callType, checkType, checkDesc, asiValue, 'Expire', bDate, eDate, false);
	}

if (check > 0) {
	cancel = true;
	showMessage = true;
	comment("The Decal Number entered (" + asiValue + " ) is already being used.  Please enter another Decal Number.");
	}
`^
CMN;Permitting!Traffic Engineering!Bicycle Registration!NA;ASIToCAPDetail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
updateShortNotes(getAppSpecific("DECAL INFORMATION.Decal Number"));
editAppName(getAppSpecific("BICYCLE INFORMATION.Serial Number"));
`^
CMN;Permitting!Traffic Engineering!Bicycle Registration!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['DECAL INFORMATION.If two other bicycles currently registered in household, check this box'] == "CHECKED") {
	removeFee("TEBRSTD","FINAL");
	updateFee("TEBRMULT","TEBKRG","FINAL",1,"N","N");
	} else {
	removeFee("TEBRMULT","FINAL");
	updateFee("TEBRSTD","TEBKRG","FINAL",1,"N","N");
	}
`^
CMN;Permitting!Traffic Engineering!Bicycle Registration!NA;HistoryUpdate^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
dtToday = new Date();
dtExpire = dtToday;
newStatus = "Registration Active";
if (AInfo['DECAL INFORMATION.Expiration Date'] != null) {
	dtExpire = new Date(AInfo['DECAL INFORMATION.Expiration Date']);
	}

if (dtToday > dtExpire) {
	newStatus = "Registration Expired";
	}

updateAppStatus(newStatus, "History Update");
`^
CMN;Permitting!Traffic Engineering!Bicycle Registration!NA;SetVendor^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
licProf = aa.licenseProfessional.getLicenseProf(capId).getOutput();
tLicNbr = licProf[0].getLicenseNbr();
if (AInfo['DECAL INFORMATION.Vendor ID'] == null && tLicNbr != null) {
	editAppSpecific("DECAL INFORMATION.Vendor ID",tLicNbr);
	}

debugObject(tLicNbr);
comment(tLicNbr);
comment(AInfo['DECAL INFORMATION.Vendor ID']);
`^
CMN;Permitting!Traffic Engineering!Bicycle Registration!Renewal;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (getAppSpecific("DECAL INFORMATION.If two other bicycles currently registered in household, check this box") == "CHECKED") {
	updateFee("TEBRMULT","TEBKRG","FINAL",1,"N");
	} else {
	removeFee("TEBRMULT","FINAL");
	}

if (getAppSpecific("DECAL INFORMATION.If two other bicycles currently registered in household, check this box") != "CHECKED") {
	updateFee("TEBRSTD","TEBKRG","FINAL",1,"N");
	} else {
	removeFee("TEBRSTD","FINAL");
	}
`^
CMN;Permitting!Traffic Engineering!Driveway!Commercial;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
DriveWayCount = 0;
ProtectionOfExistingConduitCount = 0;
DriveWay30Count = 0;
DriveWayOver30Count = 0;
SpareConduitCount = 0;
ClosureCount = 0;
tblDriveWay = loadASITable("DRIVEWAYS");
if (tblDriveWay != undefined) {
	DriveWayCount = tblDriveWay.length;
	}

isInvoiced = feeExists("TEDRVSTD", "INVOICED");
if (isInvoiced == false) {
	if(feeExists("TEDRVSTD") == true) removeFee("TEDRVSTD","FINAL");
	}

if (DriveWayCount > 0) {
	for(x in tblDriveWay) include("CMN;Permitting!Traffic Engineering!Driveway!Commercial;FeeLoop");
	}

if ((DriveWayCount > 0) && (isInvoiced == false)) {
	if(feeExists("TEDRVSTD") == false) addFee("TEDRVSTD","ENGTEDRV","FINAL", DriveWayCount-ClosureCount ,"N");
	}

isInvoiced = feeExists("TEDRVFC", "INVOICED");
if ((isInvoiced == false)) {
	if(feeExists("TEDRVFC") == true) removeFee("TEDRVFC","FINAL");
	}

if ((DriveWay30Count > 0) && (isInvoiced == false)) {
	if(feeExists("TEDRVFC") == false) addFee("TEDRVFC","ENGTEDRV","FINAL", DriveWay30Count,"N");
	}

isInvoiced = feeExists("TEDRVFC30", "INVOICED");
if ((isInvoiced == false)) {
	if(feeExists("TEDRVFC30") == true) removeFee("TEDRVFC30","FINAL");
	}

if ((DriveWayOver30Count > 0) && (isInvoiced == false)) {
	if(feeExists("TEDRVFC30") == false) addFee("TEDRVFC30","ENGTEDRV","FINAL", DriveWayOver30Count,"N");
	}

isInvoiced = feeExists("TEDRVSC", "INVOICED");
if ((isInvoiced == false)) {
	if(feeExists("TEDRVSC") == true) removeFee("TEDRVSC","FINAL");
	}

if ((SpareConduitCount > 0) && (isInvoiced == false)) {
	if(feeExists("TEDRVSC") == false) addFee("TEDRVSC","ENGTEDRV","FINAL", SpareConduitCount,"N");
	}

isInvoiced = feeExists("TEDRVCP", "INVOICED");
if ((isInvoiced == false)) {
	if(feeExists("TEDRVCP") == true) removeFee("TEDRVCP","FINAL");
	}

if ((ProtectionOfExistingConduitCount > 0) && (isInvoiced == false)) {
	if(feeExists("TEDRVCP") == false) addFee("TEDRVCP","ENGTEDRV","FINAL", ProtectionOfExistingConduitCount,"N");
	}

isInvoiced = feeExists("TEDRVCLS", "INVOICED");
if ((isInvoiced == false)) {
	if(feeExists("TEDRVCLS") == true) removeFee("TEDRVCLS","FINAL");
	}

if ((ClosureCount > 0) && (isInvoiced == false)) {
	if(feeExists("TEDRVCLS") == false) addFee("TEDRVCLS","ENGTEDRV","FINAL", ClosureCount, "N");
	}

if (isTaskStatus("Intake", "Application Accepted") == true) {
	include("CMN;Permitting!Traffic Engineering!Driveway!Commercial;UpdateASIT");
	}
`^
CMN;Permitting!Traffic Engineering!Driveway!Commercial;FeeLoop^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
DriveWayOver30 = false;
ProtectionOfExistingConduit = false;
SpareConduit = false;
Closure = false;
NumberOfConduits = tblDriveWay[x]["# of Cndt"];
if (tblDriveWay[x]["Ent Wdt"] > 30) {
	DriveWayOver30 = true;
	}

if (tblDriveWay[x]["Prtct Ext Cndt"] == "CHECKED") {
	ProtectionOfExistingConduit = true;
	} else {
	ProtectionOfExistingConduit = false;
	}

if (tblDriveWay[x]["Spare Cndt"]  == "CHECKED") {
	SpareConduit = true;
	}

if (tblDriveWay[x]["Closure"]  == "CHECKED") {
	Closure = true;
	}

if (DriveWayOver30 && NumberOfConduits > 0) {
	DriveWayOver30Count = parseInt(DriveWayOver30Count,10) + parseInt(NumberOfConduits,10);
	}

if (DriveWayOver30 == false && NumberOfConduits > 0) {
	DriveWay30Count = parseInt(DriveWay30Count,10) + parseInt(NumberOfConduits,10);
	}

if (ProtectionOfExistingConduit) {
	ProtectionOfExistingConduitCount = ProtectionOfExistingConduitCount + 1;
	}

if (SpareConduit) {
	SpareConduitCount = SpareConduitCount + 1;
	}

if (Closure) {
	ClosureCount = ClosureCount + 1;
	}
`^
CMN;Permitting!Traffic Engineering!Driveway!Commercial;GetFees^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
teFee = 0;
electricalFee = 0;
closureFee = 0;
SigningFee = feeAmount("TEDRVSMK","NEW", "INVOICED");
teFee += feeAmount("TEDRVSTD","NEW", "INVOICED");
closureFee = feeAmount("TEDRVCLS","NEW", "INVOICED");
electricalFee += feeAmount("TEDRVFC","NEW", "INVOICED");
electricalFee += feeAmount("TEDRVFC30","NEW", "INVOICED");
electricalFee += feeAmount("TEDRVAC","NEW", "INVOICED");
electricalFee += feeAmount("TEDRVAC30","NEW", "INVOICED");
electricalFee += feeAmount("TEDRVCP","NEW", "INVOICED");
electricalFee += feeAmount("TEDRVSC","NEW", "INVOICED");
`^
CMN;Permitting!Traffic Engineering!Driveway!Commercial;MakePayment^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var oPay = null;
var oPayResult = null;
var paySeqNum = null;
var bPaySuccess = false;
oPay = aa.finance.createPaymentScriptModel();
if (oPay) {
	oPay.setAuditDate(aa.date.getCurrentDate());
	}

if (oPay) {
	oPay.setAuditStatus("A");
	}

if (oPay) {
	oPay.setCapID(capId);
	}

if (oPay) {
	oPay.setCashierID(currentUserID);
	}

if (oPay) {
	oPay.setPaymentSeqNbr(oPay.getPaymentSeqNbr());
	}

if (oPay) {
	oPay.setPaymentAmount(oCapDetail.getBalance());
	}

if (oPay) {
	oPay.setAmountNotAllocated(oCapDetail.getBalance());
	}

if (oPay) {
	oPay.setPaymentChange(0);
	}

if (oPay) {
	oPay.setPaymentComment("Payment made via script");
	}

if (oPay) {
	oPay.setPaymentDate(aa.date.getCurrentDate());
	}

if (oPay) {
	oPay.setPaymentMethod("Check");
	}

if (oPay) {
	oPay.setPaymentStatus("Paid");
	}

if (oPay) {
	oPayResult = aa.finance.makePayment(oPay);
	}

if (oPayResult) {
	bPaySuccess = oPayResult.getSuccess();
	}

logDebug("Calling function applyPayments, assuming successful payment was made.");
if (oPayResult && bPaySuccess) {
	applyPayments();
	paySeqNum = oPayResult.getOutput();
	} else {
	logDebug("Error Message for makePayment function; " + oPayResult.getErrorMessage());
	logDebug("Error Type; " + oPayResult.getErrorType());
	}

if (oPayResult && bPaySuccess && paySeqNum) {
	aa.finance.generateReceipt(capId,aa.date.getCurrentDate(),paySeqNum,currentUserID,null);
	}
`^
CMN;Permitting!Traffic Engineering!Driveway!Commercial;SetReviews^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['OFFICE USE ONLY.City Engineer Approval'] == "CHECKED") {
	activateTask("City Engineer Review");
	}

if (AInfo['OFFICE USE ONLY.City Engineer Approval'] != "CHECKED") {
	deactivateTask("City Engineer Review");
	}

isElectricalReview = isTaskActive("Electrical Review");
if (isElectricalReview == undefined) {
	isElectricalReview = false;
	}

if (!!Initially customer noted review only req'd if conduit. Then noted the electrical review is where that will be determined. Leaving code in place in case this changes.) {
	}

isSigningandMarking = isTaskActive("Signing and Marking");
if (isSigningandMarking == undefined) {
	isSigningandMarking = false;
	}

if (isSigningandMarking && AInfo['OFFICE USE ONLY.Signing and Marking Review'] != "CHECKED") {
	deactivateTask("Signing and Marking");
	}

if (isSigningandMarking == false && AInfo['OFFICE USE ONLY.Signing and Marking Review'] == "CHECKED") {
	activateTask("Signing and Marking");
	}

if (intakeComplete) {
	include("EML;Permitting!Traffic Engineering!Driveway!Commercial;IntakeComplete");
	}

if (assignedSigning && AInfo['OFFICE USE ONLY.Signing and Marking Review'] == "CHECKED") {
	include("EML;Permitting!Traffic Engineering!Driveway!Commercial;SigningAssigned");
	}
`^
CMN;Permitting!Traffic Engineering!Driveway!Commercial;UpdateASIT^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
cloneParentFound = false;
cloneTableFound = false;
teFee = 0;
electricalFee = 0;
electricalComment = "";
isElectricalReviewDone = false;
SigningFee = 0;
closureFee = 0;
signingComment = "";
closureComment = "";
isSigningDone = false;
parentCapId = getParent();
if (parentCapId != false) {
	cloneParentFound = true;
	}

if (cloneParentFound) {
	tblTE = loadASITable("TRAFFIC ENGINEERING", parentCapId);
	}

if (cloneParentFound && tblTE != undefined) {
	cloneTableFound = true;
	}

tblNewTE= new Array();
tblNewTERow = new Array();
if (cloneParentFound) {
	include("CMN;Permitting!Traffic Engineering!Driveway!Commercial;GetFees");
	}

if (cloneParentFound) {
	tblNewTERow["Status"] = "Supplement Required";
	}

if (cloneParentFound && (electricalFee > 0)) {
	electricalComment = " and Deposit to Insure Conduit of $ " + electricalFee;
	}

if (isTaskComplete("Electrical Review") == true) {
	isElectricalReviewDone = true;
	}

if (isElectricalReviewDone == false) {
	electricalComment = " and Deposit to Insure Conduit of $ (TBD - by Electrical Section)";
	}

signingAssigned = isTaskStatus("Signing and Marking", "Assigned");
if (signingAssigned == undefined) {
	signingAssigned = false;
	}

if (signingAssigned) {
	signingAssigned = isTaskActive("Signing and Marking");
	}

if (signingAssigned == undefined) {
	signingAssigned = false;
	}

if (signingAssigned) {
	signingComment = " A deposit of $ (TBD) payable to City Treasurer will be required for the installation of traffic signage and markings deemed necessary with the completion of the development.";
	}

isSigningDone = isTaskStatus("Signing and Marking", "Completed");
if (isSigningDone) {
	signingComment = " A deposit of $ " + SigningFee + " payable to City Treasurer will be required for the installation of traffic signage and markings deemed necessary with the completion of the development.  The applicant shall complete a Responsible Party Form and return it to Traffic Engineering.";
	}

if (closureFee > 0) {
	closureComment = " and a closure fee of $ " + closureFee;
	}

if (cloneParentFound) {
	tblNewTERow["Comment"] = "The Driveway Approach Fee of $ " + teFee + electricalComment + closureComment + " is payable to the City of Madison Treasurer to be delivered or mailed to Attention Eric Halvorson, Traffic Engineering, Madison Municipal Building, Suite 100, 215 Martin Luther King Jr. Blvd., P.O. Box 2986, Madison, Wisconsin 53701-2986."  + signingComment;
	}

if (cloneParentFound) {
	tblNewTERow["Revision"] = "0";
	}

if (cloneParentFound) {
	dtToday = new Date();
	sdt = String(dtToday.getMonth() + 1)+"!"+dtToday.getDate()+"!"+dtToday.getFullYear();
	}

if (cloneParentFound) {
	tblNewTERow["Date"] = sdt;
	}

if (cloneParentFound) {
	tblNewTE.push(tblNewTERow);
	}

if (cloneTableFound) {
	for(x in tblTE) include("CMN;Permitting!Traffic Engineering!Driveway!Commercial;UpdateASITLoop");
	}

if (cloneTableFound) {
	removeASITable("TRAFFIC ENGINEERING", parentCapId);
	}

if (cloneParentFound) {
	addASITable("TRAFFIC ENGINEERING", tblNewTE, parentCapId);
	}
`^
CMN;Permitting!Traffic Engineering!Driveway!Commercial;UpdateASITLoop^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
Comment = String(tblTE[x]["Comment"]);
copyRow = (Comment.substr(0, 28) != "The Driveway Approach Fee of" && Comment.substr(0, 44) != "Permitting Fees Due for Commercial Driveway;");
tblNewTERow = new Array();
tblNewTERow["Status"] = tblTE[x]["Status"];
tblNewTERow["Comment"] = tblTE[x]["Comment"];
tblNewTERow["Revision"] = tblTE[x]["Revision"];
tblNewTERow["Date"] = tblTE[x]["Date"];
if (copyRow) {
	tblNewTE.push(tblNewTERow);
	}
`^
CMN;Permitting!Traffic Engineering!Street Occupancy!NA;ASITFee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
removeAllFees(capId);
tblOCD = loadASITable("OCCUPANCY DETAILS");
if (tblOCD) {
	for (eachrow in tblOCD) include("CMN;Permitting!Traffic Engineering!Street Occupancy!NA;EachRow");
	}
`^
CMN;Permitting!Traffic Engineering!Street Occupancy!NA;BiEmail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
emailSubject = "Street Occupancy Permit Review Required" + capId + "";
emailBody = "Please be advised that Street Occupancy Permit " + capId + "has been applied for and requires your review.";
email("noreply@cityofmadisonDEV.com","mvanerem@cityofmadisonDEV.com","jmoyer@cityofmadisonDEV.com",emailSubject,emailBody);
email("noreply@cityofmadisonDEV.com","aharper@cityofmadisonDEV.com","jmoyer@cityofmadisonDEV.com",emailSubject,emailBody);
`^
CMN;Permitting!Traffic Engineering!Street Occupancy!NA;Central^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (strClassification == "Arterial") {
	if (bolSidewalk) addFeeWithExtraData("TESOCSACE","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	if (bolCoveredSidewalk) addFeeWithExtraData("TESOCSA5CE","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	if (bolTerrace) addFeeWithExtraData("TESOCTACE","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	if (bolParkingLane) addFeeWithExtraData("TESOCPACE","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	if (bolTravelLane || bolBikeLane) addFeeWithExtraData("TESOCTLACE","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	}

if (strClassification == "Collector") {
	if (bolSidewalk) addFeeWithExtraData("TESOCSCCE","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	if (bolCoveredSidewalk) addFeeWithExtraData("TESOCSC5CE","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	if (bolTerrace) addFeeWithExtraData("TESOCTCCE","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	if (bolParkingLane) addFeeWithExtraData("TESOCPCCE","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	if (bolTravelLane || bolBikeLane) addFeeWithExtraData("TESOCTLCCE","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	}

if (strClassification == "Local") {
	if (bolSidewalk) addFeeWithExtraData("TESOCSLCE","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	if (bolCoveredSidewalk) addFeeWithExtraData("TESOCSL5CE","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	if (bolTerrace) addFeeWithExtraData("TESOCTLCE","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	if (bolParkingLane) addFeeWithExtraData("TESOCPLCE","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	if (bolTravelLane || bolBikeLane) addFeeWithExtraData("TESOCTLLCE","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	}
`^
CMN;Permitting!Traffic Engineering!Street Occupancy!NA;EachRow^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (tblOCD[eachrow]["CBD"] == "CHECKED") {
	bolCBD = true;
	} else {
	bolCBD = false;
	}

strSteetName = tblOCD[eachrow]["Street Name"];
if (tblOCD[eachrow]["Sidewalk"] == "CHECKED") {
	bolSidewalk = true;
	} else {
	bolSidewalk = false;
	}

if (tblOCD[eachrow]["Covered Sidewalk"] == "CHECKED") {
	bolCoveredSidewalk = true;
	} else {
	bolCoveredSidewalk = false;
	}

if (tblOCD[eachrow]["Terrace"] == "CHECKED") {
	bolTerrace = true;
	} else {
	bolTerrace = false;
	}

if (tblOCD[eachrow]["Bike Lane"] == "CHECKED") {
	bolBikeLane = true;
	} else {
	bolBikeLane = false;
	}

if (tblOCD[eachrow]["Travel Lane"] == "CHECKED") {
	bolTravelLane = true;
	} else {
	bolTravelLane = false;
	}

if (tblOCD[eachrow]["Parking Lane"] == "CHECKED") {
	bolParkingLane = true;
	} else {
	bolParkingLane = false;
	}

intDays = tblOCD[eachrow]["Days"];
intDistance = tblOCD[eachrow]["Distance"];
if (intDistance >= 0) {
	intNumSegments = Math.ceil(intDistance!25);
	}

if (intDays <= 7) {
	intFeeMultiplier = 1 ~ intNumSegments;
	}

if (intDays >= 8 && intDays <= 30) {
	intFeeMultiplier = 2 ~ intNumSegments;
	}

if (intDays >= 31) {
	intFeeMultiplier = (2+(Math.floor((intDays-1)!30)~2)) ~ intNumSegments;
	}

strClassification = tblOCD[eachrow]["Classification"];
if (bolCBD) {
	include("CMN;Permitting!Traffic Engineering!Street Occupancy!NA;Central");
	} else {
	include("CMN;Permitting!Traffic Engineering!Street Occupancy!NA;NonCentral");
	}
`^
CMN;Permitting!Traffic Engineering!Street Occupancy!NA;ErocEmail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
emailSubject = "Street Occupancy Permit Review Required" + capId + "";
emailBody = "Please be advised that Street Occupancy Permit " + capId + "has been applied for and requires your review.";
email("noreply@cityofmadisonDEV.com","ttroester@cityofmadisonDEV.com","jmoyer@cityofmadisonDEV.com",emailSubject,emailBody);
email("noreply@cityofmadisonDEV.com","jbenedict@cityofmadisonDEV.com","jmoyer@cityofmadisonDEV.com",emailSubject,emailBody);
`^
CMN;Permitting!Traffic Engineering!Street Occupancy!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
streetOccFee = 0;
include("CMN;Permitting!Traffic Engineering!Street Occupancy!NA;ASITFee");
streetOccFee = Math.ceil(AInfo['OCCUPANCY INFORMATION.Length of Occupancy']!100) ~ Math.ceil(AInfo['OCCUPANCY INFORMATION.Days of Occupancy']!30);
if (streetOccFee > 0) {
	if(feeExists("STROCCPMT", "NEW", "INVOICED") == false) updateFee("STROCCPMT", "ENGSTROCC", "FINAL", parseInt(streetOccFee), "N");
	} else {
	if(feeExists("STROCCPMT") == true) removeFee("STROCCPMT", "FINAL");
	}

if (AInfo['ADDITIONAL INFORMATION.How Many Meters?'] > 0) {
	if(feeExists("STROCCMETERS","NEW","INVOICED") == false) updateFee("STROCCMETERS", "ENGSTROCC", "FINAL", parseInt(AInfo['ADDITIONAL INFORMATION.How Many Meters?']), "N");
	} else {
	if(feeExists("STROCCMETERS") == true) removeFee("STROCCMETERS", "FINAL");
	}

if (AInfo['ADDITIONAL INFORMATION.How Many Parking Signs?'] > 0) {
	if(feeExists("STROCCSIGN", "NEW", "INVOICED") == false) updateFee("STROCCSIGN", "ENGSTROCC", "FINAL", parseInt(AInfo['ADDITIONAL INFORMATION.How Many Parking Signs?']), "N");
	} else {
	if(feeExists("STROCCSIGN") == true) removeFee("STROCCSIGN", "FINAL");
	}
`^
CMN;Permitting!Traffic Engineering!Street Occupancy!NA;ForestryEmail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
emailSubject = "Street Occupancy Permit Review Required" + capId + "";
emailBody = "Please be advised that Street Occupancy Permit " + capId + "has been applied for and requires your review.";
email("noreply@cityofmadisonDEV.com","meddy@cityofmadisonDEV.com","jmoyer@cityofmadisonDEV.com",emailSubject,emailBody);
email("noreply@cityofmadisonDEV.com","dkahl@cityofmadisonDEV.com","jmoyer@cityofmadisonDEV.com",emailSubject,emailBody);
`^
CMN;Permitting!Traffic Engineering!Street Occupancy!NA;NonCentral^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (strClassification == "Arterial") {
	if (bolSidewalk) addFeeWithExtraData("TESOCSACEN","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	if (bolCoveredSidewalk) addFeeWithExtraData("TESOCSA5CEN","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	if (bolTerrace) addFeeWithExtraData("TESOCTACEN","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	if (bolParkingLane) addFeeWithExtraData("TESOCPACEN","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	if (bolTravelLane || bolBikeLane) addFeeWithExtraData("TESOCTLACEN","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	}

if (strClassification == "Collector") {
	if (bolSidewalk) addFeeWithExtraData("TESOCSCCEN","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	if (bolCoveredSidewalk) addFeeWithExtraData("TESOCSC5CEN","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	if (bolTerrace) addFeeWithExtraData("TESOCTCCEN","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	if (bolParkingLane) addFeeWithExtraData("TESOCPCCEN","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	if (bolTravelLane || bolBikeLane) addFeeWithExtraData("TESOCTLCCEN","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	}

if (strClassification == "Local") {
	if (bolSidewalk) addFeeWithExtraData("TESOCSLCEN","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	if (bolCoveredSidewalk) addFeeWithExtraData("TESOCSL5CEN","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	if (bolTerrace) addFeeWithExtraData("TESOCTLCEN","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	if (bolParkingLane) addFeeWithExtraData("TESOCPLCEN","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	if (bolTravelLane || bolBikeLane) addFeeWithExtraData("TESOCTLLCEN","ENGSTROCC","FINAL",intFeeMultiplier,"N",capId,strSteetName,"","");
	}
`^
CMN;Permitting!Traffic Engineering!Street Occupancy!NA;ValidateLP^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showMessage = false;
showDebug = false;
correctType = false;
licProf = null;
licType = null;
licProfList = cap.getLicenseProfessionalList();
if (licProfList != null) {
	licProf = licProfList.iterator().next();
	} else {
	licProf = cap.getLicenseProfessionalModel();
	}

tLicNbr = licProf.getLicenseNbr();
licType = licProf.getLicenseType();
peep = cap.getContactsGroup().iterator().next();
user = aa.person.getCurrentUser().getOutput();
userEmail = user.getEmail();
puser = aa.publicUser.getPublicUserByEmail(userEmail).getOutput();
userSeqNum = puser.getUserSeqNum();
if (licType == null) {
	licProf.setContactFirstName(peep.getFirstName());
	licProf.setContactLastName(peep.getLastName());
	}

if (licType == null) {
	licProf.setAddress1(peep.getAddressLine1());
	licProf.setCity(peep.getCity());
	licProf.setState(peep.getState());
	licProf.setZip(peep.getZip());
	}

if (licType == null) {
	licProf.setEmail(peep.getEmail());
	licProf.setPhone1(peep.getPhone1());
	licProf.setPhone2(peep.getPhone2());
	licProf.setFax(peep.getFax());
	}

if (licType == null) {
	licProf.setLicenseType("HOME OWNER");
	licProf.setLicenseNbr("000000");
	}

if (licType == null) {
	cap.setLicenseProfessionalModel(licProf);
	}

if ((licProf.getLicenseType().equals("HOME OWNER") || licProf.getLicenseType().equals("PREQUALIFIED"))) {
	correctType = true;
	} else {
	correctType = false;
	}

if (correctType == false) {
	showMessage = true;
	comment("If you are a PREQUALIFIED contractor, you need to first associate your license information with your account before you can apply for a permit online. This is a one-time process and this must be approved by the engineering staff prior to submitting a permit on line. If you are a homeowner doing this work on your own residence, then please select the homeowner contractor record in order to proceed.");
	}
`^
CMN;Permitting!Traffic Enginnering!Bicycle Registration!~;ContactRemove^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
aa.people.removeCapContact(parentCapId, pConArray[pC].contactSeqNumber);
`^
CMN;Permitting!Vending!Banner!NA;ASITEval^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
rowCount = 0;
varLocTable = new Array();
for(x in varLocTable) include("CMN;BANNERCNT;ASIT");
`^
CMN;Permitting!Vending!Banner!NA;ASITValidation^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
rowCount = 0;
totalpermits =  0;
if (typeof(DATESREQUESTED) == "object") {
	for (eachrow in DATESREQUESTED) rowCount = rowCount + 1;
	}

if (rowCount = 0) {
	cancel = true;
	showMessage = true;
	comment("You must enter atleast 1 Banner to proceed.");
	}
`^
CMN;Permitting!Vending!Banner!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
rowCount = 0;
varLocTable = new Array();
varLocTable = loadASITable("DATES REQUESTED");
for(x in varLocTable) include("CMN;BANNERCNT;ASIT");
if (rowCount > 0) {
	if(feeExists("BNR") == false) updateFee("BNR","PERVENBNR","FINAL",rowCount,"N");
	} else {
	if(feeExists("BNR") == true) removeFee("BNR","FINAL");
	}
`^
CMN;Permitting!Vending!TEM!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['INFORMATION TABLE PERMIT.Information Table'] == "Yes" && AInfo['INFORMATION TABLE PERMIT.Type of Permit'] == "Daily") {
	if(feeExists("ITDAILY") == false) updateFee("ITDAILY","PERVENTEM","FINAL",1,"Y");
	} else {
	if(feeExists("ITDAILY") == true) removeFee("ITDAILY","FINAL");
	}

if (AInfo['INFORMATION TABLE PERMIT.Information Table'] == "Yes" && AInfo['INFORMATION TABLE PERMIT.Type of Permit'] == "Monthly") {
	if(feeExists("ITMONTH") == false) updateFee("ITMONTH","PERVENTEM","FINAL",1,"Y");
	} else {
	if(feeExists("ITMONTH") == true) removeFee("ITMONTH","FINAL");
	}

if (AInfo['INFORMATION TABLE PERMIT.Information Table'] == "Yes" && AInfo['INFORMATION TABLE PERMIT.Type of Permit'] == "Annual") {
	if(feeExists("ITANNUAL") == false) updateFee("ITANNUAL","PERVENTEM","FINAL",1,"Y");
	} else {
	if(feeExists("ITANNUAL") == true) removeFee("ITANNUAL","FINAL");
	}

if (AInfo['EXPRESSIVE STREET VENDING.Expressive Street Vending'] == "Yes" && AInfo['EXPRESSIVE STREET VENDING.Type of Permit'] == "Daily") {
	if(feeExists("ESDAILY") == false) updateFee("ESDAILY","PERVENTEM","FINAL",1,"Y");
	} else {
	if(feeExists("ESDAILY") == true) removeFee("ESDAILY","FINAL");
	}

if (AInfo['EXPRESSIVE STREET VENDING.Expressive Street Vending'] == "Yes" && AInfo['EXPRESSIVE STREET VENDING.Type of Permit'] == "Monthly") {
	if(feeExists("ESMONTH") == false) updateFee("ESMONTH","PERVENTEM","FINAL",1,"Y");
	} else {
	if(feeExists("ESMONTH") == true) removeFee("ESMONTH","FINAL");
	}

if (AInfo['EXPRESSIVE STREET VENDING.Expressive Street Vending'] == "Yes" && AInfo['EXPRESSIVE STREET VENDING.Type of Permit'] == "Annual") {
	if(feeExists("ESANNUAL") == false) updateFee("ESANNUAL","PERVENTEM","FINAL",1,"Y");
	} else {
	if(feeExists("ESANNUAL") == true) removeFee("ESANNUAL","FINAL");
	}

if (AInfo['MOBILE SALES.Mobile Sales of Expressive Items'] == "Yes") {
	if(feeExists("MSANNUAL") == false) updateFee("MSANNUAL","PERVENTEM","FINAL",1,"Y");
	} else {
	if(feeExists("MSANNUAL") == true) removeFee("MSANNUAL","FINAL");
	}
`^
CMN;Permitting!Water!New Meter!~;EmailBilling^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
emailSubject = "New Water Meter - " + capId + " - Setting Complete";
include("CMN;GetAPOAddress");
emailBody = "This is to notify you that the setting of a new water meter has been completed. <br> Please record this meter location in GIS. <br><br>";
emailBody += "Meter location; " + APOAddress + " <br> Application; " + capId + " <br> Setting completed; " + wfDateMMDDYYYY;
emailContact(emailSubject,emailBody);
`^
CMN;Permitting!Water!New Meter!~;EmailWaterOps^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
emailSubject = "Water Meter Inspection Completed - " + capId;
include("CMN;GetAPOAddress");
emailBody = "This is to notify you that the Inspection of a new water meter has been completed. <br> Please schedule a Setting for this meter. <br><br>";
emailBody += "Meter location; " + APOAddress + " <br> Application; " + capId + " <br>Inspection completed; " + wfDateMMDDYYYY;
emailContact(emailSubject,emailBody);
`^
CMN;Permitting!Water!New Meter!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['METER SIZE.1”  Meter Required'] != null) {
	if(feeExists("NEWWTR1") == false) updateFee("NEWWTR1","NMTR","FINAL",1,"N");
	} else {
	if(feeExists("NEWWTR1") == true) removeFee("NEWWTR1","FINAL");
	}

if (AInfo['METER SIZE.10” Meter Required'] != null) {
	if(feeExists("NEWWTR10") == false) updateFee("NEWWTR10","NMTR","FINAL",1,"N");
	} else {
	if(feeExists("NEWWTR10") == true) removeFee("NEWWTR10","FINAL");
	}

if (AInfo['METER SIZE.12” Meter Required'] != null) {
	if(feeExists("NEWWTR12") == false) updateFee("NEWWTR12","NMTR","FINAL",1,"N");
	} else {
	if(feeExists("NEWWTR12") == true) removeFee("NEWWTR12","FINAL");
	}

if (AInfo['METER SIZE.1-1!2” Meter Required'] != null) {
	if(feeExists("NEWWTR15") == false) updateFee("NEWWTR15","NMTR","FINAL",1,"N");
	} else {
	if(feeExists("NEWWTR15") == true) removeFee("NEWWTR15","FINAL");
	}

if (AInfo['METER SIZE.2” Meter Required'] != null) {
	if(feeExists("NEWWTR2") == false) updateFee("NEWWTR2","NMTR","FINAL",1,"N");
	} else {
	if(feeExists("NEWWTR2") == true) removeFee("NEWWTR2","FINAL");
	}

if (AInfo['METER SIZE.3” Meter Required'] != null) {
	if(feeExists("NEWWTR3") == false) updateFee("NEWWTR3","NMTR","FINAL",1,"N");
	} else {
	if(feeExists("NEWWTR3") == true) removeFee("NEWWTR3","FINAL");
	}

if (AInfo['METER SIZE.3!4” Meter Required'] != null) {
	if(feeExists("NEWWTR34") == false) updateFee("NEWWTR34","NMTR","FINAL",1,"N");
	} else {
	if(feeExists("NEWWTR34") == true) removeFee("NEWWTR34","FINAL");
	}

if (AInfo['METER SIZE.4” Meter Required'] != null) {
	if(feeExists("NEWWTR4") == false) updateFee("NEWWTR4","NMTR","FINAL",1,"N");
	} else {
	if(feeExists("NEWWTR4") == true) removeFee("NEWWTR4","FINAL");
	}

if (AInfo['METER SIZE.5!8” Meter Required'] != null) {
	if(feeExists("NEWWTR58") == false) updateFee("NEWWTR58","NMTR","FINAL",1,"N");
	} else {
	if(feeExists("NEWWTR58") == true) removeFee("NEWWTR58","FINAL");
	}

if (AInfo['METER SIZE.6” Meter Required'] != null) {
	if(feeExists("NEWWTR6") == false) updateFee("NEWWTR6","NMTR","FINAL",1,"N");
	} else {
	if(feeExists("NEWWTR6") == true) removeFee("NEWWTR6","FINAL");
	}

if (AInfo['METER SIZE.8” Meter Required'] != null) {
	if(feeExists("NEWWTR8") == false) updateFee("NEWWTR8","NMTR","FINAL",1,"N");
	} else {
	if(feeExists("NEWWTR8") == true) removeFee("NEWWTR8","FINAL");
	}
`^
CMN;Permitting!Water!NEW WATER SERVICE!~;TapSleeveSize^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (AInfo['Tap Sleeve Size'] == "4 X 4" && AInfo['Quantity'] != null) {
	addFee("4X4TPV","WTRNSVC4X4", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X4TPSLV","WTRNSVC4X4", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X4VLVBX","WTRNSVC4X4", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X4VLVBXEXT","WTRNSVC4X4", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X4ST","WTRNSVC4X4", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X4LBR","WTRNSVC4X4", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X4CC","WTRNSVC4X4", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X4TPMCH","WTRNSVC4X4", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X4PCT","WTRNSVC4X4", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X4INSP","WTRNSVC4X4", "FINAL", AInfo['Quantity'] , "N");
	}

if (AInfo['Tap Sleeve Size'] == "4 X 6" && AInfo['Quantity'] != null) {
	addFee("4X6TPV","WTRNSVC4X6", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X6TPSLV","WTRNSVC4X6", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X6VLVBX","WTRNSVC4X6", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X6VLVBXEXT","WTRNSVC4X6", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X6ST","WTRNSVC4X6", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X6LBR","WTRNSVC4X6", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X6CC","WTRNSVC4X6", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X6TPMCH","WTRNSVC4X6", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X6PCT","WTRNSVC4X6", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X6INSP","WTRNSVC4X6", "FINAL", AInfo['Quantity'] , "N");
	}

if (AInfo['Tap Sleeve Size'] == "4 X 8" && AInfo['Quantity'] != null) {
	addFee("4X8TPV","WTRNSVC4X8", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X8TPSLV","WTRNSVC4X8", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X8VLVBX","WTRNSVC4X8", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X8VLVBXEXT","WTRNSVC4X8", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X8ST","WTRNSVC4X8", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X8LBR","WTRNSVC4X8", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X8CC","WTRNSVC4X8", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X8TPMCH","WTRNSVC4X8", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X8PCT","WTRNSVC4X8", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X8INSP","WTRNSVC4X8", "FINAL", AInfo['Quantity'] , "N");
	}

if (AInfo['Tap Sleeve Size'] == "4 X 10" && AInfo['Quantity'] != null) {
	addFee("4X10TPV","WTRNSVC4X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X10TPSLV","WTRNSVC4X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X10VLVBX","WTRNSVC4X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X10VLVBXEXT","WTRNSVC4X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X10ST","WTRNSVC4X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X10LBR","WTRNSVC4X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X10CC","WTRNSVC4X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X10TPMCH","WTRNSVC4X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X10PCT","WTRNSVC4X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X10INSP","WTRNSVC4X10", "FINAL", AInfo['Quantity'] , "N");
	}

if (AInfo['Tap Sleeve Size'] == "4 X 12" && AInfo['Quantity'] != null) {
	addFee("4X12TPV","WTRNSVC4X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X12TPSLV","WTRNSVC4X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X12VLVBX","WTRNSVC4X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X12VLVBXEXT","WTRNSVC4X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X12ST","WTRNSVC4X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X12LBR","WTRNSVC4X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X12CC","WTRNSVC4X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X12TPMCH","WTRNSVC4X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X12PCT","WTRNSVC4X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("4X12INSP","WTRNSVC4X12", "FINAL", AInfo['Quantity'] , "N");
	}

if (AInfo['Tap Sleeve Size'] == "6 X 6" && AInfo['Quantity'] != null) {
	addFee("6X6TPV","WTRNSVC6X6", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X6TPSLV","WTRNSVC6X6", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X6VLVBX","WTRNSVC6X6", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X6VLVBXEXT","WTRNSVC6X6", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X6ST","WTRNSVC6X6", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X6LBR","WTRNSVC6X6", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X6CC","WTRNSVC6X6", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X6TPMCH","WTRNSVC6X6", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X6PCT","WTRNSVC6X6", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X6INSP","WTRNSVC6X6", "FINAL", AInfo['Quantity'] , "N");
	}

if (AInfo['Tap Sleeve Size'] == "6 X 8" && AInfo['Quantity'] != null) {
	addFee("6X8TPV","WTRNSVC6X8", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X8TPSLV","WTRNSVC6X8", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X8VLVBX","WTRNSVC6X8", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X8VLVBXEXT","WTRNSVC6X8", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X8ST","WTRNSVC6X8", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X8LBR","WTRNSVC6X8", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X8CC","WTRNSVC6X8", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X8TPMCH","WTRNSVC6X8", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X8PCT","WTRNSVC6X8", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X8INSP","WTRNSVC6X8", "FINAL", AInfo['Quantity'] , "N");
	}

if (AInfo['Tap Sleeve Size'] == "6 X 10" && AInfo['Quantity'] != null) {
	addFee("6X10TPV","WTRNSVC6X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X10TPSLV","WTRNSVC6X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X10VLVBX","WTRNSVC6X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X10VLVBXEXT","WTRNSVC6X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X10ST","WTRNSVC6X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X10LBR","WTRNSVC6X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X10CC","WTRNSVC6X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X10TPMCH","WTRNSVC6X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X10PCT","WTRNSVC6X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X10INSP","WTRNSVC6X10", "FINAL", AInfo['Quantity'] , "N");
	}

if (AInfo['Tap Sleeve Size'] == "6 X 12" && AInfo['Quantity'] != null) {
	addFee("6X12TPV","WTRNSVC6X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X12TPSLV","WTRNSVC6X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X12VLVBX","WTRNSVC6X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X12VLVBXEXT","WTRNSVC6X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X12ST","WTRNSVC6X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X12LBR","WTRNSVC6X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X12CC","WTRNSVC6X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X12TPMCH","WTRNSVC6X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X12PCT","WTRNSVC6X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X12INSP","WTRNSVC6X12", "FINAL", AInfo['Quantity'] , "N");
	}

if (AInfo['Tap Sleeve Size'] == "6 X 16" && AInfo['Quantity'] != null) {
	addFee("6X16TPV","WTRNSVC6X16", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X16TPSLV","WTRNSVC6X16", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X16VLVBX","WTRNSVC6X16", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X16VLVBXEXT","WTRNSVC6X16", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X16ST","WTRNSVC6X16", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X16LBR","WTRNSVC6X16", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X16CC","WTRNSVC6X16", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X16TPMCH","WTRNSVC6X16", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X16PCT","WTRNSVC6X16", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X16INSP","WTRNSVC6X16", "FINAL", AInfo['Quantity'] , "N");
	}

if (AInfo['Tap Sleeve Size'] == "6 X 20" && AInfo['Quantity'] != null) {
	addFee("6X20TPV","WTRNSVC6X20", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X20TPSLV","WTRNSVC6X20", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X20VLVBX","WTRNSVC6X20", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X20VLVBXEXT","WTRNSVC6X20", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X20ST","WTRNSVC6X20", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X20LBR","WTRNSVC6X20", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X20CC","WTRNSVC6X20", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X20TPMCH","WTRNSVC6X20", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X20PCT","WTRNSVC6X20", "FINAL", AInfo['Quantity'] , "N");
	addFee("6X20INSP","WTRNSVC6X20", "FINAL", AInfo['Quantity'] , "N");
	}

if (AInfo['Tap Sleeve Size'] == "8 X 8" && AInfo['Quantity'] != null) {
	addFee("8X8TPV","WTRNSVC8X8", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X8TPSLV","WTRNSVC8X8", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X8VLVBX","WTRNSVC8X8", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X8VLVBXEXT","WTRNSVC8X8", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X8ST","WTRNSVC8X8", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X8LBR","WTRNSVC8X8", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X8CC","WTRNSVC8X8", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X8TPMCH","WTRNSVC8X8", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X8PCT","WTRNSVC8X8", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X8INSP","WTRNSVC8X8", "FINAL", AInfo['Quantity'] , "N");
	}

if (AInfo['Tap Sleeve Size'] == "8 X 10" && AInfo['Quantity'] != null) {
	addFee("8X10TPV","WTRNSVC8X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X10TPSLV","WTRNSVC8X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X10VLVBX","WTRNSVC8X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X10VLVBXEXT","WTRNSVC8X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X10ST","WTRNSVC8X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X10LBR","WTRNSVC8X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X10CC","WTRNSVC8X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X10TPMCH","WTRNSVC8X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X10PCT","WTRNSVC8X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X10INSP","WTRNSVC8X10", "FINAL", AInfo['Quantity'] , "N");
	}

if (AInfo['Tap Sleeve Size'] == "8 X 12" && AInfo['Quantity'] != null) {
	addFee("8X12TPV","WTRNSVC8X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X12TPSLV","WTRNSVC8X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X12VLVBX","WTRNSVC8X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X12VLVBXEXT","WTRNSVC8X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X12ST","WTRNSVC8X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X12LBR","WTRNSVC8X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X12CC","WTRNSVC8X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X12TPMCH","WTRNSVC8X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X12PCT","WTRNSVC8X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X12INSP","WTRNSVC8X12", "FINAL", AInfo['Quantity'] , "N");
	}

if (AInfo['Tap Sleeve Size'] == "8 X 16" && AInfo['Quantity'] != null) {
	addFee("8X16TPV","WTRNSVC8X16", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X16TPSLV","WTRNSVC8X16", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X16VLVBX","WTRNSVC8X16", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X16VLVBXEXT","WTRNSVC8X16", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X16ST","WTRNSVC8X16", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X16LBR","WTRNSVC8X16", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X16CC","WTRNSVC8X16", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X16TPMCH","WTRNSVC8X16", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X16PCT","WTRNSVC8X16", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X16INSP","WTRNSVC8X16", "FINAL", AInfo['Quantity'] , "N");
	}

if (AInfo['Tap Sleeve Size'] == "8 X 20" && AInfo['Quantity'] != null) {
	addFee("8X20TPV","WTRNSVC8X20", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X20TPSLV","WTRNSVC8X20", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X20VLVBX","WTRNSVC8X20", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X20VLVBXEXT","WTRNSVC8X20", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X20ST","WTRNSVC8X20", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X20LBR","WTRNSVC8X20", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X20CC","WTRNSVC8X20", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X20TPMCH","WTRNSVC8X20", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X20PCT","WTRNSVC8X20", "FINAL", AInfo['Quantity'] , "N");
	addFee("8X20INSP","WTRNSVC8X20", "FINAL", AInfo['Quantity'] , "N");
	}

if (AInfo['Tap Sleeve Size'] == "10 X 10" && AInfo['Quantity'] != null) {
	addFee("10X10TPV","WTRNSVC10X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("10X10TPSLV","WTRNSVC10X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("10X10VLVBX","WTRNSVC10X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("10X10VLVBXEX","WTRNSVC10X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("10X10ST","WTRNSVC10X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("10X10LBR","WTRNSVC10X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("10X10CC","WTRNSVC10X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("10X10TPMCH","WTRNSVC10X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("10X10PCT","WTRNSVC10X10", "FINAL", AInfo['Quantity'] , "N");
	addFee("10X10INSP","WTRNSVC10X10", "FINAL", AInfo['Quantity'] , "N");
	}

if (AInfo['Tap Sleeve Size'] == "10 X 12" && AInfo['Quantity'] != null) {
	addFee("10X12TPV","WTRNSVC10X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("10X12TPSLV","WTRNSVC10X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("10X12VLVBX","WTRNSVC10X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("10X12VLVBXEX","WTRNSVC10X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("10X12ST","WTRNSVC10X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("10X12LBR","WTRNSVC10X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("10X12CC","WTRNSVC10X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("10X12TPMCH","WTRNSVC10X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("10X12PCT","WTRNSVC10X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("10X12INSP","WTRNSVC10X12", "FINAL", AInfo['Quantity'] , "N");
	}

if (AInfo['Tap Sleeve Size'] == "12 X 12" && AInfo['Quantity'] != null) {
	addFee("12X12TPV","WTRNSVC12X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("12X12TPSLV","WTRNSVC12X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("12X12VLVBX","WTRNSVC12X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("12X12VLVBXEX","WTRNSVC12X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("12X12ST","WTRNSVC12X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("12X12LBR","WTRNSVC12X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("12X12CC","WTRNSVC12X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("12X12TPMCH","WTRNSVC12X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("12X12PCT","WTRNSVC12X12", "FINAL", AInfo['Quantity'] , "N");
	addFee("12X12INSP","WTRNSVC12X12", "FINAL", AInfo['Quantity'] , "N");
	}

if (AInfo['Tap Sleeve Size'] == "12 X 16" && AInfo['Quantity'] != null) {
	addFee("12X16TPV","WTRNSVC12X16", "FINAL", AInfo['Quantity'] , "N");
	addFee("12X16TPSLV","WTRNSVC12X16", "FINAL", AInfo['Quantity'] , "N");
	addFee("12X16VLVBX","WTRNSVC12X16", "FINAL", AInfo['Quantity'] , "N");
	addFee("12X16VLVBXEX","WTRNSVC12X16", "FINAL", AInfo['Quantity'] , "N");
	addFee("12X16ST","WTRNSVC12X16", "FINAL", AInfo['Quantity'] , "N");
	addFee("12X16LBR","WTRNSVC12X16", "FINAL", AInfo['Quantity'] , "N");
	addFee("12X16CC","WTRNSVC12X16", "FINAL", AInfo['Quantity'] , "N");
	addFee("12X16TPMCH","WTRNSVC12X16", "FINAL", AInfo['Quantity'] , "N");
	addFee("12X16PCT","WTRNSVC12X16", "FINAL", AInfo['Quantity'] , "N");
	addFee("12X16INSP","WTRNSVC12X16", "FINAL", AInfo['Quantity'] , "N");
	}
`^
CMN;Permitting!Zoning!Nonconforming!NA;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if(feeExists("NCM01") == false) updateFee("NCM01","BLDNCM","FINAL",1,"N");
`^
CMN;Permitting!Zoning!Sign!Ground;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL INFORMATION.Application Type'] == "New Sign") {
	if(feeExists("GSA") == false) addFee("GSA","ZONGSN","FINAL",1,"N");
	} else {
	if(feeExists("GSA") == true) removeFee("GSA","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Application Type'] == "Change of Copy") {
	if(feeExists("GSCOP") == false) addFee("GSCOP","ZONGSN","FINAL",1,"N");
	} else {
	if(feeExists("GSCOP") == true) removeFee("GSCOP","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Application Type'] == "Business Opening Banner") {
	if(feeExists("BSO") == false) addFee("BSO","ZONGSN","FINAL",1,"N");
	} else {
	if(feeExists("BSO") == true) removeFee("BSO","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Application Type'] == "Relocate on Lot") {
	if(feeExists("RELO") == false) addFee("RELO","ZONGSN","FINAL",1,"N");
	} else {
	if(feeExists("RELO") == true) removeFee("RELO","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Application Type'] == "New Advertising Sign") {
	if(feeExists("NASGSA") == false) addFee("NASGSA","ZONGSN","FINAL",1,"N");
	} else {
	if(feeExists("NASGSA") == true) removeFee("NASGSA","FINAL");
	}
`^
CMN;Permitting!Zoning!Sign!NonGround;Fee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (AInfo['GENERAL INFORMATION.Application Type'] == "New Sign") {
	if(feeExists("NGSA") == false) addFee("NGSA","ZONNGS","FINAL",1,"N");
	} else {
	if(feeExists("NGSA") == true) removeFee("NGSA","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Application Type'] == "Change of Copy") {
	if(feeExists("NGSCOP") == false) addFee("NGSCOP","ZONNGS","FINAL",1,"N");
	} else {
	if(feeExists("NGSCOP") == true) removeFee("NGSCOP","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Application Type'] == "Business Opening Banner") {
	if(feeExists("NGBSO") == false) addFee("NGBSO","ZONNGS","FINAL",1,"N");
	} else {
	if(feeExists("NGBSO") == true) removeFee("NGBSO","FINAL");
	}

if (AInfo['GENERAL INFORMATION.Application Type'] == "Relocate on Lot") {
	if(feeExists("NGRELO") == false) addFee("NGRELO","ZONNGS","FINAL",1,"N");
	} else {
	if(feeExists("NGRELO") == true) removeFee("NGRELO","FINAL");
	}
`^
CMN;Postings!Civil Rights!Job Posting Form!NA;UpdateShortNotes^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var jobCategory = "";
var jobTitle = "";
jobCategory = getAppSpecific("CIVIL RIGHTS JOB POSTING FORM.Job Category");
jobTitle = getAppSpecific("CIVIL RIGHTS JOB POSTING FORM.Job Title");
updateShortNotes(jobCategory + " ! "  + jobTitle);
`^
CMN;PREQUAL^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
rsx = parseInt(capIDString.substring(capIDString.length() - 5),10) + "";
createReferenceLP("PRQ" + rsx, "PREQUALIFIED", "Contractor");
var refLic = getRefLicenseProf("PRQ" + rsx);
preqLicense = new licenseObject(null);
preqExpDate = preqLicense.b1ExpDate;
if (capStatus.equals("Inactive") && refLic) {
	refLic.setAuditStatus("I");
	} else {
	if(refLic) refLic.setAuditStatus("A");
	}

if (AInfo['CATEGORIES.Insurance Co'] != null && refLic) {
	refLic.setInsuranceCo(AInfo['CATEGORIES.Insurance Co']);
	}

if (AInfo['CATEGORIES.COI'] != null && refLic) {
	refLic.setInsuranceExpDate(aa.date.parseDate(AInfo['CATEGORIES.COI']));
	}

if (preqExpDate != null && preqExpDate != "" && refLic) {
	refLic.setLicenseExpirationDate(aa.date.parseDate(preqExpDate));
	}

if (refLic) {
	aa.licenseScript.editRefLicenseProf(refLic);
	}

if (AInfo['CATEGORIES.11Bond'] != null && refLic) {
	editRefLicProfAttribute("PRQ" + rsx, "11B EXPIRATION", AInfo['CATEGORIES.11Bond']);
	}

if (refLic) {
	editRefLicProfAttribute("PRQ" + rsx, "AA EXPIRATION DATE", preqLicense.b1ExpDate);
	}
`^
CMN;PrequalAffirmativeActionUpdate^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var sAAPlanValue = "";
var sLPAuditStatus = sAAStatus.substring(0,1);
LPNum = parseInt(capIDString.substring(capIDString.length() - 5),10)+"";
licEditExpInfo(sAAStatus, null);
logDebug("Hello from CMN;PrequalAffirmativeActionUpdate!");
editAppSpecific("LICENSE INFORMATION.License Status", sAAStatus);
if (sAAStatus == "Inactive") {
	sAAPlanValue = "Update to AA Plan Required";
	} else {
	sAAPlanValue = "Approved";
	}

editAppSpecific("LICENSE INFORMATION.Affirmative Action Plan - Madison General Ordinance 32.02 (9)", sAAPlanValue);
var refLicProfPRQ = getRefLicenseProf("PRQ"+ LPNum);
var refLicProfROW = getRefLicenseProf("ROW"+ LPNum);
var refLicProfTER = getRefLicenseProf("TER"+ LPNum);
if (refLicProfPRQ) {
	refLicProfPRQ.setAuditStatus(sLPAuditStatus);
	aa.licenseScript.editRefLicenseProf(refLicProfPRQ);
	}

if (refLicProfROW) {
	refLicProfROW.setAuditStatus(sLPAuditStatus);
	aa.licenseScript.editRefLicenseProf(refLicProfROW);
	}

if (refLicProfTER) {
	refLicProfTER.setAuditStatus(sLPAuditStatus);
	aa.licenseScript.editRefLicenseProf(refLicProfTER);
	}
`^
CMN;RemoveScheduledInspections^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
inspCancelAll();
`^
CMN;RenewalFlipLicenseHolder^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var capContactResult = aa.people.getCapContactByCapID(capId);
refContactNbr = 0;
if (capContactResult.getSuccess()) {
	Contacts = capContactResult.getOutput();
	}

if (capContactResult.getSuccess()) {
	for(yy in Contacts) include("cmn;FindNewLicenseHolder");
	}

if (refContactNbr > 0) {
	contactSetPrimary(refContactNbr);
	}
`^
CMN;ROWLPCARD^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
asiGroups = aa.appSpecificInfo.getByCapID(capId).getOutput();
rsx = parseInt(capIDString.substring(capIDString.length() - 5), 10) + "";
createROWCard = false;
var refLic;
for (asi in asiGroups) include("CMN;CHECKROWSECTION");
if (createROWCard) {
	createReferenceLP("ROW" + rsx, "PREQUALIFIED ROW", "Contractor");
	}

if (createROWCard) {
	refLic = getRefLicenseProf("ROW" + rsx);
	}

if (createROWCard) {
	preqLicense = new licenseObject(null);
	preqExpDate = preqLicense.b1ExpDate;
	}

if (capStatus.equals("Inactive") && refLic) {
	refLic.setAuditStatus("I");
	} else {
	if(refLic) refLic.setAuditStatus("A");
	}

if (AInfo['CATEGORIES.Insurance Co'] != null && refLic) {
	refLic.setInsuranceCo(AInfo['CATEGORIES.Insurance Co']);
	}

if (AInfo['CATEGORIES.COI'] != null && refLic) {
	refLic.setInsuranceExpDate(aa.date.parseDate(AInfo['CATEGORIES.COI']));
	}

if (preqExpDate != null && preqExpDate != "" && refLic) {
	refLic.setLicenseExpirationDate(aa.date.parseDate(preqExpDate));
	}

if (refLic) {
	aa.licenseScript.editRefLicenseProf(refLic);
	}
`^
CMN;RP3Dist^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var addrInfo = null;
var addrAttribs = null;
var sAddrIndex = null;
var sAreaNbr = null;
RefAddrID = "";
capAddrInfo = aa.address.getAddressWithAttributeByCapId(capId);
if (capAddrInfo.getSuccess()) {
	addrInfo = capAddrInfo.getOutput();
	logDebug("Address array length = " +  addrInfo.length);
	} else {
	logDebug("Was NOT successful retrieving address-with-attributes array");
	}

if (addrInfo != null && addrInfo.length == 1) {
	sAddrIndex = 0;
	logDebug("Only one address in array");
	}

if (addrInfo != null && addrInfo.length > 1) {
	for(fld in addrInfo) if (addrInfo[fld]["primaryFlag"] == "Y") sAddrIndex = fld;
	}

if (sAddrIndex != null) {
	RefAddrID = addrInfo[sAddrIndex].refAddressId;
	} else {
	RefAddrID = addrInfo[0].refAddressId;
	}

logDebug("Reference Address ID = " + RefAddrID);
if (addrInfo != null && addrInfo.length > 1 && sAddrIndex == null) {
	logDebug("More than one address, but none have primary flag set to Yes");
	}

if (sAddrIndex != null) {
	addrAttribs = addrInfo[sAddrIndex].getAttributes().toArray();
	logDebug("Array index = " + sAddrIndex);
	logDebug("Primary address is; " + addrInfo[sAddrIndex]["displayAddress"]);
	}

if (addrAttribs != null) {
	for(idx in addrAttribs) if (addrAttribs[idx].getB1AttributeName() == "RP3 AREA") sAreaNbr = addrAttribs[idx].getB1AttributeValue();
	}

if (sAreaNbr != null) {
	editAppSpecific("OFFICE USE ONLY.Area Number", sAreaNbr);
	logDebug("Area Number = " + sAreaNbr);
	} else {
	logDebug("Area Number is null.");
	}

if (addrInfo != null && addrInfo.length > 1 && sAddrIndex == null && sAreaNbr == null) {
	editAppSpecific("OFFICE USE ONLY.Area Number", "");
	logDebug("Area Number is blank, because more than one address and none are primary.");
	cancel = false;
	showMessage = true;
	comment("The parking permit does not have an Area Number, because there is more than one address associated with this permit and none are designated as the primary address. Designate one address as primary via the CAP Summary form.");
	}
`^
CMN;RUN_CRYSTAL_REPORT^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
reportModel = aa.reportManager.getReportModelByName(reportName);
if (reportModel.getSuccess()) {
	report = reportModel.getOutput();
	}

if (reportModel.getSuccess()) {
	parameters = aa.util.newHashMap();
	parameters.put("val1", capIDString);
	}

if (reportModel.getSuccess()) {
	msg = aa.reportManager.runReport(parameters,report);
	}

debugObject(report);
`^
CMN;RUN_REPORT^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var bReport = false;
report = aa.reportManager.getReportModelByName(reportName);
report = report.getOutput();
var permit = true;
bReport=true;
var parameters = aa.util.newHashMap();
var msg = aa.reportManager.runReport(parameters,report);
showMessage=true;
aa.env.setValue("ScriptReturnCode", "0");
aa.env.setValue("ScriptReturnMessage", msg.getOutput());
`^
CMN;RUN_REPORT_NO_MSG^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var bReport = false;
report = aa.reportManager.getReportModelByName(reportName);
report = report.getOutput();
var permit = true;
bReport=true;
var parameters = aa.util.newHashMap();
var msg = aa.reportManager.runReport(parameters,report);
aa.env.setValue("ScriptReturnCode", "0");
aa.env.setValue("ScriptReturnMessage", msg.getOutput());
`^
CMN;SanDist^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
varInsp = undefined;
userId = undefined;
if (validateGisObjects()) {
	varInsp = getGISInfo("agis_madison","Health San Dist","SanUserID");
	} else {
	include("EML;NoGISObject");
	}

aa.sendEmail("noreply@cityofmadisonDEV.com", "kgrittner@cityofmadisonDEV.com", "", "CMN;SanDist (varInsp)", varInsp , "");
if (varInsp != undefined) {
	userId = varInsp.toUpperCase().trim();
	assignCap(userId);
	}

if (varInsp != undefined) {
	editAppSpecific("OFFICE USE ONLY.Sanitarian ID", getGISInfo("agis_madison","Health San Dist","SanID"));
	}

if (varInsp != undefined) {
	editAppSpecific("OFFICE USE ONLY.Sanitarian Name", getGISInfo("agis_madison","Health San Dist","SanName"));
	}

if (varInsp != undefined) {
	editAppSpecific("OFFICE USE ONLY.EH District ID", getGISInfo("agis_madison","Health San Dist","DistID"));
	}

if (userId != undefined) {
	include("EML;AssignInspectorNoASI");
	}
`^
CMN;SendACADocumentNotification^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
reportModule = "Permitting";
var d = getDocumentModel(documentCategory);
if (d != false) {
	currFileKey = d.fileKey;
	}

if (d != false) {
	reportName = aa.util.newHashtable();
	var repParams = aa.util.newHashtable();
	}

if (d != false) {
	var params  = aa.util.newHashtable();
	}

if (d != false) {
	str = getACADocDownloadParam4Notification(params, madisonACAUrl, d);
	}

if (d != false) {
	sendNotification(fromNotification, toNotification, "", templateName, params, reportName, repParams, reportModule);
	}
`^
CMN;SendLandNotificationsAndSetDueDate^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
workflowGroup = workflowGroups[wfg];
if (workflowGroup.getParentProcessID() == wfProcessID) {
	childTasks = aa.workflow.getProcess(capId, workflowGroup.getProcessID()).getOutput();
	}

if (workflowGroup.getParentProcessID() == wfProcessID && childTasks != null) {
	for (task in childTasks) include("CMN;SendLandNotificationsAndSetDueDateLoop");
	}
`^
CMN;SendLandNotificationsAndSetDueDateLoop^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (callType == "WTUA") {
	editTaskDueDate(childTasks[task].getTaskDescription(), pDueDate, childTasks[task].getProcessCode());
	}

emailAddress = "None";
var whoToEmail = "None";
taskDes = childTasks[task].getTaskDescription();
if (callType == "WTUA") {
	cDueDate = pDueDate;
	} else {
	if(childTasks[task].getDueDate()!=null) cDueDate = childTasks[task].getDueDate().getMonth() + "!" + childTasks[task].getDueDate().getDayOfMonth() + "!" + childTasks[task].getDueDate().getYear();
	}

assignedPerson = childTasks[task].getAssignedStaff();
assignedFullName = assignedPerson.getFullName();
if (callType == "DUA" && childTasks[task].completeFlag == "Y") {
	whoToEmail = "Completed";
	}

if (childTasks[task].activeFlag == "Y" && assignedFullName != "") {
	whoToEmail = "Assigned";
	assignedPersonDept = assignedPerson.getDeptOfUser();
	}

if (childTasks[task].activeFlag == "Y" && assignedFullName != "") {
	deptList = aa.people.getSysUserListByDepartmentName(assignedPersonDept).getOutput();
	}

if (childTasks[task].activeFlag == "Y" && assignedFullName == "") {
	whoToEmail = "Group";
	}

if (whoToEmail == "Completed") {
	emailAddress = aa.people.getSysUserByID(childTasks[task].getTaskItem().getAuditID()).getOutput().getEmail();
	}

if (whoToEmail == "Assigned") {
	for (sUser in deptList) if (deptList[sUser].getFullName().equals(assignedFullName)) emailAddress = deptList[sUser].getEmail();
	}

if (whoToEmail == "Group") {
	emailAddress = lookup(appTypeString + typeReviewVerif, childTasks[task].getTaskDescription());
	}

if (whoToEmail == "Group" && emailAddress == undefined) {
	emailAddress = lookup("Land!Land Use!NA!NA" + typeReviewVerif, childTasks[task].getTaskDescription());
	logDebug("Sending Email to; "+emailAddress);
	}
`^
CMN;ServiceRequest!Engineering - Facility!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var assetSeq = 0;
selectString = "DECLARE @AssetDesc varchar(250);
SET @AssetDesc = '" + AInfo['SR - ENGINEERING MAINTENANCE.Facility'] + "';
SELECT G1_ASSET_seq_nbr FROM GASSET_MASTER where replace(REPLACE(REPLACE(G1_DESCRIPTION, CHAR(13), ''), CHAR(10), ''),' ','') = replace(REPLACE(REPLACE(@AssetDesc, CHAR(13), ''), CHAR(10), ''),' ','')";
var initialContext = aa.proxyInvoker.newInstance("javax.naming.InitialContext").getOutput();
var ds = initialContext.lookup("java;!AA");
var conn = ds.getConnection();
var sStmt = conn.prepareStatement(selectString);
var rSet = sStmt.executeQuery();
if (rSet.next();) {
	assetSeq = rSet.getString("G1_ASSET_seq_nbr");
	rSet.close();
	conn.close();
	} else {
	conn.close();
	}

if (assetSeq && assetSeq != 0) {
	var serAsset = aa.asset.getAssetData(assetSeq).getOutput();
	}

if (assetSeq && assetSeq != 0) {
	var woasm = aa.asset.newWorkOrderAssetScriptModel().getOutput();
	}

if (assetSeq && assetSeq != 0 && woasm) {
	woasm.setAssetPK(serAsset.assetPK);
	woasm.setCapID(capId);
	aa.asset.createWorkOrderAsset(woasm.getWorkOrderAssetModel());
	}

if (assetSeq && assetSeq != 0 && serAsset.assetMasterModel.refAddressModel != null) {
	aa.address.createAddressWithRefAddressModel(capId, serAsset.assetMasterModel.refAddressModel);
	}
`^
CMN;ServiceRequest!Engineering - Facility!NA!NA;ASITUpdate^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (tblColi.hasNext() == false) {
	tblColi = tbl.getColumns().iterator();
	newInfo = "";
	}

val = tblFieldi.next();
col = tblColi.next();
dtCreated = startDate.toLocaleString();
if (col.getColumnName() == "Additional Information") {
	newInfo = val;
	}

if (col.getColumnName() == "CreatedDate" && (val == null || val == "")) {
	tblField.set(i, dtCreated);
	addlInfos = addlInfos + newInfo + "<BR>";
	}

if (col.getColumnName() == "Submitted By" && (val == null || val == "")) {
	tblField.set(i, currentUserID);
	}

i = i + 1;
`^
CMN;ServiceRequest!Engineering - Facility!NA!NA;GetTable^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
tblMod = aa.appSpecificTableScript.getAppSpecificTableModel(capId, tblName);
if (tblMod.getSuccess()) {
	tblModOut = tblMod.getOutput();
	tbl = tblModOut.getAppSpecificTableModel();
	}

if (tblMod.getSuccess()) {
	tblFieldi = tbl.getTableField().iterator();
	tblField = tbl.getTableField();
	}

if (tblMod.getSuccess()) {
	tblColi = tbl.getColumns().iterator();
	i = 0;
	}

if (tblMod.getSuccess()) {
	while (tblFieldi.hasNext()) include("CMN;ServiceRequest!Engineering - Facility!NA!NA;ASITUpdate");
	}

if (tblMod.getSuccess()) {
	tbl.setTableField(tblField);
	}

if (tblMod.getSuccess()) {
	addResult = aa.appSpecificTableScript.editAppSpecificTableInfos(tbl, capId, currentUserID);
	}
`^
CMN;ServiceRequest!Information Technology!Tech Serv Project!NA;ASITReview^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (tblColi.hasNext() == false) {
	tblColi = aModel.getColumns().iterator();
	colCount = 0;
	rowCount = rowCount + 1;
	}

val = tblFieldi.next();
col = tblColi.next();
colCount = colCount + 1;
colName = col.getColumnName();
if (tableName == "TASKS" && colName == "Task Number" && parseInt(val) == 0) {
	tblField.set(fieldCount, rowCount.toString());
	}

if (tableName == "TASKS" && colName == "Percent Complete") {
	percentComplete = parseInt(val);
	}

if (tableName == "TASKS" && colName == "Weight") {
	weight = parseInt(val);
	totalWeight = totalWeight + weight;
	}

if (tblColi.hasNext() == false) {
	multiplier = aa.util.parseDouble(percentComplete) ! 100;
	}

if (tblColi.hasNext() == false) {
	adjustedWeight = aa.util.parseDouble(weight) ~ aa.util.parseDouble(multiplier);
	}

if (tblColi.hasNext() == false) {
	totalAdjustedWeight = totalAdjustedWeight + adjustedWeight;
	}

fieldCount = fieldCount + 1;
`^
CMN;ServiceRequest!Information Technology!Tech Serv Project!NA;ProcessTable^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
aTable = aa.appSpecificTableScript.getAppSpecificTableModel(capId, tableName).getOutput();
if (aTable.getRowIndex() != "[]") {
	aModel = aTable.getAppSpecificTableModel();
	}

if (aTable.getRowIndex() != "[]") {
	tblFieldi = aModel.getTableField().iterator();
	tblField = aModel.getTableField();
	}

if (aTable.getRowIndex() != "[]") {
	tblColi = aModel.getColumns().iterator();
	fieldCount = 0;
	colCount = 0;
	rowCount = 1;
	}

if (aTable.getRowIndex() != "[]") {
	while (tblFieldi.hasNext()) include("CMN;ServiceRequest!Information Technology!Tech Serv Project!NA;ASITReview");
	}

if (aTable.getRowIndex() != "[]") {
	aModel.setTableField(tblField);
	}

if (aTable.getRowIndex() != "[]") {
	addResult = aa.appSpecificTableScript.editAppSpecificTableInfos(aModel, capId, currentUserID);
	}
`^
CMN;ServiceRequest!Streets - Graffiti!Graffiti!NA;City^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
workDesc = AInfo['Work Order Description'];
if (workDesc == null || workDesc == "") {
	workDesc = workDescGet(capId);
	editTaskSpecific("Submitted", "Work Order Description", workDesc);
	}

childId = createChild("AMS","Streets", "Graffiti Removal", "NA", "Graffiti Work Order");
rscapModel = cap.getCapModel();
cd = aa.cap.getCapDetail(childId).getOutput().getCapDetailModel();
copyASIFields(capId, childId);
aa.asset.cloneAssets(rscapModel, childId);
newWorkDesModel = aa.cap.capWorkDesModel.getOutput();
newWorkDesModel.setCapID(childId);
newWorkDesModel.setAuditDate(aa.util.now());
newWorkDesModel.setAuditStatus("A");
newWorkDesModel.setAuditID(currentUserID);
newWorkDesModel.setDescription(workDesc);
newWorkDes = aa.cap.createCapWorkDes(newWorkDesModel);
copyDocuments(capId, childId);
copyAddresses(capId, childId);
updateAppStatus("Open","",childId);
`^
CMN;ServiceRequest!Streets - Graffiti!Graffiti!NA;Private^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
workDesc = AInfo['Work Order Description'];
if (workDesc == null || workDesc == "") {
	workDesc = workDescGet(capId);
	editTaskSpecific("Submitted", "Work Order Description", workDesc);
	}

childId = createChild("AMS","Streets", "Graffiti Removal", "NA", "Building Inspection Enforcement - Graffiti");
rscapModel = cap.getCapModel();
cd = aa.cap.getCapDetail(childId).getOutput().getCapDetailModel();
copyASIFields(capId, childId);
aa.asset.cloneAssets(rscapModel, childId);
newWorkDesModel = aa.cap.capWorkDesModel.getOutput();
newWorkDesModel.setCapID(childId);
newWorkDesModel.setAuditDate(aa.util.now());
newWorkDesModel.setAuditStatus("A");
newWorkDesModel.setAuditID(currentUserID);
newWorkDesModel.setDescription(workDesc);
newWorkDes = aa.cap.createCapWorkDes(newWorkDesModel);
copyDocuments(capId, childId);
copyAddresses(capId, childId);
updateAppStatus("Open","",childId);
`^
CMN;ServiceRequest!Streets - Graffiti!Graffiti!NA;Referral^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
emailSubject = "Graffiti Referral";
emailBody = "Graffiti found details;<br !>";
emailBody += "Service Request; " + capIDString + "<br !>";
if (AInfo['GRAFFITI DETAIL.Location Type'] != null) {
	emailBody += "Graffiti found at this location Type; " + AInfo['GRAFFITI DETAIL.Location Type'] + "<br !>";
	}

if (AInfo['GRAFFITI DETAIL.Location'] != null) {
	emailBody += "Location; " + AInfo['GRAFFITI DETAIL.Location'] + "<br !>";
	}

if (AInfo['GRAFFITI DETAIL.Contact'] != null) {
	emailBody += "Contact; " + AInfo['GRAFFITI DETAIL.Contact'] + "<br !>";
	}

if (AInfo['GRAFFITI DETAIL.Asset Type'] != null) {
	emailBody += "Asset Type; " + AInfo['GRAFFITI DETAIL.Asset Type'] + "<br !>";
	}

emailTo = AInfo['GRAFFITI DETAIL.Referral Contacts'];
if (emailTo != null && emailTo != "" && emailTo != "NA") {
	email(emailTo, "noreply@cityofmadisonDEV.com",emailSubject,emailBody);
	}
`^
CMN;ServiceRequest!Traffic Engineering;TrackAssignments^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug=true;
assignmentUpdated=false;
cd=aa.cap.getCapDetail(capId).getOutput().getCapDetailModel();
prevAssignTo=getAppSpecific("TRACKING INFORMATION.Record Assigned To");
if(prevAssignTo==null) prevAssignTo="Blank";
prevAssignDept=getAppSpecific("TRACKING INFORMATION.Record Assigned Dept");
if(prevAssignDept==null) prevAssignDept="Blank";
curAssignTo=cd.getAsgnStaff();
if(curAssignTo==null) curAssignTo="Blank";
curAssignDept=cd.getAsgnDept();
if(curAssignDept==null) curAssignDept="Blank";
if (!prevAssignDept.equals(curAssignDept)) {
	assignmentUpdated = true;
	}

if (!prevAssignTo.equals(curAssignTo)) {
	assignmentUpdated = true;
	if(!curAssignTo.equals("Blank")) include("EML;ServiceRequest!TrafficEngineering!~!~;StudyCreated");
	}

if (assignmentUpdated && AInfo['TRACKING INFORMATION.Record Assigned By'] == null) {
	editAppSpecific("TRACKING INFORMATION.Record Assigned By",currentUserID+",");
	}

if (assignmentUpdated && AInfo['TRACKING INFORMATION.Record Assigned By'] != null && AInfo['TRACKING INFORMATION.Record Assigned By'].indexOf(currentUserID)==-1) {
	editAppSpecific("TRACKING INFORMATION.Record Assigned By",AInfo['TRACKING INFORMATION.Record Assigned By']+currentUserID+",");
	}

if (!curAssignTo.equals("Blank")) {
	editAppSpecific("TRACKING INFORMATION.Record Assigned To",curAssignTo);
	}

if (!curAssignDept.equals("Blank")) {
	editAppSpecific("TRACKING INFORMATION.Record Assigned Dept",curAssignDept);
	}
`^
CMN;ServiceRequest!Traffic Engineering;TrackTaskAssignments^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug=true;
if (AInfo['TRACKING INFORMATION.Task Assigned By'] == null) {
	editAppSpecific("TRACKING INFORMATION.Task Assigned By",currentUserID+",");
	}

if (AInfo['TRACKING INFORMATION.Task Assigned By'] != null && AInfo['TRACKING INFORMATION.Task Assigned By'].indexOf(currentUserID)==-1) {
	editAppSpecific("TRACKING INFORMATION.Task Assigned By",AInfo['TRACKING INFORMATION.Task Assigned By']+currentUserID+",");
	}
`^
CMN;ServiceRequest!TrafficEngineering!~!~;CheckChildComplete^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
childCapId = "";
childCapStatus = "";
childString = "";
cd = null;
userId = "";
appName = "";
childCapId = proj[child].getCapID();
if (childCapId != "") {
	childCap = aa.cap.getCap(childCapId).getOutput();
	}

if (childCapId != "") {
	childStatus = childCap.getCapStatus();
	}

if (childCapId != "") {
	childAltId = childCap.getCapModel().getAltID();
	}

if (childCapId != "") {
	childString = childCap.getCapModel().getCapType().getSubType();
	}

if (childCapId != "") {
	cmnSubType = childString;
	include("CMN;ServiceRequest!TrafficEngineering!~!~;GetAppName");
	}

if (childCapId != "") {
	cd = aa.cap.getCapDetail(childCapId).getOutput().getCapDetailModel();
	}

if (childStatus != "Completed" && cmnSubType != "Sign" && cmnSubType !="Electrical") {
	incompCount += 1;
	}

if (childStatus != "Completed" && childString != "Request" && cmnSubType != "Sign" && cmnSubType !="Electrical") {
	userId = cd.getAsgnStaff();
	include("EML;GetUserIdEmail");
	assignEmail = userEmail;
	assignFirst = userFirst;
	assignLast = userLast;
	}

if (childStatus != "Completed" && childString != "Request" && cmnSubType != "Sign" && cmnSubType !="Electrical") {
	dispMessage += "Service Request " + appName + " (" + childAltId + ") " + " - Assigned to " + assignFirst + " " + assignLast + "<!br>";
	}
`^
CMN;ServiceRequest!TrafficEngineering!~!~;CheckChildWOClosed^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
childCapId = "";
childGroup = "";
childStatus = "";
childCapId = proj[child].getCapID();
if (childCapId != "") {
	childCap = aa.cap.getCap(childCapId).getOutput();
	}

if (childCapId != "") {
	childStatus = childCap.getCapStatus();
	}

if (childCapId != "") {
	childGroup = childCap.getCapModel().getCapType().getGroup();
	}

if (childGroup == "AMS" && childStatus != "Closed") {
	incompCount = incompCount + 1;
	}
`^
CMN;ServiceRequest!TrafficEngineering!~!~;GetAppName^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
appName = cmnSubType;
`^
CMN;ServiceRequest!TrafficEngineering!Request!NA;ASITReview^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (tblColi.hasNext() == false) {
	tblColi = workModel.getColumns().iterator();
	}

val = tblFieldi.next();
col = tblColi.next();
create = false;
if (col.getColumnName() == "Type" && val == "Count") {
	type = "Count";
	}

if (col.getColumnName() == "Type" && val == "Crash Study") {
	type = "Crash Study";
	}

if (col.getColumnName() == "Type" && val == "Field Check") {
	type = "Field Check";
	}

if (col.getColumnName() == "Type" && val == "Parking Study") {
	type = "Parking Study";
	}

if (col.getColumnName() == "Type" && val == "Previous Study") {
	type = "Previous Study";
	}

if (col.getColumnName() == "Type" && val == "Sight Distance") {
	type = "Sight Distance";
	}

if (col.getColumnName() == "Type" && val == "User Study") {
	type = "User Study";
	}

if (col.getColumnName() == "Type" && val == "Speed Study") {
	type = "Speed Study";
	}

if (col.getColumnName() == "Created By" && val == null) {
	tblField.set(i, currentUserID);
	create = true;
	}

if (col.getColumnName() == "Date Created" && val == null) {
	tblField.set(i, "02!24!2014");
	create = true;
	}

if (create == true && type == "Count") {
	createWOChild("ServiceRequest","Traffic Engineering", "Study", "Count", "Traffic Engineering Count", capId);
	}

i = i + 1;
`^
CMN;SetResParkPermitYear^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var dtToday = new Date();
var iMonth = dtToday.getMonth() + 1;
var iYear = dtToday.getFullYear();
if(iMonth > 6) iYear = iYear + 1;
var sPermitYr = iYear + "";
editAppSpecific("OFFICE USE ONLY.Permit Year", sPermitYr);
var sExpDate = "8!31!" + sPermitYr;
editAppSpecific("OFFICE USE ONLY.Permit Expiration Date", sExpDate);
if (cmnCategory == "NA") {
	licEditExpInfo(null,sExpDate);
	}
`^
CMN;Store_Report_To_Disk^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
reportInfoModel = aa.reportManager.getReportInfoModelByName(reportName);
if (reportInfoModel.getSuccess()) {
	report = reportInfoModel.getOutput();
	}

if (reportInfoModel.getSuccess()) {
	report.setModule(appTypeArray[0]);
	report.setCapId(capId);
	}

if (reportInfoModel.getSuccess()) {
	parameters = aa.util.newHashMap();
	parameters.put("AltID", capIDString);
	}

if (reportInfoModel.getSuccess()) {
	report.setReportParameters(parameters);
	}

if (reportInfoModel.getSuccess()) {
	report2 = report.getReportInfoModel();
	report2.setNotSaveToEDMS(true);
	}

if (reportInfoModel.getSuccess()) {
	reportResult = aa.reportManager.getReportResult(report);
	}

if (reportResult.getSuccess()) {
	reportResultOut = reportResult.getOutput();
	}

if (reportResult.getSuccess()) {
	reportFile = aa.reportManager.storeReportToDisk(reportResultOut);
	}

if (reportFile.getSuccess()) {
	reportFile = reportFile.getOutput();
	}
`^
CMN;TERLPCARD^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
asiGroups = aa.appSpecificInfo.getByCapID(capId).getOutput();
rsx = parseInt(capIDString.substring(capIDString.length() - 5),10)+"";
createTERCard = false;
var refLic;
for (asi in asiGroups) include("CMN;CHECKTERSECTION");
if (createTERCard) {
	createReferenceLP("TER"+rsx,"PREQUALIFIED TER","Contractor");
	}

if (createTERCard) {
	refLic = getRefLicenseProf("TER"+rsx);
	}

if (createTERCard) {
	preqLicense = new licenseObject(null);
	preqExpDate = preqLicense.b1ExpDate;
	}

if (capStatus.equals("Inactive") && refLic) {
	refLic.setAuditStatus("I");
	} else {
	if(refLic) refLic.setAuditStatus("A");
	}

if (AInfo['CATEGORIES.Insurance Co'] != null && refLic) {
	refLic.setInsuranceCo(AInfo['CATEGORIES.Insurance Co']);
	}

if (AInfo['CATEGORIES.COI'] != null && refLic) {
	refLic.setInsuranceExpDate(aa.date.parseDate(AInfo['CATEGORIES.COI']));
	}

if (preqExpDate != null && preqExpDate != "" && refLic) {
	refLic.setLicenseExpirationDate(aa.date.parseDate(preqExpDate));
	}

if (refLic) {
	aa.licenseScript.editRefLicenseProf(refLic);
	}

if (AInfo['CATEGORIES.11Bond'] != null && refLic) {
	editRefLicProfAttribute("TER" + rsx, "11B EXPIRATION", AInfo['CATEGORIES.11Bond']);
	}
`^
CMN;TrackAssignments^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug=true;
assignmentUpdated=false;
cd=aa.cap.getCapDetail(capId).getOutput().getCapDetailModel();
prevAssignTo=getAppSpecific("TRACKING INFORMATION.Record Assigned To");
if(prevAssignTo==null) prevAssignTo="Blank";
prevAssignDept=getAppSpecific("TRACKING INFORMATION.Record Assigned Dept");
if(prevAssignDept==null) prevAssignDept="Blank";
curAssignTo=cd.getAsgnStaff();
if(curAssignTo==null) curAssignTo="Blank";
curAssignDept=cd.getAsgnDept();
if(curAssignDept==null) curAssignDept="Blank";
if (!prevAssignDept.equals(curAssignDept)) {
	if(prevAssignDept != "Blank") assignmentUpdated = true;
	}

if (!prevAssignTo.equals(curAssignTo)) {
	assignmentUpdated = true;
	}

if (assignmentUpdated && AInfo['TRACKING INFORMATION.Record Assigned By'] == null) {
	editAppSpecific("TRACKING INFORMATION.Record Assigned By",currentUserID+",");
	}

if (assignmentUpdated && AInfo['TRACKING INFORMATION.Record Assigned By'] != null && AInfo['TRACKING INFORMATION.Record Assigned By'].indexOf(currentUserID)==-1) {
	editAppSpecific("TRACKING INFORMATION.Record Assigned By",AInfo['TRACKING INFORMATION.Record Assigned By']+currentUserID+",");
	}

if (!curAssignTo.equals("Blank")) {
	editAppSpecific("TRACKING INFORMATION.Record Assigned To",curAssignTo);
	}

if (!curAssignDept.equals("Blank")) {
	editAppSpecific("TRACKING INFORMATION.Record Assigned Dept",curAssignDept);
	}
`^
CMN;Traffic Engineering!Street Occupancy;Inspection;Citation^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
citationNo = Number(lookup("CitationSeq","TELastNbr"));
citationSeries = lookup("CitationSeq","TESeries");
citationNo = citationNo + 1;
editLookup("CitationSeq","TELastNbr",citationNo.toString());
editTaskSpecific("Traffic Engineering Review","Citation Number",citationSeries + Right(("00000" + citationNo.toString()),5) );
`^
CMN;TRBIKEDUPSERIALS^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
icapId = BikeCAPSerials[iRecords].getCapID();
icapId = aa.cap.getCapID(icapId.getID1(),icapId.getID2(),icapId.getID3()).getOutput();
ialtId = icapId.getCustomID();
iContacts = getContactArray(BikeCAPSerials[iRecords].getCapID());
if ((ialtId.equalsIgnoreCase(capIDString.toString())) == false) {
	for (iContact in iContacts) if ((iContacts[iContact]["contactType"]) == "Permanent Address") include("CMN;AssembyContact");
	}

if ((ialtId.equalsIgnoreCase(capIDString.toString())) == false) {
	ialtIds += "<BR><br>" + ialtId + "<br>" + dupName;
	}

if ((ialtId.equalsIgnoreCase(capIDString.toString())) == false && getAppSpecific("INCIDENT REPORTS.Reported Stolen",icapId) == "Yes") {
	ialtIds += "<br><br>This owner has reported this serial number stolen; " + getAppSpecific("INCIDENT REPORTS.Date of Report",icapId);
	}
`^
CMN;UpdateAppNameWithCAPDetail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var workDes = workDescGet(capId);
if (workDes != null && workDes.length() > 130) {
	workDes = workDes.substr(0,129);
	}

if (workDes != null) {
	editAppName(workDes);
	}
`^
CMN;UpdateAuditStatus^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
updateAppStatus("Audited", "Set by renewal paperwork document type upload script");
licEditExpInfo("Active",null);
`^
CMN;UpdateDBA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
include("CMN;GetDBA");
if (businessName) {
	updateShortNotes(businessName);
	updateWorkDesc(businessName);
	editAppName(businessName, capId);
	}
`^
CMN;UpdateParksAssets^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var strName = "";
AssetList = aa.asset.getAssetListByWorkOrder(capId,null);
if (AssetList.getSuccess()) {
	AssetList = AssetList.getOutput();
	for (x in AssetList) strName = strName + (AssetList[x].assetMasterModel["g1AssetID"]) + ";
	";
	updateWorkDesc(workDescGet(capId) + " " +strName);
	}
`^
CMN;UpdateShortNotesWithCAPDetail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var workDes = workDescGet(capId);
if (workDes != null && workDes.length() > 130) {
	workDes = workDes.substr(0,129);
	}

if (workDes != null) {
	updateShortNotes(workDes);
	}
`^
CMN;URBANDESIGNDISTRICT^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (proximity("agis_madison","Urban Design District",-1,"feet") && appHasCondition("URBAN DESIGN DISTRICT","APPLIED","UrbanDesignDist",null) == false) {
	addAppCondition("URBAN DESIGN DISTRICT","APPLIED","UrbanDesignDist","Permit applications in this area may require Urban Design Commission Approval","Notice");
	include("EML;URBANDESIGNDIST");
	}
`^
CMN;ValidateResParkAreaNum^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
oAddr = cap.getAddressModel();
var areaNum = "";
if (oAddr) {
	addrAttrib = oAddr.getAttributes();
	}

if (addrAttrib) {
	var aryAddressAttrib = addrAttrib.toArray();
	}

if (aryAddressAttrib.length) {
	for(idx in aryAddressAttrib) if(aryAddressAttrib[idx].getB1AttributeName() == "RP3 AREA") areaNum = aryAddressAttrib[idx].getB1AttributeValue();
	}

if (areaNum == "" || areaNum == null || areaNum == undefined) {
	cancel = true;
	showMessage = true;
	comment("Our system indicates that this address is not in a valid residential parking permit area.<br> Please contact the residential parking staff at (608) 266-4761 if you have questions or <br>think that this is a valid address for a residential parking permit.");
	}
`^
CMN;Vending_Store_Report_To_Disk^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
reportInfoModel = aa.reportManager.getReportInfoModelByName(reportName);
if (reportInfoModel.getSuccess()) {
	report =  reportInfoModel.getOutput();
	}

if (reportInfoModel.getSuccess()) {
	report.setModule(appTypeArray[0]);
	report.setCapId(capId);
	}

if (reportInfoModel.getSuccess()) {
	parameters = aa.util.newHashMap();
	parameters.put("AltID", capIDString);
	}

if (reportInfoModel.getSuccess()) {
	report.setReportParameters(parameters);
	}

if (reportInfoModel.getSuccess()) {
	report2 = report.getReportInfoModel();
	report2.setNotSaveToEDMS(true);
	}

if (reportInfoModel.getSuccess()) {
	reportResult = aa.reportManager.getReportResult(report);
	}

if (reportResult.getSuccess()) {
	reportResult = reportResult.getOutput();
	}

reportFile = aa.reportManager.storeReportToDisk(reportResult);
if (reportFile.getSuccess()) {
	reportFile = reportFile.getOutput();
	}
`^
CMN;WeightsMeasures!Licensing!NA!NA;DeviceQtyForFees^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var deviceType = "";
var quantity = null;
var sInvoiced = "";
deviceType = DEVICEINFORMATION[x]["Device Type"];
quantity = parseInt(DEVICEINFORMATION[x]["Number of Devices"]);
sInvoiced = DEVICEINFORMATION[x]["Invoiced"];
logDebug("Row = " + x + "; Device Type, Quantity, Invoiced; " + deviceType + ", " + quantity + ", " + sInvoiced);
if (quantity == 0) {
	quantity = null;
	}

if (deviceType == "ADVP COUNTERWEIGHT") {
	if(feeExists("WMADVPWEIGHT") == true) removeFee("WMADVPWEIGHT","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMADVPWEIGHT") == false) updateFee("WMADVPWEIGHT","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "ALUM RECYCLING MACHINE") {
	if(feeExists("WMALUMRECMAC") == true) removeFee("WMALUMRECMAC","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMALUMRECMAC") == false) updateFee("WMALUMRECMAC","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "BABY SCALE") {
	if(feeExists("WMBABY") == true) removeFee("WMBABY","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMBABY") == false) updateFee("WMBABY","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "BEAM SCALE FLOOR") {
	if(feeExists("WMBEAMFLOOR") == true) removeFee("WMBEAMFLOOR","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMBEAMFLOOR") == false) updateFee("WMBEAMFLOOR","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "BEAM SCALE TABLE TOP") {
	if(feeExists("WMBEAMTABLE") == true) removeFee("WMBEAMTABLE","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMBEAMTABLE") == false) updateFee("WMBEAMTABLE","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "BENCH SCALE OVER 30 LBS") {
	if(feeExists("WMBENCHOVER30") == true) removeFee("WMBENCHOVER30","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMBENCHOVER30") == false) updateFee("WMBENCHOVER30","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "BENCH SCALE TO 30 LBS") {
	if(feeExists("WMBENCHUNDER30") == true) removeFee("WMBENCHUNDER30","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMBENCHUNDER30") == false) updateFee("WMBENCHUNDER30","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "COMPUTING SCALE") {
	if(feeExists("WMCOMPUTING") == true) removeFee("WMCOMPUTING","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMCOMPUTING") == false) updateFee("WMCOMPUTING","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "DORMANT SCALE") {
	if(feeExists("WMDORMANT") == true) removeFee("WMDORMANT","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMDORMANT") == false) updateFee("WMDORMANT","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "EQUAL ARM BALANCE") {
	if(feeExists("WMEqualArm") == true) removeFee("WMEqualArm","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMEqualArm") == false) updateFee("WMEqualArm","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "FARM MARKET SCALE") {
	if(feeExists("WMFARMMKT") == true) removeFee("WMFARMMKT","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMFARMMKT") == false) updateFee("WMFARMMKT","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "FLOOR SCALE") {
	if(feeExists("WMFLOOR") == true) removeFee("WMFLOOR","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMFLOOR") == false) updateFee("WMFLOOR","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "FUEL BULK METER") {
	if(feeExists("WMFUELBULK") == true) removeFee("WMFUELBULK","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMFUELBULK") == false) updateFee("WMFUELBULK","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "GAS PUMP") {
	if(feeExists("WMGASPUMP") == true) removeFee("WMGASPUMP","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMGASPUMP") == false) updateFee("WMGASPUMP","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "GRAIN & METRIC SCALE BALANCE") {
	if(feeExists("WMMETRIC") == true) removeFee("WMMETRIC","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMMETRIC") == false) updateFee("WMMETRIC","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "HANGING SCALE OVER 30 LB") {
	if(feeExists("WMHANGOVER30") == true) removeFee("WMHANGOVER30","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMHANGOVER30") == false) updateFee("WMHANGOVER30","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "HANGING SCALE TO 30 LB") {
	if(feeExists("WMHANGUNDER30") == true) removeFee("WMHANGUNDER30","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMHANGUNDER30") == false) updateFee("WMHANGUNDER30","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "HIGH PRECISION BALANCE") {
	if(feeExists("WMHIGHPREC") == true) removeFee("WMHIGHPREC","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMHIGHPREC") == false) updateFee("WMHIGHPREC","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "HIGH SPEED GAS PUMP") {
	if(feeExists("WMHIGHSPDGAS") == true) removeFee("WMHIGHSPDGAS","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMHIGHSPDGAS") == false) updateFee("WMHIGHSPDGAS","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "MEASUREGRAPH") {
	if(feeExists("WMMEASUREGRAPH") == true) removeFee("WMMEASUREGRAPH","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMMEASUREGRAPH") == false) updateFee("WMMEASUREGRAPH","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "MISCELLANEOUS DEVICES") {
	if(feeExists("WMMiscDev") == true) removeFee("WMMiscDev","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMMiscDev") == false) updateFee("WMMiscDev","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "PERSONAL SCALE") {
	if(feeExists("WMPERSONAL") == true) removeFee("WMPERSONAL","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMPERSONAL") == false) updateFee("WMPERSONAL","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "PLATFORM SCALE") {
	if(feeExists("WMPLATFORM") == true) removeFee("WMPLATFORM","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMPLATFORM") == false) updateFee("WMPLATFORM","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "PREPACK SCALE") {
	if(feeExists("WMPREPACK") == true) removeFee("WMPREPACK","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMPREPACK") == false) updateFee("WMPREPACK","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "PRESCRIPTION BALANCE") {
	if(feeExists("WMPRESCRIPTION") == true) removeFee("WMPRESCRIPTION","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMPRESCRIPTION") == false) updateFee("WMPRESCRIPTION","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "SPECIAL FEES") {
	if(feeExists("WMSPECIAL") == true) removeFee("WMSPECIAL","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMSPECIAL") == false) updateFee("WMSPECIAL","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "SPRING SCALE") {
	if(feeExists("WMSPRING") == true) removeFee("WMSPRING","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMSPRING") == false) updateFee("WMSPRING","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "STATIONARY METER") {
	if(feeExists("WMSTATIONARY") == true) removeFee("WMSTATIONARY","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMSTATIONARY") == false) updateFee("WMSTATIONARY","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "TAXI METER") {
	if(feeExists("WMTAXIMETER") == true) removeFee("WMTAXIMETER","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMTAXIMETER") == false) updateFee("WMTAXIMETER","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "TIMING DEVICE") {
	if(feeExists("WMTIMINGDEV") == true) removeFee("WMTIMINGDEV","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMTIMINGDEV") == false) updateFee("WMTIMINGDEV","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "UPC SCANNER") {
	if(feeExists("WMUPCSCAN") == true) removeFee("WMUPCSCAN","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMUPCSCAN") == false) updateFee("WMUPCSCAN","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "UPC BASE FEE 1-3") {
	if(feeExists("WMUPCBS13") == true) removeFee("WMUPCBS13","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMUPCBS13") == false) updateFee("WMUPCBS13","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "UPC BASE FEE 4+") {
	if(feeExists("WMUPCBS4P") == true) removeFee("WMUPCBS4P","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMUPCBS4P") == false) updateFee("WMUPCBS4P","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "UPC BASE DIFFERENCE") {
	if(feeExists("WMUPCBSDIF") == true) removeFee("WMUPCBSDIF","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMUPCBSDIF") == false) updateFee("WMUPCBSDIF","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "VEHICLE SCALE") {
	if(feeExists("WMVEHICLE") == true) removeFee("WMVEHICLE","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMVEHICLE") == false) updateFee("WMVEHICLE","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "VEHICLE TANK METER") {
	if(feeExists("WMVEHTANK") == true) removeFee("WMVEHTANK","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMVEHTANK") == false) updateFee("WMVEHTANK","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "WEIGH BUGGY") {
	if(feeExists("WMWEIGHBUGGY") == true) removeFee("WMWEIGHBUGGY","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMWEIGHBUGGY") == false) updateFee("WMWEIGHBUGGY","WMFEES","FINAL",quantity,"N");
	}

if (deviceType == "YARD MEASURE") {
	if(feeExists("WMYARDMEASURE") == true) removeFee("WMYARDMEASURE","FINAL");
	if(quantity != null && sInvoiced == "UNCHECKED" && feeExists("WMYARDMEASURE") == false) updateFee("WMYARDMEASURE","WMFEES","FINAL",quantity,"N");
	}
`^
CMN;WeightsMeasures!Licensing!NA!NA;ProcessDeviceFees^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var bNoFees = false;
var oSetsList = null;
var arySetsList = null;
var bFarmMarket = false;
var bAddToSet = false;
var bRecAlreadyInSet = false;
if (getAppSpecific("GENERAL INFORMATION.Exclude From Billing") == "CHECKED") {
	bNoFees = true;
	}

if (bNoFees == false) {
	for(x in DEVICEINFORMATION) include("CMN;WeightsMeasures!Licensing!NA!NA;DeviceQtyForFees");
	}

for(x in DEVICEINFORMATION) if(DEVICEINFORMATION[x]["Device Type"] == "FARM MARKET SCALE") bFarmMarket = true;
for(x in DEVICEINFORMATION) if(DEVICEINFORMATION[x]["Invoiced"] == "UNCHECKED") bAddToSet = true;
if (aa.set.getSetHeadersListByMember(capId).getSuccess()) {
	oSetsList = aa.set.getSetHeadersListByMember(capId).getOutput();
	}

if (oSetsList != null) {
	arySetsList = oSetsList.toArray();
	}

if (arySetsList != null) {
	for(x in arySetsList) if(arySetsList[x].setID == "WMMONTHLY") bRecAlreadyInSet = true;
	}

if (bNoFees == false && bFarmMarket == false && bRecAlreadyInSet == false && bAddToSet == true) {
	aa.set.add("WMMONTHLY",capId);
	}
`^
CMN;WeightsMeasures!Licensing!NA!NA;ProcessRenewals^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (false) {
	logDebug("In EMSE script CMN;WeightsMeasures!Licensing!NA!NA;ProcessRenewals");
	}

for(x in DEVICEINFORMATION) include("CMN;WeightsMeasures!Licensing!NA!NA;DeviceQtyForFees");
`^
CMN;WeightsMeasuresLicenseIssueProcess^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var bPaidInFull = false;
var bIssueLicense = false;
var bLicSetActive = false;
var appExpDate = null;
var currentYr = null;
var currentMonth = null;
var newExpYr = null;
var newExpDate = null;
if (feesInvoicedTotal > 0 && balanceDue <= 0) {
	bPaidInFull = true;
	logDebug("Value of bPaidInFull = " + bPaidInFull);
	}

if (bPaidInFull == false) {
	cancel = true;
	showMessage = true;
	comment("There are either no fees assessed or the balance due is > 0, so the license issuance process has been cancelled. If fees have been assessed, please pay the balance in full to issue and activate the license.");
	}

if (bPaidInFull && isTaskActive("Intake") && appMatch("WeightsMeasures!Licensing!NA!NA") == true) {
	closeTask("Intake","Complete","Intake completed due to full fee payment","Automated process");
	}

if (bPaidInFull && isTaskActive("Issuance") && appMatch("WeightsMeasures!Licensing!NA!NA") == true) {
	bIssueLicense = true;
	}

if (bIssueLicense) {
	closeTask("Issuance", "Issued", "Closed by script", "Automated process");
	}

if (bIssueLicense) {
	updateTask("License Status", "Active", "Updated by script", "Automated process");
	}

if (bPaidInFull && (isTaskStatus("License Status", "About to Expire") || isTaskStatus("License Status", "Expired"))) {
	bLicSetActive = true;
	}

if (bLicSetActive) {
	updateTask("License Status", "Active", "Updated by script", "Automated process");
	}

appExpDate = aa.expiration.getLicensesByCapID(capId).getOutput();
currentYr = startDate.getFullYear();
currentMonth = startDate.getMonth();
logDebug("Current Year = " + currentYr);
logDebug("Current Month = " + currentMonth);
if ((currentMonth == 10 || currentMonth == 11)) {
	newExpYr = currentYr + 1;
	} else {
	newExpYr = currentYr;
	}

newExpDate = appExpDate.getExpDate().getMonth() + "!" + appExpDate.getExpDate().getDayOfMonth() + "!" + newExpYr;
if (bPaidInFull && (bIssueLicense || bLicSetActive)) {
	licEditExpInfo("Active", newExpDate);
	}

if (publicUser == false && bPaidInFull == true) {
	aa.set.add("WM LIC DAILY",capId);
	}
`^
CMN;WorkOrderStandard StatusUpdates^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (capStatus == "Approved") {
	closeTask("Open","Approved","Work Order Approved","Approved by status update");
	}

if (capStatus == "Work Completed") {
	if(isTaskActive("Open") == true) closeTask("Open","Approved","Work Order Approved","Approved by status update");
	closeTask("Complete","Work Complete","Work Order Completed","Completed by status update");
	}

if (capStatus == "Work in Progress") {
	updateTask("Complete","Work in Progress","Work Order in progress","In Progress by status update");
	}
`^
CommunicationReceivingEmailAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = true;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("REA;" + cmnGroup + "!~!~!~");
include("REA;" + cmnGroup + "!" + cmnType + "!~!~");
include("REA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("REA;" + appTypeString);
associateMessagesToRecords(messages);
aa.sendEmail("elamsupport@cityofmadison.com", "jmoyer@cityofmadison.com", "jmoyer@cityofmadison.com", "SCemailSubject", "SCemailText", "");
`^
CommunicationReceivingEmailBefore^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
aa.sendEmail("noreply@cityofmadison.com", "jmoyer@cityofmadison.com", "jmoyer@cityofmadison.com", "emailSubject", "emailText", "");
`^
ContactEditAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CEA;" + cmnGroup + "!~!~!~");
include("CEA;" + cmnGroup + "!" + cmnType + "!~!~");
include("CEA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CEA;" + appTypeString);
`^
ConvertToRealCapAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (publicUser == true) {
	updateAppStatus("Online Submittal","Submitted via Citizen Access");
	}

include("CMN;~!~!~!~;GET_APP_PARTS");
include("CRCA;" + cmnGroup + "!~!~!~");
include("CRCA;" + cmnGroup + "!" + cmnType + "!~!~");
include("CRCA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CRCA;" + appTypeString);
`^
ConvertToRealCAPBefore^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("CRCB;" + cmnGroup + "!~!~!~");
include("CRCB;" + cmnGroup + "!" + cmnType + "!~!~");
include("CRCB;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("CRCB;" + appTypeString);
`^
CPB;Licenses!Treasurer!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
addrMod = cap.getAddressModel();
neighbor = addrMod.getNeighborhood();
if (neighbor != "City of Madison") {
	cancel = true;
	showMessage = true;
	comment("The address you selected is not within the City of Madison.  It is not necessary for you to obtain a Pet License for the City of Madison.");
	}
`^
CPB;Permitting!Building!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
neighbor = "City of Madison";
addrMod = cap.getAddressModel();
neighbor = addrMod.getNeighborhood();
if (addrMod.getRefAddressId() != null && neighbor != "City of Madison") {
	cancel = true;
	showMessage = true;
	comment("The address you selected is not within the City of Madison. Please check your local jurisdiction to see if a permit is required.");
	}
`^
CPB;Permitting!Engineering!Street Terrace!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
addrMod = cap.getAddressModel();
neighbor = addrMod.getNeighborhood();
if (neighbor != "City of Madison") {
	cancel = true;
	showMessage = true;
	comment("The address you selected is not within the City of Madison.");
	}
`^
CPB;Permitting!Fire!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
neighbor = "City of Madison";
isMadisonOrShorewood = false;
city = "";
found = -1;
addrMod = cap.getAddressModel();
neighbor = addrMod.getNeighborhood();
if (addrMod.getRefAddressId() != null && neighbor == "City of Madison") {
	isMadisonOrShorewood = true;
	}

if (isMadisonOrShorewood == false) {
	city = addrMod.getCity();
	city = city.toUpperCase();
	found = city.indexOf("SHOREWOOD HILLS");
	}

if (isMadisonOrShorewood == false && found == -1) {
	city = addrMod.getCity();
	city = city.toUpperCase();
	found = city.indexOf("TOWN OF BLOOMING GROVE");
	}

if (isMadisonOrShorewood == false && found > -1) {
	isMadisonOrShorewood = true;
	}

if (isMadisonOrShorewood == false) {
	cancel = true;
	showMessage = true;
	comment("The address you selected is not within the City of Madison or the Village of Shorewood Hills or the Town of Blooming Grove. Please check your local jurisdiction to see if a permit is required.");
	}
`^
CPB;Permitting!Miscellaneous!Edible Landscape!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
addrMod = cap.getAddressModel();
neighbor = addrMod.getNeighborhood();
if (neighbor != "City of Madison") {
	cancel = true;
	showMessage = true;
	comment("The address you selected is not within the City of Madison.");
	}

if (neighbor == "City of Madison") {
	ownerName = cap.getOwnerModel().getOwnerFullName();
	}

if (ownerName.toLowerCase().indexOf("city of madison") == -1) {
	cancel = true;
	showMessage = true;
	comment("This property does not have City of Madison listed on the ownership record. Please contact the City Assessor if you have questions about the property ownership.");
	}
`^
CRCA;Enforcement!Building Inspection!Construction!No Permit^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
debugObject(cap);
debugObject(cap.getCapModel().getCapOwnerModel());
debugObject(cap.getCapModel().getParcelModel());
aa.sendEmail("noreply@cityofmadisonDEV.com", "jmoyer@cityofmadisonDEV.com", "jmoyer@cityofmadisonDEV.com", "CRCA IPAD TEST", debug, "");
`^
CRCA;Licenses!Building Inspection!Landlord Registration!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
closeTask("Intake","Submitted","Submited","Submitted");
aa.cap.removeExpiredIncompleteCAP();
updateAppStatus("Registered","");
include("CMN;GetAPOAddress");
updateShortNotes(APOAddress);
rsEXPStatus = "Active";
updateTask("Registration Status","Registered","","");
include("CMN;GENERIC;ExpDec31");
ad = aa.address.getAddressByCapId(capId).getOutput();
RefAddressID = "";
if (ad.length && ad[0].getRefAddressId() != null) {
	RefAddressID = ad[0].getRefAddressId();
	}

if (RefAddressID != "") {
	addParcelAndOwnerFromRefAddress(RefAddressID);
	}
`^
CRCA;Licenses!Building Inspection!Landlord Registration!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
ad = aa.address.getAddressByCapId(capId).getOutput();
RefAddressID = "";
if (ad.length && ad[0].getRefAddressId() != null) {
	RefAddressID = ad[0].getRefAddressId();
	}

if (RefAddressID != "") {
	addParcelAndOwnerFromRefAddress(RefAddressID);
	}

if (publicUser) {
	include("CMN;Licenses!Building Inspection!Landlord Registration!Renewal;UpdateRenwal");
	}
`^
CRCA;Licenses!Civil Rights!AA Plan!Developer^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
closeTask("AA Dev Review","Approved","Auto Approval","Auto Approval");
updateTask("AA Dev Status","Active","Auto Approval","Auto Approval");
include("EML;Licenses!DCR!AA Plan!NA;PlanReviewDeveloper");
if ((startDate.getMonth() == 10 || startDate.getMonth() == 11)) {
	newYear = startDate.getFullYear() + 3;
	expDate = "03!01!" + newYear;
	} else {
	newYear = startDate.getFullYear() + 2;
	expDate = "03!01!" + newYear;
	}

licEditExpInfo("Active", expDate);
updateAppStatus("Active", "Set by workflow", capId);
`^
CRCA;Licenses!Civil Rights!AA Plan!Exempt Under $25,000^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
closeTask("AA Exemption Review","Approved","Auto Approval","Auto Approval");
updateTask("AA Exemption Status","Active","Auto Approval","Auto Approval");
include("EML;Licenses!DCR!AA Plan!NA;PlanReviewExempt25K");
if ((startDate.getMonth() == 10 || startDate.getMonth() == 11)) {
	newYear = startDate.getFullYear() + 3;
	expDate = "03!01!" + newYear;
	} else {
	newYear = startDate.getFullYear() + 2;
	expDate = "03!01!" + newYear;
	}

licEditExpInfo("Active", expDate);
updateAppStatus("Active", "Set by workflow", capId);
`^
CRCA;Licenses!Clerk!Operator!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (getAppSpecific("ADDITIONAL APPLICANT INFO.Employer Paying Fees") == "Yes") {
	include("CMN;Licenses!Clerk!Operator!NA;Fee");
	}

if (getAppSpecific("ADDITIONAL APPLICANT INFO.Employer Paying Fees") == "Yes") {
	employerEmail = AInfo['ADDITIONAL APPLICANT INFO.Employer Email'];
	include("EML;Licenses!Clerk!Operator!Renewal;EmployerNotice");
	} else {
	include("EML;Licenses!Clerk!Operator!NA;ApplicationSubmitted");
	}

if (getAppSpecific("ADDITIONAL APPLICANT INFO.Employer Paying Fees") == "Yes") {
	updateAppStatus("Payment Pending", "Employer Paying Fees", capId);
	}
`^
CRCA;Licenses!Clerk!Operator!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
proj1 = aa.cap.getProjectByChildCapID(capId, "Renewal", "Incomplete");
projSuccess1 = proj1.getSuccess();
if (projSuccess1 == true) {
	proj1 = proj1.getOutput();
	parentCapId = proj1[0].getProjectID();
	}

if (AInfo['ADDITIONAL APPLICANT INFO.Employer Paying Fees'] == "Yes") {
	calledBy = "CRCA";
	include("CMN;Licenses!Clerk!Operator!Renewal;Fee");
	}

if (AInfo['ADDITIONAL APPLICANT INFO.Employer Paying Fees'] == "Yes") {
	employerEmail = AInfo['ADDITIONAL APPLICANT INFO.Employer Email'];
	include("EML;Licenses!Clerk!Operator!Renewal;EmployerNotice");
	}

if (!cap.isCreatedByACA() && AInfo['ADDITIONAL APPLICANT INFO.Employer Paying Fees'] == "No") {
	include("CMN;Licenses!Clerk!Operator!Renewal;Fee");
	}

tempCapId = capId;
capId = parentCapId;
licEditExpInfo("Pending", null);
capId = tempCapId;
`^
CRCA;Licenses!Engineering!Prequalified Contractor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
r = aa.cap.getProjectByChildCapID(capId, "Renewal", "Incomplete").getOutput();
r[0].setStatus("Review");
aa.cap.updateProject(r[0]);
r1 = aa.cap.getProjectByChildCapID(capId, "Renewal", "Review").getOutput();
r1[0].setStatus("Complete");
aa.cap.updateProject(r1[0]);
taskCloseAllExcept("Renewal", "Do not process renewal record.");
updateAppStatus("Renewal Complete", "Do not process renewal record.");
`^
CRCA;Licenses!Health!Temp Food Establishment!DaneCounty^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (publicUser && isTaskActive("Intake")) {
	closeTask("Intake", "Completed", "Intake has been auto-completed due to online fee payment", "Automated process");
	}
`^
CRCA;Licenses!Treasurer!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var bHasCitation = false;
if (cmnSubType.toString().slice(0,3) == "Cat" && AInfo['ANIMAL DETAILS.I have received a citation for failure to license my cat within the last 45 days'] == "CHECKED") {
	bHasCitation = true;
	}

if (cmnSubType.toString().slice(0,3) == "Dog" && AInfo['ANIMAL DETAILS.I have received a citation for failure to license my dog within the last 45 days'] == "CHECKED") {
	bHasCitation = true;
	}

if (publicUser && (cmnSubType == "Cat Registration" || cmnSubType == "Dog Registration" || cmnSubType  == "Chicken Owner")) {
	include("EML;Licenses!Treasurer!~!~;PetLicAppSubmitted");
	}

if (publicUser && bHasCitation && (cmnSubType == "Cat Registration" || cmnSubType == "Dog Registration")) {
	include("EML;Licenses!Treasurer!~!~;PetLicCitation");
	}

if (!publicUser && cmnCategory == "Renewal" && currentUserID !="TRMRA" && (cmnSubType == "Dog Registration" || cmnSubType == "Cat Registration" || cmnSubType == "Chicken Owner")) {
	aa.set.add("PETLIC",capId);
	}

if (!publicUser && cmnCategory == "Renewal" && currentUserID =="TRMRA" && (cmnSubType == "Dog Registration" || cmnSubType == "Cat Registration" || cmnSubType == "Chicken Owner")) {
	aa.set.add("PETLIC2",capId);
	}

if (cmnCategory != "Renewal") {
	include("CMN;LICENSE;ExpDec31");
	}
`^
CRCA;Licenses!Treasurer!Cat Registration!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (publicUser) {
	include("CMN;Licenses!Treasurer!Cat Registration!NA;Fee");
	}
`^
CRCA;Licenses!Treasurer!Cat Registration!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
proj = aa.cap.getProjectByChildCapID(capId, "Renewal", "Incomplete");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	parentCapId = proj[0].getProjectID();
	aa.cap.updateRenewalCapStatus(parentCapId, capId);
	}

if (publicUser == false) {
	include("CMN;Licenses!Treasurer!Cat Registration!NA;Fee");
	}

aa.cap.updateAccessByACA(capId, "N");
taskCloseAllNotComplete("Closed","Closed");
if (publicUser) {
	updateAppStatus("Online Submittal" ,"Updated because renewal was completed.", capId);
	} else {
	updateAppStatus("Open" ,"Updated because renewal was completed.", capId);
	}
`^
CRCA;Licenses!Treasurer!Chicken Owner!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
proj = aa.cap.getProjectByChildCapID(capId, "Renewal", "Incomplete");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	parentCapId = proj[0].getProjectID();
	aa.cap.updateRenewalCapStatus(parentCapId, capId);
	}

if (publicUser == false) {
	include("CMN;Licenses!Treasurer!Chicken Owner!NA;Fee");
	}

aa.cap.updateAccessByACA(capId, "N");
taskCloseAllNotComplete("Closed","Closed");
if (publicUser) {
	updateAppStatus("Online Submittal" ,"Updated because renewal was completed.", capId);
	} else {
	updateAppStatus("Open" ,"Updated because renewal was completed.", capId);
	}
`^
CRCA;Licenses!Treasurer!Dog Registration!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (publicUser) {
	include("CMN;Licenses!Treasurer!Dog Registration!NA;Fee");
	}
`^
CRCA;Licenses!Treasurer!Dog Registration!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
proj = aa.cap.getProjectByChildCapID(capId, "Renewal", "Incomplete");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	parentCapId = proj[0].getProjectID();
	aa.cap.updateRenewalCapStatus(parentCapId, capId);
	}

if (publicUser == false) {
	include("CMN;Licenses!Treasurer!Dog Registration!NA;Fee");
	}

aa.cap.updateAccessByACA(capId, "N");
taskCloseAllNotComplete("Closed","Closed");
if (publicUser) {
	updateAppStatus("Online Submittal" ,"Updated because renewal was completed.", capId);
	} else {
	updateAppStatus("Open" ,"Updated because renewal was completed.", capId);
	}
`^
CRCA;Licenses!Treasurer!Kennel!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
proj = aa.cap.getProjectByChildCapID(capId, "Renewal", "Incomplete");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	parentCapId = proj[0].getProjectID();
	aa.cap.updateRenewalCapStatus(parentCapId, capId);
	}

aa.cap.updateAccessByACA(capId, "N");
taskCloseAllNotComplete("Closed","Closed");
if (publicUser) {
	updateAppStatus("Online Submittal" ,"Updated because renewal was completed.", capId);
	} else {
	updateAppStatus("Open" ,"Updated because renewal was completed.", capId);
	}
`^
CRCA;Licenses!Vending!HighDensityVending!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licenses!Vending!~!~;ExpirationDate");
streetVendorCap = aa.cap.getCapID(AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number']);
if (streetVendorCap.getSuccess()) {
	addParent(AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number']);
	}

include("EML;Licenses!Vending!~!~;CRCAAppSubmitted");
licEditExpInfo("Pending", null);
`^
CRCA;Licenses!Vending!HighDensityVending!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("EML;Licenses!Vending!~!~;CRCRenewalSubmitted");
`^
CRCA;Licenses!Vending!LateNightVendor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licenses!Vending!~!~;ExpirationDate");
streetVendorCap = aa.cap.getCapID(AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number']);
if (streetVendorCap.getSuccess()) {
	addParent(AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number']);
	}

include("EML;Licenses!Vending!~!~;CRCAAppSubmitted");
licEditExpInfo("Pending", null);
`^
CRCA;Licenses!Vending!LateNightVendor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("EML;Licenses!Vending!~!~;CRCRenewalSubmitted");
`^
CRCA;Licenses!Vending!MallCraftVendor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licenses!Vending!~!~;ExpirationDate");
streetVendorCap = aa.cap.getCapID(AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number']);
if (streetVendorCap.getSuccess()) {
	addParent(AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number']);
	}

include("EML;Licenses!Vending!~!~;CRCAAppSubmitted");
licEditExpInfo("Pending", null);
`^
CRCA;Licenses!Vending!MallCraftVendor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("EML;Licenses!Vending!~!~;CRCRenewalSubmitted");
`^
CRCA;Licenses!Vending!MallFoodVendor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licenses!Vending!~!~;ExpirationDate");
streetVendorCap = aa.cap.getCapID(AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number']);
if (streetVendorCap.getSuccess()) {
	addParent(AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number']);
	}

include("EML;Licenses!Vending!~!~;CRCAAppSubmitted");
licEditExpInfo("Pending", null);
`^
CRCA;Licenses!Vending!MallFoodVendor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("EML;Licenses!Vending!~!~;CRCRenewalSubmitted");
`^
CRCA;Licenses!Vending!MerchantVendor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licenses!Vending!~!~;ExpirationDate");
include("EML;Licenses!Vending!~!~;CRCAAppSubmitted");
licEditExpInfo("Pending", null);
`^
CRCA;Licenses!Vending!SidewalkCafe!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licenses!Vending!~!~;ExpirationDate");
include("EML;Licenses!Vending!~!~;CRCAAppSubmitted");
licEditExpInfo("Pending", null);
`^
CRCA;Licenses!Vending!SidewalkCafe!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("EML;Licenses!Vending!~!~;CRCRenewalSubmitted");
`^
CRCA;Licenses!Vending!SoutheastCampusVending!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licenses!Vending!~!~;ExpirationDate");
streetVendorCap = aa.cap.getCapID(AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number']);
if (streetVendorCap.getSuccess()) {
	addParent(AInfo['APPLICANT INFORMATION.City of Madison Street Vendor License Number']);
	}

include("EML;Licenses!Vending!~!~;CRCAAppSubmitted");
licEditExpInfo("Pending", null);
`^
CRCA;Licenses!Vending!SoutheastCampusVending!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("EML;Licenses!Vending!~!~;CRCRenewalSubmitted");
`^
CRCA;Licenses!Vending!StreetVendor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Licenses!Vending!~!~;ExpirationDate");
include("EML;Licenses!Vending!~!~;CRCAAppSubmitted");
licEditExpInfo("Pending", null);
`^
CRCA;Licenses!Vending!StreetVendor!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("EML;Licenses!Vending!~!~;CRCRenewalSubmitted");
`^
CRCA;Licenses!Vending!TOSVOD!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = true;
include("CMN;Licenses!Vending!~!~;ExpirationDate");
reportName ="Vending Application";
include("EML;Licenses!Vending!~!~;CRCAAppSubmitted");
licEditExpInfo("Pending", null);
`^
CRCA;Permitting!Building!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
updateAppStatus("Online Submittal","Submitted via Citizen Access");
`^
CRCA;Permitting!Building!RepairReplace!Construction^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showMessage = false;
showDebug = false;
include("CMN;Permitting!Building!RepairReplace!Construction;UpdateCAPDetail");
`^
CRCA;Permitting!Building!RepairReplace!Electrical^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showMessage = false;
showDebug = false;
include("CMN;Permitting!Building!RepairReplace!Electrical;UpdateCAPDetail");
`^
CRCA;Permitting!Building!RepairReplace!HVAC^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showMessage = false;
showDebug = false;
include("CMN;Permitting!Building!RepairReplace!HVAC;UpdateCAPDetail");
`^
CRCA;Permitting!Building!RepairReplace!Plumbing^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showMessage = false;
showDebug = false;
include("CMN;Permitting!Building!RepairReplace!Plumbing;UpdateCAPDetail");
`^
CRCA;Permitting!Engineering!Erosion Control!Inspection^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!Erosion Control!Inspection;BMPFail");
include("CMN;Permitting!Engineering!Erosion Control!Inspection;UpdateParent");
copyAddresses(getApplication(erosionPermit), capId);
if (currentUserID == "ITJBS") {
	showDebug = true;
	}
`^
CRCA;Permitting!Engineering!ROW!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;UpdateAppNameWithCAPDetail");
if (!excludeUserFromEmail()) {
	include("EML;Permitting!Engineering!ROW!NA;CRCAAppSubmitted");
	}
`^
CRCA;Permitting!Engineering!Street Terrace!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
addparcel = parcelExistsOnCap(capId) == false;
if (publicUser == true) {
	include("EML;Permitting!Engineering!StreetTerrace!NA;Submitted");
	}

if (addparcel) {
	include("CMN;AddParcelAndOwner");
	}
`^
CRCA;Permitting!Fire!Alarm!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
projName = AInfo['PROJECT INFORMATION.Project Name'];
updateShortNotes(projName);
scopeOfWork = AInfo['PROJECT INFORMATION.Location - Area, Floor, Room Name and Number'];
newWorkDesModel = aa.cap.capWorkDesModel.getOutput();
newWorkDesModel.setCapID(capId);
newWorkDesModel.setAuditDate(aa.util.now());
newWorkDesModel.setAuditStatus("A");
newWorkDesModel.setAuditID("admin");
newWorkDesModel.setDescription(scopeOfWork);
newWorkDes = aa.cap.createCapWorkDes(newWorkDesModel);
include("CMN;Permitting!Fire!Alarm!NA;Fee");
if (publicUser == true) {
	include("EML;Permitting!Fire!~!~;FeeACA");
	}

if (publicUser == true) {
	iCnt = 0;
	valDescr = "";
	bFireCondFlag = false;
	}

if (publicUser == true && valDescr != undefined) {
	include("CMN;LoadFireASITConditions");
	}

if (bFireCondFlag == true) {
	logDebug("~~~ Flag is true;
	file CMN;LoadFireASITConditions is available.");
	} else {
	logDebug("~~~ Flag is false;
	file CMN;LoadFireASITConditions is NOT available.");
	}

if (bFireCondFlag == true && publicUser == true) {
	while (valDescr != undefined && iCnt < 21) include("CMN;LoadFireASITConditions");
	}
`^
CRCA;Permitting!Fire!AltFireSuppression!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
include("CMN;Permitting!Fire!AltFireSuppression!NA;Fee");
if (publicUser == true) {
	include("EML;Permitting!Fire!~!~;FeeACA");
	}

if (publicUser == true) {
	iCnt = 0;
	valDescr = "";
	bFireCondFlag = false;
	}

logDebug("IMPORTANT; branch script MUST be enabled, or else this script will be caught in infinite loop.");
if (publicUser == true && valDescr != undefined) {
	include("CMN;LoadFireASITConditions");
	}

if (bFireCondFlag == true) {
	logDebug("~~~ Flag is true;
	file CMN;LoadFireASITConditions is available.");
	} else {
	logDebug("~~~ Flag is false;
	file CMN;LoadFireASITConditions is NOT available.");
	}

if (bFireCondFlag == true && publicUser == true) {
	while (valDescr != undefined && iCnt < 21) include("CMN;LoadFireASITConditions");
	}
`^
CRCA;Permitting!Fire!ControlledEgress!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
bFireCondFlag = false;
include("CMN;Permitting!Fire!ControlledEgress!NA;Fee");
if (publicUser == true) {
	include("EML;Permitting!Fire!~!~;FeeACA");
	}

if (publicUser == true) {
	iCnt = 0;
	valDescr = "";
	bFireCondFlag = false;
	}

logDebug("IMPORTANT; branch script MUST be enabled, or else this script will be caught in infinite loop.");
if (publicUser == true && valDescr != undefined) {
	include("CMN;LoadFireASITConditions");
	}

if (bFireCondFlag == true) {
	logDebug("~~~ Flag is true;
	file CMN;LoadFireASITConditions is available.");
	} else {
	logDebug("~~~ Flag is false;
	file CMN;LoadFireASITConditions is NOT available.");
	}

if (bFireCondFlag == true && publicUser == true) {
	while (valDescr != undefined && iCnt < 21) include("CMN;LoadFireASITConditions");
	}
`^
CRCA;Permitting!Fire!KitchenHood!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Fire!Kitchenhood!NA;Fee");
if (publicUser == true) {
	include("EML;Permitting!Fire!~!~;FeeACA");
	}

if (publicUser == true) {
	iCnt = 0;
	valDescr = "";
	bFireCondFlag = false;
	}

logDebug("IMPORTANT; branch script MUST be enabled, or else this script will be caught in infinite loop.");
if (publicUser == true && valDescr != undefined) {
	include("CMN;LoadFireASITConditions");
	}

if (bFireCondFlag == true) {
	logDebug("~~~ Flag is true;
	file CMN;LoadFireASITConditions is available.");
	} else {
	logDebug("~~~ Flag is false;
	file CMN;LoadFireASITConditions is NOT available.");
	}

if (bFireCondFlag == true && publicUser == true) {
	while (valDescr != undefined && iCnt < 21) include("CMN;LoadFireASITConditions");
	}
`^
CRCA;Permitting!Fire!Sprinkler!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
projName = AInfo['PROJECT INFORMATION.Project Name'];
updateShortNotes(projName);
scopeOfWork = AInfo['PROJECT INFORMATION.Location - Area, Floor, Room Name & Room Number'];
newWorkDesModel = aa.cap.capWorkDesModel.getOutput();
newWorkDesModel.setCapID(capId);
newWorkDesModel.setAuditDate(aa.util.now());
newWorkDesModel.setAuditStatus("A");
newWorkDesModel.setAuditID("admin");
newWorkDesModel.setDescription(scopeOfWork);
newWorkDes = aa.cap.createCapWorkDes(newWorkDesModel);
include("CMN;Permitting!Fire!Sprinkler!NA;Fee");
if (publicUser == true) {
	include("EML;Permitting!Fire!~!~;FeeACA");
	}

if (publicUser == true) {
	iCnt = 0;
	valDescr = "";
	bFireCondFlag = false;
	}

logDebug("IMPORTANT; branch script MUST be enabled, or else this script will be caught in infinite loop.");
if (publicUser == true && valDescr != undefined) {
	include("CMN;LoadFireASITConditions");
	}

if (bFireCondFlag == true) {
	logDebug("~~~ Flag is true;
	file CMN;LoadFireASITConditions is available.");
	} else {
	logDebug("~~~ Flag is false;
	file CMN;LoadFireASITConditions is NOT available.");
	}

if (bFireCondFlag == true && publicUser == true) {
	while (valDescr != undefined && iCnt < 21) include("CMN;LoadFireASITConditions");
	}
`^
CRCA;Permitting!Health!POWTS!Holding Tank^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
sanitaryCap = aa.cap.getCapID(AInfo['INSPECTION RESULTS.Sanitary Permit Number']);
if (sanitaryCap.getSuccess()) {
	addParent(AInfo['INSPECTION RESULTS.Sanitary Permit Number']);
	}

if (sanitaryCap.getSuccess()) {
	copyParcels(getParent(), capId);
	include("CMN;GetAPOAddress");
	updateShortNotes(APOAddress);
	}

if (sanitaryCap.getSuccess()) {
	include("CMN;Permitting!Health!POWTS!Holding Tank;UpdateLastServiceDate");
	}

if (getAppSpecific("INSPECTION RESULTS.Problems with Tank(s)") == "No") {
	closeTask("Application Acceptance","Accepted","Task closed by CRCA script","");
	closeTask("Closed","Closed","Task closed by CRCA script","");
	updateAppStatus("Closed","Closed by CRCA script");
	}
`^
CRCA;Permitting!Health!POWTS!TAM^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
var bCloseCAPCond1 = false;
var bCloseCAPCond2 = false;
var bCloseCAPCond3 = false;
var bDoUpdate = false;
var holdID = null;
var bStatusIsCorpCounsel = false;
var bStatusIsSysCompliance = false;
sanitaryCap = aa.cap.getCapID(AInfo['INSPECTION RESULTS.Sanitary Permit Number']);
if (sanitaryCap.getSuccess()) {
	addParent(AInfo['INSPECTION RESULTS.Sanitary Permit Number']);
	}

if (sanitaryCap.getSuccess()) {
	copyParcels(getParent(), capId);
	include("CMN;GetAPOAddress");
	updateShortNotes(APOAddress);
	}

if (getAppSpecific("INSPECTION RESULTS.Amount of Solids in Septic Tank") == "Greater than 1!3 full" && parseInt(getAppSpecific("INSPECTION RESULTS.Gallons Pumped")) < 100) {
	bCloseCAPCond1 = false;
	} else {
	bCloseCAPCond1 = true;
	}

if (getAppSpecific("INSPECTION RESULTS.Problems with Tank(s)") == "Yes") {
	bCloseCAPCond2 = false;
	} else {
	bCloseCAPCond2 = true;
	}

if (getAppSpecific("INSPECTION RESULTS.Liquid Discharge from the System Observed") == "Yes") {
	bCloseCAPCond3 = false;
	} else {
	bCloseCAPCond3 = true;
	}

if (bCloseCAPCond1 && bCloseCAPCond2 && bCloseCAPCond3) {
	bDoUpdate = true;
	closeTask("Application Acceptance","Accepted","Task closed via CRCA script","");
	closeTask("Closed","Closed","Task closed via CRCA script","");
	updateAppStatus("Closed","CAP closed via CRCA script");
	}

parentCapId = getParent();
var intDiff = 0;
if (parentCapId != false && bDoUpdate) {
	var dtTAM = new Date(getAppSpecific("OFFICE USE ONLY.Date TAM Due",parentCapId));
	var dtWork = new Date(AInfo['INSPECTION RESULTS.Date Serviced']);
	var intDiff = Math.ceil(dtTAM.getTime() - dtWork.getTime())!86400000;
	comment(intDiff);
	}

if (parentCapId != false && bDoUpdate) {
	var sMonthWork = (dtWork.getMonth() + 1) + "";
	var sYearWork = (dtWork.getFullYear() + 3) + "";
	var sNewTAMDueWork = sMonthWork + "!1!" + sYearWork;
	}

if (parentCapId != false && bDoUpdate) {
	var sMonthTAM = (dtTAM.getMonth() + 1) + "";
	var sYearTAM = (dtTAM.getFullYear() + 3) + "";
	var sNewTAMDueOldTAM = sMonthTAM + "!1!" + sYearTAM;
	}

if (parentCapId != false) {
	holdID = capId;
	capId = parentCapId;
	}

if (isTaskActive("Operational","PERPOWTS") && isTaskStatus("Operational","Referral to Corp Counsel","PERPOWTS")) {
	bStatusIsCorpCounsel = true;
	}

if (holdID != null) {
	capId = holdID;
	}

if (parentCapId != false && bDoUpdate && (intDiff < -180 || intDiff > 180)) {
	editAppSpecific("OFFICE USE ONLY.Date TAM Due", sNewTAMDueWork, parentCapId);
	updateTask("Operational", "System in Compliance", "Updated via CRCA script", "", "PERPOWTS", parentCapId);
	updateAppStatus("System in Compliance", "", parentCapId);
	bStatusIsSysCompliance = true;
	}

if (parentCapId != false && bDoUpdate && (intDiff >= -180 && intDiff <= 180)) {
	editAppSpecific("OFFICE USE ONLY.Date TAM Due", sNewTAMDueOldTAM, parentCapId);
	updateTask("Operational", "System in Compliance", "Updated via CRCA script", "", "PERPOWTS", parentCapId);
	updateAppStatus("System in Compliance", "", parentCapId);
	bStatusIsSysCompliance = true;
	}

if (bStatusIsCorpCounsel && bStatusIsSysCompliance) {
	include("EML;Permitting!Health!POWTS!TAM;NotifyCorpCounselToCompliance");
	}
`^
CRCA;Permitting!Miscellaneous!Edible Landscape!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (publicUser == true) {
	include("CMN;AddParcelAndOwner");
	}

if (publicUser == true) {
	include("CMN;Permitting!Miscellaneous!Edible Landscape!NA;SetWorkflow");
	}
`^
CRCA;Permitting!Parking!Residential Parking!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (publicUser) {
	include("CMN;SetResParkPermitYear");
	}

if (publicUser) {
	include("CMN;RP3Dist");
	}

if (RefAddrID != null && RefAddrID != "") {
	addParcelAndOwnerFromRefAddress(RefAddrID);
	}
`^
CRCA;Permitting!Parking!Residential Parking!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
cbACA = true;
if (cap.isCreatedByACA() == false) {
	cbACA = false;
	}

proj = aa.cap.getProjectByChildCapID(capId, "Renewal", "Incomplete");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	parentCapId = proj[0].getProjectID();
	aa.cap.updateRenewalCapStatus(parentCapId, capId);
	}

pCap = aa.cap.getCap(parentCapId);
pCapSuccess = pCap.getSuccess();
if (pCapSuccess == true) {
	pCap = pCap.getOutput();
	pCapStatus = pCap.getCapStatus();
	}

if (pCapStatus == "About to Expire") {
	tempCapId = capId;
	capId = parentCapId;
	licEditExpInfo("About to Expire", null);
	capId = tempCapId;
	}

if (pCapStatus == "About to Expire") {
	updateAppStatus("Active" ,"Updated because renewal was completed.", parentCapId);
	}

if (pCapStatus == "Expired") {
	tempCapId = capId;
	capId = parentCapId;
	licEditExpInfo("Inactive", null);
	capId = tempCapId;
	}

if (pCapStatus == "Expired") {
	updateAppStatus("Inactive" ,"Updated because renewal was completed.", parentCapId);
	}

include("CMN;Permitting!Parking!Residential Parking!NA;Fee");
aa.cap.updateAccessByACA(capId, "Y");
if (AInfo['OFFICE USE ONLY.Permit Number Issued'] != null && AInfo['OFFICE USE ONLY.Permit Number Issued'] != "") {
	updateAppStatus("In Process" ,"Updated because a permit number was assigned.", capId);
	} else {
	if (cbACA) updateAppStatus("Online Submittal", "Updated because a permit number was not assigned.", capId);
	if (!cbACA) updateAppStatus("Open", "Updated because a permit number was not assigned.", capId);
	}

if (AInfo['OFFICE USE ONLY.Permit Number Issued'] != null && AInfo['OFFICE USE ONLY.Permit Number Issued'] != "") {
	aa.set.add ("PARKINGISSUANCE",capId);
	}

var dtToday = new Date();
var iMonth = dtToday.getMonth() + 1;
var iYear = dtToday.getFullYear();
if(iMonth > 6) iYear = iYear + 1;
var sPermitYr = iYear + "";
var sExpDate = "8!31!" + sPermitYr;
licEditExpInfo(null,sExpDate);
include("CMN;RP3Dist");
`^
CRCA;Permitting!Parks!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
eventName = "";
if (publicUser && (appMatch("Permitting!Parks!SkiTrail!~") || appMatch("Permitting!Parks!DiscGolf!~")) && AInfo['GENERAL INFORMATION.Permit Type'] == "Daily") {
	closeTask("Application Review", "Application Received","Closed by payment script","");
	closeTask("Issuance","Sent","Closed by payment script","");
	closeTask("Closed","Closed","Closed by submit script","");
	}

if (publicUser && appMatch("Permitting!Parks!DogPark!~") && AInfo['GENERAL INFORMATION.Permit Type'] == "Daily") {
	closeTask("Application Review", "Application Received","Closed by payment script","");
	closeTask("License Check","Valid License");
	closeTask("Issuance","Sent","Closed by payment script","");
	closeTask("Closed","Closed","Closed by submit script","");
	}

if (publicUser && AInfo['GENERAL INFORMATION.Permit Type'] != "Daily") {
	updateAppStatus("Online Submittal","Submitted via Citizen Access");
	}

if (cmnSubType != "DiscGolf" && cmnSubType != "DogPark" && cmnSubType != "Lake Access" && cmnSubType != "SkiTrail") {
	eventName = getAppSpecific("EVENT INFORMATION.Name of Event");
	}

if (eventName != null && eventName != "") {
	updateShortNotes(eventName);
	}

if (publicUser && appMatch("Permitting!Parks!Lake Access Daily!NA")  && AInfo['GENERAL INFORMATION.Permit Type'] != "Daily") {
	closeTask("Active","Closed","Closed by submit script","");
	closeTask("Done","Closed","Closed by submit script","");
	}

if (currentUserID == "ITJBS") {
	showDebug = true;
	}
`^
CRCA;Permitting!Parks!Block Party!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
reportName = aa.util.newHashtable();
var repParams = aa.util.newHashtable();
reportModule = "Permitting";
var params  = aa.util.newHashtable();
getRecordParams4Notification(params);
ca = getContactArray();
getContactParams4Notification(params, ca[0]);
contactEmail = ca[0]["email"];
getACARecordParam4Notification(params, madisonACAUrl, "Base");
sendNotification("elamsupport@cityofmadison.com", "jgoltz@cityofmadison.com" , "", "PARKSSUBMITTED", params, reportName, repParams, reportModule);
`^
CRCA;Permitting!Parks!Electrical Amplification!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;Permitting!Parks!~!~;CreateContactfromASI");
`^
CRCA;Permitting!Parks!Farmers Market Electric!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;Permitting!Parks!~!~;CreateContactfromASI");
`^
CRCA;Permitting!Parks!Street Use!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
reportName = aa.util.newHashtable();
var repParams = aa.util.newHashtable();
reportModule = "Permitting";
var params  = aa.util.newHashtable();
getRecordParams4Notification(params);
ca = getContactArray();
getContactParams4Notification(params, ca[0]);
contactEmail = ca[0]["email"];
getACARecordParam4Notification(params, madisonACAUrl, "Base");
sendNotification("madisonevents@cityofmadison.com", "elamsupport@cityofmadison.com", "jgoltz@cityofmadison.com", "PARKSSUBMITTED", params, reportName, repParams, reportModule);
`^
CRCA;Permitting!Traffic Engineering!Bicycle Registration!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
cbACA = true;
if (cap.isCreatedByACA() == false) {
	cbACA = false;
	}

if (cbACA == true) {
	editAppSpecific("DECAL INFORMATION.Vendor ID", "0400");
	}

if (cbACA == true) {
	include("CMN;Permitting!Traffic Engineering!Bicycle Registration!NA;ASIToCAPDetail");
	}

if (cbACA == true) {
	include("EML;Permitting!Traffic Engineering!Bicycle Registration!~;Submitted");
	}
`^
CRCA;Permitting!Traffic Engineering!Bicycle Registration!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
cbACA = true;
if (cap.isCreatedByACA() == false) {
	cbACA = false;
	}

if (cbACA == false) {
	proj = aa.cap.getProjectByChildCapID(capId, "Renewal", "Incomplete");
	projSuccess = proj.getSuccess();
	}

if (cbACA == false && projSuccess == true) {
	proj = proj.getOutput();
	parentCapId = proj[0].getProjectID();
	aa.cap.updateRenewalCapStatus(parentCapId, capId);
	}

if (cbACA == false) {
	proj1 = aa.cap.getProjectByChildCapID(capId, "Renewal", "Review");
	projSuccess1 = proj1.getSuccess();
	}

if (cbACA == false && projSuccess1 == true) {
	proj1 = proj1.getOutput();
	parentCapId = proj1[0].getProjectID();
	}

if (cbACA == false && projSuccess1 == true) {
	aa.cap.updateAccessByACA(capId, "N");
	}

if (cbACA == false && projSuccess1 == true) {
	closeTask("Intake", "Submitted", "This task was automatically closed because it was not needed.", "", "LICHDV");
	}

if (cbACA == false && projSuccess1 == true) {
	closeTask("Closed", "Closed", "This task was automatically closed because it was not needed.", "", "LICHDV");
	}

if (cbACA == false && projSuccess1 == true) {
	updateAppStatus("Complete", "Renewal Complete", capId);
	}

if (cbACA == false && projSuccess1 == true) {
	include("CMN;Permitting!Traffic Engineering!Bicycle Registration!Renewal;Fee");
	}

bicycleDecal = getAppSpecific("DECAL INFORMATION.Decal Number");
bicycleSerial = getAppSpecific("BICYCLE INFORMATION.Serial Number");
if (cbACA == false && projSuccess1 == true) {
	updateShortNotes(bicycleDecal);
	editAppName(bicycleSerial);
	}

if (currentUserGroup == "Traffic Bicycle") {
	aa.set.add("BIKEREGRENEWTE",capId);
	} else {
	aa.set.add("BIKEREGRENEWAL",capId);
	}

if (cbACA == true) {
	include("EML;Permitting!Traffic Engineering!Bicycle Registration!~;Submitted");
	}
`^
CRCA;Permitting!Vending!Banner!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("EML;Permitting!Vending!Banner!NA;CRCAAppSubmitted");
`^
CRCA;Permitting!Vending!TEM!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("EML;Permitting!Vending!TEM!NA;CRCAAppSubmitted");
`^
CRCA;Postings!Civil Rights!Job Posting Form!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (publicUser) {
	include("CMN;Postings!Civil Rights!Job Posting Form!NA;UpdateShortNotes");
	}
`^
CRCB;Licenses!Treasurer!Cat Registration!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
neighbor = "City of Madison";
refAddr = aa.address.getRefAddressByPK(AddressValidatedNumber);
if (!publicUser && refAddr.getSuccess()) {
	refAdd = refAddr.getOutput();
	neighbor = refAdd.getNeighborhood();
	}

if (!publicUser && neighbor != "City of Madison") {
	cancel = true;
	showMessage = true;
	comment("The address you selected is not within the City of Madison.  It is not necessary for you to obtain a Pet License for the City of Madison.");
	}

callType = "ASBCRCB";
include("CMN;Licenses!Treasurer!~!~;DuplicateLicCheck");
`^
CRCB;Licenses!Treasurer!Chicken Owner!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
neighbor = "City of Madison";
disclaimercount = 0;
if (AInfo['I am the owner and resident of this address'] == "No") {
	disclaimercount =+ 1;
	}

if (AInfo['I do not own the premises and have notified the owner'] == "No") {
	disclaimercount =+ 1;
	}

if (AInfo['I do not own the premises and have notified all occupants'] == "No") {
	disclaimercount =+ 1;
	}

if (AInfo['I have read, understand, and agree to abide by the conditions specified on the previous page'] == "No") {
	disclaimercount =+ 1;
	}

if (AInfo['I understand the Zoning Administrator may revoke this license as specified on the previous page'] == "No") {
	disclaimercount =+ 1;
	}

refAddr = aa.address.getRefAddressByPK(AddressValidatedNumber);
if (!publicUser && refAddr.getSuccess()) {
	refAdd = refAddr.getOutput();
	neighbor = refAdd.getNeighborhood();
	}

if (!publicUser && neighbor != "City of Madison") {
	cancel = true;
	showMessage = true;
	comment("The address you selected is not within the City of Madison.  It is not necessary for you to obtain a Pet License for the City of Madison.");
	}

callType = "ASBCRCB";
include("CMN;Licenses!Treasurer!~!~;DuplicateLicCheck");
`^
CRCB;Licenses!Treasurer!Dog Registration!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
neighbor = "City of Madison";
refAddr = aa.address.getRefAddressByPK(AddressValidatedNumber);
if (!publicUser && refAddr.getSuccess()) {
	refAdd = refAddr.getOutput();
	neighbor = refAdd.getNeighborhood();
	}

if (!publicUser && neighbor != "City of Madison") {
	cancel = true;
	showMessage = true;
	comment("The address you selected is not within the City of Madison.  It is not necessary for you to obtain a Pet License for the City of Madison.");
	}

callType = "ASBCRCB";
include("CMN;Licenses!Treasurer!~!~;DuplicateLicCheck");
`^
CRCB;Licenses!Treasurer!Kennel!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
refAddr = aa.address.getRefAddressByPK(AddressValidatedNumber);
if (publicUser == false && refAddr.getSuccess()) {
	refAdd = refAddr.getOutput();
	neighbor = refAdd.getNeighborhood();
	}

if (publicUser == false && neighbor != "City of Madison") {
	cancel = true;
	showMessage = true;
	comment("The address you selected is not within the City of Madison.  It is not necessary for you to obtain a Pet License for the City of Madison.");
	}
`^
CRCB;Permitting!Traffic Engineering!Bicycle Registration!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (publicUser == false) {
	callType = "ASBCRCB";
	include("CMN;Permitting!Traffic Engineering!Bicycle Registration!~DcalDuplicateCheck");
	}
`^
CreateChileTrafficElectricalWO^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
createElec = false;
createSign = false;
if (capId) {
	docList = aa.document.getCapDocumentList(capId, currentUserID);
	}

if (docList.getSuccess()) {
	DocList = docList.getOutput();
	}

if (docList.getSuccess()) {
	for(doc in DocList) if(DocList[doc].docCategory == "Electrical WO Diagram") createElec = true;
	}

if (docList.getSuccess()) {
	for(doc in DocList) if(DocList[doc].docCategory == "Sign WO Diagram") createSign = true;
	}

if (createElec == true) {
	type = "elec";
	include("CMN;CreateChildTEWO");
	}

if (createSign == true) {
	type = "sign";
	include("CMN;CreateChildTEWO");
	}

if (docList.getSuccess()) {
	for(doc in DocList) if(DocList[doc].docCategory == "Electrical WO Diagram" || DocList[doc].docCategory == "Sign WO Diagram") aa.document.removeDocumentByPK(DocList[doc].entityPK.entitySeq1,"","","ServiceRequest");
	}
`^
DocumentDeleteBefore^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("DDB;" + cmnGroup + "!~!~!~");
include("DDB;" + cmnGroup + "!" + cmnType + "!~!~");
include("DDB;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("DDB;" + appTypeString);
`^
DocumentReviewAddAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("DRAA;" + cmnGroup + "!~!~!~");
include("DRAA;" + cmnGroup + "!" + cmnType + "!~!~");
include("DRAA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("DRAA;" + appTypeString);
`^
DocumentReviewAddBefore^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("DRAB;" + cmnGroup + "!~!~!~");
include("DRAB;" + cmnGroup + "!" + cmnType + "!~!~");
include("DRAB;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("DRAB;" + appTypeString);
`^
DocumentReviewDeleteAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("DRDA;" + cmnGroup + "!~!~!~");
include("DRDA;" + cmnGroup + "!" + cmnType + "!~!~");
include("DRDA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("DRDA;" + appTypeString);
`^
DocumentReviewDeleteBefore^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("DRDB;" + cmnGroup + "!~!~!~");
include("DRDB;" + cmnGroup + "!" + cmnType + "!~!~");
include("DRDB;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("DRDB;" + appTypeString);
`^
DocumentReviewUpdateAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("DRUA;" + cmnGroup + "!~!~!~");
include("DRUA;" + cmnGroup + "!" + cmnType + "!~!~");
include("DRUA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("DRUA;" + appTypeString);
`^
DocumentReviewUpdateBefore^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("DRUB;" + cmnGroup + "!~!~!~");
include("DRUB;" + cmnGroup + "!" + cmnType + "!~!~");
include("DRUB;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("DRUB;" + appTypeString);
`^
DocumentUpdateAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("DUDA;" + cmnGroup + "!~!~!~");
include("DUDA;" + cmnGroup + "!" + cmnType + "!~!~");
include("DUDA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("DUDA;" + appTypeString);
`^
DocumentUpdateBefore^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("DUDB;" + cmnGroup + "!~!~!~");
include("DUDB;" + cmnGroup + "!" + cmnType + "!~!~");
include("DUDB;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("DUDB;" + appTypeString);
`^
DocumentUploadAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("DUA;" + cmnGroup + "!~!~!~");
include("DUA;" + cmnGroup + "!" + cmnType + "!~!~");
include("DUA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("DUA;" + appTypeString);
`^
DocumentUploadBefore^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("DUB;" + cmnGroup + "!~!~!~");
include("DUB;" + cmnGroup + "!" + cmnType + "!~!~");
include("DUB;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("DUB;" + appTypeString);
`^
DUA;Land!~!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
workflowGroups = null;
childTasks = null;
pDueDate = null;
typeReviewVerif = "None";
callType = "DUA";
docExists = false;
cDueDate = "";
if (isTaskActive("LM Agency Review")) {
	typeReviewVerif = "Review";
	}

docGroupArray = new Array("LANDUSE");
if (!documentModelArray.isEmpty()) {
	docArray = documentModelArray.toArray();
	}

if (!documentModelArray.isEmpty()) {
	for (doc in docArray) include("CMN;Land!~!~!~;DetermineDocumentEmail");
	}

if (docExists && isTaskActive("LM Agency Review")) {
	workflowGroups =  aa.workflow.getProcessRelationByCapID(capId, null).getOutput();
	}

if (workflowGroups != null) {
	if (workflowGroups[0].getParentProcessID() == 0) wfProcessID = workflowGroups[0].getProcessID();
	}

if (workflowGroups != null) {
	if (workflowGroups[0].getParentProcessID() != 0) wfProcessID = workflowGroups[0].getParentProcessID();
	}

if (workflowGroups != null) {
	for (wfg in workflowGroups) include("CMN;SendLandNotificationsAndSetDueDate");
	}

if (cmnType == "Land Use") {
	include("EML;Land!~!~!;NotifyAssignedTo");
	}
`^
DUA;Licenses!Clerk!ClassABeerLiquor!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (documentModelArray != null) {
	var docAry = documentModelArray.toArray();
	}

if (docAry) {
	for (doc in docAry) if (docAry[doc].getDocCategory() == "Audited Liquor License Renewal Paperwork") include("CMN;UpdateAuditStatus");
	}

if (docAry) {
	for (doc in docAry) if (docAry[doc].getDocCategory() == "Liquor License Renewal Paperwork - Returned not Audited") updateAppStatus("Renewal Paperwork Returned", "Set by renewal paperwork document type upload script");
	}
`^
DUA;Licenses!Clerk!ClassBBeerLiquor!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (documentModelArray != null) {
	var docAry = documentModelArray.toArray();
	}

if (docAry) {
	for (doc in docAry) if (docAry[doc].getDocCategory() == "Audited Liquor License Renewal Paperwork") include("CMN;UpdateAuditStatus");
	}

if (docAry) {
	for (doc in docAry) if (docAry[doc].getDocCategory() == "Liquor License Renewal Paperwork - Returned not Audited") updateAppStatus("Renewal Paperwork Returned", "Set by renewal paperwork document type upload script");
	}
`^
DUA;Permitting!Engineering!ROW!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
curDate = new Date();
audit = new Date();
strFileName = "<br>";
isOnlyAsBuiltSketch = "";
aa.sendEmail("noreply@cityofmadisonDEV.com", "poleary@cityofmadison.com;
mwalizada@cityofmadison.com", "", "Report Test DUA", "testing", "");
`^
DUA;ServiceRequest!Engineering - Facility!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (currentUserID != "ENKMS") {
	callType = "DUA";
	include("EML;ServiceRequestReceived!Engineering!Facility!~;Update");
	}
`^
DUA;ServiceRequest!Information Technology!Accela Change Request!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
if (!documentModelArray.isEmpty()) {
	doci = documentModelArray.iterator();
	currDoc = doci.next();
	!!debugObject(doci.next());
	}

taskItemModel = aa.document.getCapTaskByCapID(capId).getOutput();
taski = taskItemModel.iterator();
currTask = taski.next();
debugObject(currTask);
`^
DUB;Licenses!Vending!MerchantVendor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
`^
DUB;Permitting!Engineering!ROW!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
aa.sendEmail("noreply@cityofmadisonDEV.com", "poleary@cityofmadison.com", "", "Report Test", "testing", "");
`^
email_template_test^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
contactTypes = new Array("Applicant");
notificationTemplate = "JASON_TEST_TEMPLATE";
iCon = null;
contactArray = new Array();
parameters = aa.util.newHashMap();
report = null;
contactArray = getContactArray();
parameters.put("serviceProviderCode","MADISON");
parameters.put("AltID", capIDString);
report = generateReport("Business License",parameters,"Licenses");
if (report) {
	for (iCon in contactArray) if (exists(contactArray[iCon]["contactType"],contactTypes)) include("email_template_test_loop");
	}
`^
email_template_test_loop^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
params = aa.util.newHashtable();
acaUrl = "https;!!elam73dev.cityofmadison.com!CitizenAccess";
tContact =contactArray[iCon];
getRecordParams4Notification(params);
getACARecordParam4Notification(params,acaUrl);
getContactParams4Notification(params,tContact);
aa.print("ContactName; " + tContact["firstName"] + " " + tContact["lastName"]);
getPrimaryAddressLineParam4Notification(params);
if (!matches(tContact["email"],null,"",undefined)) {
	sendNotification("elamsupport@cityofmadison.com",tContact["email"],"",notificationTemplate ,params,new Array(report));
	}
`^
EML;AddressInformation^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var pq = hasPrimaryAddressInCap(capId);
if (pq == true) {
	ap = aa.address.getPrimaryAddressByCapID(capId,"Y").getOutput();
	ad = [ap];
	}

if (pq != true) {
	ad = aa.address.getAddressByCapId(capId).getOutput();
	}

emailText += "<b>Address<!b>  ";
if (ad[0] != null && ad[0].getHouseNumberStart() != null) {
	emailText += ad[0].getHouseNumberStart();
	}

if (ad[0] != null && ad[0].getStreetDirection() != null) {
	emailText += " " + ad[0].getStreetDirection();
	}

if (ad[0] != null && ad[0].getStreetName() != null) {
	emailText += " " + ad[0].getStreetName();
	}

if (ad[0] != null && ad[0].getStreetSuffix() != null) {
	emailText += " " + ad[0].getStreetSuffix();
	}

if (ad[0] != null && ad[0].getUnitStart() != null) {
	emailText += "<br> 
	 
	 
	 
	 
	 
	 
	 
	 
	 
	 
	 
	 
	 
	 
	" + ad[0].getUnitStart();
	}

if (ad[0] != null && ad[0].getCity() != null) {
	emailText += "<br> 
	 
	 
	 
	 
	 
	 
	 
	 
	 
	 
	 
	 
	 
	 
	" + ad[0].getCity();
	}

if (ad[0] != null && ad[0].getState() != null) {
	emailText += " " + ad[0].getState();
	}

if (ad[0] != null && ad[0].getZip() != null) {
	emailText += " " + ad[0].getZip();
	}

emailText += "<br><br>";
`^
EML;AddressLine^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
ad = aa.address.getAddressByCapId(capId).getOutput();
if (ad[0].getHouseNumberStart() != null) {
	emailSubject += ad[0].getHouseNumberStart();
	}

if (ad[0].getStreetDirection() != null) {
	emailSubject += " " + ad[0].getStreetDirection();
	}

if (ad[0].getStreetName() != null) {
	emailSubject += " " + ad[0].getStreetName();
	}

if (ad[0].getStreetSuffix() != null) {
	emailSubject += " " + ad[0].getStreetSuffix();
	}

if (ad[0].getUnitStart() != null) {
	emailSubject += " " + ad[0].getUnitStart();
	}
`^
EML;AMS!Engineering Facility Maint!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
currentStatus = "";
createdByUserId = currentUserID;
ccUser = "";
facility = "";
include("EML;ApplicantInformation");
emailText = "<a href=" + "" + "https;!!avdev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=AMS&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capId.getCustomID() + "<!a><br>";
parentCapID = getParent();
facility = getAppSpecific("SR - ENGINEERING MAINTENANCE.Facility", parentCapID);
if (facility != "") {
	emailText += "<p><b>Facility; <!b>" + facility;
	}

emailText += "<p><b>Description;<!b>" + workDescGet(capId) + "<!p>";
if (vEventName == "WorkflowTaskUpdateAfter" && wfComment != null) {
	emailText += "<p><b>Task Comments;<!b>" + wfComment + "<!p>";
	}

if (vEventName == "WorkflowTaskUpdateAfter") {
	currentStatus = wfStatus;
	}

if (vEventName == "ApplicationStatusUpdateAfter" && statusComment != null) {
	emailText += "<p><b>Task Comments;<!b>" + statusComment + "<!p>";
	}

if (vEventName == "ApplicationStatusUpdateAfter") {
	currentStatus = appStatus;
	}

if (vEventName == "ApplicationSpecificInfoUpdateAfter") {
	emailText += "<p><b>Comments;<!b>" + getAppSpecific("WORK ORDER INFO.Comments") + "<!p>";
	}

if (vEventName == "ApplicationSpecificInfoUpdateAfter") {
	currentStatus = getAppSpecific("WORK ORDER INFO.Status");
	}

emailSubject =  "Work Order# " + capIDString + " "+ currentStatus;
if (currentStatus == "Additional Info Required") {
	var user = aa.person.getUser("ENKMS");
	user = user.getOutput();
	userEmail= user.getEmail();
	} else {
	include("CMN;GetParentRecordSubmitter");
	var user = aa.person.getUser(createdByUserId);
	user = user.getOutput();
	userEmail= user.getEmail();
	var user = aa.person.getUser("ENKMS");
	user = user.getOutput();
	ccUser= user.getEmail();
	}

if (currentStatus == "Additional Info Required" || currentStatus == "Completed" || currentStatus == "On Hold") {
	sendAsyncEmail("noreply@cityofmadison.com", userEmail, ccUser,  emailSubject, emailText, "elamsupport@cityofmadison.com");
	}
`^
EML;AMS!Engineering Facility Maint!InfoReceived^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
cd=aa.cap.getCapDetail(capId).getOutput().getCapDetailModel();
var user = aa.person.getUser(cd.getAsgnStaff());
user = user.getOutput();
userEmail= user.getEmail();
logDebug("userEmail is;"+userEmail);
emailSubject =  "Work Order# " + capIDString + " Updated with additional information";
emailText = capId.getCustomID() + "<br>";
emailText += "<p><b>Description;<!b>" + workDescGet(capId) + "<!p>";
var strName = "";
AssetList = aa.asset.getAssetListByWorkOrder(capId,null);
if (AssetList.getSuccess()) {
	AssetList = AssetList.getOutput();
	for (x in AssetList) strName = strName + (AssetList[x].assetMasterModel["g1AssetID"]) + ", ";
	emailText += "<b>Facility;<!b>" + strName;
	}

emailText += "<br><b>Additional Information;<!b> "+ wfComment;
updateWorkDesc("Additional Info; "+  wfComment + "\n" + workDescGet(capId));
email(userEmail, "noreply@cityofmadison.com", emailSubject, emailText);
`^
EML;AMS!Engineering Facility Maint!Invoice^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (getAppSpecific("WORK ORDER INFO.Billable") != null && getAppSpecific("WORK ORDER INFO.Billable") == "Yes") {
	reportName= "Facility Maint Invoice";
	reportViewAttachEmail(false,true,reportName,"noreply@cityofmadison.com","elamsupport@cityofmadison.com","","Facility Maintenance Invoice for Work Order; "+capIDString,"Facility Maintenance Invoice attached for work order; "+capIDString ,false, "");
	}
`^
EML;AMS!Engineering Storm!Mowing!Weeds;AddlInfoRequested^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
ccEmail = "";
emailText = "";
contactEmail = "";
emailSubject = "Engineering Mowing Weeds " + capIDString + " - Additional Information Requested";
emailText = "<html><body>";
emailText += "<p>Please respond to the following;<!p>";
if (statusComment != "") {
	emailText += statusComment;
	}

emailText += "<p><b>Work Order<!b> <a href=" + "" + "https;!!av.cityofmadison.com!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=AMS&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a><br><br>";
emailText += "<p>For Additional Information please log into Accela<!p>";
emailText += "<!body><!html>";
ccEmail = "rsjachrani@cityofmadison.com";
contactEmail = "rsjachrani@cityofmadison.com";
if (contactEmail != "") {
	aa.sendEmail("noreply@cityofmadison.com", contactEmail, ccEmail, emailSubject, emailText, "");
	logDebug("End");
	}
`^
EML;AMS!Engineering Storm!Mowing!Weeds;Submitted^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
ccEmail = "";
emailText = "";
contactEmail = "";
emailSubject = "Engineering Mowing Weeds WO Created " + capIDString;
emailText = "<html><body>";
emailText += "<p>A new Spot Mowing Work Order has been created;<!p><p>" + strName.substring(0, 200) + "<!p>";
emailText += "" + workDescGet(capId);
emailText += "<p><b>Work Order<!b> <a href=" + "" + "https;!!av.cityofmadison.com!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=AMS&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a><br><br>";
emailText += "<p>For Additional Information please log into Accela<!p>";
emailText += "<!body><!html>";
ccEmail = "rsjachrani@cityofmadison.com";
contactEmail = "rsjachrani@cityofmadison.com";
if (contactEmail != "") {
	aa.sendEmail("noreply@cityofmadison.com", contactEmail, ccEmail, emailSubject, emailText, "");
	}
`^
EML;AMS!Facility Work Order!~!~;RecordAssigned^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
docList = null;
DocList = null;
emailSubject =  "Work Order# " + capId.getCustomID() + " assigned to you";
emailText = capId.getCustomID() + "<br>";
emailText += "<p><b>Description;<!b> 
" + workDescGet(capId) + "<!p>";
var strName = "";
AssetList = aa.asset.getAssetListByWorkOrder(capId,null);
if (AssetList.getSuccess()) {
	AssetList = AssetList.getOutput();
	}

if (AssetList) {
	for (x in AssetList) emailText += "<b>Building or Building Asset;<!b> "+ AssetList[x].getAssetMasterModel().g1Description + "<BR>";
	}

ca = getContactArray();
if (ca != undefined && ca != null) {
	for (eachRecord in ca) emailText += "<br><b>Request Submitter;<!b> " + ca[eachRecord]["firstName"] + " " + ca[eachRecord]["lastName"];
	}

if (typeof(holdId) != "undefined" && capId) {
	docList = aa.document.getCapDocumentList(holdId, currentUserID);
	}

if (docList != null && docList.getSuccess()) {
	DocList = docList.getOutput();
	emailText += "<p><b>Attached Documents;<!b> ";
	}

if (DocList != null && docList.getSuccess()) {
	for(doc in DocList) emailText += "<br>"+DocList[doc].docName;
	}

cd=aa.cap.getCapDetail(capId).getOutput().getCapDetailModel();
var user = aa.person.getUser(cd.getAsgnStaff());
user = user.getOutput();
userEmail= user.getEmail();
logDebug("userEmail is;"+userEmail);
sendAsyncEmail("noreply@cityofmadison.com", userEmail, "elamsupport@cityofmadison.com", emailSubject, emailText, "");
`^
EML;AMS!Facility Work Order!~!~;RecordAssignedGroup^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emailSubject =  "Work Order# " + capId.getCustomID() + " assigned to your territory";
emailText = capId.getCustomID() + "<br>";
emailText += "<p><b>Description;<!b>" + workDescGet(capId) + "<!p>";
var strName = "";
AssetList = aa.asset.getAssetListByWorkOrder(capId,null);
if (AssetList.getSuccess()) {
	AssetList = AssetList.getOutput();
	}

if (AssetList) {
	for (x in AssetList) emailText += "<b>Building or Building Asset;<!b> "+ AssetList[x].getAssetMasterModel().g1Description + "<BR>";
	}

ca = getContactArray();
if (ca != undefined && ca != null) {
	for (eachRecord in ca) emailText += "<br><b>Request Submitter;<!b> " + ca[eachRecord]["firstName"] + " " + ca[eachRecord]["lastName"];
	}

if (capId) {
	docList = aa.document.getCapDocumentList(holdId, currentUserID);
	}

if (docList.getSuccess()) {
	DocList = docList.getOutput();
	emailText += "<p><b>Attached Documents;<!b> ";
	}

if (docList.getSuccess()) {
	for(doc in DocList) emailText += "<br>"+DocList[doc].docName;
	}

email(userEmail, "noreply@cityofmadison.com", emailSubject, emailText);
`^
EML;ApplicantInformation^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
ca = getContactArray();
emailText = "<b>General Information<!b><br><br>  ";
if (ca[0]) {
	emailText += "Name; 	" + ca[0]["firstName"] + " " + ca[0]["lastName"] + "<br>";
	}

if (ca[0]) {
	emailText += "Address; 	" + ca[0]["addressLine1"] + ", " + ca[0]["city"] + " " + ca[0]["state"] + " " + ca[0]["zip"] + "<br>";
	}

if (ca[0]) {
	emailText += "Phone; 	" + ca[0]["phone1"] + "<br>";
	}

if (ca[0]) {
	emailText += "email; 	" + ca[0]["email"] + "<br>";
	}

if (ca[0]) {
	emailText += "Date; 	" + fileDate + "<br><br>";
	}
`^
EML;AssignInspector^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emailText = "<html><body><p>Notice of Permit Issuance in your Inspection District <!p>";
emailSubject = "Permit Assigned; ";
include("EML;AddressLine");
emailSubject += " " + capIDString;
emailText += "<b>Category<!b> " + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
emailText += "<b>CAP<!b> <a href=" + "" + "https;!!av73dev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=Permitting&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a><br><br>";
emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
include("EML;AddressInformation");
AInfo.sort();
for (loopInfo in AInfo) if (AInfo[loopInfo] != null && loopInfo.indexOf("ParcelAttribute") < 0 && AInfo[loopInfo] != "") emailText += loopInfo + "; " + AInfo[loopInfo] + "<br>";
emailText += "<p>For Additional Information please log into Accela<!p>";
include("EML;GetUserIdEmail");
if (userEmail != undefined) {
	email(userEmail,"noreply@cityofmadisonDEV.com",emailSubject,emailText);
	}
`^
EML;AssignInspectorNoASI^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emailText = "<html><body><p>Notice of CAP in your Inspection District <!p>";
emailSubject = "CAP Assigned; ";
include("EML;AddressLine");
emailSubject += " " + capIDString;
emailText += "<b>Category<!b> " + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
emailText += "<b>CAP<!b> <a href=" + "" + "https;!!av73dev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=Permitting&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capId.getCustomID() + "<!a><br><br>";
if (workDescGet(capId)) {
	emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
	}

include("EML;AddressInformation");
emailText += "<p>For Additional Information please log into Accela<!p>";
include("EML;GetUserIdEmail");
logDebug("Email will be sent to userID = " + userEmail);
if (userEmail != undefined) {
	email(userEmail,"noreply@cityofmadisonDEV.com",emailSubject,emailText);
	}

if (userEmail != undefined) {
	email("rsjachrani@cityofmadison.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
	}
`^
EML;CAPITOLFIREDISTRICT^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emailText = "<html><body><p>Notice of Permit Application on a Address in the Capitol Fire District <!p>";
emailSubject = "Capitol Fire District Notification " + capIDString + " - Permit App Submitted";
emailText += "<b>Category<!b> " + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
emailText += "<b>CAP<!b> <a href=" + "" + "https;!!av73dev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=Permitting&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a><br><br>";
emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
include("EML;AddressInformation");
emailText += "<p>For Additional Information please log into Accela<!p>";
email("rsjachrani@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
email("aharper@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
email("mvanerem@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
`^
EML;CityLicensesAgencyNotification^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
email("noreply@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","BI Notification; "+emailSubject,emailText);
email("noreply@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Zoning Notification; "+emailSubject,emailText);
email("mwalizada@cityofmadison.com","noreply@cityofmadisonDEV.com","MFD Notification; "+emailSubject,emailText);
`^
EML;ENCertOccupancyNotice^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var emailSubject = "Certificate of Occupancy Notice for " + capIDString;
emailText = "<html><body><p>A Certificate of Occupancy has been issued.<!p>";
emailText += "<p><b>Category;<!b> 
" + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<!p>";
emailText += "<p><b>Description;<!b> 
" + workDescGet(capId) + "<!p>";
emailText += "<p><b>Permit #;<!b> 
<a href=" + "" + "https;!!avdev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=tabSummary&isRedirect=false&module=" + cmnGroup + "&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a><!p>";
hp = hasPrimaryAddressInCap(capId);
include("EML;AddressInformation");
emailText += "<p>For additional information, please log into Accela.<!p>";
emailText += "<!body><!html>";
email("cehagen@cityofmadison.com","noreply@cityofmadison.com",emailSubject,emailText);
`^
EML;ENFooting^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emailText = "<html><body><p>Footing Inspection " + inspResult + " by " + currentUserID + "<!p>";
emailSubject = "Footing Inspection Notice " + capIDString + " ";
emailText += "<b>Category<!b> " + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
emailText += "<b>CAP<!b> <a href=" + "" + "https;!!av73dev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=" + cmnGroup + "&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a><br><br>";
include("EML;AddressInformation");
emailText += "<p>For Additional Information please log into Accela<!p>";
email("lZenchenko@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
email("rsjachrani@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
`^
EML;Enforcement!Health!Complaint!~;NotifySanitarian^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
reportName = "Complaint Report";
capModule = "Enforcement";
var cd = aa.cap.getCapDetail(capId).getOutput().getCapDetailModel();
if (cd != null) {
	userId = cd.getAsgnStaff();
	logDebug("User ID = " + userId);
	}

if (userId != "" && userId != null) {
	logDebug("User ID = " + userId);
	var deptId = getDepartmentName(userId);
	logDebug("Department = " + deptId);
	}

if (userId != "" && userId != null) {
	include("EML;GetUserIdEmail");
	logDebug("Send to Email = " + userEmail);
	}

include("CMN;Store_Report_To_Disk");
emailSubject = "Enforcement!Health!Complaint Notification - " + capIDString;
emailText = "<html><body><p>This is an Accela auto-notification email letting you know that you have been assigned to investigate health complaint " + capIDString + ".<!p>";
emailText += "<p>Workflow comments from task = Intake, status = Pending Investigation ; " + wfComment + "<!p>";
aa.sendEmail("noreply@cityofmadisonDEV.com", "jgoltz@cityofmadisonDEV.com", "glabelle-brown@cityofmadisonDEV.com",  emailSubject, emailText, reportFile);
`^
EML;FoodDrink;Land;Zoning^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
reportFile = "";
cName = "Undefined CAP";
include("CMN;Licenses!Zoning!AppType");
ad = aa.address.getAddressByCapId(capId).getOutput();
owner = aa.owner.getOwnerByCapId(capId).getOutput();
if ((owner[0] != null && owner[0].toString().length() > 0)) {
	ownerName = owner[0].getOwnerFullName();
	}

emailSubject = cName + " License; " + capIDString;
emailText = "<html><body><p>" + cName + " License; " + capIDString + " needs your review.<!p>";
if ((owner[0] != null && owner[0].toString().length() > 0)) {
	emailText += "<p>Owner Name; " + ownerName + "<!p>";
	}

if ((ad[0] != null && ad[0].toString().length() > 0)) {
	emailText += "<p>Business Location; " + ad[0] + "<!p><!body><!html>";
	}

aa.sendEmail("noreply@cityofmadisonDEV.com", "mtucker@cityofmadisonDEV.com", "panderson@cityofmadisonDEV.com",  emailSubject, emailText, reportFile);
`^
EML;GetAddressLine^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
emailText += ad[eachRecord]  + "<br>";
`^
EML;GetContactEmail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "notmail@cityofmadisondev.com";
ca = getContactArray();
contactFName = "firstName";
contactLName = "lastName";
businessName = "businessName";
for (eachRecord in ca) include("EML;GetContactInfo");
`^
EML;GetContactEmail_Banner^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "nomail@cityofmadisonDEV.com";
ca = getContactArray();
contactFName = "firstName";
contactLName = "lastName";
businessName = "businessName";
for (eachRecord in ca) include("EML;GetContactInfo_Banner");
`^
EML;GetContactInfo^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (ca[eachRecord]["contactType"] == "Applicant") {
	contactEmail = ca[eachRecord]["email"];
	contactFName = ca[eachRecord]["firstName"];
	contactLName = ca[eachRecord]["lastName"];
	businessName = ca[eachRecord]["businessName"];
	}

if (ca[eachRecord]["contactType"] == "Company") {
	contactEmail = ca[eachRecord]["email"];
	contactFName = ca[eachRecord]["firstName"];
	contactLName = ca[eachRecord]["lastName"];
	businessName = ca[eachRecord]["businessName"];
	}

if (ca[eachRecord]["contactType"] == "License Holder") {
	contactEmail = ca[eachRecord]["email"];
	contactFName = ca[eachRecord]["firstName"];
	contactLName = ca[eachRecord]["lastName"];
	businessName = ca[eachRecord]["businessName"];
	}

if (ca[eachRecord]["contactType"] == "Applicant or Contact") {
	contactEmail = ca[eachRecord]["email"];
	contactFName = ca[eachRecord]["firstName"];
	contactLName = ca[eachRecord]["lastName"];
	businessName = ca[eachRecord]["businessName"];
	}

if (ca[eachRecord]["contactType"] == "Applicant or Organization") {
	contactEmail = ca[eachRecord]["email"];
	contactFName = ca[eachRecord]["firstName"];
	contactLName = ca[eachRecord]["lastName"];
	businessName = ca[eachRecord]["businessName"];
	}
`^
EML;GetContactInfo_Banner^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (ca[eachRecord]["contactType"] == "Organization") {
	contactEmail = ca[eachRecord]["email"];
	contactFName = ca[eachRecord]["firstName"];
	contactLName = ca[eachRecord]["lastName"];
	businessName = ca[eachRecord]["businessName"];
	}
`^
EML;GetContactInfoNewLicense^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (ca[eachRecord]["contactType"] == "Applicant") {
	contactFName = ca[eachRecord]["firstName"];
	contactLName = ca[eachRecord]["lastName"];
	contactPhone1 = ca[eachRecord]["phone1"];
	bizContactEmail =  ca[eachRecord]["email"];
	}

if (ca[eachRecord]["contactType"] == "Applicant or Contact") {
	contactFName = ca[eachRecord]["firstName"];
	contactLName = ca[eachRecord]["lastName"];
	contactPhone1 = ca[eachRecord]["phone1"];
	bizContactEmail =  ca[eachRecord]["email"];
	}

if (ca[eachRecord]["contactType"] == "Liquor!Beer Agent") {
	contactFName = ca[eachRecord]["firstName"];
	contactLName = ca[eachRecord]["lastName"];
	contactPhone1 = ca[eachRecord]["phone1"];
	bizContactEmail =  ca[eachRecord]["email"];
	}

if (ca[eachRecord]["contactType"] == "License Holder") {
	contactFName = ca[eachRecord]["firstName"];
	contactLName = ca[eachRecord]["lastName"];
	contactPhone1 = ca[eachRecord]["phone1"];
	bizContactEmail =  ca[eachRecord]["email"];
	}

if (contactFName == null) {
	contactFName = "";
	}

if (contactLName == null) {
	contactLName = "";
	}

if (contactPhone1 == null) {
	contactPhone1 = "";
	}

if (bizContactEmail == null) {
	bizContactEmail = "";
	}
`^
EML;GetContactNewLicense^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
phoneLen = null;
ca = getContactArray();
contactFName = null;
contactLName = null;
contactPhone1 = null;
bizContactEmail = null;
for (eachRecord in ca) if(ca[eachRecord]["contactType"] == LicContactType) include("EML;GetContactInfoNewLicense");
if ((contactPhone1 == null || contactPhone1 == "")) {
	for (eachRecord in ca) include("EML;GetContactInfoNewLicense");
	}

if (contactPhone1 != null && contactPhone1 != "") {
	contactPhone1 = contactPhone1.toString().replace(" ","");
	phoneLen = contactPhone1.length();
	}

if (phoneLen != null && phoneLen == 7 && contactPhone1.indexOf("-") == -1) {
	contactPhone1 = contactPhone1.substr(0, 3) + '-' + contactPhone1.substr(3, 4);
	}

if (phoneLen != null && phoneLen == 10 && contactPhone1.indexOf("-") == -1) {
	contactPhone1 = contactPhone1.substr(0, 3) + '-' + contactPhone1.substr(3, 3) + '-' + contactPhone1.substr(6,4);
	}
`^
EML;GetContactType^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (ca[eachRecord]["contactType"] == myContactType) {
	contactEmail = ca[eachRecord]["email"];
	contactFName = ca[eachRecord]["firstName"];
	contactLName = ca[eachRecord]["lastName"];
	businessName = ca[eachRecord]["businessName"];
	}
`^
EML;GetContactTypeEmail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "nomail@cityofmadisonDEV.com";
ca = getContactArray();
contactFName = "firstName";
contactLName = "lastName";
businessName = "businessName";
for (eachRecord in ca) include("EML;GetContactType");
`^
EML;GetCurrentUserEmail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
user =  aa.person.getCurrentUser();
if (user.getSuccess()) {
	user = user.getOutput();
	divCode = user.getDivisionCode();
	}

if (divCode.equals("PUBLIC")) {
	userEmail = user.getEmail();
	userFirst = "";
	userLast = "";
	} else {
	userEmail = user.getEmail();
	userFirst = user.getFirstName();
	userLast = user.getLastName();
	}

userTitle = user.getTitle();
userPhone = user.getPhoneNumber();
userDept = user.getDispDeptOfUser();
`^
EML;GetLicProf^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
xLProf = aa.licenseScript.getLicenseProf(capId).getOutput();
xLProf = xLProf[0];
xlpEmail = xLProf.getEmail();
`^
EML;GetUserIdEmail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
if (userId) {
	var user = aa.person.getUser(userId);
	}

if (userId && user.getSuccess()) {
	user = user.getOutput();
	userEmail= user.getEmail();
	userFirst = user.getFirstName();
	userLast = user.getLastName();
	}
`^
EML;HEIntake^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var otherKnownEvents = null;
var tfEventsInfo = "";
var fiveSpaces = " 
 
 
 
 
";
emailText = "<html><body><p>" + cmnType + " Record created by " + currentUserID + "<!p>";
ca = getContactArray();
emailSubject = "Record " + capIDString + " was created ";
emailText += "<b>Category<!b> " + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
emailText += "<b>Record<!b> <a href=" + "" + "https;!!avdev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=" + cmnGroup + "&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a><br><br>";
include("CMN;getDBA");
var dba = null;
if (businessName) {
	dba = businessName;
	}

if (!(cmnGroup == "Permitting" && cmnType == "Health" && cmnSubType == "Temp Tattoo And Or Piercing") && cmnSubType != "Temp Food Establishment" && dba) {
	emailText += "<b>DBA<!b> "+dba +"<br>";
	}

if (!(cmnGroup == "Permitting" && cmnType == "Health" && cmnSubType == "Temp Tattoo And Or Piercing") && cmnSubType != "Temp Food Establishment") {
	include("EML;AddressInformation");
	}

if (cmnGroup == "Licenses" && cmnSubType == "Temp Food Establishment") {
	emailText += "<strong>First Event<!strong> " + AInfo['EVENT INFORMATION.Name of First Event'] + "<br>";
	}

if (cmnGroup == "Licenses" && cmnSubType == "Temp Food Establishment") {
	emailText += "<strong>First Event Date<!strong> " + AInfo['EVENT INFORMATION.First Event Date'] + "<br><br>";
	}

if (cmnGroup == "Licenses" && cmnSubType == "Temp Food Establishment") {
	otherKnownEvents = loadASITable("OTHER KNOWN EVENTS");
	for(x in otherKnownEvents) tfEventsInfo += otherKnownEvents[x]["Name of Event"].fieldValue + fiveSpaces + otherKnownEvents[x]["Start Date"].fieldValue + fiveSpaces + otherKnownEvents[x]["End Date"].fieldValue + "<br>";
	}

if (cmnGroup == "Licenses" && cmnSubType == "Temp Food Establishment" && tfEventsInfo != "") {
	emailText += "<strong>Other Known Events & Dates<!strong><br>" + tfEventsInfo + "<br>";
	}

if (ca[0] && (cmnSubType == "Temp Food Establishment")) {
	emailText += "<strong>License Holder Business Name<!strong> " + ca[0]["businessName"] + "<br>";
	}

if (dba && cmnSubType == "Temp Food Establishment") {
	emailText += "<strong>DBA<!strong> " + dba + "<br><br>";
	}

emailText += "<p>For Additional Information please log into Accela<!p>";
include("CMN;GetMuni");
if (muni == "City of Madison" && cmnGroup == "Licenses" && (cmnSubType != "DischofNonStrmwtr")) {
	include("EML;CityLicensesAgencyNotification");
	}

if (cmnGroup == "Licenses" && cmnSubType == "Temp Food Establishment") {
	email("jschneider@cityofmadison.com", "noreply@cityofmadisonDEV.com", emailSubject, emailText);
	}

if (cmnGroup == "Permitting" && cmnType == "Health" && cmnSubType == "Temp Tattoo And Or Piercing") {
	email("bcleary@publichealthmdcDEV.com;
	SMoccero@publichealthmdcDEV.com;
	sreese@publichealthmdcDEV.com;
	", "noreply@cityofmadisonDEV.com", emailSubject, emailText);
	}
`^
EML;HENotifyFire^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emailSubject = "License Application " + capIDString + " requires your review ";
emailText = "<html><body><p>" + cmnSubType + " License application action by " + currentUserID + "<!p>";
include("EML;AddressInformation");
emailText += "Find the Application at; <a href=" + "" + "https;!!av73dev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=" + cmnGroup + "&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a><br><br>";
email("cpeterson@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
`^
EML;HESwimmingPool^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emailText = "<html><body><p>" + cmnType + " Record created by " + currentUserID + "<!p>";
ca = getContactArray();
emailSubject = "Record " + capIDString + " was created ";
emailText += "<b>Category<!b> " + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
emailText += "<b>Record<!b> <a href=" + "" + "https;!!av73dev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=" + cmnGroup + "&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a><br><br>";
include("CMN;getDBA");
var dba = null;
if (businessName) {
	dba = businessName;
	}

include("EML;AddressInformation");
emailText += "<b>Applicant Business Name<!b> " + dba + "<br>";
emailText += "<p>For Additional Information please log into Accela<!p>";
include("CMN;GetMuni");
if (muni == "City of Madison") {
	include("EML;CityLicensesAgencyNotification");
	}

email("mwalizada@cityofmadison.com", "glabelle-brown@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
`^
EML;LAND!~!~!~;AgencyApproval^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("EML;GetContactEmail");
emailSubject = "";
include("EML;AddressLine");
emailSubject += " and " + capIDString;
emailText = "<p>Notice of Site Plan Review approval;<!p>";
emailText += "<p>Your project has been reviewed and approved by City staff. ";
emailText += "The approved plans are available to pick up at the Zoning counter. ";
emailText += "If your project requires permits, Zoning staff may be able to sign-off on permits at this time. ";
emailText += "Plans must be picked up from the Zoning counter within 6 months of approval. <!p>";
`^
EML;Land!~!~!~;ElectricalAssigned^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
assignedUser = "";
assignedUserEmail = "";
assignedUserPhone = "";
activeTaskVerification = false;
parntTaskName = "[None]";
activeTaskReview = isTaskActive("LM Agency Review");
if (activeTaskReview) {
	parntTaskName = "LM Agency Review>Traffic Engineering Review";
	}

if (parntTaskName == "[None]") {
	activeTaskVerification = isTaskActive("LM Agency Verification");
	}

if (activeTaskVerification) {
	parntTaskName = "LM Agency Verification>Traffic Engineering Review";
	activeTaskReview = false;
	}

workflowGroups = aa.workflow.getProcessRelationByCapID(capId, null).getOutput();
!!debugObject(workflowGroups[1]);
if (workflowGroups != null) {
	for (wfg in workflowGroups) include("CMN;GetWorkflowAssignedByProcessID");
	}

emailText = "<html><body><p><b>Electrical Review<!b><!p><p>Notice of Electrical Review Assignment<!p>";
emailSubject = "Electrical Review Assignment for ";
include("EML;AddressLine");
emailSubject += " " + capIDString;
emailText += "<b>Category<!b> " + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
emailText += "<b>CAP<!b> <a href=" + "" + "https;!!av73dev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=Land&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capId.getCustomID() + "<!a><br><br>";
emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
include("EML;AddressInformation");
emailText += "<p>For Additional Information please log into Accela<!p>";
if (assignedUserEmail != "") {
	aa.sendEmail("noreply@cityofmadison.com", assignedUserEmail, "", emailSubject, emailText, "");
	}
`^
EML;LAND!~!~!~;IntakeApplicant^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("EML;GetContactEmail");
emailSubject = "";
include("EML;AddressLine");
emailSubject += " and " + capIDString;
emailText = "<html><body><p>Notice of plans submitted for Site Plan Review;<!p>";
emailText += "<p>Your project has been submitted to the Zoning counter and will be routed to City agencies for site plan review.";
emailText += " By utilizing a website that has the current status and requirements from the reviewers, the City hopes to expedite the review process and allow all involved with a particular project to be kept informed of the details of the plan review.";
emailText += " The web site address is;<!p>";
emailText += "<p>http;!!www.cityofmadison.com!developmentcenter!projectstatus!<!p>";
emailText += "<p>You will be able to view the current status of the project in this system and learn if there are any problems or items that must be addressed to ensure approval. ";
emailText += "Each line in the table represents a project currently under review in the system. ";
emailText += "The projects are listed in order by street address.  You can see a more detailed status of any review by clicking on the street address of the project.<!p>";
emailText += "<p>A project can have a review status of Additional Information Required, Reject! Redraft, or Approved;<!p>";
emailText += "<UL><LI><b>Additional Information Required<!b>-One or more reviewers have indicated a need for supplementary materials. ";
emailText += "The project can be approved without a revised submission, but supplementary materials are still required. ";
emailText += "See the project detail view for instructions on satisfying the specific agency requirements.<!LI>";
emailText += "<LI><b>Reject!Redraft<!b>- One or more reviews indicate that the application must be resubmitted with revised plans. ";
emailText += "All the reviewing agencies will need to review the revised plans. ";
emailText += "Resubmit the same number of complete plan sets as originally submitted to the Zoning counter.<!LI>";
emailText += "<LI><b>Approved<!b>- The plans have been approved by all the reviewing agencies. ";
emailText += "The approved applicant plans will be available to pick up at the Zoning counter prior to any permits being approved. ";
emailText += "Plans must be picked up from the Zoning counter within 6 months of approval.<!LI><!UL>";
emailText += "<p>If you have any questions or need more information about the web site and!or the review process itself, please contact Zoning staff at (608) 266-4551.<!p>";
emailText += "<p>If you have questions about a specific review comment, please contact the staff person listed under the review status in the agency you are interested in.<!p>";
`^
EML;LAND!~!~!~;LMAgencyReject^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
include("EML;GetContactEmail");
emailSubject = "";
include("EML;AddressLine");
emailSubject += " and " + capIDString;
emailText = "<p>Notice of Site Plan Review status Reject! Redraft;<!p>";
emailText += "<p>One or more reviews indicate that the plans have been rejected. ";
emailText += "The application must be resubmitted with revised plans. ";
emailText += "See the project detail view for instructions on satisfying the specific agency requirements. ";
emailText += "All the reviewing agencies will need to review the revised plans. ";
emailText += "Resubmit the same number of complete plan sets as originally submitted to the Zoning counter.<!p> ";
`^
EML;LAND!~!~!~;PlanDirectorApproval^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("EML;GetContactEmail");
emailSubject = "";
include("EML;AddressLine");
emailSubject += " and " + capIDString;
emailText = "<p>Notice of Site Plan Review approval;<!p>";
emailText += "Your project has been reviewed and approved by City staff and by the Director of Planning. ";
emailText += "To complete the Alteration to PUD!SIP process, the approved plans and documents must be recorded with the Dane County Register of Deeds. ";
emailText += "In order to have the plans recorded, first pick up your applicant copies of the approved plans at the Zoning counter. ";
emailText += "<p>You must then supply Zoning staff with the following;<!p>";
emailText += "<UL><LI><b>Two copies<!b> of the complete plans, reduced in size to no larger than 8 ½"
x 14"
, including the original <i>Alteration to SIP<!i> application form and <i>site plan approval sheet<!i>.<!LI>";
emailText += "<LI><b>A digital copy<!b> of the complete submittal and approvals, in .pdf form, on a CD.<!LI>";
emailText += "<LI><b>A check for $30.00<!b> to cover recording costs, made payable to the Dane County Register of Deeds.<!LI><!UL>";
emailText += "<p>The City will then record the documents and place a copy in our files. If your project requires permits, Zoning staff may be able to sign-off on permits at this time.<!p>";
`^
EML;LAND!~!~!~;PlanDirectorReview^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emailText = "<html><body><p>Notice of Plan Ready for Plan Director Review;<!p>";
emailSubject = " for ";
include("EML;AddressLine");
emailSubject += " " + capIDString;
emailText += "<b>Category<!b> " + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
emailText += "<b>CAP<!b> <a href=" + "" + "https;!!av73dev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=Land&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capId.getCustomID() + "<!a><br><br>";
emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
include("EML;AddressInformation");
emailText += "<p>For Additional Information please log into Accela<!p>";
`^
EML;Land!~!~!~;SigningMarkingAssigned^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
assignedUser = "";
assignedUserEmail = "";
assignedUserPhone = "";
activeTaskVerification = false;
parntTaskName = "[None]";
activeTaskReview = isTaskActive("LM Agency Review");
if (activeTaskReview) {
	parntTaskName = "LM Agency Review>Traffic Engineering Review";
	}

if (parntTaskName == "[None]") {
	activeTaskVerification = isTaskActive("LM Agency Verification");
	}

if (activeTaskVerification) {
	parntTaskName = "LM Agency Verification>Traffic Engineering Review";
	activeTaskReview = false;
	}

workflowGroups = aa.workflow.getProcessRelationByCapID(capId, null).getOutput();
!!debugObject(workflowGroups[1]);
if (workflowGroups != null) {
	for (wfg in workflowGroups) include("CMN;GetWorkflowAssignedByProcessID");
	}

emailText = "<html><body><p><b>Signing and Marking<!b><!p><p>Notice of Signing and Marking Assignment<!p>";
emailSubject = "Signing and Marking Assignment for ";
include("EML;AddressLine");
emailSubject += " " + capIDString;
emailText += "<b>Category<!b> " + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
emailText += "<b>CAP<!b> <a href=" + "" + "https;!!av73dev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=Land&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capId.getCustomID() + "<!a><br><br>";
emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
include("EML;AddressInformation");
emailText += "<p>For Additional Information please log into Accela<!p>";
if (assignedUserEmail != "") {
	aa.sendEmail("noreply@cityofmadison.com", assignedUserEmail, "", emailSubject, emailText, "");
	}
`^
EML;Land!~!~!;LMAgencyNotification^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emailText = "<html><body><p><b>Plan Review<!b><!p><p>Notice of Plan Ready to Review<!p>";
emailSubject = " for ";
include("EML;AddressLine");
emailSubject += " " + capIDString;
emailText += "<b>Category<!b> " + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
emailText += "<b>CAP<!b> <a href=" + "" + "https;!!av73dev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=Land&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capId.getCustomID() + "<!a><br><br>";
emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
include("EML;AddressInformation");
emailText += "<p>For Additional Information please log into Accela<!p><p>If you would like to stop receiving these notifications, please email Matt Tucker<!p>";
if (isTaskActive("Zoning Review")) {
	email("JKirchgatter@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Zoning Review" + emailSubject,emailText+"Zoning Review");
	}

if (isTaskActive("Parks!Forestry Review")) {
	email("KRutledge@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Parks!Forestry Review" + emailSubject,emailText+"Parks!Forestry Review");
	}

if (isTaskActive("Parks!Forestry Review")) {
	email("TMaglio@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Parks!Forestry Review" + emailSubject,emailText+"Parks!Forestry Review");
	}

if (isTaskActive("Landmarks Commission Review")) {
	email("AScanlon@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Landmarks Commission Review" + emailSubject,emailText+"Landmarks Commission Review");
	}

if (isTaskActive("Real Estate Review")) {
	email("JFrese@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Real Estate Review" + emailSubject,emailText+"Real Estate Review");
	}

if (isTaskActive("Real Estate Review")) {
	email("HFischer@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Real Estate Review" + emailSubject,emailText+"Real Estate Review");
	}

if (isTaskActive("Traffic Engineering Review")) {
	email("EHalvorson@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Traffic Engineering Review" + emailSubject,emailText+"Traffic Engineering Review");
	}

if (isTaskActive("Traffic Engineering Review")) {
	email("JLeach@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Traffic Engineering Review" + emailSubject,emailText+"Traffic Engineering Review");
	}

if (isTaskActive("City Eng. Review Mapping") || isTaskActive("Engineering Mapping")) {
	email("EPederson@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","City Eng. Review Mapping" + emailSubject,emailText+"City Eng. Review Mapping");
	}

if (isTaskActive("City Eng. Review Mapping") || isTaskActive("Engineering Mapping")) {
	email("LZenchenko@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","City Eng. Review Mapping" + emailSubject,emailText+"City Eng. Review Mapping");
	}

if (isTaskActive("Engineering Review Main Office")) {
	email("GFries@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Engineering Review Main Office" + emailSubject,emailText+"Engineering Review Main Office");
	}

if (isTaskActive("Engineering Review Main Office")) {
	email("JBenedict@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Engineering Review Main Office" + emailSubject,emailText+"Engineering Review Main Office");
	}

if (isTaskActive("Engineering Review Main Office")) {
	email("TTroester@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Engineering Review Main Office" + emailSubject,emailText+"Engineering Review Main Office");
	}

if (isTaskActive("Engineering Review Main Office")) {
	email("MHacker@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Engineering Review Main Office" + emailSubject,emailText+"Engineering Review Main Office");
	}

if (isTaskActive("Engineering Review Main Office")) {
	email("JSchmidt@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Engineering Review Main Office" + emailSubject,emailText+"Engineering Review Main Office");
	}

if (isTaskActive("Engineering Review Main Office")) {
	email("MModer@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Engineering Review Main Office" + emailSubject,emailText+"Engineering Review Main Office");
	}

if (isTaskActive("Engineering Review Main Office")) {
	email("CPetykowski@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Engineering Review Main Office" + emailSubject,emailText+"Engineering Review Main Office");
	}

if (isTaskActive("Fire Review")) {
	email("WSullivan@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Fire Review" + emailSubject,emailText+"Fire Review");
	}

if (isTaskActive("Water Utility Review")) {
	email("DCawley@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Water Utility Review" + emailSubject,emailText+"Water Utility Review");
	}

if (isTaskActive("Assessor Review")) {
	email("MRichards@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Assessor Review" + emailSubject,emailText+"Assessor Review");
	}

if (isTaskActive("Metro Review")) {
	email("TSobota@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Metro Review" + emailSubject,emailText+"Metro Review");
	}

if (isTaskActive("Urban Design Commission Review")) {
	email("AMartin@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Urban Design Commission Review" + emailSubject,emailText+"Urban Design Commission Review");
	}

if (isTaskActive("Planning Review")) {
	email("HStouder@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Planning Review" + emailSubject,emailText+"Planning Review");
	}

if (isTaskActive("Planning Review")) {
	email("KFirchow@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Planning Review" + emailSubject,emailText+"Planning Review");
	}

if (isTaskActive("Planning Review")) {
	email("TParks@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Planning Review" + emailSubject,emailText+"Planning Review");
	}

if (isTaskActive("Planning Review")) {
	email("WFruhling@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Planning Review" + emailSubject,emailText+"Planning Review");
	}

if (isTaskActive("Lighting Review")) {
	email("FRehbein@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Lighting Review" + emailSubject,emailText+"Lighting Review");
	}

if (isTaskActive("Architectural Review")) {
	email("AMartin@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Architectural Review" + emailSubject,emailText+"Architectural Review");
	}

if (isTaskActive("Recycling Coordinator")) {
	email("BJohnson2@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Recycling Coordinator" + emailSubject,emailText+"Recycling Coordinator");
	}

if (isTaskActive("Real Estate Review")) {
	email("JLund@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Real Estate Review" + emailSubject,emailText+"Real Estate Review");
	}
`^
EML;Land!~!~!;LMAgencyNotificationInProcess^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (callType == "WTUA") {
	emailSubject = typeReviewVerif + " for " + capIDString + " - ";
	include("EML;AddressLine");
	emailSubject += " - "+ taskDes + " due by " + cDueDate;
	}

if (callType == "DUA") {
	emailSubject = "New Document Uploaded for " + capIDString + " - ";
	include("EML;AddressLine");
	}

emailText = "<html><body><p><b>Plan " + typeReviewVerif + ".<!b><!p>";
emailText += "<p>Notice of " + taskDes + " due by " + cDueDate + ".<!p>";
if (callType == "DUA") {
	emailText += "<p>Document(s) have been attached for your review.<!p>";
	}

emailText += "<p><b>Category<!b> " + cmnType + "!" + cmnSubType + "!" + cmnCategory + ".<!p><br><br>";
emailText += "<b>CAP<!b> <a href=" + "" + "https;!!av73dev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=Land&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capId.getCustomID() + "<!a><br><br>";
emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
include("EML;AddressInformation");
emailText += "<p>For Additional Information please log into Accela.<!p>";
emailText += "<p>If you would like to stop receiving these notifications, please email Matt Tucker.<!p><!body><!html>";
sendAsyncEmail("noreply@cityofmadison.com", emailAddress, "", emailSubject, emailText, "elamsupport@cityofmadison.com");
`^
EML;Land!~!~!;NotifyAssignedTo^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var cd = aa.cap.getCapDetail(capId).getOutput().getCapDetailModel();
if (cd != null) {
	userId = cd.getAsgnStaff();
	logDebug("User ID = " + userId);
	}

if (userId != "" && userId != null) {
	logDebug("User ID = " + userId);
	var deptId = getDepartmentName(userId);
	logDebug("Department = " + deptId);
	}

if (userId != "" && userId != null) {
	include("EML;GetUserIdEmail");
	logDebug("Send to Email = " + userEmail);
	}

emailSubject = "New Document Uploaded for " + capIDString + " - ";
include("EML;AddressLine");
emailText = "<html><body><p><b>Plan " + typeReviewVerif + ".<!b><!p>";
emailText += "<p>Document(s) have been attached.<!p>";
emailText += "<p><b>Category<!b> " + cmnType + "!" + cmnSubType + "!" + cmnCategory + ".<!p><br><br>";
emailText += "<b>CAP<!b> <a href=" + "" + "https;!!avdev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=Land&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capId.getCustomID() + "<!a><br><br>";
emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
include("EML;AddressInformation");
emailText += "<p>For Additional Information please log into Accela.<!p>";
aa.sendEmail("noreply@cityofmadison.com", userEmail, "elamsupport@cityofmadison.com",  emailSubject, emailText, "");
`^
EML;Land!Land Use!NA!NA;EngReviewMainOfficeNotify^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
sEmailTo = "cehagen@cityofmadison.com";
!!Set this on since this is dev to force all emails to come to this address.;
emailSubject = "Review for " + capIDString + "; Engineering Review Main Office - " + sCurentTask;
emailText = "<html><body>";
emailText += "<b>Plan Review<!b><!p><p>Notice of Plan Ready for " + sCurentTask + ".<!p>";
emailText += "<b>Category;<!b> " + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
emailText += "<b>CAP;<!b> 
<a href=" + "" + "https;!!avdev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=Land&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capId.getCustomID() + "<!a><br><br>";
emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
include("EML;AddressInformation");
emailText += "<p>For Additional Information please log into Accela<!p><p>If you would like to stop receiving these notifications, please email Matt Tucker.<!p>";
emailText  +=  "<!body><!html>";
sendAsyncEmail("noreply@cityofmadisonDEV.com", sEmailTo, "", emailSubject, emailText, "");
`^
EML;Land!Land Use!NA!NA;IntakeAccepted^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emailText = "<html><body><p><b>Land Use<!b><!p><p>Notice of Land Use Application Accepted<!p>";
emailSubject = " for ";
include("EML;AddressLine");
emailSubject += " " + capIDString;
emailText += "<b>Category<!b> " + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
emailText += "<b>CAP<!b> <a href=" + "" + "https;!!av73dev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=Land&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capId.getCustomID() + "<!a><br><br>";
emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
include("EML;AddressInformation");
emailText += "<p>For Additional Information please log into Accela<!p><p>If you would like to stop receiving these notifications, please email elamsupport@cityofmadison.com<!p>";
if (email("jwendt@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Land Use Application Accepted" + emailSubject,emailText+"LM Agency Review");) {
	}

if (email("rsjachrani@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Land Use Application Accepted" + emailSubject,emailText+"LM Agency Review");) {
	}
`^
EML;Land!Landmark!NA!NA;NotifyBuildInspector^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var sToEmail = "";
sToEmail = "jschneider@cityofmadison.com"  !! For IT testing.;
logDebug("Email address = " + sToEmail);
emailSubject = "Landmark Building Inspection Notice";
emailText = "<html><body>";
emailText += "<p>A Certificate of Appropriateness has been issued for Landmark record 
<a href=" + "" + "https;!!avdev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=" + cmnGroup + "&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a>.<!p>";
emailText  +=  "<!body><!html>";
aa.sendEmail("noreply@cityofmadison.com", sToEmail, "", emailSubject, emailText, "");
`^
EML;LandAgencyApprovedNotify^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
userEmail = "noEmail@cityofmadisonDEV.com";
include("EML;GetCurrentUserEmail");
reportFile = "";
cName = cmnType + "!" + cmnSubType;
emailSubject = cName + "; " + capIDString + " Approved!Closed.";
emailText = "<html><body><p>Hello " + userFirst + " " + userLast + ",<!p>";
emailText +=  "<p>" + cName + "; <a href=" + "" + "https;!!av73dev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=Land&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capId.getCustomID() + "<!a> has been Approved!Closed.<!p>";
ad = aa.address.getAddressByCapId(capId).getOutput();
if ((ad[0] != null && ad[0].toString().length() > 0)) {
	emailText += "<p>Address of Work;<br>";
	}

if ((ad[0] != null && ad[0].toString().length() > 0)) {
	for (eachRecord in ad) include("EML;GetAddressLine");
	}

if ((ad[0] != null && ad[0].toString().length() > 0)) {
	emailText += "<!p>";
	}

if (workDescGet(capId) != null) {
	emailText += "<p>Description of Work; " + workDescGet(capId)  + "<!p>";
	}

if (wfComment != null) {
	emailText += "<p>Comments; " + wfComment + "<!p>";
	}

aa.sendEmail("noreply@cityofmadisonDEV.com", "rsjachrani@cityofmadisonDEV.com", "jmoyer@cityofmadisonDEV.com",  emailSubject, emailText, reportFile);
`^
EML;LANDMARKSDISTRICT^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emailText = "<html><body><p>Notice of Permit Application on an Address which is a Landmark<!p>";
emailSubject = "Landmark Notification " + capIDString + " - Permit App Submitted";
emailText += "<b>Category<!b> " + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
include("EML;AddressInformation");
emailText += "<p>For Additional Information please log into Accela<!p>";
email("rsjachrani@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
email("kgrittner@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
`^
EML;LANDMARKSDISTRICTADJACENT^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
emailText = "<html><body><p>Notice of Permit Application on an Address adjacent to a Landmark<!p>";
emailSubject = "Landmark Notification " + capIDString + " - Permit App Submitted";
emailText += "<b>Category<!b> " + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
include("EML;AddressInformation");
emailText += "<p>For Additional Information please log into Accela<!p>";
email("rsjachrani@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
email("kgrittner@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
`^
EML;Licenses!~!~!~;LicenseNotIssued^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (cmnType == "Health" && wfTask == "License Issuance" && wfStatus == "Issued - Conditional") {
	isCondLic = true;
	} else {
	isCondLic = false;
	}

if (isCondLic == false) {
	emailSubject = "License Not Issued for " + capIDString;
	}

if (isCondLic == true) {
	emailSubject = "Conditional License Not Issued for " + capIDString;
	}

emailText = "<html><body>";
emailText  +=  "<p><strong>RE; Application ID " + capIDString + "<!strong><!p>";
if (isCondLic == false) {
	emailText  +=  "<p>A license was not issued for this application, because either no fees were invoiced or there is an unpaid balance on this record. Please follow up as needed to ensure that this license is issued.<!p>";
	}

if (isCondLic == true) {
	emailText  +=  "<p>A conditional license was not issued for this application, because either no fees were invoiced or there is an unpaid balance on this record. Please follow up as needed to ensure that this license is issued.<!p>";
	}

emailText  +=  "<!body><!html>";
if (cmnType == "Fire") {
	aa.sendEmail("noreply@cityofmadisonDEV.com", "", "", emailSubject, emailText, "");
	!!send email to FPSets for production.;
	}

if (cmnType == "Health") {
	aa.sendEmail("noreply@cityofmadisonDEV.com", "", "", emailSubject, emailText, "");
	!!send email to Beth Cleary for production.;
	}

aa.sendEmail("noreply@cityofmadisonDEV.com", "", "", emailSubject, emailText, "");
!!send email to licensing@cityofmadison for production.;
`^
EML;Licenses!Clerk!ClassABeerLiquor!~;BackgroundCheckComp^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
myContactType = "License Holder";
var sWFStatus = "";
var sWFStatus = "Background Check|" + wfStatus;
include("EML;GetContactTypeEmail");
sSendTo = lookup("LicClerkPoliceReviewEmailsSendTo", sWFStatus);
emailSubject = "Class A Beer & Liquor License " + lookup("LicClerkPoliceReviewEmailsSubject", sWFStatus);
emailText = "<html><body>";
emailText += "<p><strong>LicenseType;<!strong> 
Class A Beer Liquor<br><strong>License Application #;<!strong> 
" + capIDString;
if (contactLName != null && contactLName != "") {
	emailText  += "<br><strong>License Holder Name;<!strong> 
	" + contactFName + " " + contactLName;
	}

if (businessName != null && businessName != "") {
	emailText += "<br><strong>Business Name;<!strong> 
	" + businessName + "<!p>";
	}

if (wfStatus == "ALRC Captain Consultation" && wfComment != null) {
	emailText += "<p>Comments; " + wfComment + "<!p>";
	}

emailText += lookup("LicClerkPoliceReviewEmailBody", sWFStatus);
sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, "", emailSubject, emailText, "");
`^
EML;Licenses!Clerk!ClassABeerLiquor!~;BackgroundCheckNeeded^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
myContactType = "License Holder";
include("EML;GetContactTypeEmail");
sSendTo = lookup("LicClerkPoliceReviewEmailsSendTo", "Legistar|Received");
emailSubject = "New Class A Beer Liquor " + lookup("LicClerkPoliceReviewEmailsSubject", "Legistar|Received");
emailText = "<html><body>";
emailText += "<p><strong>License Type;<!strong> 
Class A Beer Liquor<br><strong>License Application #;<!strong> 
" + capIDString + "<br><strong>License Holder Name;<!strong> 
" + businessName + "<!p>";
emailText += lookup("LicClerkPoliceReviewEmailBody", "Legistar|Received");
contactEmail = "";
include("CMN;getMPDEmail");
sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, contactEmail, emailSubject, emailText, "");
`^
EML;Licenses!Clerk!ClassABeerLiquor!~;CaptainReviewComp^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
myContactType = "License Holder";
var sWFStatus = "";
var sWFStatus = "District Captain Review|" + wfStatus;
include("EML;GetContactTypeEmail");
sSendTo = lookup("LicClerkPoliceReviewEmailsSendTo", sWFStatus);
emailSubject = "Class A Beer & Liquor License " + lookup("LicClerkPoliceReviewEmailsSubject", sWFStatus);
emailText = "<html><body>";
emailText += "<p><strong>LicenseType;<!strong> 
Class A Beer Liquor<br><strong>License Application #;<!strong> 
" + capIDString;
if (contactLName != null && contactLName != "") {
	emailText  += "<br><strong>License Holder Name;<!strong> 
	" + contactFName + " " + contactLName;
	}

if (businessName!= null && businessName != "") {
	emailText += "<br><strong>Business Name;<!strong> 
	" + businessName + "<!p>";
	}

emailText += lookup("LicClerkPoliceReviewEmailBody", sWFStatus);
sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, "", emailSubject, emailText, "");
`^
EML;Licenses!Clerk!ClassABeerLiquor!~;Issued^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
LicContactType = "";
DefaultContactType = "";
contactFName = "";
contactLName = "";
contactPhone1 = "";
var cName = "Class A Beer & Liquor";
ad = aa.address.getAddressByCapId(capId).getOutput();
include("CMN;getDBA");
var dba = null;
contactEmail="";
if (businessName) {
	dba = businessName;
	}

include("CMN;getAlderDist");
emailSubject = cName + " License; " + capIDString;
DefaultContactType = "License Holder";
LicContactType = "Applicant";
include("EML;GetContactNewLicense");
emailText = "<html><body><p>A new " + cName +  " license has been issued in your district.<!p><p>Contact Name!Phone; " + contactFName + " " + contactLName + " " + contactPhone1 + "<!p>";
if ((dba != null)) {
	emailText += "<p>Establishment Name; " + dba + "<!p>";
	}

if ((ad[0] != null && ad[0].toString().length() > 0)) {
	emailText += "<p>Address; " + ad[0] + "<!p><!body><!html>";
	}

if (contactEmail != null && contactEmail != "") {
	sendAsyncEmail("noreplyDEV@cityofmadison.com", "elamsupport@cityofmadison.com", "", emailSubject+" (for; "+contactEmail+")", emailText, "");
	}

contactEmail = "";
include("CMN;getMPDEmail");
if (contactEmail != null && contactEmail != "") {
	sendAsyncEmail("noreplyDEV@cityofmadison.com", "elamsupport@cityofmadison.com", "", emailSubject+" (for; "+contactEmail+")", emailText, "");
	}

emailText = "";
emailText = "<html><body><p>A new " + cName +  " license has been issued in the City of Madison.<!p>";
if ((dba != null)) {
	emailText += "<p>Establishment Name; " + dba + "<!p>";
	}

if ((ad[0] != null && ad[0].toString().length() > 0)) {
	emailText += "<p>Address; " + ad[0] + "<!p><!body><!html>";
	}
`^
EML;Licenses!Clerk!ClassBBeerLiquor!~;BackgroundCheckcomp^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
myContactType = "License Holder";
var sWFStatus = "";
var sWFStatus = "Background Check|" + wfStatus;
include("EML;GetContactTypeEmail");
sSendTo = lookup("LicClerkPoliceReviewEmailsSendTo", sWFStatus);
emailSubject = "Class B Beer & Liquor License " + lookup("LicClerkPoliceReviewEmailsSubject", sWFStatus);
emailText = "<html><body>";
emailText += "<p><strong>LicenseType;<!strong> 
Class B Beer Liquor<br><strong>License Application #;<!strong> 
" + capIDString;
if (contactLName != null && contactLName != "") {
	emailText  += "<br><strong>License Holder Name;<!strong> 
	" + contactFName + " " + contactLName;
	}

if (businessName!= null && businessName != "") {
	emailText += "<br><strong>Business Name;<!strong> 
	" + businessName + "<!p>";
	}

if (wfStatus == "ALRC Captain Consultation" && wfComment != null) {
	emailText += "<p>Comments; " + wfComment + "<!p>";
	}

emailText += lookup("LicClerkPoliceReviewEmailBody", sWFStatus);
sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, "", emailSubject, emailText, "");
`^
EML;Licenses!Clerk!ClassBBeerLiquor!~;BackgroundCheckNeeded^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
myContactType = "License Holder";
include("EML;GetContactTypeEmail");
sSendTo = lookup("LicClerkPoliceReviewEmailsSendTo", "Legistar|Received");
emailSubject = "New Class B Beer Liquor " + lookup("LicClerkPoliceReviewEmailsSubject", "Legistar|Received");
emailText = "<html><body>";
emailText += "<p><strong>License Type;<!strong> 
Class B Beer Liquor<br><strong>License Application #;<!strong> 
" + capIDString + "<br><strong>License Holder Name;<!strong> 
" + businessName + "<!p>";
emailText += lookup("LicClerkPoliceReviewEmailBody", "Legistar|Received");
contactEmail = "";
include("CMN;getMPDEmail");
sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, contactEmail , emailSubject, emailText, "");
`^
EML;Licenses!Clerk!ClassBBeerLiquor!~;CaptainReviewComp^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
myContactType = "License Holder";
var sWFStatus = "";
var sWFStatus = "District Captain Review|" + wfStatus;
include("EML;GetContactTypeEmail");
sSendTo = lookup("LicClerkPoliceReviewEmailsSendTo", sWFStatus);
emailSubject = "Class B Beer & Liquor License " + lookup("LicClerkPoliceReviewEmailsSubject", sWFStatus);
emailText = "<html><body>";
emailText += "<p><strong>LicenseType;<!strong> 
Class B Beer Liquor<br><strong>License Application #;<!strong> 
" + capIDString;
if (contactLName != null && contactLName != "") {
	emailText  += "<br><strong>License Holder Name;<!strong> 
	" + contactFName + " " + contactLName;
	}

if (businessName!= null && businessName != "") {
	emailText += "<br><strong>Business Name;<!strong> 
	" + businessName + "<!p>";
	}

emailText += lookup("LicClerkPoliceReviewEmailBody", sWFStatus);
sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, "", emailSubject, emailText, "");
`^
EML;Licenses!Clerk!ClassBBeerLiquor!~;Issued^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
LicContactType = "";
DefaultContactType = "";
contactFName = "";
contactLName = "";
contactPhone1 = "";
var cName = "Class B Beer & Liquor";
ad = aa.address.getAddressByCapId(capId).getOutput();
include("CMN;getDBA");
var dba = null;
contactEmail="";
if (businessName) {
	dba = businessName;
	}

include("CMN;getAlderDist");
emailSubject = cName + " License; " + capIDString;
DefaultContactType = "License Holder";
LicContactType = "Applicant";
include("EML;GetContactNewLicense");
emailText = "<html><body><p>A new " + cName +  " license has been issued in your district.<!p><p>Contact Name!Phone; " + contactFName + " " + contactLName + " " + contactPhone1 + "<!p>";
if ((dba != null)) {
	emailText += "<p>Establishment Name; " + dba + "<!p>";
	}

if ((ad[0] != null && ad[0].toString().length() > 0)) {
	emailText += "<p>Address; " + ad[0] + "<!p><!body><!html>";
	}

if (contactEmail != null && contactEmail != "") {
	sendAsyncEmail("noreplyDEV@cityofmadison.com", "elamsupport@cityofmadison.com", "",  emailSubject+" (for; "+contactEmail+")", emailText, "");
	}

contactEmail="";
include("CMN;getMPDEmail");
if (contactEmail != null && contactEmail != "") {
	sendAsyncEmail("noreplyDEV@cityofmadison.com", "elamsupport@cityofmadison.com","",  emailSubject+" (for; "+contactEmail+")", emailText, "");
	}

emailText = "";
emailText = "<html><body><p>A new " + cName +  " license has been issued in the City of Madison.<!p>";
if ((dba != null)) {
	emailText += "<p>Establishment Name; " + dba + "<!p>";
	}

if ((ad[0] != null && ad[0].toString().length() > 0)) {
	emailText += "<p>Address; " + ad[0] + "<!p><!body><!html>";
	}
`^
EML;Licenses!Clerk!MallSecondHandDealer!NA;BackgroundCheckComp^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
myContactType = "License Holder";
var sWFStatus = "";
var sWFStatus = "Background Check|" + wfStatus;
include("EML;GetContactTypeEmail");
sSendTo = lookup("LicClerkPoliceReviewEmailsSendTo", sWFStatus);
emailSubject = lookup("LicClerkPoliceReviewEmailsSubject", sWFStatus)+ " - Mall Second Hand Dealer License";
emailText = "<html><body>";
emailText += "<p><strong>LicenseType;<!strong> 
Mall Second Hand Dealer<br><strong>License Application #;<!strong> 
" + capIDString;
if (contactLName != null && contactLName != "") {
	emailText  += "<br><strong>License Holder Name;<!strong> 
	" + contactFName + " " + contactLName;
	}

if (businessName!= null && businessName != "") {
	emailText += "<br><strong>Business Name;<!strong> 
	" + businessName + "<!p>";
	}

if (wfStatus == "Captain Consultation" && wfComment != null) {
	emailText += "<p>Comments; " + wfComment + "<!p>";
	}

emailText += lookup("LicClerkPoliceReviewEmailBody", sWFStatus);
sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, "", emailSubject, emailText, "");
`^
EML;Licenses!Clerk!MallSecondHandDealer!NA;BackgroundCheckNeeded^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
myContactType = "License Holder";
include("EML;GetContactTypeEmail");
sSendTo = lookup("LicClerkPoliceReviewEmailsSendTo", "Legistar|Entered");
emailSubject = "New Mall Second Hand Dealer " + lookup("LicClerkPoliceReviewEmailsSubject", "Legistar|Entered");
emailText = "<html><body>";
emailText += "<p><strong>License Type;<!strong> 
Mall Second Hand Dealer<br><strong>License Application #;<!strong> 
" + capIDString + "<br><strong>Applicant Name;<!strong> 
" + businessName + "<!p>";
emailText += lookup("LicClerkPoliceReviewEmailBody", "Legistar|Entered");
contactEmail = "";
include("CMN;getMPDEmail");
sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, contactEmail,emailSubject, emailText, "");
`^
EML;Licenses!Clerk!MallSecondHandDealer!NA;CaptainReviewComplete^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
myContactType = "License Holder";
var sWFStatus = "";
var sWFStatus = "District Captain Review|" + wfStatus;
include("EML;GetContactTypeEmail");
sSendTo = lookup("LicClerkPoliceReviewEmailsSendTo", sWFStatus);
emailSubject = lookup("LicClerkPoliceReviewEmailsSubject", sWFStatus) + " - Mall Second Hand Dealer License";
emailText = "<html><body>";
emailText += "<p><strong>LicenseType;<!strong> 
Mall Second Hand Dealer<br><strong>License Application #;<!strong> 
" + capIDString;
if (contactLName != null && contactLName != "") {
	emailText  += "<br><strong>License Holder Name;<!strong> 
	" + contactFName + " " + contactLName;
	}

if (businessName!= null && businessName != "") {
	emailText += "<br><strong>Business Name;<!strong> 
	" + businessName + "<!p>";
	}

emailText += lookup("LicClerkPoliceReviewEmailBody", sWFStatus);
sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, "", emailSubject, emailText, "");
`^
EML;Licenses!Clerk!Operator!NA;ALRCScheduled^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var LicHolderEmail = "";
var bNoEmail = true;
include("EML;GetContactEmail");
for(rec in ca) if (ca[rec]["contactType"] == "License Holder") LicHolderEmail = ca[rec]["email"];
firstName = ca[rec]["firstName"];
lastName = ca[rec]["lastName"];
if (LicHolderEmail != null && LicHolderEmail != undefined && LicHolderEmail != "") {
	bNoEmail = false;
	}

if (!bNoEmail) {
	emailSubject = "City of Madison Operator License Application " + capIDString + " - ALRC Appearance Information";
	}

if (!bNoEmail) {
	emailText = "<html><body><p>Hello " + firstName + " " + lastName + ",<!p>";
	}

if (!bNoEmail) {
	emailText += "<p>Your appearance to appear before the ALRC is scheduled for " + AInfo['Enter Date of ALRC Hearing'] + ".<!p>";
	}

if (!bNoEmail) {
	emailText += "<p>If you have any questions, please reply to this email or contact the City of Madison Clerk's Office at 608-266-4601<!p>";
	}

if (!bNoEmail) {
	emailText += "<p>Thank you,<br>City of Madison Clerk's Office<!p><!body><!html>";
	}

if (!bNoEmail) {
	sendAsyncEmail("Licensing@cityofmadisonDEV.com", LicHolderEmail, "Licensing@cityofmadisonDEV.com", emailSubject, emailText, "");
	}

if (bNoEmail == true) {
	include("EML;Licenses!Clerk!Operator!NA;EmailTemplate");
	}
`^
EML;Licenses!Clerk!Operator!NA;ApplicationSubmitted^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
employerEmail = "";
reportFile = "";
if (cmnCategory == "NA") {
	licenseNumber = capIDString;
	} else {
	licenseNumber = pAltId;
	}

employerEmail = AInfo['ADDITIONAL APPLICANT INFO.Employer Email'];
if (employerEmail == null) {
	employerEmail = "";
	}

include("EML;GetContactEmail");
cName = "City of Madison Operators License";
emailSubject = " License Application Received (" + licenseNumber + ") for " + cName;
emailText = "<html><body><p>Hello " + contactFName + " " + contactLName + ",<!p>";
emailText += "<p>We are processing your " + cName + " application. <!p>";
if (contactEmail != "") {
	puResult = aa.publicUser.getPublicUserByEmail(contactEmail).getOutput();
	}

if (puResult != null) {
	emailText += "<p>You may check on the status of your license at any time by logging in to <a href='https;!!elam.cityofmadison.com!CitizenAccess!'>City of Madison Licenses & Permits<!a> and following the directions below;<!p>";
	}

if (puResult != null) {
	emailText += "1.  Once logged in, click on 'Search for a License!Registration'.<br>";
	}

if (puResult != null) {
	emailText += "2.  Locate the license number (" + licenseNumber + ") and click on the number.<br>";
	}

if (puResult != null) {
	emailText += "3.  Expand the Workflow section near the bottom of the page to review the status of your application.<br>";
	}

emailText += "<p>Thank you,<BR>City Clerk<BR>210 Martin Luther King, Jr. Blvd., Room 103<BR>City of Madison, Wisconsin 53703<!p>";
emailText += "<p>608 266 4601 Phone<BR>608 266 4666 Fax<BR>licensing@cityofmadisonDEV.com<!p><!body><!html>";
if (cmnCategory == "NA" && contactEmail != "") {
	aa.sendEmail("noreply@cityofmadisonDEV.com", contactEmail, employerEmail, emailSubject, emailText, reportFile);
	}
`^
EML;Licenses!Clerk!Operator!NA;EmailTemplate^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var LicHolderEmail = "";
var bNoEmail = true;
var bPoliceALRC = false;
var sPoliceALRCLookup = "";
var sPoliceALRCSubject = "";
var sPoliceALRCBody = "";
var sSendTo = "";
var bCourtFees = false;
var sCourtFeesLookup = "";
var sCourtFeesSubject = "";
var sCourtFeesBody = "";
var bCriminalCase = false;
var sCriminalCaseLookup = "";
var sCriminalCaseSubject = "";
var sCriminalCaseBody = "";
if (lookup("LicClerkOperatorEmailsSendTo", wfTask + "|" + wfStatus)) {
	sSendTo = lookup("LicClerkOperatorEmailsSendTo", wfTask + "|" + wfStatus);
	}

if (wfTask == "Police Review" && wfStatus == "Submit to ALRC") {
	bPoliceALRC = true;
	}

if (wfTask == "Police Review" && wfStatus == "Court Fees Past Due") {
	bCourtFees = true;
	}

if (wfTask == "Police Review" && wfStatus == "Pending Criminal Case") {
	bCriminalCase = true;
	}

include("EML;GetContactEmail");
logDebug("workflow task!status = " + wfTask + "|" + wfStatus);
if (bPoliceALRC == false && bCourtFees == false && bCriminalCase == false && lookup("LicClerkOperatorEmailsSubject", wfTask + "|" + wfStatus)  != undefined) {
	emailSubject = lookup("LicClerkOperatorEmailsSubject", wfTask + "|" + wfStatus);
	} else {
	emailSubject = "Operator License Application";
	}

for(rec in ca) if (ca[rec]["contactType"] == "License Holder") LicHolderEmail = ca[rec]["email"];
firstName = ca[rec]["firstName"];
lastName = ca[rec]["lastName"];
if (LicHolderEmail != null && LicHolderEmail != undefined && LicHolderEmail != "") {
	bNoEmail = false;
	logDebug("LicHolderEmail; " + LicHolderEmail);
	}

if (bPoliceALRC == true) {
	if(bNoEmail == false) sPoliceALRCLookup = "1";
	if(bNoEmail == true) sPoliceALRCLookup = "2";
	}

if (sPoliceALRCLookup != "") {
	sPoliceALRCSubject = lookup("LicClerkOperatorEmailsSubject", "Police Review|Submit to ALRC" + sPoliceALRCLookup);
	}

if (sPoliceALRCLookup != "") {
	sPoliceALRCBody = lookup("LicClerkOperatorEmailsBody", "Police Review|Submit to ALRC" + sPoliceALRCLookup + "a");
	}

if (sPoliceALRCLookup != "" && lookup("LicClerkOperatorEmailsBody", "Police Review|Submit to ALRC" + sPoliceALRCLookup + "b") != undefined) {
	sPoliceALRCBody += lookup("LicClerkOperatorEmailsBody", "Police Review|Submit to ALRC" + sPoliceALRCLookup + "b");
	}

if (bCourtFees == true) {
	if(bNoEmail == false) sCourtFeesLookup = "1";
	if(bNoEmail == true) sCourtFeesLookup = "2";
	}

if (sCourtFeesLookup != "") {
	sCourtFeesSubject = lookup("LicClerkOperatorEmailsSubject", "Police Review|Court Fees Past Due" + sCourtFeesLookup);
	}

if (sCourtFeesLookup != "") {
	sCourtFeesBody = lookup("LicClerkOperatorEmailsBody", "Police Review|Court Fees Past Due" + sCourtFeesLookup);
	}

if (bCriminalCase == true) {
	if(bNoEmail == false) sCriminalCaseLookup = "1";
	if(bNoEmail == true) sCriminalCaseLookup = "2";
	}

if (sCriminalCaseLookup != "") {
	sCriminalCaseSubject = lookup("LicClerkOperatorEmailsSubject", "Police Review|Pending Criminal Case" + sCriminalCaseLookup);
	}

if (sCriminalCaseLookup != "") {
	sCriminalCaseBody = lookup("LicClerkOperatorEmailsBody", "Police Review|Pending Criminal Case" + sCriminalCaseLookup);
	}

emailText = "<html><body>";
emailText += "<p><strong>License Type;<!strong> 
Operator (Bartender)<br><strong>License Application #;<!strong> 
" + capIDString + "<br><strong>Applicant Name;<!strong> 
" + firstName + " " + lastName + "<!p>";
if (bPoliceALRC == false && bCourtFees == false && bCriminalCase == false && lookup("LicClerkOperatorEmailsBody", wfTask + "|" + wfStatus)  != undefined) {
	emailText += lookup("LicClerkOperatorEmailsBody", wfTask + "|" + wfStatus);
	}

if (bPoliceALRC == true) {
	emailText += sPoliceALRCBody;
	emailSubject = sPoliceALRCSubject;
	}

if (bCourtFees == true) {
	emailSubject = sCourtFeesSubject;
	if(bNoEmail == true) emailText += sCourtFeesBody;
	if(bNoEmail == false) emailText = sCourtFeesBody;
	}

if (bCriminalCase == true) {
	emailSubject = sCriminalCaseSubject;
	if(bNoEmail == true) emailText += sCriminalCaseBody;
	if(bNoEmail == false) emailText = sCriminalCaseBody;
	}

emailText += "<!html><!body>";
if (bPoliceALRC == true && bNoEmail == false) {
	sendAsyncEmail("Licensing@cityofmadisonDEV.com", LicHolderEmail , "Licensing@cityofmadisonDEV.com", emailSubject, emailText, "");
	bALRCemailSent = true;
	logDebug("ALRC email sent to LicHolder");
	}

if ((bCourtFees == true || bCriminalCase == true) && bNoEmail == false) {
	sendAsyncEmail("Licensing@cityofmadisonDEV.com", LicHolderEmail , "Licensing@cityofmadisonDEV.com", emailSubject, emailText, "");
	logDebug(emailSubject + " email sent to LicHolder");
	}

if ((((bPoliceALRC == true || bCourtFees == true || bCriminalCase == true) && bNoEmail == true) || (bPoliceALRC == false && bCourtFees == false && bCriminalCase == false))) {
	sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, "", emailSubject, emailText, "");
	logDebug("Email sent to " + sSendTo + " value for given task and status.");
	}
`^
EML;Licenses!Clerk!Operator!NA;LicenseIssued^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
employerEmail = "";
if (cmnCategory == "NA") {
	licenseNumber = capIDString;
	} else {
	licenseNumber = pAltId;
	}

employerEmail = AInfo['ADDITIONAL APPLICANT INFO.Employer Email'];
if (employerEmail == null) {
	employerEmail = "";
	}

include("EML;GetContactEmail");
cName = "City of Madison Operators License";
emailSubject = "License Issued (" + licenseNumber + ") for " + cName;
emailText = "<html><body><p>Hello " + contactFName + " " + contactLName + ",<!p>";
emailText += "<p>Your " + cName + " has been issued and is attched as a PDF file.<br>";
emailText += "You will need to have Adobe Reader installed in order to print or view this license.<!p>";
if (contactEmail != "") {
	puResult = aa.publicUser.getPublicUserByEmail(contactEmail).getOutput();
	}

if (puResult != null) {
	emailText += "<p>You may download your license at any time by logging in to <a href='https;!!elam.cityofmadison.com!CitizenAccess!'>City of Madison Licenses & Permits<!a>  and following the directions below;<!p>";
	}

if (puResult != null) {
	emailText += "1.  Once logged in, click on 'Search for a License!Registration'.<br>";
	}

if (puResult != null) {
	emailText += "2.  Locate the license number (" + licenseNumber + ") and click on the number.<br>";
	}

if (puResult != null) {
	emailText += "3.  Find the documents section near the bottom of the page.  Expand and review!print your documents.<br><br>";
	}

emailText += "If you need the Clerk's Office to mail you a hard copy of your license, please let us know using the contact information below.<br>";
emailText += "<p>Thank you,<BR>City Clerk<BR>210 Martin Luther King, Jr. Blvd., Room 103<BR>City of Madison, Wisconsin 53703<!p>";
emailText += "<p>608 266 4601 Phone<BR>608 266 4666 Fax<BR>licensing@cityofmadisonDEV.com<!p><!body><!html>";
if (cmnCategory == "NA" && contactEmail != "") {
	reportName = "Business License";
	reportViewAttachEmail(false, true, reportName, "noreply@cityofmadisonDEV.com", contactEmail, employerEmail, emailSubject, emailText, false, "");
	}

if (cmnCategory == "Renewal" && contactEmail != "") {
	reportName = "Business License";
	reportViewAttachEmail(false, true, reportName, "noreply@cityofmadisonDEV.com", contactEmail, employerEmail, emailSubject, emailText, true, "");
	}
`^
EML;Licenses!Clerk!Operator!NA;OperatorDenied^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var LicHolderEmail = "";
var bNoEmail = true;
include("EML;GetContactEmail");
for(rec in ca) if (ca[rec]["contactType"] == "License Holder") LicHolderEmail = ca[rec]["email"];
firstName = ca[rec]["firstName"];
lastName = ca[rec]["lastName"];
if (LicHolderEmail != null && LicHolderEmail != undefined && LicHolderEmail != "") {
	bNoEmail = false;
	logDebug("Lic Holder Email; " + LicHolderEmail);
	}

if (!bNoEmail) {
	emailSubject = "City of Madison Operator License Application " + capIDString + " Denied";
	}

if (!bNoEmail) {
	emailText = "<html><body><p>Hello " + firstName + " " + lastName + ",<!p>";
	}

if (!bNoEmail) {
	emailText += "<p>We regret to inform you that your application for an Operator license was denied by the Common Council.<!p>";
	}

if (!bNoEmail) {
	emailText += "<p>Thank you,<br>Madison City Clerk's Office<!p><!body><!html>";
	}

if (!bNoEmail) {
	sendAsyncEmail("Licensing@cityofmadisonDEV.com", LicHolderEmail, "Licensing@cityofmadisonDEV.com", emailSubject, emailText, "");
	}

if (bNoEmail == true) {
	include("EML;Licenses!Clerk!Operator!NA;EmailTemplate");
	}
`^
EML;Licenses!Clerk!Operator!NA;PoliceAdditionalInfo^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var LicHolderEmail = "";
var bNoEmail = true;
include("EML;GetContactEmail");
for(rec in ca) if (ca[rec]["contactType"] == "License Holder") LicHolderEmail = ca[rec]["email"];
firstName = ca[rec]["firstName"];
lastName = ca[rec]["lastName"];
if (LicHolderEmail != null && LicHolderEmail != undefined && LicHolderEmail != "") {
	bNoEmail = false;
	logDebug("Lic Holder Email; " + LicHolderEmail);
	}

if (!bNoEmail) {
	emailSubject = "City of Madison Operator License Application " + capIDString + " - Additional Information Required";
	}

if (!bNoEmail) {
	emailText = "<html><body><p>Hello " + firstName + " " + lastName + ",<!p>";
	}

if (!bNoEmail) {
	emailText += "<p>The following additional information is required by " + dateAdd(null,30) + " in order for your Operator license application to be processed;<!p>";
	}

if (!bNoEmail) {
	if(wfComment != null) emailText += "<p> 
	 
	 
	 
	 
	" + wfComment + "<!p>";
	if(wfComment == null) emailText += "<p> 
	 
	 
	 
	 
	Please call Clerk's Office for details<!p>";
	}

if (!bNoEmail) {
	emailText += "<p>If you have any questions, please reply to this email or contact the City of Madison Clerk's Office at 608-266-4601<!p>";
	}

if (!bNoEmail) {
	emailText += "<p>Thank you,<br>City of Madison Clerk's Office<!p><!body><!html>";
	}

if (!bNoEmail) {
	sendAsyncEmail("noreply@cityofmadison.com", "kgrittner@cityofmadison.com", "", emailSubject, emailText + "LicHolderEmail;" + LicHolderEmail, "");
	bPoliceInfoRequestEmailSent = true;
	}

if (bNoEmail) {
	include("EML;Licenses!Clerk!Operator!NA;EmailTemplate");
	}

logDebug("Lic Holder Email; " + LicHolderEmail);
`^
EML;Licenses!Clerk!Operator!NA;PoliceBackgroundCheck^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("EML;GetContactEmail");
for(rec in ca) if (ca[rec]["contactType"] == "License Holder") firstName = ca[rec]["firstName"];
lastName = ca[rec]["lastName"];
sSendTo = lookup("LicClerkOperatorEmailsSendTo", "Intake|Completed");
emailSubject = lookup("LicClerkOperatorEmailsSubject", "Intake|Completed");
emailText = "<html><body>";
emailText += "<p><strong>License Type;<!strong> 
Operator (Bartender)<br><strong>License Application #;<!strong> 
" + capIDString + "<br><strong>Applicant Name;<!strong> 
" + firstName + " " + lastName + "<!p>";
emailText += lookup("LicClerkOperatorEmailsBody", "Intake|Completed");
sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, "", emailSubject, emailText, "");
`^
EML;Licenses!Clerk!Operator!NA;ProvisionalLicense^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("EML;GetContactEmail");
cName = "Operator";
employerEmail = AInfo['ADDITIONAL APPLICANT INFO.Employer Email'];
if (employerEmail == null) {
	employerEmail = "";
	}

emailSubject = "Provisional License Issued (" + capIDString + ") for " + cName;
emailText = "<html><body><p>Hello " + contactFName + " " + contactLName + ",<!p>";
emailText += "<p>Thank you for applying for your operator license. <!p>";
emailText += "<p>Your provisional license has been issued. <!p>";
if (contactEmail != "") {
	puResult = aa.publicUser.getPublicUserByEmail(contactEmail).getOutput();
	}

if (puResult != null) {
	emailText += "<p>You may download you provisional license any time by logging in to <a href='https;!!elam.cityofmadison.com!CitizenAccess!'>City of Madison Licenses & Permits<!a> and following the directions below;<!p>";
	}

if (puResult != null) {
	emailText += "1.  Once logged in, click on 'Search for a License!Registration'.<br>";
	}

if (puResult != null) {
	emailText += "2.  Locate the license number (" + capIDString + ") and click on the number.<br>";
	}

if (puResult != null) {
	emailText += "3.  Find the Documents section near the bottom of the page.  Expand and review!print your documents.<br>";
	}

emailText += "<p>Thank you,<BR>City Clerk<BR>210 Martin Luther King, Jr. Blvd., Room 103<BR>City of Madison, Wisconsin 53703<!p>";
emailText += "<p>608 266 4601 Phone<BR>608 266 4666 Fax<BR>licensing@cityofmadisonDEV.com<!p><!body><!html>";
if (contactEmail != "" && cmnCategory == "Renewal") {
	reportName = "Business License";
	reportViewAttachEmail(false, true, reportName, "noreply@cityofmadisonDEV.com", contactEmail, employerEmail, emailSubject, emailText, true, "");
	}

if (contactEmail != "" && cmnCategory == "NA") {
	reportName = "Business License";
	reportViewAttachEmail(false, true, reportName, "noreply@cityofmadisonDEV.com", contactEmail, employerEmail, emailSubject, emailText, false, "");
	}
`^
EML;Licenses!Clerk!Operator!Renewal;EmployerNotice^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "";
include("EML;GetContactEmail");
emailSubject = "Fees are Ready for Operator Application (" + capIDString + ")";
emailText = "<html><body><p>Hello,<!p>";
emailText += "<p>The operator license application materials for " + contactFName + " " + contactLName + " have been submitted.<!p>";
emailText += "<p>You may now pay the fee(s) for this license.<!p>";
emailText += "<p>A copy of the invoice is attached to this email in PDF format.  You will need Adobe Reader installed to view and!or print this invoice.";
emailText += "If you need the Clerk's Office to mail you a hard copy of this incoice, please let us know using the contact information below.<!p>";
emailText += "Checks, cash, MasterCard and Visa are accepted by the City of Madison Treasurer.<br>";
emailText += "<p>Thank you,<BR>City Clerk<BR>210 Martin Luther King, Jr. Blvd., Room 103<BR>City of Madison, Wisconsin 53703<!p>";
emailText += "<p>608 266 4601 Phone<BR>608 266 4666 Fax<BR>licensing@cityofmadisonDEV.com<!p><!body><!html>";
if (employerEmail != "") {
	reportName = "Business Invoice";
	reportViewAttachEmail(false, true, reportName, "noreply@cityofmadisonDEV.com", employerEmail, contactEmail, emailSubject, emailText, true, "");
	} else {
	reportName = "Business Invoice";
	reportViewAttachEmail(false, true, reportName, "noreply@cityofmadisonDEV.com", contactEmail, contactEmail, emailSubject, emailText, true, "");
	}
`^
EML;Licenses!Clerk!Scrap-Recycling!NA;BackgroundCheckNeeded^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
myContactType = "License Holder";
include("EML;GetContactTypeEmail");
sSendTo = lookup("LicClerkPoliceReviewEmailsSendTo", "Streets Review|Approved");
emailSubject = "New Scrap-Recycling " + lookup("LicClerkPoliceReviewEmailsSubject", "Streets Review|Approved");
emailText = "<html><body>";
emailText += "<p><strong>License Type;<!strong> 
Scrap Recycling<br><strong>License Application #;<!strong> 
" + capIDString + "<br><strong>Applicant Name;<!strong> 
" + businessName + "<!p>";
emailText += lookup("LicClerkPoliceReviewEmailBody", "Streets Review|Approved");
contactEmail = "";
include("CMN;getMPDEmail");
sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, contactEmail, emailSubject, emailText, "");
`^
EML;Licenses!Clerk!Scrap-Recycling!NA;CaptainReviewComplete^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
myContactType = "License Holder";
var sWFStatus = "";
var sWFStatus = "District Captain Review|" + wfStatus;
include("EML;GetContactTypeEmail");
sSendTo = lookup("LicClerkPoliceReviewEmailsSendTo", sWFStatus);
emailSubject = "New Scrap-Recycling " + lookup("LicClerkPoliceReviewEmailsSubject", sWFStatus);
emailText = "<html><body>";
emailText += "<p><strong>LicenseType;<!strong> 
Scrap-Recycle<br><strong>License Application #;<!strong> 
" + capIDString;
if (contactLName != null && contactLName != "") {
	emailText  += "<br><strong>License Holder Name;<!strong> 
	" + contactFName + " " + contactLName;
	}

if (businessName!= null && businessName != "") {
	emailText += "<br><strong>Business Name;<!strong> 
	" + businessName + "<!p>";
	}

emailText += lookup("LicClerkPoliceReviewEmailBody", sWFStatus);
sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, "", emailSubject, emailText, "");
`^
EML;Licenses!Clerk!Scrap-Recycling!NA;PoliceBackgroundCheck^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
myContactType = "License Holder";
var sWFStatus = "";
var sWFStatus = "Background Check|" + wfStatus;
include("EML;GetContactTypeEmail");
sSendTo = lookup("LicClerkPoliceReviewEmailsSendTo", sWFStatus);
emailSubject = "New Scrap-Recycling " + lookup("LicClerkPoliceReviewEmailsSubject", sWFStatus);
emailText = "<html><body>";
emailText += "<p><strong>LicenseType;<!strong> 
Scrap-Recycle<br><strong>License Application #;<!strong> 
" + capIDString;
if (contactLName != null && contactLName != "") {
	emailText  += "<br><strong>License Holder Name;<!strong> 
	" + contactFName + " " + contactLName;
	}

if (businessName!= null && businessName != "") {
	emailText += "<br><strong>Business Name;<!strong> 
	" + businessName + "<!p>";
	}

emailText += lookup("LicClerkPoliceReviewEmailBody", sWFStatus);
sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, "", emailSubject, emailText, "");
`^
EML;Licenses!Clerk!SecondHandBicycleDealer!NA;BackgroundCheck^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
myContactType = "License Holder";
var sWFStatus = "";
var sWFStatus = "Background Check|" + wfStatus;
include("EML;GetContactTypeEmail");
sSendTo = lookup("LicClerkPoliceReviewEmailsSendTo", sWFStatus);
emailSubject = "Second Hand Bicycle Dealer " + lookup("LicClerkPoliceReviewEmailsSubject", sWFStatus);
emailText = "<html><body>";
emailText += "<p><strong>LicenseType;<!strong> 
Second Hand Bicycle Dealer<br><strong>License Application #;<!strong> 
" + capIDString;
if (contactLName != null && contactLName != "") {
	emailText  += "<br><strong>License Holder Name;<!strong> 
	" + contactFName + " " + contactLName;
	}

if (businessName!= null && businessName != "") {
	emailText += "<br><strong>Business Name;<!strong> 
	" + businessName + "<!p>";
	}

if (wfStatus == "Captain Consultation" && wfComment != null) {
	emailText += "<p>Comments; " + wfComment + "<!p>";
	}

emailText += lookup("LicClerkPoliceReviewEmailBody", sWFStatus);
sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, "", emailSubject, emailText, "");
`^
EML;Licenses!Clerk!SecondHandBicycleDealer!NA;BackgroundCheckNeeded^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
myContactType = "License Holder";
include("EML;GetContactTypeEmail");
sSendTo = lookup("LicClerkPoliceReviewEmailsSendTo", "Legistar|Entered");
emailSubject = " New Second Hand Bicycle Dealer " + lookup("LicClerkPoliceReviewEmailsSubject", "Legistar|Entered");
emailText = "<html><body>";
emailText += "<p><strong>License Type;<!strong> 
SecondHandBicycleDealer<br><strong>License Application #;<!strong> 
" + capIDString + "<br><strong>Applicant Name;<!strong> 
" + businessName + "<!p>";
emailText += lookup("LicClerkPoliceReviewEmailBody", "Legistar|Entered");
contactEmail = "";
include("CMN;getMPDEmail");
sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, contactEmail, emailSubject, emailText, "");
`^
EML;Licenses!Clerk!SecondHandBicycleDealer!NA;CaptainReviewComplete^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
myContactType = "License Holder";
var sWFStatus = "";
var sWFStatus = "District Captain Review|" + wfStatus;
include("EML;GetContactTypeEmail");
for(rec in ca) if (ca[rec]["contactType"] == "License Holder") firstName = ca[rec]["firstName"];
lastName = ca[rec]["lastName"];
businessName = ca[rec]["businessName"];
sSendTo = lookup("LicClerkPoliceReviewEmailsSendTo", sWFStatus);
emailSubject = "Second Hand Bicycle Dealer " + lookup("LicClerkPoliceReviewEmailsSubject", sWFStatus);
emailText = "<html><body>";
emailText += "<p><strong>LicenseType;<!strong> 
Second Hand Bicycle Dealer<br><strong>License Application #;<!strong> 
" + capIDString;
if (contactLName != null && contactLName != "") {
	emailText  += "<br><strong>License Holder Name;<!strong> 
	" + contactFName + " " + contactLName;
	}

if (businessName!= null && businessName != "") {
	emailText += "<br><strong>Business Name;<!strong> 
	" + businessName + "<!p>";
	}

emailText += lookup("LicClerkPoliceReviewEmailBody", sWFStatus);
sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, "", emailSubject, emailText, "");
`^
EML;Licenses!Clerk!SecondHandDealer!NA;BackgroundCheckComp^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
myContactType = "License Holder";
var sWFStatus = "";
var sWFStatus = "Background Check|" + wfStatus;
include("EML;GetContactTypeEmail");
sSendTo = lookup("LicClerkPoliceReviewEmailsSendTo", sWFStatus);
emailSubject = lookup("LicClerkPoliceReviewEmailsSubject", sWFStatus) + " - Second Hand Dealer License";
emailText = "<html><body>";
emailText += "<p><strong>LicenseType;<!strong> 
Second Hand Dealer<br><strong>License Application #;<!strong> 
" + capIDString;
if (contactLName != null && contactLName != "") {
	emailText  += "<br><strong>License Holder Name;<!strong> 
	" + contactFName + " " + contactLName;
	}

if (businessName!= null && businessName != "") {
	emailText += "<br><strong>Business Name;<!strong> 
	" + businessName + "<!p>";
	}

if (wfStatus == "Captain Consultation" && wfComment != null) {
	emailText += "<p>Comments; " + wfComment + "<!p>";
	}

emailText += lookup("LicClerkPoliceReviewEmailBody", sWFStatus);
sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, "", emailSubject, emailText, "");
`^
EML;Licenses!Clerk!SecondHandDealer!NA;BackgroundCheckNeeded^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
myContactType = "License Holder";
include("EML;GetContactTypeEmail");
for(rec in ca) if (ca[rec]["contactType"] == "License Holder") firstName = ca[rec]["firstName"];
lastName = ca[rec]["lastName"];
businessName = ca[rec]["businessName"];
sSendTo = lookup("LicClerkPoliceReviewEmailsSendTo", "Legistar|Entered");
emailSubject = "New Second Hand Dealer " + lookup("LicClerkPoliceReviewEmailsSubject", "Legistar|Entered");
emailText = "<html><body>";
emailText += "<p><strong>License Type;<!strong> 
Second Hand Dealer<br><strong>License Application #;<!strong> 
" + capIDString + "<br><strong>Applicant Name;<!strong> 
" + businessName + "<!p>";
emailText += lookup("LicClerkPoliceReviewEmailBody", "Legistar|Entered");
contactEmail = "";
include("CMN;getMPDEmail");
sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, contactEmail, emailSubject, emailText, "");
`^
EML;Licenses!Clerk!SecondHandDealer!NA;CaptainReviewComplete^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
myContactType = "License Holder";
var sWFStatus = "";
var sWFStatus = "District Captain Review|" + wfStatus;
include("EML;GetContactTypeEmail");
sSendTo = lookup("LicClerkPoliceReviewEmailsSendTo", sWFStatus);
emailSubject = lookup("LicClerkPoliceReviewEmailsSubject", sWFStatus) + " - Second Hand Dealer License";
emailText = "<html><body>";
emailText += "<p><strong>LicenseType;<!strong> 
Second Hand Dealer<br><strong>License Application #;<!strong> 
" + capIDString;
if (contactLName != null && contactLName != "") {
	emailText  += "<br><strong>License Holder Name;<!strong> 
	" + contactFName + " " + contactLName;
	}

if (businessName!= null && businessName != "") {
	emailText += "<br><strong>Business Name;<!strong> 
	" + businessName + "<!p>";
	}

emailText += lookup("LicClerkPoliceReviewEmailBody", sWFStatus);
sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, "", emailSubject, emailText, "");
`^
EML;Licenses!Clerk!SecondHandDealer!NoLicense;BackgroundCheckComp^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
var sWFStatus = "";
var sWFStatus = "Police Review|" + wfStatus;
include("EML;GetContactEmail");
for(rec in ca) if (ca[rec]["contactType"] == "License Holder") firstName = ca[rec]["firstName"];
lastName = ca[rec]["lastName"];
businessName = ca[rec]["businessName"];
sSendTo = lookup("LicClerkPoliceReviewEmailsSendTo", sWFStatus);
emailSubject = lookup("LicClerkPoliceReviewEmailsSubject", sWFStatus) + " - Second Hand Dealer";
emailText = "<html><body>";
emailText += "<p><strong>LicenseType;<!strong> 
Second Hand Dealer No License<br><strong>License Application #;<!strong> 
" + capIDString;
if (contactLName != null && contactLName != "") {
	emailText  += "<br><strong>License Holder Name;<!strong> 
	" + contactFName + " " + contactLName;
	}

if (businessName!= null && businessName != "") {
	emailText += "<br><strong>Business Name;<!strong> 
	" + businessName + "<!p>";
	}

emailText += lookup("LicClerkPoliceReviewEmailBody", sWFStatus);
sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, "", emailSubject, emailText, "");
`^
EML;Licenses!Clerk!SecondHandDealer!NoLicense;BackgroundCheckNeeded^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
myContactType = "License Holder";
include("EML;GetContactTypeEmail");
sSendTo = lookup("LicClerkPoliceReviewEmailsSendTo", "License Clerk Review|Under Review");
emailSubject = "New Second Hand Dealer No " + lookup("LicClerkPoliceReviewEmailsSubject", "License Clerk Review|Under Review");
emailText = "<html><body>";
emailText += "<p><strong>License Type;<!strong> 
Second Hand Dealer No License<br><strong>License Application #;<!strong> 
" + capIDString + "<br><strong>Applicant Name;<!strong> 
" + businessName + "<!p>";
emailText += lookup("LicClerkPoliceReviewEmailBody", "License Clerk Review|Under Review");
sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, "", emailSubject, emailText, "");
`^
EML;Licenses!Clerk!SecondHandDealer!NoLicense;CaptainReviewComp^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
myContactType = "License Holder";
var sWFStatus = "";
var sWFStatus = "District Captain Review|" + wfStatus;
include("EML;GetContactTypeEmail");
sSendTo = lookup("LicClerkPoliceReviewEmailsSendTo", sWFStatus);
emailSubject = lookup("LicClerkPoliceReviewEmailsSubject", sWFStatus'] + " - Second Hand Dealer";
emailText = "<html><body>";
emailText += "<p><strong>LicenseType;<!strong> 
Second Hand Dealer No License<br><strong>License Application #;<!strong> 
" + capIDString;
if (contactLName != null && contactLName != "") {
	emailText  += "<br><strong>License Holder Name;<!strong> 
	" + contactFName + " " + contactLName;
	}

if (businessName!= null && businessName != "") {
	emailText += "<br><strong>Business Name;<!strong> 
	" + businessName + "<!p>";
	}

emailText += lookup("LicClerkPoliceReviewEmailBody", sWFStatus);
sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, "", emailSubject, emailText, "");
include("CMN;getMPDEmail");
`^
EML;Licenses!DCR!AA Plan!NA;AdditionalInfo^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = true;
var sEmailTextFile = "AffirmativeActionEmailsBody";
include("CMN;Licenses!DCR!AA Plan!NA;getEmailAddrs");
emailSubject = "AA Plan -- Incomplete -- " + sBizName +" -- "+ cmnCategory + " -- " + capIDString;
emailText = "<html><body><FONT face=calibri>";
if (lookup(sEmailTextFile, "aaSalutation") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "aaSalutation") + "<!p>";
	}

if (cmnCategory == "Public Works" &&  lookup(sEmailTextFile, "IncompleteLine1PW") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "IncompleteLine1PW") + "<!p>";
	}

if (cmnCategory == "CBO" &&  lookup(sEmailTextFile, "IncompleteLine1CBO") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "IncompleteLine1CBO") + "<!p>";
	}

if (cmnCategory == "Vendors and Suppliers" &&  lookup(sEmailTextFile, "IncompleteLine1VS") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "IncompleteLine1VS") + "<!p>";
	}

if (wfComment != null && wfComment != "") {
	emailText += "<p>" + wfComment + "<!p>";
	}

if (lookup(sEmailTextFile, "IncompleteLine2") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "IncompleteLine2") + "<!p>";
	}

if (lookup(sEmailTextFile, "xMarthaSigLine") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "xDanaSignatureLine") + "<!p>";
	}

emailText += "<!body><!html>";
sCcEmail = "KBracey@cityofmadison.com;
";
sCcEmail += "mewhite@cityofmadison.com;
";
if (!bNoEmail) {
	aa.sendEmail("noreply@cityofmadison.com", sToEmail, sCcEmail, emailSubject, emailText, "");
	} else {
	message = "Neither the EEO!AA Officer nor the Contractor contacts has an email address. ";
	cancel = false;
	showMessage = true;
	}
`^
EML;Licenses!DCR!AA Plan!NA;PlanOrDataUpdateApproval^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var sEmailTextFile = "AffirmativeActionEmailsBody";
include("CMN;Licenses!DCR!AA Plan!NA;getEmailAddrs");
emailSubject = "AA Plan --Approved-- " + sBizName +" -- "+ cmnCategory + " -- " + capIDString;
emailText = "<html><body><FONT face=calibri>";
if (lookup(sEmailTextFile, "aaSalutation") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "aaSalutation") + "<!p>";
	}

if (lookup(sEmailTextFile, "ApprovalLine1") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "ApprovalLine1") + "<!p>";
	}

if (wfComment != null && wfComment != "") {
	emailText += "<p>" + wfComment + "<!p>";
	}

if (lookup(sEmailTextFile, "ApprovalLine2") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "ApprovalLine2") + "<!p>";
	}

if (lookup(sEmailTextFile, "ApprovalLine3") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "ApprovalLine3") + "<!p>";
	}

if (lookup(sEmailTextFile, "ApprovalLine4") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "ApprovalLine4") + "<!p>";
	}

if (lookup(sEmailTextFile, "xMarthaSigLine") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "xMarthaSigLine") + "<!p>";
	}

emailText += "<!body><!html>";
if (cmnCategory == "Public Works") {
	sCcEmail += "KBracey@cityofmadison.com;
	";
	}

sCcEmail += "mewhite@cityofmadison.com;
";
if (true) {
	sCcEmail += "KMcCarthy@cityofmadison.com;
	";
	}

if (!bNoEmail) {
	aa.sendEmail("noreply@cityofmadison.com", sToEmail, sCcEmail, emailSubject, emailText, "");
	} else {
	message = "Neither the EEO!AA Officer nor the Contractor contacts has an email address. ";
	cancel = false;
	showMessage = true;
	}
`^
EML;Licenses!DCR!AA Plan!NA;PlanReviewDeveloper^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var sEmailTextFile = "AffirmativeActionEmailsBody";
include("CMN;Licenses!DCR!AA Plan!NA;getEmailAddrs");
emailSubject = "AA Plan - Approved - " + sBizName + " - Individual Developer" +  "-- " + capIDString;
emailText = "<html><body><FONT face=calibri>";
if (lookup(sEmailTextFile, "aaSalutation") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "aaSalutation") + "<!p>";
	}

if (lookup(sEmailTextFile, "DevApprovalLine1") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "DevApprovalLine1") + "<!p>";
	}

if (lookup(sEmailTextFile, "DevApprovalLine2") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "DevApprovalLine2") + "<!p>";
	}

if (lookup(sEmailTextFile, "DevApprovalLine3") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "DevApprovalLine3") + "<!p>";
	}

if (lookup(sEmailTextFile, "DevApprovalLine4") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "DevApprovalLine4") + "<!p>";
	}

if (lookup(sEmailTextFile, "DevApprovalLine5") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "DevApprovalLine5") + "<!p>";
	}

if (lookup(sEmailTextFile, "xMarthaSigLine") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "xMarthaSigLine") + "<!p>";
	}

emailText += "<!body><!html>";
sCcEmail = "mwhite@cityofmadison.com;
";
if (true) {
	sCcEmail += "KMcCarthy@cityofmadison.com;
	";
	}

if (!bNoEmail) {
	aa.sendEmail("noreply@cityofmadison.com", sToEmail, sCcEmail, emailSubject, emailText, "");
	} else {
	message = "Neither the EEO!AA Officer nor the Contractor contacts has an email address. ";
	cancel = false;
	showMessage = true;
	}
`^
EML;Licenses!DCR!AA Plan!NA;PlanReviewExempt^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = true;
planType = " ";
var sEmailTextFile = "AffirmativeActionEmailsBody";
include("CMN;Licenses!DCR!AA Plan!NA;getEmailAddrs");
if (getAppSpecific("GENERAL INFO.Community-Based Organization") == "CHECKED") {
	planType = "14 or fewer CBO";
	}

if (getAppSpecific("GENERAL INFO.Vendor and Supplier")  == "CHECKED") {
	planType = "14 or Fewer V&S";
	}

if (getAppSpecific("GENERAL INFO.Public Works") == "CHECKED") {
	planType = "14 or fewer PW";
	}

emailSubject =  "AA Plan -- Exempt --  " +  sBizName + " -- " + planType + " -- " + capIDString;
emailText = "<html><body><FONT face=calibri>";
if (lookup(sEmailTextFile, "aaSalutation") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "aaSalutation") + "<!p>";
	}

if (lookup(sEmailTextFile, "ExemptionLine1") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "ExemptionLine1") + "<!p>";
	}

if (lookup(sEmailTextFile, "ExemptionLine2") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "ExemptionLine2") + "<!p>";
	}

if (lookup(sEmailTextFile, "ExemptionLine3") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "ExemptionLine3") + "<!p>";
	}

if (lookup(sEmailTextFile, "xMarthaSigLine") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "xMarthaSigLine") + "<!p>";
	}

emailText += "<!body><!html>";
sCcEmail = "mewhite@cityofmadison.com;
";
if (true) {
	sCcEmail += "KMcCarthy@cityofmadison.com;
	";
	}

if (getAppSpecific("GENERAL INFO.Public Works") == "CHECKED") {
	sCcEmail += "KBracey@cityofmadison.com;
	";
	}

if (!bNoEmail) {
	aa.sendEmail("noreply@cityofmadison.com", sToEmail, sCcEmail, emailSubject, emailText, "");
	} else {
	message = "Neither the EEO!AA Officer nor the Contractor contacts has an email address. ";
	cancel = false;
	showMessage = true;
	}
`^
EML;Licenses!DCR!AA Plan!NA;PlanReviewExempt25K^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
planType = " ";
var sEmailTextFile = "AffirmativeActionEmailsBody";
include("CMN;Licenses!DCR!AA Plan!NA;getEmailAddrs");
if (getAppSpecific("GENERAL INFO.Community-Based Organization") == "CHECKED") {
	planType = "$25k or less CBO";
	}

if (getAppSpecific("GENERAL INFO.Public Works") == "CHECKED") {
	planType = "$25k or less PW";
	}

if (getAppSpecific("GENERAL INFO.Vendor and Supplier") == "CHECKED") {
	planType = "$25k or less V&S";
	}

emailSubject =  "AA Plan -- Exempt --  " +  sBizName + " -- " + planType + " -- " + capIDString;
emailText = "<html><body><FONT face=calibri>";
if (lookup(sEmailTextFile, "aaSalutation") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "aaSalutation") + "<!p>";
	}

if (lookup(sEmailTextFile, "Exemption25LIne1") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "Exemption25LIne1") + "<!p>";
	}

if (lookup(sEmailTextFile, "Exemption25Line2") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "Exemption25Line2") + "<!p>";
	}

if (lookup(sEmailTextFile, "Exemption25Line3") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "Exemption25Line3") + "<!p>";
	}

if (lookup(sEmailTextFile, "xMarthaSigLine") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "xMarthaSigLine") + "<!p>";
	}

emailText += "<!body><!html>";
if (true) {
	sCcEmail = "mewhite@cityofmadison.com;
	";
	}

if (getAppSpecific("GENERAL INFO.Public Works") == "CHECKED") {
	sCcEmail += "KBracey@cityofmadison.com;
	";
	}

if (true) {
	sCcEmail += "KMcCarthy@cityofmadison.com;
	";
	}

if (!bNoEmail) {
	aa.sendEmail("noreply@cityofmadison.com", sToEmail, sCcEmail, emailSubject, emailText, "");
	} else {
	message = "Neither the EEO!AA Officer nor the Contractor contacts has an email address. ";
	cancel = false;
	showMessage = true;
	}
`^
EML;Licenses!DCR!AA Plan!NA;ReviewSmallCapTiff^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = true;
planType = " ";
myContactType = "Contact Person";
var bSendEmailOK = false;
include("EML;GetContactTypeEmail");
if (contactEmail != null && contactEmail != "" && contactEmail != "nomail@cityofmadison.com") {
	bSendEmailOK = true;
	}

var sEmailTextFile = "AffirmativeActionEmailsBody";
if (getAppSpecific("GENERAL INFO.Small Cap Tiff") == "CHECKED") {
	planType = "Small Cap Tiff";
	}

emailSubject =  "AA Plan -- Exempt --  " + contactFName + " " + contactLName + " -- "+  planType + " -- " + capIDString;
emailText = "<html><body><FONT face=calibri>";
emailText += "<p>Dear " + contactFName + " " + contactLName + ";<!p>";
if (lookup(sEmailTextFile, "SmallCap1") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "SmallCap1") + "<!p>";
	}

if (lookup(sEmailTextFile, "SmallCap2") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "SmallCap2") + "<!p>";
	}

if (lookup(sEmailTextFile, "xMarthaSigLine") != undefined) {
	emailText += "<p>" + lookup(sEmailTextFile, "xMarthaSigLine") + "<!p>";
	}

emailText += "<!body><!html>";
sCcEmail = "mewhite@cityofmadison.com;
";
if (true) {
	sCcEmail += "KMcCarthy@cityofmadison.com;
	";
	}

if (true) {
	sCcEmail += "tgoldbin@cityofmadison.com;
	";
	}

if (bSendEmailOK) {
	aa.sendEmail("noreply@cityofmadison.com", contactEmail, sCcEmail, emailSubject, emailText, "");
	} else {
	message = "Neither the EEO!AA Officer nor the Contractor contacts has an email address. ";
	cancel = false;
	showMessage = true;
	}
`^
EML;Licenses!Engineering!Prequalified Contractor!Na^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
reportName = aa.util.newHashtable();
var repParams = aa.util.newHashtable();
reportModule = "Licenses";
var params  = aa.util.newHashtable();
getRecordParams4Notification(params);
ca = getContactArray();
getContactParams4Notification(params, ca[0]);
getWorkflowParams4Notification(params);
if (emailType == "Issued") {
	reportName.put(0, "Prequal Approval Letter");
	addParameter(repParams, "ALTID", capIDString);
	}

if (emailType == "Issued") {
	sendNotification("elamsupport@cityofmadison.com", "jschneiderDEV@cityofmadison.com", "", "PREQUALISSUED", params, reportName, repParams, reportModule);
	}

if (emailType == "Amend") {
	sendNotification("elamSupport@cityofmadison.com", "jschneiderDEV@cityofmadison.com", "", "PREQUALADDITIONALINFO", params, reportName, repParams, reportModule);
	}

if (emailType == "AddInfoJo") {
	sendNotification("elamsupport@cityofmadison.com", "jschneiderDEV@cityofmadison.com", "", "PREQUALREVIEW", params, reportName, repParams, reportModule);
	}

if (emailType == "AddInfoKe") {
	sendNotification("elamsupport@cityofmadison.com", "jschneiderDEV@cityofmadison.com", "", "PREQUALREVIEW", params, reportName, repParams, reportModule);
	}
`^
EML;Licenses!Health!FoodandDrink!Madison;PersonalProperty^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
ca = getContactArray();
emailText = "";
businessName = "";
include("CMN;GetDBA");
for (ca1 in ca) if ((ca[ca1]["contactType"]) == "License Holder") include("CMN;GetContactAddress");
emailText = "<p>A license has been issued for a new Madison Food & Drink Establishment.<!p>";
emailText += "<p><b>Application ID;<!b> <a href=" + "" + "https;!!av73dev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=" + cmnGroup + "&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a><br>";
emailText += "<b>License Issue Date;<!b> " + wfDateMMDDYYYY + "<br>";
if (businessName != "" && businessName != null) {
	emailText += "<b>Doing Business As (DBA);<!b> " + businessName + "<br><!p>";
	}

emailText += "<b>Application <!b>";
include("EML;AddressInformation");
emailText += "<b>License Holder business name and address<!b>";
emailText += "<p>" + conBizName + "<br>";
emailText += conAddress1 + "<br>";
if (conAddress2 != "") {
	emailText += conAddress2  + "<br>";
	}

emailText +=  conCity + ", " + conState + "  " + conZip + "<br><!p>";
email("personalproperty@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com","Madison Food & Drink Establishment License Issuance Notification",emailText);
`^
EML;Licenses!Health!Temp Food Establishment!DaneCounty;AppSubmitted^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
myContactType = "License Holder - Temp Food";
sLicHolderName = "";
var sFirstEventName = "";
var sFirstEventDate = "";
var bSendEmailOK = false;
include("EML;GetContactTypeEmail");
if (contactEmail != null && contactEmail != "" && contactEmail != "nomail@cityofmadison.com") {
	bSendEmailOK = true;
	}

if ((businessName == null || businessName == "")) {
	sLicHolderName = contactFName + " " + contactLName;
	} else {
	sLicHolderName = businessName;
	}

var sStaticLine1a = "Thank you for submitting an application for an annual temporary food establishment license.  You will receive your license by email prior to the first event or from your health inspector on the day of that event.  At least one week before your";
var sStaticLine1b = " event, contact the Environmental Health office at 608-242-6515 or email health@publichealthmdc.com . Please ask to speak with the sanitarian that may be inspecting your food stand.  They will review the details of your license to help ensure your stand will be approved to operate.";
var sStaticLine2 = "Next, please review the health department’s temporary food stand requirements; http;!!www.publichealthmdc.com!environmental!food!documents!TempFoodKeyPoints.pdf.";
var sStaticLine3 = "You may also find helpful information, including what to expect during your inspection, on our website; http;!!www.publichealthmdc.com!environmental!food!tempFoodInspections.cfm.";
var sStaticLine4 = "If you have questions, please don’t hesitate to contact Public Health Madison and Dane County – Environmental Health Division.";
sFirstEventName = AInfo['EVENT INFORMATION.Name of First Event'];
sFirstEventDate = AInfo['EVENT INFORMATION.First Event Date'];
reportName = aa.util.newHashtable();
var repParams = aa.util.newHashtable();
reportModule = "Licenses";
var params  = aa.util.newHashtable();
getRecordParams4Notification(params);
addParameter(params, "$$StaticLine1a$$", sStaticLine1a);
addParameter(params, "$$StaticLine1b$$", sStaticLine1b);
addParameter(params, "$$StaticLine2$$", sStaticLine2);
addParameter(params, "$$StaticLine3$$", sStaticLine3);
addParameter(params, "$$StaticLine4$$", sStaticLine4);
addParameter(params, "$$FirstEventName$$", sFirstEventName);
addParameter(params, "$$FirstEventDate$$", sFirstEventDate);
addParameter(params, "$$LicHolderName$$", sLicHolderName);
if (aa.env.getValue("PaymentTotalPaidAmount") == "") {
	sAmtPaid = "$0.00";
	} else {
	sAmtPaid = String(aa.env.getValue("PaymentTotalPaidAmount"));
	}

addParameter(params, "$$AmtPaid$$", sAmtPaid);
!!String(PaymentTotalPaidAmount);
getACARecordParam4Notification(params, madisonACAUrl, "Base");
reportName.put(0, "Temp Food Application");
addParameter(repParams, "AltID", capIDString);
if (bSendEmailOK) {
	sendNotification("noreplyDEV@cityofmadison.com", contactEmail, "jschneider@cityofmadison.com", "TEMPFOODLICACASUBMIT", params, reportName, repParams, reportModule);
	}
`^
EML;Licenses!Health!Temp Food Establishment!DaneCounty;Issued^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
myContactType = "License Holder - Temp Food";
var bSendEmailOK = false;
include("EML;GetContactTypeEmail");
if (contactEmail != null && contactEmail != "" && contactEmail != "nomail@cityofmadisonDEV.com") {
	bSendEmailOK = true;
	}

var sStaticLine1 = "Please print and post the license at your food stand each time you operate.  Failure to provide a current license may result in purchasing another Temporary Food Establishment License from Public Health Madison and Dane County.";
var sStaticLine2 = "In lieu of printing this license, it is acceptable to show a health inspector your emailed license on a Smartphone or other electronic device.";
var sStaticLine3 = "is a food establishment that operates at a fixed location for a period of no more than 14 consecutive days in conjunction with a single event or celebration such as a fair, carnival, circus, public exhibition, anniversary sale, or occasional sales promotion.";
var sStaticLine4 = "license and is valid at all food events in Madison and Dane County until the expiration date on the license.  License renewals are sent in May of each year and you will have the option at this time to renew your";
var sStaticLine5 = "If you operate multiple food stands at the same event or operate a food stand at multiple events occurring on the same day a separate annual license is required for each food stand.";
var sStaticLine6 = "If you have any questions please contact the Environmental Health Office at 608-242-6515 or email health@publichealthmdc.com.";
reportName = aa.util.newHashtable();
var repParams = aa.util.newHashtable();
reportModule = "Licenses";
var params  = aa.util.newHashtable();
getRecordParams4Notification(params);
addParameter(params, "$$StaticLine1$$", sStaticLine1);
addParameter(params, "$$StaticLine2$$", sStaticLine2);
addParameter(params, "$$StaticLine3$$", sStaticLine3);
addParameter(params, "$$StaticLine4$$", sStaticLine4);
addParameter(params, "$$StaticLine5$$", sStaticLine5);
addParameter(params, "$$StaticLine6$$", sStaticLine6);
getACARecordParam4Notification(params, madisonACAUrl, "Base");
reportName.put(0, "Business License");
addParameter(repParams, "AltID", capIDString);
if (bSendEmailOK) {
	sendNotification("noreplyDEV@cityofmadison.com", contactEmail, "jschneider@cityofmadison.com", "TEMPFOODLICISSUED", params, reportName, repParams, reportModule);
	}

if (bSendEmailOK == false) {
	myContactType = "License Holder";
	!!Try previous contact type.;
	}

if (myContactType == "License Holder") {
	include("EML;GetContactTypeEmail");
	}

if (myContactType == "License Holder" && contactEmail != null && contactEmail != "" && contactEmail != "nomail@cityofmadisonDEV.com") {
	bSendEmailOK = true;
	}

if (myContactType == "License Holder" && bSendEmailOK) {
	sendNotification("noreplyDEV@cityofmadison.com", contactEmail, "jschneider@cityofmadison.com", "TEMPFOODLICISSUED", params, reportName, repParams, reportModule);
	}
`^
EML;Licenses!Treasurer!~!~;InfoNeeded^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "noEmail@cityofmadisonDEV.com";
include("EML;GetContactEmail");
reportFile = "";
cName = cmnSubType;
if (contactEmail != "") {
	puResult = aa.publicUser.getPublicUserByEmail(contactEmail).getOutput();
	}

emailSubject = "Information for " + cName + " Application (" + capIDString + ")";
emailText = "<html><body><p>Hello " + contactFName + " " + contactLName + ",<!p>";
emailText += "<p>The information needed was not submitted with your application for a " + cName + " license.<!p>";
if (wfComment != null) {
	emailText += "<p>Comments; " + wfComment + "<!p>";
	}

emailText += "<p>To submit the needed information;<!p>";
emailText += "<p>You may login to <a href='https;!!elam.cityofmadison.com!CitizenAccess!'>City of Madison Licenses & Permits<!a> website to review!attach needed documents or mail the needed documents to the address below.<!p>";
emailText += "Once logged in click on 'Search for a License!Registration'.<br>";
emailText += "Locate the License number (" + capIDString + ") and click on it.<br>";
emailText += "Click on the arrow to the left of the word Attachments.<br>";
emailText += "Search for the file you wish to attach, fill in the appropriate boxes and click Attach.<br>";
emailText += "<p>Please respond promptly, so that we can continue processing the issuance of your license.<!p>";
emailText += "<p>Thank you,<BR>City of Madison Treasurer's Office<BR>City-County Building";
emailText += "<BR>210 Martin Luther King, Jr. Blvd., Room 107<BR>City of Madison, Wisconsin 53701-3324<!p>";
emailText += "<p>608 266 4771 Phone<BR>608 266 4128 Fax<!p><!body><!html>";
if (puResult != "") {
	aa.sendEmail("noreply@cityofmadisonDEV.com", contactEmail, "jmoyer@cityofmadisonDEV.com",  emailSubject, emailText, reportFile);
	}
`^
EML;Licenses!Treasurer!~!~;PetLicAppSubmitted^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
include("EML;GetContactEmail");
logDebug("Applicant Email = " + contactEmail);
if (appTypeArray[2]  == "Chicken Owner") {
	var animalType = "Chicken";
	} else {
	if( appTypeArray[2]  == "Cat Registration") var animalType = "Cat";
	if (appTypeArray[2]  == "Dog Registration") var animalType = "Dog";
	}

emailSubject = "Application Submitted for " + animalType + " License";
emailText = "<html><body><p>Hello " + contactFName + " " + contactLName + ",<!p>";
emailText += "<p>Thank you for submitting your application for a " + animalType + " license .<!p>";
if (appTypeArray[2]  != "Chicken Owner") {
	emailText += "<p>Your application is being reviewed. We will contact you if we require additional information. Otherwise, you will receive the tag(s) by mail.<!p>";
	} else {
	emailText += "<p>Your application is being reviewed. We will contact you if we require additional information. Otherwise, you will receive the license by mail.<!p>";
	}

emailText += "<p>Please keep this number; <b>" + capIDString  + "<!b> for future reference.<!p>";
emailText += "<p>Thank You,<br>City of Madison Treasurer's Office<!p><!body><!html>";
if (contactEmail != null && contactEmail != "") {
	aa.sendEmail("noreply@cityofmadisonDEV.com", contactEmail, "",  emailSubject, emailText,"");
	}
`^
EML;Licenses!Treasurer!~!~;PetLicCitation^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var ad = null;
var oAddress = null;
var sPetType = "";
var sPetName = "";
var sNewOrRenew = "";
var sApplicantName = "{
Applicant Not Found}
";
myContactType = "Applicant";
include("EML;GetContactTypeEmail");
ad = aa.address.getAddressByCapId(capId);
if (ad != null && ad.getSuccess()) {
	oAddress = ad.getOutput();
	}

if (contactFName != null && contactFName != "firstName" && contactLName != null && contactLName != "lastName ") {
	sApplicantName = contactFName + " " + contactLName;
	}

if(cmnSubType == "Cat Registration") sPetType = "Cat";
if (cmnSubType == "Dog Registration") sPetType = "Dog";
if (sPetType == "Dog") {
	sPetName = AInfo['ANIMAL DETAILS.Name of Dog'];
	sPetType == "Cat";
	} else {
	sPetName = AInfo['ANIMAL DETAILS.Name of Cat'];
	}

if(cmnCategory == "NA") sNewOrRenew = "New";
if(cmnCategory == "Renewal") sNewOrRenew = "Renewal";
emailSubject = sNewOrRenew + " " + sPetType + " Registration Has Citation";
emailText = "<p>License application " + capIDString + " has been filed by " + sApplicantName + " in relation to a failure to license citation.<!p>";
emailText += "<p><strong>License Type;<!strong> 
" + appTypeString + "<br>";
emailText += "<strong>License #;<!strong> 
" + capIDString + "<br>";
emailText += "<strong>Applicant Name;<!strong> 
" + sApplicantName + "<br>";
if (oAddress != null) {
	emailText += "<strong>Address;<!strong> 
	" + oAddress[0].displayAddress + "<br>";
	}

emailText += "<strong>" + sPetType + " Name;<!strong> " + sPetName + "<br>";
emailText += "<strong>Breed;<!strong> " + AInfo['ANIMAL DETAILS.Breed'] + "<br>";
emailText += "<strong>Sex;<!strong> " + AInfo['HEALTH STATUS.Spayed or Neutered'] + "<br>";
emailText += "<strong>Color and Markings;<!strong> " + AInfo['ANIMAL DETAILS.Color and Markings'] + "<!p>";
aa.sendEmail("noreply@cityofmadisonDEV.com", "jschneider@cityofmadison.com", "",  emailSubject, emailText,"");
`^
EML;Licenses!Vending!~!~;AppSubmitted^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "noEmail@cityofmadisonDEV.com";
include("EML;GetContactEmail");
reportFile = "";
cName = "Undefined CAP";
!!include("CMN;Store_Report_To_Disk");
include("CMN;Licenses!Vending!~!~;AppName");
exp = aa.expiration.getLicensesByCapID(capId).getOutput().getExpDateString();
emailSubject = "Application " + capIDString + " Submitted for " + cName;
emailText = "<html><body><p>Hello " + contactFName + " " + contactLName + ",<!p>";
emailText += "<p>Thank you for submitting your application for a " + cName + " license. <!p>";
emailText += "<p>Your " + cName + " license application (" + capIDString + ") has been received and is being reviewed by the City of Madison Street Vending Coordinator.<!p>";
emailText += "<p>Please keep this number available to apply for additional licenses and for future reference. <!p>";
emailText += "<p>Pending issuance of this license, the expected expiration date will be;  " + exp + ".<!p>";
emailText += "<p>Attached you will find the details of your application. Note that these details may change due to availability.<!p>";
emailText += "<p>Additional emails will be sent at key points in the process as reminders of action needed or updates in the status of your application.<!p>";
emailText += "<p>Thank you,<BR>Meghan Blake-Horst<BR>Street Vending Coordinator<BR>Office of Business Resources<BR>Department of Planning & Community & Economic Development";
emailText += "<BR>30 W Mifflin Street<BR>P.O. Box 2983<BR>City of Madison, Wisconsin 53703<!p>";
emailText += "608 261 9171 Phone<BR>608 261 6126 Fax<BR>mblake-horst@cityofmadison.com<!body><!html>";
aa.sendEmail("mblake-horst@cityofmadisonDEV.com", contactEmail, "jgoltz@cityofmadisonDEV.com", emailSubject, emailText, reportFile);
`^
EML;Licenses!Vending!~!~;CRCAAppSubmitted^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "noEmail@cityofmadisonDEV.com";
include("EML;GetCurrentUserEmail");
reportFile = "";
cName = "Undefined CAP";
include("CMN;Licenses!Vending!~!~;AppName");
exp = aa.expiration.getLicensesByCapID(capId).getOutput().getExpDateString();
emailSubject = "Application " + capId.getCustomID() + " Submitted for " + cName;
emailText = "<html><body><p>Hello " + userFirst + " " + userLast + ",<!p>";
emailText += "<p>Thank you for submitting your application for a " + cName + " license .<!p>";
emailText += "<p>Your  " + cName + " license application (" + capId.getCustomID() + ") has been received and is being reviewed by the City of Madison Street Vending Coordinator.<!p>";
emailText += "<p>Please keep this number available to apply for additional licenses and for future reference. <!p>";
emailText += "<p>Pending issuance of this license, the expected expiration date will be; " + exp + ".<!p>";
emailText += "<p>Attached you will find the details of your application. Note that these details may change due to availability.<!p>";
emailText += "<p>You may login to the <a href='https;!!elam.cityofmadison.com!CitizenAccess!'>City of Madison Licenses & Permits<!a> website to review the status of your application, pay fees when they are available for payment, view the license and!or receipt when they are available, and attach needed documents.<!p>";
emailText += "<p>Additional emails will be sent at key points in the process as reminders of action needed or updates in the status of your application.<!p>";
emailText += "<p>Thank you,<BR>Meghan Blake-Horst<BR>Street Vending Coordinator<BR>Office of Business Resources<BR>Department of Planning & Community & Economic Development";
emailText += "<BR>30 W Mifflin Street<BR>P.O. Box 2983<BR>City of Madison, Wisconsin 53703<!p>";
emailText += "608 261 9171 Phone<BR>608 261 6126 Fax<BR>mblake-horst@cityofmadison.com<!body><!html>";
aa.sendEmail("mblake-horst@cityofmadisonDEV.com", contactEmail, "jgoltz@cityofmadison.com",  emailSubject, emailText, reportFile);
`^
EML;Licenses!Vending!~!~;CRCRenewalSubmitted^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "noEmail@cityofmadisonDEV.com";
include("EML;GetCurrentUserEmail");
reportFile = "";
cName = "Undefined CAP";
include("CMN;Licenses!Vending!~!~;AppName");
emailSubject = "License Renewal Submitted for " + cName;
emailText = "<html><body><p>Hello " + userFirst + " " + userLast + ",<!p>";
emailText += "<p>Thank you for submitting your application for a " + cName + " license .<!p>";
emailText += "<p>Your  " + cName + " license application has been received and is being reviewed by the City of Madison Street Vending Coordinator.<!p>";
emailText += "<p>You may login to the <a href='https;!!elam.cityofmadison.com!CitizenAccess!'>City of Madison Licenses & Permits<!a> website to review the status of your application, pay fees when they are available for payment, view the license and!or receipt when they are available, and attach needed documents.<!p>";
emailText += "<p>Additional emails will be sent at key points in the process as reminders of action needed or updates in the status of your application.<!p>";
emailText += "<p>Thank you,<BR>Meghan Blake-Horst<BR>Street Vending Coordinator<BR>Office of Business Resources<BR>Department of Planning & Community & Economic Development";
emailText += "<BR>30 W Mifflin Street<BR>P.O. Box 2983<BR>City of Madison, Wisconsin 53703<!p>";
emailText += "608 261 9171 Phone<BR>608 261 6126 Fax<BR>mblake-horst@cityofmadison.com<!body><!html>";
aa.sendEmail("mblake-horst@cityofmadisonDEV.com", userEmail, "jgoltz@cityofmadisonDEV.com",  emailSubject, emailText, reportFile);
`^
EML;Licenses!Vending!~!~;FeesPaid^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "noEmail@cityofmadisonDEV.com";
bDue = PaymentTotalPaidAmount - PaymentTotalPaidAmount;
include("EML;GetContactEmail");
reportFile = "";
cName = "Undefined CAP";
include("CMN;Licenses!Vending!~!~;AppName");
emailSubject = "Fees are Paid for " + cName + " Application (" + capIDString + ")";
emailText = "<html><body><p>Hello " + contactFName + " " + contactLName + ",<!p>";
emailText += "<p>The fees for your " + cmnSubType + " application have been paid.<!p>";
if (cName == "Merchant Vendor") {
	emailText += "<p>The number of display cases allowed is " + getAppSpecific("OPERATIONS.Number of Display Units Allowed (Table or Racks)") + ".<!p>";
	}

if (contactEmail != "") {
	puResult = aa.publicUser.getPublicUserByEmail(contactEmail).getOutput();
	}

if (puResult != null) {
	emailText += "<p>If you wish to have a paper copy, please go to the <a href='https;!!elam.cityofmadison.com!CitizenAccess!'>City of Madison Licenses & Permits<!a> website to view!download your receipt.<!p>";
	}

emailText += "<p> 
 
 
 
Payment Date; 
 
" + PaymentDate + "<br>";
emailText += " 
 
 
 
Payment Method; 
 
" + PaymentMethod + "<br>";
emailText += " 
 
 
 
Amount Due; 
 
$" + String(Number(PaymentTotalPaidAmount).toFixed(2)) + "<br>";
emailText += " 
 
 
 
Amount Paid; 
 
$" + String(Number(PaymentTotalPaidAmount).toFixed(2)) + "<br>";
emailText += " 
 
 
 
-------------------------------------------------<br>";
emailText += "  
 
 
 
Balance Due; 
 
$" + bDue + "<br><!p>";
emailText += "<p>Thank you,<BR>Meghan Blake-Horst<BR>Street Vending Coordinator<BR>Office of Business Resources<BR>Department of Planning & Community & Economic Development";
emailText += "<BR>30 W Mifflin Street<BR>P.O. Box 2983<BR>City of Madison, Wisconsin 53703<!p>";
emailText += "<p>608 261 9171 Phone<BR>608 261 6126 Fax<BR>mblake-horst@cityofmadison.com<!p><!body><!html>";
if (contactEmail != "") {
	aa.sendEmail("mblake-horst@cityofmadisonDEV.com", contactEmail, "jgoltz@cityofmadisonDEV.com",  emailSubject, emailText, reportFile);
	}
`^
EML;Licenses!Vending!~!~;FeesReady^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
contactEmail = "noEmail@cityofmadisonDEV.com";
include("EML;GetContactEmail");
reportFile = "";
cName = "Undefined CAP";
include("CMN;Licenses!Vending!~!~;AppName");
emailSubject = "Fees are Ready for " + cName + " Application (" + capIDString + ")";
emailText = "<html><body><p>Hello " + contactFName + " " + contactLName + ",<!p>";
emailText += "<p>The application materials for your " + cName + " license have been successfully processed and approved.<!p>";
if (cName == "Mall Food Vendor" && AInfo['Mall Food Daily Site'] != null) {
	emailText += "<p>I accept the daily site of " + AInfo['Mall Food Daily Site'] + ".<!p>";
	}

if (cName == "Mall Food Vendor" && AInfo['Mall Food Saturday Site'] != null) {
	emailText += "<p>I accept the Saturday site of " + AInfo['Mall Food Saturday Site'] + ".<!p>";
	}

if (contactEmail != "") {
	puResult = aa.publicUser.getPublicUserByEmail(contactEmail).getOutput();
	}

if (puResult == null) {
	emailText += "<p>You may now pay your fee(s).  Please mail a check to the address below.  Checks are payable to City Treasurer.<!p>";
	}

if (puResult != null) {
	emailText += "<p>You may now pay your fee(s).  Directions below;<!p>";
	}

if (puResult != null) {
	emailText += "<p>Please login to the <a href='https;!!elam.cityofmadison.com!CitizenAccess!'>City of Madison Licenses & Permits<!a> website to pay the fees.<br>";
	}

if (puResult != null) {
	emailText += "Once logged in click on 'Search for a License!Registration'.<br>";
	}

if (puResult != null) {
	emailText += "Locate the License number (" + capIDString + ").<br>";
	}

if (puResult != null) {
	emailText += "In the Status column click on the 'Pay Fees Due' and follow the remaining steps.<br>";
	}

if (puResult != null) {
	emailText += "MasterCard and Visa are accepted by the City of Madison.<br>";
	}

if (puResult != null) {
	emailText += "You are able to print a receipt at the end of the process.<br>";
	}

emailText += "<p>Thank you,<BR>Meghan Blake-Horst<BR>Street Vending Coordinator<BR>Office of Business Resources<BR>Department of Planning & Community & Economic Development";
emailText += "<BR>30 W Mifflin Street<BR>P.O. Box 2983<BR>City of Madison, Wisconsin 53703<!p>";
emailText += "<p>608 261 9171 Phone<BR>608 261 6126 Fax<BR>mblake-horst@cityofmadison.com<!p><!body><!html>";
if (contactEmail != "") {
	aa.sendEmail("mblake-horst@cityofmadisonDEV.com", contactEmail, "jgoltz@cityofmadison.com",  emailSubject, emailText, reportFile);
	}
`^
EML;Licenses!Vending!~!~;HealthComplete^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
reportFile = "";
cName = "Undefined CAP";
include("CMN;Licenses!Vending!~!~;AppName");
emailSubject = "Health Inspection for " + cName + " Application (" + capIDString + ")";
emailText = "<html><body><p>Hello Meghan,<!p>";
emailText += "<p>The Health Department reviewed the application for a " + cName + " license and it was  " + wfStatus +".<!p>";
emailText += "<p>If no reason is given below someone will be in contact with you.<!p>";
if (wfComment != null) {
	emailText += "<p>Reason; " + wfComment + "<!p>";
	}

aa.sendEmail("bcleary@cityofmadisonDEV.com", "jgoltz@cityofmadisonDEV.com", "jgoltz@cityofmadisonDEV.com",  emailSubject, emailText, reportFile);
`^
EML;Licenses!Vending!~!~;InformHealth^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
reportFile = "";
cName = "Undefined CAP";
include("CMN;Licenses!Vending!~!~;AppName");
emailSubject = "Health Inspection for " + cName + " Application (" + capIDString + ")";
emailText = "<html><body><p>Hello Beth Cleary,<!p>";
emailText += "<p>The Vending License application above needs the Health Departments attention.<!p>";
emailText += "<p>Once the Health Department has done its review please approve the task.<!p>";
emailText += "<p>Thank you,<BR>Warren Hansen<BR>Street Vending Coordinator<!p><!body><!html>";
aa.sendEmail("mblake-horst@cityofmadisonDEV.com", "jmoyer@cityofmadisonDEV.com", "jgoltz@cityofmadisonDEV.com",  emailSubject, emailText, reportFile);
`^
EML;Licenses!Vending!~!~;InsDeclined^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "noEmail@cityofmadisonDEV.com";
include("EML;GetContactEmail");
reportFile = "";
cName = "Undefined CAP";
include("CMN;Licenses!Vending!~!~;AppName");
emailSubject = "Insurance for " + cName + " Application (" + capIDString + ")";
emailText = "<html><body><p>Hello " + contactFName + " " + contactLName + ",<!p>";
emailText += "<p>The insurance you submitted on your application for a " + cName + " license was denied. <!p>";
emailText += "<p>If no reason is given below someone will be in contact with you.<!p>";
if (wfComment != null) {
	emailText += "<p>Reason; " + wfComment + "<!p>";
	}

emailText += "<p>The application process for this application(" + capIDString + ") has closed.<!p>";
emailText += "<p>Thank you,<BR>Meghan Blake-Horst<BR>Street Vending Coordinator<BR>Office of Business Resources<BR>Department of Planning & Community & Economic Development";
emailText += "<Btrue;
emailText += "<p>608 261 9171 Phone<BR>608 261 6126 Fax<BR>mblake-horst@cityofmadison.com<!p><!body><!html>";
aa.sendEmail("mblake-horst@cityofmadisonDEV.com", "jgoltz@cityofmadison.com", "jgoltz@cityofmadisonDEV.com",  emailSubject, emailText, reportFile);
`^
EML;Licenses!Vending!~!~;InsInfo^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "noEmail@cityofmadisonDEV.com";
include("EML;GetContactEmail");
reportFile = "";
cName = "Undefined CAP";
include("CMN;Licenses!Vending!~!~;AppName");
emailSubject = "Insurance for " + cName + " Application (" + capIDString + ")";
emailText = "<html><body><p>Hello " + contactFName + " " + contactLName + ",<!p>";
emailText += "<p>The insurance you submitted on your application for a " + cName + " license was incomplete. <!p>";
emailText += "<p>If no reason is given below someone will be in contact with you.<!p>";
if (wfComment != null) {
	emailText += "<p>Reason; " + wfComment + "<!p>";
	}

if (contactEmail != "") {
	puResult = aa.publicUser.getPublicUserByEmail(contactEmail).getOutput();
	}

if (puResult != null) {
	emailText += "<p>You may login to <a href='https;!!elam.cityofmadison.com!CitizenAccess!'>City of Madison Licenses & Permits<!a> website to review!attach needed documents.<!p>";
	} else {
	emailText += "<p>Contact the Street Vending Coordinator to correct this issue.<!p>";
	}

emailText += "<p>The application process will not continue until this matter is completed.<!p>";
emailText += "<p>Thank you,<BR>Meghan Blake-Horst<BR>Street Vending Coordinator<BR>Office of Business Resources<BR>Department of Planning & Community & Economic Development";
emailText += "<BR>30 W Mifflin Street<BR>P.O. Box 2983<BR>City of Madison, Wisconsin 53703<!p>";
emailText += "<p>608 261 9171 Phone<BR>608 261 6126 Fax<BR>whansen@cityofmadisonDEV.com<!p><!body><!html>";
if (contactEmail != "") {
	aa.sendEmail("mblake-horst@cityofmadisonDEV.com", contactEmail, "jgoltz@cityofmadisonDEV.com",  emailSubject, emailText, reportFile);
	}
`^
EML;Licenses!Vending!~!~;InsNeeded^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "noEmail@cityofmadisonDEV.com";
include("EML;GetContactEmail");
reportFile = "";
cName = "Undefined CAP";
include("CMN;Licenses!Vending!~!~;AppName");
emailSubject = "Insurance for " + cName + " Application (" + capIDString + ")";
emailText = "<html><body><p>Hello " + contactFName + " " + contactLName + ",<!p>";
emailText += "<p>The insurance information needed was not submitted with your application for a " + cName + " license.<!p>";
emailText += "<p>To submit the insurance;<!p>";
if (contactEmail != "") {
	puResult = aa.publicUser.getPublicUserByEmail(contactEmail).getOutput();
	}

if (puResult != null) {
	emailText += "<p>You may login to <a href='https;!!elam.cityofmadison.com!CitizenAccess!'>City of Madison Licenses & Permits<!a> website to review!attach needed documents or mail the needed documents to the address below.<!p>";
	} else {
	emailText += "<p>Please, mail the needed documents to the address below.<!p>";
	}

if (puResult != null) {
	emailText += "Once logged in click on 'Search for a License!Registration'.<br>";
	}

if (puResult != null) {
	emailText += "Locate the License number (" + capIDString + ") and click on it.<br>";
	}

if (puResult != null) {
	emailText += "Click on the arrow to the left of the word Attachments.<br>";
	}

if (puResult != null) {
	emailText += "Search for the file you wish to attach, fill in the appropriate boxes and click Attach.<br>";
	}

emailText += "<p>The application process will not continue until this matter is resolved.<!p>";
emailText += "<p>Thank you,<BR>Warren Hansen<BR>Street Vending Coordinator<BR>Office of Business Resources<BR>Department of Planning & Community & Economic Development";
emailText += "<BR>215 Martin Luther King, Jr. Blvd., Room 312<BR>P.O. Box 2983<BR>City of Madison, Wisconsin 53701-2983<!p>";
emailText += "<p>608 261 9171 Phone<BR>608 261 6126 Fax<BR>whansen@cityofmadisonDEV.com<!p><!body><!html>";
if (contactEmail != "") {
	aa.sendEmail("whansen@cityofmadisonDEV.com", contactEmail, "jmoyer@cityofmadisonDEV.com",  emailSubject, emailText, reportFile);
	}
`^
EML;Licenses!Vending!~!~;LicenseIssued^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
reportFile = "";
include("EML;GetContactEmail");
cName = "Undefined CAP";
include("CMN;Licenses!Vending!~!~;AppName");
include("CMN;Vending_Store_Report_To_Disk");
emailSubject = "License Issued (" + capIDString + ") for " + cName;
emailText = "<html><body><p>Hello " + contactFName + " " + contactLName + ",<!p>";
emailText += "<p>Thank you for applying for and receiving your " + cName + " license. <!p>";
emailText += "<p>Your license has been issued. If you did not apply online, you will receive a copy of your license in a separate email.<!p>";
if (contactEmail != "") {
	puResult = aa.publicUser.getPublicUserByEmail(contactEmail).getOutput();
	}

if (puResult != null) {
	emailText += "<p>At any time you may login to <a href='https;!!elam.cityofmadison.com!CitizenAccess!'>City of Madison Licenses & Permits<!a> website to download the license from attached documents.  Directions below;<!p>";
	}

if (puResult != null) {
	emailText += "Once logged in click on 'Search for a License!Registration'.<br>";
	}

if (puResult != null) {
	emailText += "Locate the License number (" + capIDString + ") and click on the number.<br>";
	}

if (puResult != null) {
	emailText += "Near the bottom of the page is the Documents section.  Expand and review!print your documents.<br>";
	}

emailText += "<p>Thank you,<BR>Meghan Blake-Horst<BR>Street Vending Coordinator<BR>Office of Business Resources<BR>Department of Planning & Community & Economic Development";
emailText += "<BR>30 W Mifflin Street<BR>P.O. Box 2983<BR>City of Madison, Wisconsin 53703<!p>";
emailText += "<p>608 261 9171 Phone<BR>608 261 6126 Fax<BR>mblake-horst@cityofmadison.com<!p><!body><!html>";
if (contactEmail != "") {
	aa.sendEmail("mblake-horst@cityofmadisonDEV.com", contactEmail, "jgoltz@cityofmadison.com",  emailSubject, emailText, reportFile);
	}
`^
EML;LOCALHISTDIST^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emailText = "<html><body><p>Notice of Permit Application on a Address in the Local Historic District <!p>";
emailSubject = "Local Historical District Notification " + capIDString + " - Permit App Submitted";
emailText += "<b>Category<!b> " + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
include("EML;AddressInformation");
emailText += "<p>For Additional Information please log into Accela<!p>";
email("rsjachrani@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
email("kgrittner@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
email("GLabelle-Brown@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
`^
EML;LOCALHISTDISTENFORCEMENT^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emailText = "<html><body><p>Notice of Enforcement Case on an Address in a Local Historic District <!p>";
emailSubject = "Local Historical District Notification " + capIDString + " - Enforcement Case";
emailText += "<b>Category<!b> " + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
emailText += "<b>CAP<!b> <a href=" + "" + "https;!!av.cityofmadison.com!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=Permitting&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a><br><br>";
emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
include("EML;AddressInformation");
emailText += "<p>For Additional Information please log into Accela<!p>";
email("rsjachrani@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
email("kgrittner@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
`^
EML;LOCALLANDMARK^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
emailText = "<html><body><p>Notice of Permit Application on an Address Adjacent to a Landmark<!p>";
emailSubject = "Landmark Proximity Notification " + capIDString + " - Permit App Submitted";
emailText += "<b>Category<!b> " + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
include("EML;AddressInformation");
emailText += "<p>For Additional Information please log into Accela<!p>";
email("rsjachrani@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
email("kgrittner@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
email("GLabelle-Brown@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
`^
EML;LOCALLANDMARKENFORCEMENT^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emailText = "<html><body><p>Notice of Enforcement Case on an Address Adjacent to a Landmark<!p>";
emailSubject = "Landmark Proximity Notification " + capIDString + " - Enforcement Case";
emailText += "<b>Category<!b> " + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
emailText += "<b>CAP<!b> <a href=" + "" + "https;!!av.cityofmadison.com!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=Permitting&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a><br><br>";
emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
include("EML;AddressInformation");
emailText += "<p>For Additional Information please log into Accela<!p>";
email("rsjachrani@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
email("kgrittner@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
`^
EML;LOCALLANDMARKSITE^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
emailText = "<html><body><p>Notice of Permit Application on an Address which is a Landmark<!p>";
emailSubject = "Landmark Notification " + capIDString + " - Permit App Submitted";
emailText += "<b>Category<!b> " + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
include("EML;AddressInformation");
emailText += "<p>For Additional Information please log into Accela<!p>";
email("rsjachrani@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
email("kgrittner@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
email("GLabelle-Brown@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
`^
EML;LOCALLANDMARKSITEENFORCEMENT^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
emailText = "<html><body><p>Notice of Enforcement Case on an Address which is a Landmark Site<!p>";
emailSubject = "Landmark Notification " + capIDString + " - Enforcement Case";
emailText += "<b>Category<!b> " + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
emailText += "<b>CAP<!b> <a href=" + "" + "https;!!av.cityofmadison.com!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=Permitting&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a><br><br>";
emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
include("EML;AddressInformation");
emailText += "<p>For Additional Information please log into Accela<!p>";
email("rsjachrani@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
email("kgrittner@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
`^
EML;LOCALURBANDESIGN^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
emailText = "<html><body><p>Notice of Permit Application on an Address in an Urban Design District <!p>";
emailSubject = "Urban Design District Notification " + capIDString + " - Permit App Submitted";
emailText += "<b>Category<!b> " + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
include("EML;AddressInformation");
emailText += "<p>For Additional Information please log into Accela<!p>";
email("rsjachrani@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
email("kgrittner@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
email("GLabelle-Brown@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
`^
EML;LOCALURBANDESIGNENFORCEMENT^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emailText = "<html><body><p>Notice of Enforcement Case on an Address in an Urban Design District <!p>";
emailSubject = "Urban Design District Notification " + capIDString + " - Enforcement Case";
emailText += "<b>Category<!b> " + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
emailText += "<b>CAP<!b> <a href=" + "" + "https;!!av.cityofmadison.com!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=Permitting&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a><br><br>";
emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
include("EML;AddressInformation");
emailText += "<p>For Additional Information please log into Accela<!p>";
email("rsjachrani@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
email("kgrittner@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
`^
EML;NewLicenseApp^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
LicContactType = "";
DefaultContactType = "";
var cName = "";
contactFName = "";
contactLName = "";
contactPhone1 = "";
bizContactEmail = "";
ad = aa.address.getAddressByCapId(capId).getOutput();
if (cmnSubType == "CigaretteTobaccoProduct") {
	cName = "Cigarettes!Tobacco Product";
	LicContactType = "";
	}

if (cmnSubType == "AdultEntertainment") {
	cName = "Adult Entertainment";
	LicContactType = "Applicant";
	}

if (cmnSubType == "AmusementDevice") {
	cName = "Amusement Device";
	LicContactType = "Applicant";
	}

if (cmnSubType == "AutoSalvageJunkDealer") {
	cName = "Auto Salvage Junk Dealer";
	LicContactType = "Applicant";
	}

if (cmnSubType == "BicycleDealer") {
	cName = "Bicycle Dealer";
	LicContactType = "Applicant";
	}

if (cmnSubType == "ClassABeerLiquor") {
	cName = "Class A Beer & Liquor";
	LicContactType = "Applicant";
	}

if (cmnSubType == "ClassBBeerLiquor") {
	cName = "Class B Beer & Liquor";
	LicContactType = "Applicant";
	}

if (cmnSubType == "Entertainment") {
	cName = "Entertainment";
	LicContactType = "Applicant or Contact";
	}

if (cmnSubType == "HorseDrawnOrPedalCab") {
	cName = "Horse-Drawn or Pedal Cab";
	LicContactType = "Applicant";
	}

if (cmnSubType == "MallSecondHandDealer") {
	cName = "Mall Second Hand Dealer";
	LicContactType = "Applicant";
	}

if (cmnSubType == "ParaTransitOperating") {
	cName = "Taxicab Company License Application";
	LicContactType = "Applicant";
	}

if (cmnSubType == "PremiseChange") {
	cName = "Premise Change";
	LicContactType = "Applicant";
	}

if (cmnSubType == "Scrap-Recycling") {
	cName = "Scrap!Recycling";
	LicContactType = "Applicant";
	}

if (cmnSubType == "SecondHandBicycleDealer") {
	cName = "Second Hand Bicycle Dealer";
	LicContactType = "Applicant";
	}

if (cmnSubType == "SecondHandDealer") {
	cName = "Second Hand Dealer";
	LicContactType = "Applicant";
	}

if (cmnSubType == "SecondHandTextBook") {
	cName = "Second-Hand Text Book";
	LicContactType = "Applicant";
	}

if (cmnSubType == "TransLocLiquorBeerLicense") {
	cName = "Transfer of Location of Liquor!Beer License";
	LicContactType = "Applicant";
	}

if (cmnSubType == "Theatre") {
	cName = "Theatre";
	LicContactType = "Applicant";
	}

if (cmnSubType == "HazardousMaterials") {
	cName = "Fire - HazMat";
	LicContactType = "Applicant";
	}

if (cmnSubType == "SpecialHazards") {
	cName = "Fire - Special Hazards";
	LicContactType = "Applicant";
	}

if (cmnSubType == "SpecialOccupancy") {
	cName = "Fire - Special Occupancy";
	LicContactType = "Applicant";
	}

if (cmnSubType == "Beach") {
	cName = "Beach";
	LicContactType = "Applicant or Contact";
	}

if (cmnSubType == "BedAndBreakfast") {
	cName = "Bed And Breakfast";
	LicContactType = "Applicant or Contact";
	}

if (cmnSubType == "Campgrounds") {
	cName = "Campgrounds";
	LicContactType = "Applicant or Contact";
	}

if (cmnSubType == "DischofNonStrmwtr") {
	cName = "Discharge of Non Storm Water";
	LicContactType = "Applicant or Contact";
	}

if (cmnSubType == "FoodandDrink") {
	cName = "Food and Drink";
	LicContactType = "Applicant or Contact";
	}

if (cmnSubType == "HotelMotelTRH") {
	cName = "Hotel!Motel!Tourist Rooming House";
	LicContactType = "Applicant or Contact";
	}

if (cmnSubType == "MobileHomePark") {
	cName = "Mobile Home Park";
	LicContactType = "Applicant or Contact";
	}

if (cmnSubType == "Outdoor Wood Boiler") {
	cName = "Outdoor Wood Boiler";
	LicContactType = "";
	}

if (cmnSubType == "RecreationEducationCamps") {
	cName = "RecreationEducationCamps";
	LicContactType = "Applicant or Contact";
	}

if (cmnSubType == "School") {
	cName = "School";
	LicContactType = "Applicant or Contact";
	}

if (cmnSubType == "SwimmingPool") {
	cName = "Swimming Pool";
	LicContactType = "Applicant or Contact";
	}

if (cmnSubType == "TattooAndOrBodyPiercing") {
	cName = "Tattoo Body Piercing";
	LicContactType = "Applicant or Contact";
	}

include("CMN;getDBA");
var dba = null;
contactEmail = "";
if (businessName) {
	dba = businessName;
	}

DefaultContactType = "License Holder";
include("EML;GetContactNewLicense");
emailSubject = cName + " License; " + capIDString;
include("CMN;getAlderDist");
emailText = "<html><body><p>A new " + cName +  " license has been applied for in your district.<!p><p>Contact Name!Phone!Email; " + contactFName + " " + contactLName + " 
 
" + contactPhone1 + " 
 
" +  bizContactEmail + "<!p>";
if ((dba != null)) {
	emailText += "<p>Establishment Name; " + dba + "<!p>";
	}

if ((ad[0] != null && ad[0].toString().length() > 0)) {
	emailText += "<p>Address; " + ad[0] + "<!p><!body><!html>";
	}

contactEmail = "";
include("CMN;getMPDEmail");
if ((cName ==  "Class A Beer & Liquor" || cName == "Class B Beer & Liquor") && (contactEmail !="" &&  contactEmail != null)) {
	aa.sendEmail("noreply@cityofmadisonDEV.com", "elamsupport@cityofmadisonDEV.com", "", emailSubject+" (for; "+contactEmail+")", emailText, "");
	}

if ((cName ==  "Class A Beer & Liquor" || cName == "Class B Beer & Liquor") && (contactEmail !="" &&  contactEmail != null)) {
	emailText = "";
	}

if ((cName ==  "Class A Beer & Liquor" || cName == "Class B Beer & Liquor") && (contactEmail !="" &&  contactEmail != null)) {
	emailText = "<html><body><p>A new " + cName +  " license has been applied for in the City of Madison.<!p><p>Contact Name!Phone; " + contactFName + " " + contactLName + " " + contactPhone1 + "<!p>";
	}

if ((cName ==  "Class A Beer & Liquor" || cName == "Class B Beer & Liquor") && (contactEmail !="" &&  contactEmail != null) && (dba != null)) {
	emailText += "<p>Establishment Name; " + dba + "<!p>";
	}

if ((cName ==  "Class A Beer & Liquor" || cName == "Class B Beer & Liquor") && (contactEmail !="" &&  contactEmail != null) && (ad[0] != null && ad[0].toString().length() > 0)) {
	emailText += "<p>Address; " + ad[0] + "<!p><!body><!html>";
	}

if ((cName ==  "Class A Beer & Liquor" || cName == "Class B Beer & Liquor") && (contactEmail !="" &&  contactEmail != null)) {
	aa.sendEmail("noreplyDEV@cityofmadison.com", "mwalizada@cityofmadison.com","elamsupport@cityofmadison.com",emailSubject + " (for ALRC)", emailText, "");
	}
`^
EML;NewNonStormLicense^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emailText = "<html><body><p>Notice of new Non-Storm water discharge license<!p>";
emailSubject = "Record Created; " + capIDString;
emailText += "<b>Record; <!b> <a href=" + "" + "https;!!av73dev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=Permitting&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capId.getCustomID() + "<!a><br><br>";
include("EML;AddressInformation");
if (workDescGet(capId)) {
	emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
	}

aa.sendEmail("noreply@cityofmadisonDEV.com", "glabelle-brown@cityofmadisonDEV.com", "elamsupport@cityofmadisonDEV.com",  emailSubject, emailText, "");
`^
EML;NoGISObject^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emailSubject = "Application " + capIDString + " Doesn't have a valid GIS Object ";
emailText = "<html><body><p>" + cmnSubType + " application action by " + currentUserID + "<!p>";
include("EML;AddressInformation");
emailText += "Find the Application at; <a href=" + "" + "https;!!av73dev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=" + cmnGroup + "&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a><br><br>";
email("glabelle-brown@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
`^
EML;Permitting!Building!~!~;ResubmitTimeLimit^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
emailSubject = "Permit " + capId + " - Reminder to Resubmit";
resubDate = dateAdd(wfDateMMDDYYYY,60);
emailBody = "Your Permit Application, number " + capId + ", received a Resubmit status on " + wfDateMMDDYYYY + ". You have 60 days, until " + resubDate + ", to resubmit this application.";
emailContact(emailSubject,emailBody);
`^
EML;Permitting!Building!RepairReplace!Construction;FeeACA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "";
emailText = "";
emailSubject ="";
include("EML;GetContactEmail");
emailSubject = "Repair or Replace Building Permit Application Submitted";
emailText = "<html><body><p>Thank you for submitting your application for a Repair or Replace Building Permit . <!p>";
emailText += "<p>We have received your permit application, but the following reviews must take place before we can process your permit. Fees will then be assessed and must be paid if the permit is approved.<!p><ul>";
if (appHasCondition("LOCAL HISTORIC DISTRICT","APPLIED","LocalHistDist",null)) {
	emailText += "<li>Local Historic District Review<!li>";
	}

if (appHasCondition("URBAN DESIGN DISTRICT","APPLIED","UrbanDesignDist",null)) {
	emailText += "<li>Urban Design Review<!li>";
	}

if (appHasCondition("LANDMARK SITE","APPLIED","Landmark Site",null)  || appHasCondition("ADJACENT TO LANDMARK","APPLIED","Adjacent to Landmark",null)) {
	emailText += "<li>Landmark Review<!li>";
	}

emailText += "<!ul><p>Thank you,<BR><BR><BR>City of Madison<BR><!p><!body><!html>";
if (contactEmail != "") {
	aa.sendEmail("noreply@cityofmadisonDEV.com", contactEmail, contactEmail,  emailSubject, emailText, "");
	}
`^
EML;Permitting!Building!RepairReplace!Construction;FeeACAPaid^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "";
emailText = "";
emailSubject ="";
emailText = "<html><body><p>Repair or Replace Building Permit Application Fees Paid<!p>";
emailSubject = "Repair or Replace Building Permit Application Fees Paid " + capIDString + " - Permit App Fees Paid";
emailText += "<b>Category<!b> " + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
emailText += "<b>CAP<!b> <a href=" + "" + "https;!!av73dev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=Permitting&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a><br><br>";
emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
include("EML;AddressInformation");
emailText += "<p>For Additional Information please log into Accela<!p>";
email("rsjachrani@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
email("kgrittner@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
email("GLabelle-Brown@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
`^
EML;Permitting!Building!RepairReplace!Construction;FeeACAReadyToPay^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "";
emailText = "";
emailSubject ="";
include("EML;GetContactEmail");
emailSubject = "Fees are ready for your Repair or Replace Building Permit Application";
emailText = "<html><body><p>The application materials for your Repair or Replace Building Permit have been successfully processed and approved.<!p>";
if (contactEmail != "") {
	puResult = aa.publicUser.getPublicUserByEmail(contactEmail).getOutput();
	}

if (puResult == null) {
	emailText += "<p>You may now pay your fee(s).  Please mail a check to the address below.<!p>";
	}

if (puResult != null) {
	emailText += "<p>You may now pay your fee(s).  Directions below;<!p>";
	}

if (puResult != null) {
	emailText += "<p>Please login to the <a href='https;!!elam.cityofmadison.com!CitizenAccess!'>City of Madison Licenses & Permits<!a> website to pay the fees.<br>";
	}

if (puResult != null) {
	emailText += "Once logged in click on 'Search for a Permit Application'.<br>";
	}

if (puResult != null) {
	emailText += "Locate the Permit number (" + capIDString + ").<br>";
	}

if (puResult != null) {
	emailText += "In the Status column click on the 'Pay Fees Due' and follow the remaining steps.<br>";
	}

if (puResult != null) {
	emailText += "MasterCard and Visa are accepted by the City of Madison.<br>";
	}

if (puResult != null) {
	emailText += "You are able to print a receipt at the end of the process.<br>";
	}

emailText += "<p>Thank you.<!p>";
if (contactEmail != "") {
	aa.sendEmail("noreply@cityofmadisonDEV.com", contactEmail, contactEmail,  emailSubject, emailText, "");
	}
`^
EML;Permitting!Building!Residential!Construction;FeeACA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "";
emailText = "";
emailSubject ="";
include("EML;GetContactEmail");
emailSubject = "Residential Solar Installation Permit Application Submitted";
emailText = "<html><body><p>Thank you for submitting your application for a Residential Solar Installation Permit. <!p>";
include("EML;AddressInformation");
emailText += "<p>We have received your permit application, but the following reviews must take place before we can process your permit. Fees will then be assessed and must be paid if the permit is approved.<!p><ul>";
emailText += "<li>Plan Review<!li>";
if (true) {
	emailText += "<li>Zoning Review<!li>";
	}

if (appHasCondition("LOCAL HISTORIC DISTRICT","APPLIED","LocalHistDist",null)) {
	emailText += "<li>Local Historic District Review<!li>";
	}

if (appHasCondition("URBAN DESIGN DISTRICT","APPLIED","UrbanDesignDist",null)) {
	emailText += "<li>Urban Design Review<!li>";
	}

if (appHasCondition("LANDMARK SITE","APPLIED","Landmark Site",null)  || appHasCondition("ADJACENT TO LANDMARK","APPLIED","Adjacent to Landmark",null)) {
	emailText += "<li>Landmark Review<!li>";
	}

emailText += "<!ul><p>Thank you,<BR><BR><BR>City of Madison<BR><!p><!body><!html>";
if (contactEmail != "") {
	aa.sendEmail("noreply@cityofmadisonDEV.com", contactEmail, contactEmail,  emailSubject, emailText, "");
	}

emailText = "<html><body><p>Residential Solar Installation Permit Submitted. <!p>";
emailText += "<b>Category<!b> " + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
include("EML;AddressInformation");
contactEmail = "kgrittner@cityofmadisonDEV.com";
contactEmail2 = "rsjachrani@cityofmadisonDEV.com";
aa.sendEmail("noreply@cityofmadisonDEV.com", contactEmail, contactEmail2,  emailSubject, emailText, "");
`^
EML;Permitting!Building!Residential!Construction;FeeACAPaid^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "";
emailText = "";
emailSubject ="";
emailText = "<html><body><p>Residential Solar Installation Permit Application Fees Paid<!p>";
emailSubject = "Residential Solar Installation Permit Application Fees Paid " + capIDString + " - Permit App Fees Paid";
emailText += "<b>Category<!b> " + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
emailText += "<b>CAP<!b> <a href=" + "" + "https;!!av73dev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=Permitting&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a><br><br>";
emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
include("EML;AddressInformation");
emailText += "<p>For Additional Information please log into Accela<!p>";
email("rsjachrani@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
email("mvanerem@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
email("aharper@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
email("kgrittner@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
email("GLabelle-Brown@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
`^
EML;Permitting!Building!Residential!Construction;FeeACAReadyToPay^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "";
emailText = "";
emailSubject ="";
include("EML;GetContactEmail");
emailSubject = "Fees are ready for your Residential Solar Installation Permit Application";
emailText = "<html><body><p>The application materials for your Residential Solar Installation Permit have been successfully processed and approved.<!p>";
include("EML;AddressInformation");
if (contactEmail != "") {
	puResult = aa.publicUser.getPublicUserByEmail(contactEmail).getOutput();
	}

if (puResult == null) {
	emailText += "<p>You may now pay your fee(s).  Please mail a check to the address below.<!p>";
	}

if (puResult != null) {
	emailText += "<p>You may now pay your fee(s).  Directions below;<!p>";
	}

if (puResult != null) {
	emailText += "<p>Please login to the <a href='https;!!elam.cityofmadison.com!CitizenAccess!'>City of Madison Licenses & Permits<!a> website to pay the fees.<br>";
	}

if (puResult != null) {
	emailText += "Once logged in click on 'Search for a Permit Application'.<br>";
	}

if (puResult != null) {
	emailText += "Locate the Permit number (" + capIDString + ").<br>";
	}

if (puResult != null) {
	emailText += "In the Status column click on the 'Pay Fees Due' and follow the remaining steps.<br>";
	}

if (puResult != null) {
	emailText += "MasterCard and Visa are accepted by the City of Madison.<br>";
	}

if (puResult != null) {
	emailText += "You are able to print a receipt at the end of the process.<br>";
	}

emailText += "<p>Thank you.<!p>";
if (contactEmail != "") {
	aa.sendEmail("noreply@cityofmadisonDEV.com", contactEmail, contactEmail,  emailSubject, emailText, "");
	}
`^
EML;Permitting!Clerk!~!~;PermitIssued^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
sPermitType = "";
sPermitTypeText = "";
if (cmnSubType == "Transient Merchant") {
	sPermitType = cmnSubType;
	}

if (cmnSubType == "Solicitor" && cmnCategory == "NA") {
	sPermitType = "Solicitor's";
	}

if (cmnSubType == "Solicitor" && cmnCategory == "NoFee") {
	sPermitType = "No Fee Solicitor's";
	}

sPermitTypeText = "City of Madison " + sPermitType + " Permit";
include("EML;GetContactEmail");
emailSubject = "Permit Issued (" + capIDString + ") for " + sPermitTypeText;
emailText = "<html><body><p>Hello " + contactFName + " " + contactLName + ",<!p>";
emailText += "<p>Your " + sPermitTypeText + " has been issued and is attched as a PDF file.<br>";
emailText += "You will need to have Adobe Reader installed in order to print or view this permit.<!p>";
emailText += "If you need the Clerk's Office to mail you a hard copy of your permit, please let us know using the contact information below.<br>";
emailText += "<p>Thank you,<br>City Clerk<br>210 Martin Luther King, Jr. Blvd., Room 103<br>City of Madison, Wisconsin 53703<!p>";
emailText += "<p>Phone; 608-266-4601<br>Fax; 608-266-4666<br>licensing@cityofmadison.com<!p><!body><!html>";
if (contactEmail != null && contactEmail != "") {
	reportName = "Business License";
	reportViewAttachEmail(false, true, reportName, "noreply@cityofmadisonDEV.com", contactEmail, "", emailSubject, emailText, false, "elamsupport@cityofmadison.com");
	}
`^
EML;Permitting!Clerk!Solicitor!~;EmailTemplate^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var ApplEmail = "";
var bNoEmail = true;
var sSendTo = "";
var bCourtFees = false;
var sCourtFeesLookup = "";
var sCourtFeesSubject = "";
var sCourtFeesBody = "";
var bCriminalCase = false;
var sCriminalCaseLookup = "";
var sCriminalCaseSubject = "";
var sCriminalCaseBody = "";
if (lookup("PermClerkPermitEmailsSendTo", wfTask + "|" + wfStatus)) {
	sSendTo = lookup("PermClerkPermitEmailsSendTo", wfTask + "|" + wfStatus);
	}

if (wfTask == "Police Review" && wfStatus == "Court Fees Past Due") {
	bCourtFees = true;
	}

if (wfTask == "Police Review" && wfStatus == "Pending Criminal Case") {
	bCriminalCase = true;
	}

include("EML;GetContactEmail");
logDebug("workflow task!status = " + wfTask + "|" + wfStatus);
if (bCourtFees == false && bCriminalCase == false && lookup("PermClerkEmailsSubject", wfTask + "|" + wfStatus)  != undefined) {
	emailSubject = lookup("PermClerkEmailsSubject", wfTask + "|" + wfStatus);
	} else {
	emailSubject = "Solicitor Permit Application";
	}

for(rec in ca) if (ca[rec]["contactType"] == "Applicant") ApplEmail = ca[rec]["email"];
firstName = ca[rec]["firstName"];
lastName = ca[rec]["lastName"];
if (ApplEmail != null && ApplEmail != undefined && ApplEmail != "") {
	bNoEmail = false;
	logDebug("ApplEmail ; " + ApplEmail);
	}

if (bCourtFees == true) {
	if(bNoEmail == false) sCourtFeesLookup = "1";
	if(bNoEmail == true) sCourtFeesLookup = "2";
	}

if (sCourtFeesLookup != "") {
	sCourtFeesSubject = lookup("PermClerkEmailsSubject", "Police Review|Court Fees Past Due" + sCourtFeesLookup);
	}

if (sCourtFeesLookup != "") {
	sCourtFeesBody = lookup("PermClerkPermitEmailsBody", "Police Review|Court Fees Past Due" + sCourtFeesLookup);
	}

if (bCriminalCase == true) {
	if(bNoEmail == false) sCriminalCaseLookup = "1";
	if(bNoEmail == true) sCriminalCaseLookup = "2";
	}

if (sCriminalCaseLookup != "") {
	sCriminalCaseSubject = lookup("PermClerkEmailsSubject", "Police Review|Pending Criminal Case" + sCriminalCaseLookup);
	}

if (sCriminalCaseLookup != "") {
	sCriminalCaseBody = lookup("PermClerkPermitEmailsBody", "Police Review|Pending Criminal Case" + sCriminalCaseLookup);
	}

emailText = "<html><body>";
emailText += "<p><strong>Permit Type;<!strong> 
Solicitor<br><strong>Permit Application #;<!strong> 
" + capIDString + "<br><strong>Applicant Name;<!strong> 
" + firstName + " " + lastName + "<!p>";
if (bCourtFees == false && bCriminalCase == false && lookup("PermClerkPermitEmailsBody", wfTask + "|" + wfStatus)  != undefined) {
	emailText += lookup("PermClerkPermitEmailsBody", wfTask + "|" + wfStatus);
	}

if (bCourtFees == true) {
	emailText += sCourtFeesBody;
	emailSubject = sCourtFeesSubject;
	}

if (bCriminalCase == true) {
	emailText += sCriminalCaseBody;
	emailSubject = sCriminalCaseSubject;
	}

emailText += "<!html><!body>";
if ((bCourtFees == true || bCriminalCase == true) && bNoEmail == false) {
	sendAsyncEmail("noreply@cityofmadisonDEV.com", ApplEmail, "", emailSubject, emailText, "");
	logDebug(emailSubject + " email sent to Applicant");
	}

if ((((bCourtFees == true || bCriminalCase == true) && bNoEmail == true) || (bCourtFees == false && bCriminalCase == false))) {
	sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, "", emailSubject, emailText, "");
	logDebug("Email sent to " + sSendTo + " value for given task and status.");
	}
`^
EML;Permitting!Clerk!Solicitor!~;PoliceBackgroundCheck^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
include("EML;GetContactEmail");
for(rec in ca) if (ca[rec]["contactType"] == "Applicant") firstName = ca[rec]["firstName"];
lastName = ca[rec]["lastName"];
sSendTo = lookup("PermClerkPermitEmailsSendTo", "Intake|Submitted");
emailSubject = "New Solicitor " +  lookup("PermClerkEmailsSubject", "Intake|Submitted");
emailText = "<html><body>";
emailText += "<p><strong>Permit Type;<!strong> 
Solicitor<br><strong>Permit Application #;<!strong> 
" + capIDString + "<br><strong>Applicant Name;<!strong> 
" + firstName + " " + lastName + "<!p>";
emailText += lookup("PermClerkPermitEmailsBody", "Intake|Submitted");
sendAsyncEmail("noreply@cityofmadison.com", sSendTo, "", emailSubject, emailText, "");
`^
EML;Permitting!Clerk!Solicitor!~;PoliceBackgroundCheckApproved^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
var sWFStatus = "";
var sWFStatus = "Police Review|" + wfStatus;
include("EML;GetContactEmail");
for(rec in ca) if (ca[rec]["contactType"] == "Applicant") firstName = ca[rec]["firstName"];
lastName = ca[rec]["lastName"];
sSendTo =  lookup("PermClerkPermitEmailsSendTo", sWFStatus);
emailSubject = lookup("PermClerkEmailsSubject", sWFStatus);
emailText = "<html><body>";
emailText += "<p><strong>Permit Type;<!strong> 
Solicitor<br><strong>Permit Application #;<!strong> 
" + capIDString + "<br><strong>Applicant Name;<!strong> 
" + firstName + " " + lastName + "<!p>";
emailText += lookup("PermClerkPermitEmailsBody", sWFStatus);
sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, "", emailSubject, emailText, "");
`^
EML;Permitting!Clerk!Transient Merchant!NA;EmailTemplate^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
var ApplEmail = "";
var bNoEmail = true;
var sSendTo = "";
var bCourtFees = false;
var sCourtFeesLookup = "";
var sCourtFeesSubject = "";
var sCourtFeesBody = "";
var bCriminalCase = false;
var sCriminalCaseLookup = "";
var sCriminalCaseSubject = "";
var sCriminalCaseBody = "";
if (lookup("PermClerkPermitEmailsSendTo", wfTask + "|" + wfStatus)) {
	sSendTo = lookup("PermClerkPermitEmailsSendTo", wfTask + "|" + wfStatus);
	}

if (wfTask == "Police Review" && wfStatus == "Court Fees Past Due") {
	bCourtFees = true;
	}

if (wfTask == "Police Review" && wfStatus == "Pending Criminal Case") {
	bCriminalCase = true;
	}

include("EML;GetContactEmail");
logDebug("workflow task!status = " + wfTask + "|" + wfStatus);
if (bCourtFees == false && bCriminalCase == false && lookup("PermClerkEmailsSubject", wfTask + "|" + wfStatus)  != undefined) {
	emailSubject = lookup("PermClerkEmailsSubject", wfTask + "|" + wfStatus);
	} else {
	emailSubject = "Permit Application";
	}

for(rec in ca) if (ca[rec]["contactType"] == "Applicant") ApplEmail = ca[rec]["email"];
firstName = ca[rec]["firstName"];
lastName = ca[rec]["lastName"];
if (ApplEmail != null && ApplEmail != undefined && ApplEmail != "") {
	bNoEmail = false;
	logDebug("ApplEmail ; " + ApplEmail);
	}

if (bCourtFees == true) {
	if(bNoEmail == false) sCourtFeesLookup = "1";
	if(bNoEmail == true) sCourtFeesLookup = "2";
	}

if (sCourtFeesLookup != "") {
	sCourtFeesSubject = lookup("PermClerkEmailsSubject", "Police Review|Court Fees Past Due" + sCourtFeesLookup);
	}

if (sCourtFeesLookup != "") {
	sCourtFeesBody = lookup("PermClerkPermitEmailsBody", "Police Review|Court Fees Past Due" + sCourtFeesLookup);
	}

if (bCriminalCase == true) {
	if(bNoEmail == false) sCriminalCaseLookup = "1";
	if(bNoEmail == true) sCriminalCaseLookup = "2";
	}

if (sCriminalCaseLookup != "") {
	sCriminalCaseSubject = lookup("PermClerkEmailsSubject", "Police Review|Pending Criminal Case" + sCriminalCaseLookup);
	}

if (sCriminalCaseLookup != "") {
	sCriminalCaseBody = lookup("PermClerkPermitEmailsBody", "Police Review|Pending Criminal Case" + sCriminalCaseLookup);
	}

emailText = "<html><body>";
emailText += "<p><strong>Permit Type;<!strong> 
Transient Merchant<br><strong>Permit Application #;<!strong> 
" + capIDString + "<br><strong>Applicant Name;<!strong> 
" + firstName + " " + lastName + "<!p>";
if (bCourtFees == false && bCriminalCase == false && lookup("y", wfTask + "PermClerkPermitEmailsBody" + wfStatus)  != undefined) {
	emailText += lookup("PermClerkPermitEmailsBody", wfTask + "|" + wfStatus);
	}

if (bCourtFees == true) {
	emailText += sCourtFeesBody;
	emailSubject = sCourtFeesSubject;
	}

if (bCriminalCase == true) {
	emailText += sCriminalCaseBody;
	emailSubject = sCriminalCaseSubject;
	}

emailText += "<html><body>";
if ((bCourtFees == true || bCriminalCase == true) && bNoEmail == false) {
	sendAsyncEmail("noreply@cityofmadisonDEV.com", ApplEmail, "", emailSubject, emailText, "");
	logDebug(emailSubject + " email sent to Applicant");
	}

if ((((bCourtFees == true || bCriminalCase == true) && bNoEmail == true) || (bCourtFees == false && bCriminalCase == false))) {
	sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, "", emailSubject, emailText, "");
	logDebug("Email sent to " + sSendTo + " value for given task and status.");
	}
`^
EML;Permitting!Clerk!Transient Merchant!NA;PoliceBackgroundCheck^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
include("EML;GetContactEmail");
for(rec in ca) if (ca[rec]["contactType"] == "Applicant") firstName = ca[rec]["firstName"];
lastName = ca[rec]["lastName"];
sSendTo = lookup("PermClerkPermitEmailsSendTo", "Intake|Submitted");
emailSubject = "New Transient Merchant " + lookup("PermClerkEmailsSubject", "Intake|Submitted");
emailText = "<html><body>";
emailText += "<p><strong>Permit Type;<!strong> 
Transient Merchant<br><strong>Permit Application #;<!strong> 
" + capIDString + "<br><strong>Applicant Name;<!strong> 
" + firstName + " " + lastName + "<!p>";
emailText += lookup("PermClerkPermitEmailsBody", "Intake|Submitted");
sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, "", emailSubject, emailText, "");
include("PRA;Permitting!Clerk!~!~");
`^
EML;Permitting!Clerk!Transient Merchant!NA;PoliceBackgroundCheckApproved^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
var sWFStatus = "Police Review|" + wfStatus;
include("EML;GetContactEmail");
for(rec in ca) if (ca[rec]["contactType"] == "Applicant") firstName = ca[rec]["firstName"];
lastName = ca[rec]["lastName"];
sSendTo = lookup("PermClerkPermitEmailsSendTo", sWFStatus );
emailSubject = lookup("PermClerkEmailsSubject", sWFStatus);
emailText = "<html><body>";
emailText += "<p><strong>Permit Type;<!strong> 
Transient Merchant<br><strong>Permit Application #;<!strong> 
" + capIDString + "<br><strong>Applicant Name;<!strong> 
" + firstName + " " + lastName + "<!p>";
emailText += lookup("PermClerkPermitEmailsBody", sWFStatus);
sendAsyncEmail("noreply@cityofmadisonDEV.com", sSendTo, "", emailSubject, emailText, "");
`^
EML;Permitting!Engineering!~!NA;SewerMeterPermit^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmails = "AJones@cityofmadison.com;
";
xLProfEmail = null;
varInsp = getGISInfo("agis_madison","Meter District","inspector");
if(varInsp == undefined) varInsp = "Cindy";
emailText = "";
if (varInsp) {
	emailAddr = lookup("WaterInspEmails", varInsp);
	contactEmails += emailAddr +=";
	";
	}

reportName =  "Sewer Meter Permit";
capModule = "Permitting";
businessName = "";
xLProfs = aa.licenseScript.getLicenseProf(capId).getOutput();
if (xLProfs != null) {
	xLProfEmail = xLProfs[0].getEmail();
	}

if (xLProfEmail != null) {
	contactEmails += xLProfEmail;
	}

ownerEmail = getAppSpecific("OWNER!PLUMBER INFORMATION.Owner Email");
if (ownerEmail !=null && ownerEmail != "") {
	contactEmails += ";
	" + ownerEmail;
	}

emailSubject = "Sewer " + woCategory + " Meter Permit Issued - " + capIDString;
emailText = "<html><body><p>Sewer " + woCategory + " Meter Permit Issued - " + capIDString + "<!p>";
ad = aa.address.getAddressByCapId(capId).getOutput();
if ((ad[0] != null && ad[0].toString().length() > 0)) {
	emailText += "<p>Address of Work;<br>";
	}

if ((ad[0] != null && ad[0].toString().length() > 0)) {
	for (eachRecord in ad) include("EML;GetAddressLine");
	}

if ((ad[0] != null && ad[0].toString().length() > 0)) {
	emailText += "<!p>";
	}

mechEmailText = emailText;
mechEmailText += "<p><b>Work Order;<!b>  <a href=" + "" + "https;!!avdev.cityofmadison.com;444!portlets!cap!capDetail.do?mode=list&module=AMS&serviceProviderCode=MADISON&ID1=" + childId.getID1() + "&ID2=" + childId.getID2()  + "&ID3=" + childId.getID3()  + "&clearForm=clearForm" + "" + ">" + childId.getCustomID() + "<!a><br><br> ";
emailText += "<p>Contact Cindy Hemenway to schedule the Inspection and Meter Setting Appointment when piping is complete. <!br>Cindy can be reached via email at chemenway@cityofmadison.com or phone at 608-266-6429.<!p>";
emailText = "contactEmails; " + contactEmails + "<br>" + emailText;
reportViewAttachEmail(true, true, reportName,"noreply@cityofmadison.com", "elamsupport@cityofmadison.com", "", emailSubject, emailText, false, "");
`^
EML;Permitting!Engineering!ROW!~;IssuanceEmail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
reportName = "Excavate in Right of Way Permit";
capModule = "Permitting";
reportName = "ROW Permit Temp";
capModule = "Permitting";
businessName = "";
include("EML;GetContactEmail");
include("EML;GetCurrentUserEmail");
include("CMN;Store_Report_To_Disk");
emailSubject = "ROW Permit Issued - " + capIDString;
emailText = "<html><body><p>ROW Permit Issued - " + capIDString + "<!p>";
emailText += "<p>ROW Permit Applicant - " + businessName + "<!p>";
if (workDescGet(capId) != null) {
	emailText += "<p>Location of Work; " + workDescGet(capId)  + "<!p>";
	}

if (wfComment != null) {
	emailText += "<p>Comments; " + wfComment + "<!p>";
	}

emailText += "<p>This is a notice generated from the Engineering Department that your permit has been issued.<!br>";
emailText += "A copy of the permit is attached to this email in PDF format.  You will need Adobe Reader installed to view and or print your permit. <!p><!body><!html>";
aa.sendEmail("noreply@cityofmadisonDEV.com", contactEmail, userEmail,  emailSubject, emailText, reportFile);
`^
EML;Permitting!Engineering!ROW!NA;CRCAAppSubmitted^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
reportFile = "";
include("EML;GetContactEmail");
cName = "Excavate in the Right of Way";
emailSubject = "Application " + capId.getCustomID() + " Submitted for " + cName;
emailText = "<html><body><p>Hello " + contactFName + " " + contactLName + ",<!p>";
emailText += "<p>Thank you for submitting your application for a " + cName + " permit .<!p>";
emailText += "<p>Your  " + cName + " application (" + capId.getCustomID() + ") has been received and is being reviewed by the City of Madison Engineering Department.<!p>";
emailText += "<p>Please keep this number available for future reference. <!p>";
ad = aa.address.getAddressByCapId(capId).getOutput();
emailText += "<p>Location of Work;<br>";
if (workDescGet(capId) != null && ad[0] != null && ad[0].toString().length() > 0) {
	for (eachRecord in ad) include("EML;GetAddressLine");
	}

if (workDescGet(capId) != null && ad[0] != null && ad[0].toString().length() > 0) {
	emailText +=  "<br>" + workDescGet(capId)  + "<!p>";
	}

emailText += "<p>You may login to the <a href='https;!!elam.cityofmadison.com!CitizenAccess!'>City of Madison Licenses & Permits<!a> website to review the status of your application, pay fees when they are available for payment, view the license and!or receipt when they are available, and attach needed documents.<!p>";
emailText += "<p>Additional emails will be sent at key points in the process as reminders of action needed or updates in the status of your application.<!p>";
emailText += "<p>Thank you,<BR>Engineering Main Office<BR>";
emailText += "210 Martin Luther King, Jr. Blvd., Room 115<BR>City of Madison, Wisconsin 53703<BR>";
emailText += "608 266 4751 Phone<BR>608 264 9275 Fax<!p><!body><!html>";
aa.sendEmail("noreply@cityofmadisonDEV.com", contactEmail, "jschneider@cityofmadisonDEV.com",  emailSubject, emailText, reportFile);
`^
EML;Permitting!Engineering!ROW!NA;DocumentAttached^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
reportFile = "";
cName = "Excavate in the Right of Way";
emailSubject = "Document Attached for Application (" + capId.getCustomID() + ")";
emailText = "<html><body><p>The following " + cName + " permit has an attachment recently added.<!p>";
ad = aa.address.getAddressByCapId(capId).getOutput();
emailText += "<p>Location of Work;<br>";
if (workDescGet(capId) != null && ad[0] != null && ad[0].toString().length() > 0) {
	for (eachRecord in ad) include("EML;GetAddressLine");
	}

if (workDescGet(capId) != null && ad[0] != null && ad[0].toString().length() > 0) {
	emailText +=  "<br>" + workDescGet(capId)  + "<!p>";
	}

emailText += "<p>Please review the following files;<br>" + strFileName + "<!p><!body><!html>";
aa.sendEmail("noreply@cityofmadisonDEV.com", "poleary@cityofmadisonDEV.com", "", emailSubject, emailText, reportFile);
`^
EML;Permitting!Engineering!ROW!NA;FailedInsp^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
contactEmail = "noEmail@cityofmadisonDEV.com";
shortNotes = "";
count = 0;
countString = "no string";
include("EML;GetContactEmail");
include("EML;GetCurrentUserEmail");
if (contactFName == null) {
	contactFName = "";
	}

if (contactLName == null) {
	contactLName = "";
	}

inspRes = aa.inspection.getInspections(capId);
inspSuccess = inspRes.getSuccess();
if (inspSuccess) {
	insps = inspRes.getOutput();
	for (i in insps) include("CMN;Permitting!Engineering!ROW!NA;FailedInspCount");
	}

reportFile = "";
gsMessage = "";
gsObj = getGuideSheetObjects(inspId, capId);
shortNotes = getShortNotes(capId);
emailSubject = "Inspection for Excavate in Right of Way Permit (" + capIDString + ")";
emailText = "<html><body><p>Hello " + contactFName + " " + contactLName + ",<!p>";
if (inspType == "Initial") {
	inspType2 = " Inspection";
	} else {
	inspType2 ="";
	}

emailText += "<p>The " + inspType + inspType2 + " for the excavate in right of way permit failed.  This is the " + countString + " time the inspections for this permit have failed.<!p>";
include("EML;AddressInformation");
if (shortNotes != "") {
	emailText += "<p>The work order associated with this permit; " + shortNotes + ".<!p>";
	}

if (gsObj != "") {
	for (gs in gsObj) include("CMN;Permitting!Engineering!ROW!NA;ListGuideSheetItems");
	}

if (gsMessage == "") {
	emailText += "<p>If no reason is given below someone will be in contact with you.<!p>";
	}

if (gsObj != "") {
	emailText += "<p>Reason(s);<br>" + gsMessage + "<!p>";
	}

emailText += "<p>Work associated with this permit will not be considered satisfactorily completed until the above stated issues are corrected.<!p>";
emailText += "<p>William McGlynn<br !>1600 Emil Street<br !>City of Madison, Wisconsin 53713";
emailText += "<br !>Phone; (608) 266-4514<br !>Cell; (608) 520-2416<br !>Fax; (608) 267-1123<br !>Email; " + userEmail + "<!p><!body><!html>";
if (contactEmail != "") {
	aa.sendEmail(userEmail, "kgrittner@cityofmadisonDEV.com", "rsjachrani@cityofmadisonDEV.com",  emailSubject, emailText, reportFile);
	}
`^
EML;Permitting!Engineering!ROW!NA;Inspection^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
myContactType = "Applicant";
include("EML;GetContactTypeEmail");
!! include("EML;GetCurrentUserEmail");
emailSubject = "ROW Inspection Completed - " + capIDString;
emailText = "<html><body><p>ROW Inspection Completed - " + capIDString + "<!p>";
emailText += "<p>ROW Permit Applicant - " + businessName + "<!p>";
if (workDescGet(capId) != null) {
	emailText += "<p>Location of Work; " + workDescGet(capId)  + "<!p>";
	}

if (wfComment != null) {
	emailText += "<p>Comments; " + wfComment + "<!p>";
	}

emailText += "<p>This is a notice generated from the Engineering Department that your permit inspection has been completed.<!br>";
if (contactEmail != "nomail@cityofmadisonDEV.com") {
	aa.sendEmail("noreply@cityofmadisonDEV.com", contactEmail, "", emailSubject, emailText, "");
	}

xLProf = aa.licenseScript.getLicenseProf(capId).getOutput();
if (xLProf != null) {
	xLProf = xLProf[0];
	xlpEmail = xLProf.getEmail();
	aa.sendEmail("noreply@cityofmadisonDEV.com", xlpEmail, xlpEmail, emailSubject, emailText, "");
	aa.sendEmail("noreply@cityofmadisonDEV.com", "kgrittner@cityofmadisonDEV.com", "", "xlpEmail", xlpEmail, "");
	}
`^
EML;Permitting!Engineering!Sewer Plug!NA;EmailForCIP^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("EML;GetContactEmail");
if (wfTask == "Lining Complete" && wfStatus == "Completed") {
	var toEmail = "dwipperfurthdev@cityofmadison.com";
	var ccEmail = "elamsupport@cityofmadison.com";
	} else {
	var toEmail = "jschlimgendev@cityofmadison.com,kstonedev@cityofmadison.com";
	var ccEmail = "elamsupport@cityofmadison.com";
	}

if (wfTask == "Lining Complete" && wfStatus == "Completed") {
	emailSubject = "Sewer Plug Permit " + capIDString + " is ready for Mapping";
	} else {
	emailSubject = "Sewer Plug Permit " + capIDString + " is ready for permanent abandonment";
	}

emailText = "<html><body><p>Sewer Plug Permit Inspected - CIP Abandonments - " + capIDString + "<br>";
if (wfTask == "Lining Complete" && wfStatus == "Completed") {
	emailText += "Debbie, <!p>";
	} else {
	emailText += "Permit Applicant - " + contactFName + " " + contactLName + "<!p>";
	}

ad = aa.address.getAddressByCapId(capId).getOutput();
include("CMN;Permitting!Engineering!Sewer Plug!NA;GetCounts");
if ((ad[0] != null && ad[0].toString().length() > 0)) {
	emailText += "<p>Address of Work;<br>";
	}

if ((ad[0] != null && ad[0].toString().length() > 0)) {
	for (eachRecord in ad) include("EML;GetAddressLine");
	}

if ((ad[0] != null && ad[0].toString().length() > 0)) {
	emailText += "<!p>";
	}

if (workDescGet(capId) != null) {
	emailText += "<p>Location of Work; " + workDescGet(capId)  + "<!p>";
	}

if (wfComment != null) {
	emailText += "<p>Comments; " + wfComment + "<!p>";
	}

emailText += "<p>This permit has a total of " + varNumPermSans + " Permanent Sanitary Abandonments;<br>";
if (parseInt(AInfo['NUMBER OF ABANDONMENTS.Permanent on 6 Inch Sanitary Main']) > 0) {
	emailText += "Number of 6 inch abandonments; " + AInfo['NUMBER OF ABANDONMENTS.Permanent on 6 Inch Sanitary Main'] + "<br>";
	}

if (parseInt(AInfo['NUMBER OF ABANDONMENTS.Permanent on 8 Inch Sanitary Main']) > 0) {
	emailText += "Number of 8 inch abandonments; " + AInfo['NUMBER OF ABANDONMENTS.Permanent on 8 Inch Sanitary Main'] + "<br>";
	}

if (parseInt(AInfo['NUMBER OF ABANDONMENTS.Permanent on 10 Inch Sanitary Main']) > 0) {
	emailText += "Number of 10 inch abandonments; " + AInfo['NUMBER OF ABANDONMENTS.Permanent on 10 Inch Sanitary Main'] + "<br>";
	}

if (parseInt(AInfo['NUMBER OF ABANDONMENTS.Permanent on 12 Inch Sanitary Main']) > 0) {
	emailText += "Number of 12 inch abandonments; " + AInfo['NUMBER OF ABANDONMENTS.Permanent on 12 Inch Sanitary Main'] + "<br>";
	}

if (parseInt(AInfo['NUMBER OF ABANDONMENTS.Permanent on 15 Inch Sanitary Main']) > 0) {
	emailText += "Number of 15 inch abandonments; " + AInfo['NUMBER OF ABANDONMENTS.Permanent on 15 Inch Sanitary Main'] + "<br>";
	}

if (parseInt(AInfo['NUMBER OF ABANDONMENTS.Permanent on 18 Inch Sanitary Main']) > 0) {
	emailText += "Number of 18 inch abandonments; " + AInfo['NUMBER OF ABANDONMENTS.Permanent on 18 Inch Sanitary Main'] + "<br>";
	}

if (parseInt(AInfo['NUMBER OF ABANDONMENTS.Permanent on 21 Inch Sanitary Main']) > 0) {
	emailText += "Number of 21 inch abandonments; " + AInfo['NUMBER OF ABANDONMENTS.Permanent on 21 Inch Sanitary Main'] + "<br>";
	}

if (parseInt(AInfo['NUMBER OF ABANDONMENTS.Permanent on 24 Inch Sanitary Main']) > 0) {
	emailText += "Number of 24 inch abandonments; " + AInfo['NUMBER OF ABANDONMENTS.Permanent on 24 Inch Sanitary Main'] + "<br>";
	}

if (AInfo['NUMBER OF ABANDONMENTS.Permanent Plug at Structure'] != null && parseInt(AInfo['NUMBER OF ABANDONMENTS.Permanent Plug at Structure']) > 0) {
	emailText += "Number of Permanent Plug at Structure; " + AInfo['NUMBER OF ABANDONMENTS.Permanent Plug at Structure'] + "<br>";
	}

emailText += " <!p><!body><!html>";
aa.sendEmail("noreply@cityofmadisonDEV.com", toEmail, ccEmail,  emailSubject, emailText, "");
`^
EML;Permitting!Engineering!Sewer Plug!NA;IssuanceEmail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
reportName = "Sewer Plug Permit";
capModule = "Permitting";
include("EML;GetContactEmail");
var ccEmail = "poleary@cityofmadisonDEV.com";
include("CMN;Store_Report_To_Disk");
emailSubject = "Sewer Plug Permit Issued - " + capIDString;
emailText = "<html><body><p>Sewer Plug Permit Issued - " + capIDString + "<!p>";
emailText += "<p>Sewer Plug Permit Applicant - " + contactFName + " " + contactLName + "<!p>";
ad = aa.address.getAddressByCapId(capId).getOutput();
if ((ad[0] != null && ad[0].toString().length() > 0)) {
	emailText += "<p>Address of Work;<br>";
	}

if ((ad[0] != null && ad[0].toString().length() > 0)) {
	for (eachRecord in ad) include("EML;GetAddressLine");
	}

if ((ad[0] != null && ad[0].toString().length() > 0)) {
	emailText += "<!p>";
	}

if (workDescGet(capId) != null) {
	emailText += "<p>Location of Work; " + workDescGet(capId)  + "<!p>";
	}

emailText += "<p>This is a notice generated from the Engineering Department that your permit has been issued.<!br>";
emailText += "A copy of the permit is attached to this email in PDF format.  You will need Adobe Reader installed to view and or print your permit. <!p><!body><!html>";
if (contactEmail == null | contactEmail == "") {
	contactEmail = "ttroester@cityofmadisonDEV.com";
	} else {
	contactEmail = "ttroester@cityofmadisonDEV.com;
	" + contactEmail;
	}
`^
EML;Permitting!Engineering!Sewer Plug!NA;ProcessFees^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
emailSubject = "Sewer Plug Permit " + capIDString + " is ready for payment processing";
emailText = "<html><body><p>Sewer Plug Permit - Fee Created - " + capIDString + "<br>";
if (workDescGet(capId) != null) {
	emailText += "<p>Location of Work; " + workDescGet(capId)  + "<!p>";
	}

emailText += "<p>This permit is ready to be paid.<br>";
emailText += " <!p><!body><!html>";
aa.sendEmail("noreply@cityofmadisonDEV.com", "jmoyer@cityofmadisonDEV.com", "poleary@cityofmadisonDEV.com",  emailSubject, emailText, "");
`^
EML;Permitting!Engineering!Sewer Plug!NA;ProcessRefund^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
tNumAbandon = 0;
tCIPAbandonComplete = 0;
emailSubject = "Sewer Plug Permit " + capIDString + " is ready for refund processing";
emailText = "<html><body><p>Sewer Plug Permit - Lining Complete - " + capIDString + "<br>";
ad = aa.address.getAddressByCapId(capId).getOutput();
if ((ad[0] != null && ad[0].toString().length() > 0)) {
	emailText += "<p>Address of Work;<br>";
	}

if ((ad[0] != null && ad[0].toString().length() > 0)) {
	for (eachRecord in ad) include("EML;GetAddressLine");
	}

if ((ad[0] != null && ad[0].toString().length() > 0)) {
	emailText += "<!p>";
	}

if (workDescGet(capId) != null) {
	emailText += "<p>Location of Work; " + workDescGet(capId)  + "<!p>";
	}

tNumAbandon = getAppSpecific("NUMBER OF ABANDONMENTS.Total number of sewer laterals being plugged or abandoned", capId);
tCIPAbandonComplete = getAppSpecific("OFFICE USE ONLY.Total CIP Abandonments", capId);
emailText += "<p>The total number of abandonments is; " + tNumAbandon + "<br>";
emailText += "The total number of abandondments completed is; " + tCIPAbandonComplete + "<!p>";
emailText += "<p>This permit is ready to be refunded.<!p>";
emailText += " <!body><!html>";
aa.sendEmail("noreply@cityofmadisonDEV.com", "elamsupport@cityofmadison.com", " ",  emailSubject, emailText, "");
`^
EML;Permitting!Engineering!StormWaterManagement!~;Inspection^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emailSubject = "Eng Storm Water Warning  " + capIDString;
emailText = "<html><body><p>Engineering Storm Water Management Warning Notice to Code Enforcement " + capIDString + "<!p>";
emailText += "<p>" + wfComment + "<!p>";
emailText += "<p>This is a notification email from Accela generated from Engineering Storm Water Management. During inspections for the above CAP, a violation was identified. This is a notice that a Code Enforcement Case needs to be started so that subsequent follow up inspections are created to ensure compliance.<!p><!body><!html>";
email("rsjachrani@cityofmadisonDEV.com","No-Reply@cityofmadisonDEV.com",emailSubject,emailText );
`^
EML;Permitting!Engineering!StreetTerrace!NA;Submitted^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
emailText = "";
include("EML;GetContactEmail");
var emailSubject = "Street Terrace Permit Application Received";
emailText = "<html><body>";
emailText = "<html><body><p>Your application for a Street Terrace Permit has been received as of " + fileDate + ". Engineering will review it and send an approved permit via email within 48 hours.  Work shall not begin within the City right of way until the permit is approved.  Please contact Bill McGlynn at 608-266-4537 or wmcglynn@cityofmadison.com with questions. <!p>";
emailText += "<p><a href=https;!!elam73dev;444!citizenaccess!urlrouting.ashx?type=1000&Module=Permitting&capID1=" + capId.getID1() + "&capID2=" + capId.getID2() + "&capID3=" + capId.getID3() + "&agencyCode=MADISON>" + capIDString  + "<!a><!p>";
emailText += "<p>Thank you,<!p>City Engineering";
emailText += "<!body><!html>";
if (contactEmail != null && contactEmail != "") {
	aa.sendEmail("noreply@cityofmadison.com", contactEmail, "",  emailSubject, emailText, "");
	} else {
	aa.sendEmail("noreply@cityofmadison.com", "kgrittner@cityofmadison.com", "", "Street Terrace Application " + capIDString + " Missing Contact Email", "<html><body><p>The following email was not sent, because there is no Applicant email address.<!p><!body><!html>" + emailText, "");
	}

emailSubject = "Application " + capIDString + " Submitted";
emailText = "";
emailText = "<html><body><p>An application for a Street Terrace Permit " + capIDString  + "  has been received as of " + fileDate + ".<!p>";
emailText += contactFName + " " + contactLName + "<br !>";
include("EML;AddressInformation");
emailText +="<!body><!html>";
if (contactEmail != null && contactEmail != "") {
	aa.sendEmail("noreply@cityofmadison.com", "rsjachrani@cityofmadison.com", "", emailSubject, emailText , "");
	}
`^
EML;Permitting!Fire!~!~;AdditionalInfo^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var ccEmail = "";
emailText = "";
var sSubType = "";
var sSubTypeLookup = "FirePermitSubTypeEmailText";
include("EML;GetContactEmail");
sSubType = lookup(sSubTypeLookup, cmnSubType);
var emailSubject =  sSubType +  " Permit Application - Additional Information Required";
emailText = "<html><body>";
emailText += "<br>";
include("CMN;GetFirePermitEmailHdrVals");
emailText += "<br>";
include("CMN;GetFirePemitApplicantInfo");
emailText += "<p>Thank you for submitting your application for a Fire " + sSubType + " permit. <!p>";
emailText += "<p>We have received your application.  The following items!information are needed before we can begin the review process for your permit; <!p>";
emailText += "<p>If no items are listed below someone, will be in contact with you.<!p>";
if (wfComment != null) {
	reComment = wfComment.replaceAll("~", "<BR>");
	}

if (wfComment != null) {
	emailText += "<p>Items;<br>" + reComment + "<!p>";
	}

emailText += "<p>Thank you,<!p><p>";
include("CMN;FirePermitEmailFooter");
emailText += "<!p>";
emailText += "<p><font color=red>Effective December 8, 2015, Madison Fire Administration’s new address will be 314 W Dayton St., Madison, WI  53703. Please plan accordingly.<!font><!p>";
emailText += "<!body><!html>";
if (contactEmail != null && contactEmail != "") {
	aa.sendEmail("noreply@cityofmadison.com", contactEmail, ccEmail, emailSubject, emailText, "");
	} else {
	cancel = false;
	showMessage = true;
	comment("");
	comment("<strong>~~~ NOTE; ~~~<!strong> Contact does not have an email address, so email was not sent.");
	}
`^
EML;Permitting!Fire!~!~;FeeACA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var sSubType = "";
var sSubTypeLookup = "FirePermitSubTypeEmailText";
include("EML;GetContactEmail");
sSubType = lookup(sSubTypeLookup, cmnSubType);
var emailSubject = "Fire " + sSubType + " Permit Application Received";
emailText = "<html><body>";
emailText += "<br>";
include("CMN;GetFirePermitEmailHdrVals");
emailText += "<br>";
emailText += "<br>";
include("CMN;GetFirePemitApplicantInfo");
emailText += "<p>Your application for a Fire " + sSubType + " Permit has been received as of " + fileDate + ".<!p>";
emailText += "<p>We are currently reviewing your permit application. Once it is accepted, you will receive an email notice with instructions for payment of any fees.<!p>";
emailText += "<p>If your project requires a review of plans, please submit the following to our office;<!p><ul><li>Three (3) copies of the plans<!li><li>Supporting documentation<!li><li>A copy of this email<!li><!ul>";
emailText += "<p>Thank you,<!p><p>";
include("CMN;FirePermitEmailFooter");
emailText += "<!p>";
emailText += "<p><font color=red>Effective December 8, 2015, Madison Fire Administration’s new address will be 314 W Dayton St., Madison, WI  53703. Please plan accordingly.<!font><!p>";
emailText += "<!body><!html>";
if (contactEmail != null && contactEmail != "") {
	aa.sendEmail("noreply@cityofmadisonTEST.com", contactEmail, "", emailSubject, emailText, "");
	} else {
	aa.sendEmail("noreply@cityofmadisonTEST.com", "jschneider@cityofmadisonTEST.com;
	rsjachrani@cityofmadisonTEST.com", "", "Fire Sprinkler Application " + capIDString + " Missing Contact Email", "<html><body><p><strong>The following email was not sent, because there is no Applicant email address.<!strong><!p><!body><!html>" + emailText, "");
	}

emailSubject = "Application " + capIDString + " Submitted";
emailText = "<html><body><p>An application for a Fire " + sSubType + " Permit has been received as of " + fileDate + ".<!p>";
emailText += contactFName + " " + contactLName + "<br !>";
include("EML;AddressInformation");
emailText += "<!body><!html>";
if (contactEmail != null && contactEmail != "") {
	aa.sendEmail("noreply@cityofmadison.com", contactEmail, "", emailSubject, emailText , "") !!For IT testing only.;
	}
`^
EML;Permitting!Fire!~!~;FeeACAReadyToPay^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
emailText = "";
ccEmail = "";
var sSubType = "";
var sSubTypeLookup = "FirePermitSubTypeEmailText";
include("EML;GetContactEmail");
sSubType = lookup(sSubTypeLookup, cmnSubType);
var emailSubject = "Fees are ready for your " + sSubType  + " Permit Application";
emailText = "<html><body>";
emailText += "<br>";
include("CMN;GetFirePermitEmailHdrVals");
emailText += "<br>";
include("CMN;GetFirePemitApplicantInfo");
emailText += "<p>The application materials for your Fire " + sSubType  + " Permit have been accepted.<!p>";
emailText += "<p>Your payment may now be submitted online.  To submit your payment;<!p>";
emailText += "<ol><li>Login to the <a href='https;!!elamtest.cityofmadison.com!citizenaccess!'>City of Madison Licenses & Permits<!a> website.<!li>";
emailText += "<li>Click on <span style='font-style; italic;
'>Search for a Permit Application.<!span><!li>";
emailText += "<li>Locate the Permit number (" + capIDString + ").<!li>";
emailText += "<li>Click on <span style='font-style; italic;
'>Pay Fees Due<!span> in the Status Column and follow the steps listed.<!li>";
emailText += "<li>The City of Madison accepts both MasterCard and Visa.<!li>";
emailText += "<li>Complete the process by printing your receipt.<!li><!ol>";
emailText += "<p>Thank you,<!p><p>";
include("CMN;FirePermitEmailFooter");
emailText += "<!p>";
emailText += "<!body><!html>";
if (contactEmail != null && contactEmail != "") {
	aa.sendEmail("noreply@cityofmadison.com", contactEmail, ccEmail,  emailSubject, emailText, "");
	} else {
	cancel = false;
	showMessage = true;
	comment("<strong>~~~ NOTE; ~~~<!strong> Contact does not have an email address, so email was not sent.");
	}
`^
EML;Permitting!Fire!~!~;IssuanceEmail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
emailText = "";
var sSubType = "";
var sSubTypeLookup = "FirePermitSubTypeEmailText";
if (include("EML;GetCurrentUserEmail"); true) {
	include("EML;GetContactEmail");
	}

sSubType = lookup(sSubTypeLookup, cmnSubType);
var emailSubject = sSubType +  " Permit Issued - " + capIDString;
emailText = "<html><body>";
emailText += "<br>";
include("CMN;GetFirePermitEmailHdrVals");
emailText += "<br>";
include("CMN;GetFirePemitApplicantInfo");
if (businessName != null && businessName != "") {
	emailText += "<p>Fire " + sSubType + " Permit has been issued to " + businessName + ".<!p>";
	} else {
	emailText += "<p>Fire " + sSubType + " Permit has been issued.<!p>";
	}

if (workDescGet(capId) != false) {
	emailText += "<p>Location of Work; " + workDescGet(capId)  + "<!p>";
	}

if (wfComment != null) {
	emailText += "<p>Comments; " + wfComment + "<!p>";
	}

emailText += "<p>Thank you,<!p><p>";
include("CMN;FirePermitEmailFooter");
emailText += "<!p>";
emailText += "<p><font color=red>Effective December 8, 2015, Madison Fire Administration’s new address will be 314 W Dayton St., Madison, WI  53703. Please plan accordingly.<!font><!p>";
emailText += "<!body><!html>";
if (contactEmail != null && contactEmail != "") {
	aa.sendEmail("noreply@cityofmadison.com", "jschneider@cityofmadison.com", "jgoltz@cityofmadison.com",  emailSubject, emailText, "");
	} else {
	cancel = false;
	showMessage = true;
	comment("<strong>~~~ NOTE; ~~~<!strong> Contact does not have an email address, so email was not sent.");
	}
`^
EML;Permitting!Fire!Alarm!NA;PermitIssued^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
`^
EML;Permitting!Fire!Burn!~;NotifyParks^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emailSubject = "Burn Permit Application " + capIDString + " requires your review ";
emailText = "<html><body><p>Notice of <b>" + cmnCategory + "<!b> Burn Permit Application near or adjacent to City Park land <!p>";
include("EML;AddressInformation");
emailText += "Find the Application at; <a href=" + "" + "https;!!av73dev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=" + cmnGroup + "&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a><br><br>";
email("poleary@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
`^
EML;Permitting!Fire!Sprinkler!NA;PermitIssued^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
`^
EML;Permitting!Health!POWTS!TAM;NotifyCorpCounselToCompliance^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var operStatusDt = "N!A - there is no Orders Issued status associated with this sanitary record";
var OperTask = null;
var parentId = null;
parentId = getParent();
var holdId = null;
if (parentId != null) {
	OperTask = aa.workflow.getWorkflowHistory(parentId,"Operational",null).getOutput();
	}

if (OperTask != null) {
	for(itm in OperTask) if(OperTask[itm].disposition == "Orders Issued") operStatusDt = OperTask[itm].statusDate;
	}

if (parentId != null) {
	holdId = capId;
	capId = parentId;
	}

include("CMN;GetAPOAddress");
include("CMN;GetRefOwnerNameAddressfromParcel");
if (parentId != null && holdId != null) {
	capId = holdId;
	}

TAMServiceDate = getAppSpecific("INSPECTION RESULTS.Date Serviced");
logDebug("TAM fileDate = " + fileDate);
emailSubject = "Accela Notification; Sanitary Workflow Updated Due to TAM Submission";
emailText = "<html><body><p>A TAM record was submitted, and the parent sanitary record's Operational workflow task was updated from "
Referral to Corp Counsel"
to "
System in Compliance"
.<!p>";
emailText += "<p>Sanitary Record; " + getParent().customID;
if (APOAddress != null && APOAddress != "") {
	emailText += "<br>Sanitary Record's Property Address; " + APOAddress;
	}

emailText += "<br>Sanitary Record Reference!APO Owner Name and Address; " + sOwnerFirstName + " 
" + sOwnerLastName;
if (sOwnerAddr1 != "") {
	emailText += ", " + sOwnerAddr1;
	}

if (sOwnerAddr2 != "") {
	emailText += ", " + sOwnerAddr2;
	}

if (sOwnerAddr3 != "") {
	emailText += ", " + sOwnerAddr3;
	}

emailText += ", " + sOwnerCity + ", " + sOwnerState + " " + sOwnerZip;
emailText += "<br>TAM Record; " + capIDString;
emailText += "<br>TAM Record Creation Date; " + fileDate;
emailText += "<br>TAM Service Date; " + TAMServiceDate;
emailText += "<br>Sanitary record's last Operational!Orders Issued date; " + operStatusDt.toString().slice(5,7) + "!" + operStatusDt.toString().slice(8,10) + "!" + operStatusDt.toString().slice(0,4);
emailText += "<!p><!body><!html>";
aa.sendEmail("noreply@cityofmadisonDEV.com", "jschneider@cityofmadison.com", "", emailSubject, emailText, "");
`^
EML;Permitting!Health!Temp Food Establishment^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
ccEmail = "";
emailText = "";
var eventDts = "";
include("EML;GetContactEmail");
logDebug("Email address is; " + contactEmail);
emailSubject = "Application " + capIDString + " Submitted for Temporary Food Permit";
emailText = "<html><body>";
emailText += "Thank you for submitting an application for a temporary food stand permit.  You will receive your permit by email prior to the event or from your health inspector on the day of the event.  At least one week before your event, please contact the Environmental Health office at 608-242-6515 and ask to speak with the sanitarian that will be inspecting your food stand.  They will review the details of your permit to help make sure your stand will be approved to operate.";
emailText += "<p>Next, please review the health department’s temporary food stand requirements; <a href = 'http;!!www.publichealthmdc.com!environmental!food!documents!TempFoodKeyPoints.pdf'>Temporary Food Permit Key Points<!a>";
emailText += "<p>You may also find helpful information including what to expect during your inspection on our website; <a href='http;!!www.publichealthmdc.com!environmental!food!tempFoodInspections.cfm'>Temporary Food Permit Inspections<!a>";
emailText += "<p>If you have questions, you may also email the Environmental Health office at; <a href='mailto;foodfacts@publichealthmdc.com'>foodfacts@publichealthmdc.com<!a>";
emailText += "<p><b>Application No;<!b> "+ capIDString;
if (businessName) {
	emailText += "<br><b>Applicant!Organization Name;<!b> "+ businessName;
	}

emailText += "<br><b>Event Name;<!b> "+getAppSpecific("EVENT INFORMATION.Name of Event");
emailText += "<br><b>Amount Paid;<!b> "+ String(PaymentTotalPaidAmount);
eventDates = loadASITable("DATE(S) OF EVENT");
for(x in eventDates) eventDts += eventDates[x]["Date(s) of Event - Enter all dates of Event"].fieldValue +"<br> ";
emailText += "<br><b>Event Date(s);<!b> "+ eventDts;
emailText += "<!body><!html>";
reportViewAttachEmail(true, true, "Temp Food Application", "noreply@cityofmadison.com", contactEmail, "", emailSubject, emailText, false, "");
`^
EML;Permitting!Health!TempFoodIssued^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
ccEmail = "";
emailText = "";
var eventDts = "";
include("EML;GetContactEmail");
emailSubject = capIDString + " Temporary Food Permit Application - Approved";
emailText = "<html><body>";
varTempDatesTable = new Array();
varTempDatesTable = loadASITable("DATE(S) OF EVENT");
emailText += "Your permit "+ capIDString+ " for "+ getAppSpecific("EVENT INFORMATION.Name of Event") +" on ";
eventDates = loadASITable("DATE(S) OF EVENT");
for(x in eventDates) eventDts += eventDates[x]["Date(s) of Event - Enter all dates of Event"].fieldValue +"<br> ";
emailText += " date(s); <br>"+ eventDts + " is attached. Please print and post the permit at your food stand. If you have any questions please contact the Environmental Health Office at 608-242-6515 or email <a href='mailto;foodfacts@publichealthmdc.com'>foodfacts@publichealthmdc.com<!a>";
reportViewAttachEmail(true, true, "Business License", "noreply@cityofmadison.com", contactEmail, "", emailSubject, emailText, false,"");
`^
EML;Permitting!Health!Well!NA;AdditionalInfo^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "noContactEmail@cityofmadisonDEV.com";
xlpEmail = "noLicProfEmail@cityofmadisonDEV.com";
include("EML;GetContactEmail");
include("EML;GetLicProf");
logDebug("Lic prof email = " + xlpEmail);
emailSubject = "Recently submitted well location permit application -" + capIDString;
emailText = "<html><body><p>Thank you for your recent private well permit application. Our initial review of your application found the following issues;<!p>";
emailText += "<p> " + wfComment + "<!p>";
emailText += "<p>To correct this problem(s), please contact our office at 608-242-6515 or privatewellseptic@publichealthmdcDEV.com<!p>";
if (contactEmail != null) {
	aa.sendEmail("noreply@cityofmadisonDEV.com", contactEmail, "privatewellseptic@publichealthmdcDEV.com", emailSubject, emailText, "");
	}

if (xlpEmail != null) {
	aa.sendEmail("noreply@cityofmadisonDEV.com", xlpEmail, "privatewellseptic@publichealthmdcDEV.com",  emailSubject, emailText, "");
	}
`^
EML;Permitting!Health!Well!NA;Approved^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
userEmail = "noEmail@cityofmadisonDEV.com";
var cd = aa.cap.getCapDetail(capId).getOutput().getCapDetailModel();
if (cd != null) {
	userId = cd.getAsgnStaff();
	logDebug("User ID = " + userId);
	}

if (userId != "" && userId != null) {
	include("EML;GetUserIdEmail");
	logDebug("Send to Email = " + userEmail);
	}

emailSubject = "Well Permit Approved; " + capIDString;
emailText = "<html><body><p>Well permit application; " + capIDString + " approved, ready to issue<!p>";
emailText = "<a href='http;!!crystal!accela!export_report_parameterstest.asp?ReportName=WellPermitApplication&val1=" + capIDString + "' target='_blank' >Permit Application<!a>";
aa.sendEmail("noreply@cityofmadisonDEV.com", "jhausbeck@publichealthmdcDEV.com", "jwescott@publichealthmdcDEV.com",  emailSubject, emailText, "");
`^
EML;Permitting!Health!Well!NA;Complete^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
reportName = "Well Permit Application";
capModule = "Permitting";
userEmail = "noEmail@cityofmadisonTEST.com";
reportFile = "";
var cd = aa.cap.getCapDetail(capId).getOutput().getCapDetailModel();
if (cd != null) {
	userId = cd.getAsgnStaff();
	logDebug("User ID = " + userId);
	}

if (userId != "" && userId != null) {
	include("EML;GetUserIdEmail");
	logDebug("Send to Email = " + userEmail);
	}

include("CMN;Store_Report_To_Disk");
emailSubject = "Well Permit ready for you Review " + capIDString;
emailText = "<html><body><p>Attached is a private well location permit for your review; " + capIDString + "<!p>";
aa.sendEmail("noreply@cityofmadisonDEV.com", userEmail, "jwescott@publichealthmdcDEV.com",  emailSubject, emailText, reportFile);
`^
EML;Permitting!Health!Well!NA;ReviewAdditionalInfo^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "noContactEmail@cityofmadisonDEV.com";
xlpEmail = "noLicProfEmail@cityofmadisonDEV.com";
include("EML;GetContactEmail");
include("EML;GetLicProf");
logDebug("Lic prof email = " + xlpEmail);
emailSubject = "Recently submitted well location permit application -" + capIDString;
emailText = "<html><body><p>Thank you for your recent private well permit application. Our initial review of your application found the following issues;<!p>";
emailText += "<p> " + wfComment + "<!p>";
emailText += "<p>To correct this problem(s), please contact out office at 608-242-6515 or privatewellseptic@publichealthmdcDEV.com<!p>";
if (contactEmail != null) {
	aa.sendEmail("noreply@cityofmadisonDEV.com", contactEmail, "privatewellseptic@publichealthmdcDEV.com", emailSubject, emailText, "");
	}

if (xlpEmail != null) {
	aa.sendEmail("noreply@cityofmadisonDEV.com", xlpEmail, "privatewellseptic@publichealthmdcDEV.com", emailSubject, emailText, "");
	}
`^
EML;Permitting!LandManagement!PrivilegeInStreets!PrivilegeInStreets;NotifyEngineering^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
`^
EML;Permitting!Miscellaneous!Edible Landscape!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
ccEmail = "";
emailText = "";
include("EML;GetContactEmail");
emailSubject = "Application " + capIDString + " Submitted for Edible Landscape Permit";
emailText = "<html><body>";
emailText += "Thank you for submitting an application for an edible landscape permit.";
emailText += "<p>If you have questions, you may contact " + assignedUser + " via email; " + assignedUserEmail;
if (assignedUserPhone != null && assignedUserPhone != "") {
	emailText +=  " or phone; "+ assignedUserPhone;
	}

emailText += "<!p>";
emailText += "<p><b>Application No;<!b> "+ capIDString;
if (businessName) {
	emailText += "<br><b>Applicant!Organization Name;<!b> "+ businessName;
	}

emailText += "<!p>";
if (contactEmail != null && contactEmail != "") {
	aa.sendEmail("noreplyDEV@cityofmadisonDEV.com", contactEmail, "", emailSubject, emailText, "");
	} else {
	aa.sendEmail("noreplyDEV@cityofmadison.com", "elamsupport@cityofmadison.com", "",  "Edible Landscape Application " + capIDString + " Missing Contact Email", "<html><body><p><strong>The following email was not sent, because there is no Applicant email address.<!strong><!p><!body><!html>" + emailText, "");
	}
`^
EML;Permitting!Miscellaneous!Edible Landscape!NA;AlderPerson^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "";
emailSubject = "";
emailText = "";
PlantingDesc = "";
ownerAddress = "";
var cName = "";
contactFName = "";
contactLName = "";
contactPhone1 = "";
ca = getContactArray();
contactPhone1 = "";
if (ca != null) {
	contactPhone1 = " Phone; " + ca[0]["phone1"];
	}

emailSubject = "Edible Landscape Permit Issued";
if (AInfo['GENERAL INFORMATION.Description of specific location of planting site within parcel'] != null) {
	PlantingDesc = "Description; " + AInfo['GENERAL INFORMATION.Description of specific location of planting site within parcel'] + "<br>";
	}

owner = aa.owner.getOwnerByCapId(capId).getOutput();
if (owner != null) {
	ownerAddress = owner[0].mailAddress1;
	}

if (ownerAddress == null) {
	ownerAddress = "";
	}

emailText="An edible landscape permit has been issued in your district to; " + contactDetails + " " + contactPhone1 + ".<br>" + PlantingDesc + ownerAddress + "<br>" + contactText;
include("CMN;getAlderDist");
contactEmail = "kgrittner@cityofmadison.com";
!! Temp for testing, don't want to send to Alderperson by mistake;
if (contactEmail != "") {
	aa.sendEmail("noreply@cityofmadison.com", contactEmail, "",  emailSubject, emailText, "");
	}
`^
EML;Permitting!Parking!Residential Parking!NA;ACA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Issuance" && wfStatus == "Temporary") {
	reportName = "Temp Parking Permit";
	} else {
	reportName = "";
	}

include("EML;GetContactEmail");
if (lookup("ResParkEmailsSubject", wfStatus)  != undefined) {
	emailSubject = lookup("ResParkEmailsSubject", wfStatus);
	} else {
	emailSubject = "Residential Parking Permit Application";
	}

emailText = "<html><body><p>RE; 
" + capIDString + "<br>";
ad = aa.address.getAddressByCapId(capId).getOutput();
if ((ad[0] != null && ad[0].toString().length() > 0)) {
	emailText += " 
	 
	 
	 
	 
	 
	 
	 
	";
	}

if ((ad[0] != null && ad[0].toString().length() > 0)) {
	for (eachRecord in ad) include("EML;GetAddressLine");
	}

if (true) {
	emailText += "<!p>";
	logDebug("Workflow Status = " + wfStatus);
	logDebug("Contact email = " + contactEmail);
	}

if (lookup("ResParkEmailsBody", wfStatus + "1") != undefined) {
	emailText += lookup("ResParkEmailsBody", wfStatus + "1");
	}

if (lookup("ResParkEmailsBody", wfStatus + "2") != undefined) {
	emailText += lookup("ResParkEmailsBody", wfStatus + "2");
	}

emailText += "<!body><!html>";
if (reportName != "") {
	include("CMN;Store_Report_To_Disk");
	} else {
	var reportFile = "";
	}

if (contactEmail != null && contactEmail != "") {
	aa.sendEmail("noreply@cityofmadison.com", contactEmail, "",  emailSubject, emailText, reportFile);
	} else {
	emailText = "<p><strong>Error; 
	<!strong>Could not retrieve applicant'
	s email address for application " + capIDString + ", so unable to send email, '" + emailSubject + "'.<!p>" + emailText;
	emailSubject = "Error; ACA Residential Parking email not sent";
	aa.sendEmail("noreply@cityofmadison.com", "elamsupport@cityofmadison.com", "",  emailSubject, emailText, reportFile);
	}
`^
EML;Permitting!Parks!~!~;AdditionalInfo^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "noEmail@cityofmadisonDEV.com";
include("EML;GetContactEmail");
include("CMN;GetParksAppName");
reportFile = "";
emailSubject = "Application " + capIDString + " for " + cName;
emailText = "<p>Hello " + contactFName + " " + contactLName + "<!p>";
emailText += "<p>Thank you for submitting your application for a " + cName + " permit. <!p>";
emailText += "<p>We have received your " + cName + " application.  The following items!information are needed before we can begin the review process for your permit; <!p>";
emailText += "<p>If no items are listed below someone, will be in contact with you.<!p>";
if (wfComment != null) {
	reComment = wfComment.replaceAll("~", "<BR>");
	}

if (wfComment != null) {
	emailText += "<p>Items;<br>" + reComment + "<!p>";
	}

emailText += "<p>Please feel free to contact Kelli Lamberty with any questions or concerns.  Thank you for your prompt attention to this matter.<!p>";
emailText += "<p>Thank you,<BR>Kelli Lamberty<BR>Community Events Coordinator<BR>Parks Division<BR>City of Madison<BR>210 MLK Jr. Blvd. Rm. 104<BR>Madison, WI 53703<BR>608-266-6033<BR>Like us on Facebook.<br>Follow us on Twitter @PlayMadison.<!p><!body><!html>";
if (contactEmail != "") {
	aa.sendEmail("klamberty@cityofmadisonDEV.com", contactEmail, "jmoyer@cityofmadison.com;
	",  emailSubject, emailText, reportFile);
	}
`^
EML;Permitting!Parks!~!~;Issued^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "noEmail@cityofmadisonDEV.com";
capModule = "Permitting";
include("EML;GetContactEmail");
include("CMN;GetParksAppName");
distList = "rbach@cityofmadisonDEV.com;
dbeck@cityofmadisonDEV.com;
sue.barica@wisconsindev.gov;
abitterman@cityofmadisonDEV.com;
mbrenneis@cityofmadisonDEV.com;
mwalizada@cityofmadisonDEV.com;
mwalizada@cityofmadison.com;
fhodge@cityofmadisonDEV.com;
klamberty@cityofmadisonDEV.com;
dmccaw@cityofmadisonDEV.com;
tmohr@cityofmadisonDEV.com;
sniesen@cityofmadisonDEV.com;
mobrien@cityofmadisonDEV.com;
cpedretti@cityofmadisonDEV.com;
jpratt@cityofmadisonDEV.com;
bputnam@cityofmadisonDEV.com;
rschwenn@cityofmadisonDEV.com;
ksellner@cityofmadisonDEV.com;
jvillarreal@cityofmadisonDEV.com;
mwinter@cityofmadisonDEV.com;
";
emailSubject = "Application " + capIDString + " for " + cName;
emailText = "<p>Hello " + contactFName + " " + contactLName + "<!p>";
if (cmnSubType == "Street Use" && AInfo['LOCATION INFORMATION.Location Requested'] != "Other") {
	emailText += "<p>Attached is the approved "+ cName + " permit for your event taking place at " + AInfo['LOCATION INFORMATION.Location Requested'] + " during the time period of " + AInfo['EVENT INFORMATION.Date(s) of Event Including Setup and Take Down'] + ".<!p>";
	}

if (cmnSubType == "Street Use"&& AInfo['LOCATION INFORMATION.Location Requested'] == "Other") {
	emailText += "<p>Attached is the approved "+ cName + " permit for your event taking place at " + AInfo['LOCATION INFORMATION.Other'] + " during the time period of " + AInfo['EVENT INFORMATION.Date(s) of Event Including Setup and Take Down'] + ".<!p>";
	}

if (cmnSubType != "Street Use" emailText += "<p>Attached is the approved "+ cName + " permit for your event.<!p>") {
	}

emailText += "<p>Please review the conditions carefully and make sure your event is in compliance.  Let me know if you have questions or if you have trouble opening the file.  Have a great event!<!p>";
if (wfComment != null) {
	reComment = wfComment.replaceAll("~", "<BR>");
	}

if (wfComment != null) {
	emailText += "<p>Conditions;<br>" + reComment + "<!p>";
	}

emailText += "<p>Thank you,<BR>Kelli Lamberty<BR>Community Events Coordinator<BR>Parks Division<BR>City of Madison<BR>210 MLK Jr. Blvd. Rm. 104<BR>Madison, WI 53703<BR>608-266-6033<BR>Like us on Facebook.  Follow us on Twitter @PlayMadison.<!p><!body><!html>";
if (contactEmail != "") {
	reportViewAttachEmail(true, true, "Parks Permit", "klamberty@cityofmadisonDEV.com", "jmoyer@cityofmadisonDEV.com;
	", "jmoyer@cityofmadisonDEV.com;
	", emailSubject, emailText, false, "elamSupport@cityofmadisonDEV.com");
	}
`^
EML;Permitting!Parks!~!~;PayFees^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "noEmail@cityofmadisonDEV.com";
include("EML;GetContactEmail");
include("CMN;GetParksAppName");
reportFile = "";
emailSubject = "Application " + capIDString + " for " + cName;
emailText = "<p>Hello " + contactFName + " " + contactLName + "<!p>";
emailText += "<p>Thank you for submitting your application for a " + cName + " permit.  The application has been successfully processed and approved.<!p>";
emailText += "<p>Additional fees need to be paid in order to issue your permit.<!p>";
if (AInfo['LOCATION INFORMATION.Location Requested'] == "Capitol Square") {
	emailText += "<p>A cleanup deposit check in the amount of $3000.00 will need to be mailed to the address below.<!p>";
	}

if (contactEmail != "") {
	puResult = aa.publicUser.getPublicUserByEmail(contactEmail).getOutput();
	}

if (puResult == null) {
	emailText += "<p>You may now pay your fee(s).  Please mail a check to the address below.<!p>";
	}

if (puResult != null) {
	emailText += "<p>You may now pay your fee(s).  Directions below;<!p>";
	}

if (puResult != null) {
	emailText += "<p>Please login to the <a href='https;!!elam.cityofmadison.com!CitizenAccess!'>City of Madison Licenses & Permits<!a> website to pay the fees.<br>";
	}

if (puResult != null) {
	emailText += "Once logged in click on 'Search for a Permit'.<br>";
	}

if (puResult != null) {
	emailText += "Locate the Permit number (" + capIDString + ").<br>";
	}

if (puResult != null) {
	emailText += "In the Status column click on the 'Pay Fees Due' and follow the remaining steps.<br>";
	}

if (puResult != null) {
	emailText += "MasterCard and Visa are accepted by the City of Madison.<br>";
	}

if (puResult != null) {
	emailText += "You are able to print a receipt at the end of the process.<br>";
	}

emailText += "<p>Please feel free to contact Kelli Lamberty with any questions or concerns.  Thank you for your prompt attention to this matter.<!p>";
emailText += "<p>Thank you,<BR>Kelli Lamberty<BR>Community Events Coordinator<BR>Parks Division<BR>City of Madison<BR>210 MLK Jr. Blvd. Rm. 104<BR>Madison, WI 53703<BR>608-266-6033<BR>Like us on Facebook.<br>Follow us on Twitter @PlayMadison.<!p><!body><!html>";
if (contactEmail != "") {
	aa.sendEmail("klamberty@cityofmadisonDEV.com", contactEmail, "jmoyer@cityofmadison.com;
	",  emailSubject, emailText, reportFile);
	}
`^
EML;Permitting!Parks!~!~;ReadyToIssue^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "noEmail@cityofmadisonDEV.com";
include("EML;GetContactEmail");
include("CMN;GetParksAppName");
reportFile = "";
distList = "rbach@cityofmadisonDEV.com;
dbeck@cityofmadisonDEV.com;
sue.barica@wisconsindev.gov;
abitterman@cityofmadisonDEV.com;
mbrenneis@cityofmadisonDEV.com;
cgloede@cityofmadisonDEV.com;
mwalizada@cityofmadison.com;
fhodge@cityofmadisonDEV.com;
klamberty@cityofmadisonDEV.com;
dmccaw@cityofmadisonDEV.com;
tmohr@cityofmadisonDEV.com;
sniesen@cityofmadisonDEV.com;
mobrien@cityofmadisonDEV.com;
cpedretti@cityofmadisonDEV.com;
jpratt@cityofmadisonDEV.com;
bputnam@cityofmadisonDEV.com;
rschwenn@cityofmadisonDEV.com;
ksellner@cityofmadisonDEV.com;
jvillarreal@cityofmadisonDEV.com;
mwinter@cityofmadisonDEV.com;
";
emailSubject = "Application " + capIDString + " for " + cName;
emailText = "<p>Please see attached.  Let me know if there are any edits or additions.<!p>";
emailText += "<p>Thank you,<BR>Kelli Lamberty<BR>Community Events Coordinator<BR>Parks Division<BR>City of Madison<BR>210 MLK Jr. Blvd. Rm. 104<BR>Madison, WI 53703<BR>608-266-6033<BR>Like us on Facebook.  Follow us on Twitter @PlayMadison.<!p><!body><!html>";
aa.sendEmail("klamberty@cityofmadisonDEV.com", "jmoyer@cityofmadison.com;
", "",  emailSubject, emailText, reportFile);
`^
EML;Permitting!Parks!~!~;Submitted^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "noEmail@cityofmadisonDEV.com";
include("EML;GetContactEmail");
include("CMN;GetParksAppName");
reportFile = "";
emailSubject = "Application " + capIDString + " for " + cName;
emailText = "<p>Hello " + contactFName + " " + contactLName + "<!p>";
emailText += "<p>Thank you for submitting your application for a " + cName + " permit. <!p>";
emailText += "<p>We have received your " + cName + " application and will begin processing it shortly.  You can expect additional emails at key points in our review process.<!p>";
emailText += "<p>Please feel free to contact Kelli Lamberty with any questions or concerns.  Thank you for your prompt attention to this matter.<!p>";
emailText += "<p>Thank you,<BR>Kelli Lamberty<BR>Community Events Coordinator<BR>Parks Division<BR>City of Madison<BR>210 MLK Jr. Blvd. Rm. 104<BR>Madison, WI 53703<BR>608-266-6033<BR>Like us on Facebook.<br>Follow us on Twitter @PlayMadison.<!p><!body><!html>";
if (contactEmail != "") {
	aa.sendEmail("klamberty@cityofmadisonDEV.com", contactEmail, "jmoyer@cityofmadison.com;
	",  emailSubject, emailText, reportFile);
	}
`^
EML;Permitting!Parks!Street Use!~;Issued^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "noEmail@cityofmadisonDev.com";
capModule = "Permitting";
include("EML;GetContactEmail");
include("CMN;Store_Report_To_Disk");
distList = "rbach@cityofmadisonDEV.com;
dbeck@cityofmadisonDEV.com;
sue.barica@wisconsinDEV.gov;
abitterman@cityofmadisonDEV.com;
mbrenneis@cityofmadisonDEV.com;
mwalizada@cityofmadison.com;
cgloede@cityofmadisonDEV.com;
fhodge@cityofmadisonDEV.com;
klamberty@cityofmadisonDEV.comDEV;
dmccaw@cityofmadisonDEV.com;
tmohr@cityofmadisonDEV.com;
sniesen@cityofmadisonDEV.com;
mobrien@cityofmadisonDEV.com;
cpedretti@cityofmadisonDEV.com;
jpratt@cityofmadisonDEV.com;
bputnam@cityofmadisonDEV.com;
rschwenn@cityofmadisonDEV.com;
ksellner@cityofmadisonDEV.com;
jvillarreal@cityofmadisonDEV.com;
mwinter@cityofmadisonDEV.com;
";
emailSubject = "Application " + capIDString + " Submitted for " + cName;
emailText = "<p>Attached is the approved "+ cName + " permit for your event taking place at " + AInfo['LOCATION INFORMATION.Location Requested'] + " during the time period of " + AInfo['EVENT INFORMATION.Date(s) of Event Including Setup and Take Down'] + ".<!p>";
emailText += "<p>Please review the conditions carefully and make sure your event is in compliance.  Let me know if you have questions or if you have trouble opening the file.  Have a great event!<!p>";
emailText += "<p>Thank you,<BR>Kelli Lamberty<BR>Community Events Coordinator<BR>Parks Division<BR>City of Madison<BR>210 MLK Jr. Blvd. Rm. 104<BR>Madison, WI 53703<BR>608-266-6033<BR>Like us on Facebook.  Follow us on Twitter @PlayMadison.<!p><!body><!html>";
if (contactEmail != "") {
	aa.sendEmail("klamberty@cityofmadisonDEV.com", contactEmail, "jmoyer@cityofmadisonDEV.com;
	",  emailSubject, emailText, reportFile);
	}
`^
EML;Permitting!Parks!Street Use!~;ReadyToIssue^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "noEmail@cityofmadisonDev.com";
capModule = "Permitting";
include("CMN;Store_Report_To_Disk");
distList = "rbach@cityofmadisonDEV.com;
dbeck@cityofmadisonDEV.com;
sue.barica@wisconsinDEV.gov;
abitterman@cityofmadisonDEV.com;
mbrenneis@cityofmadisonDEV.com;
mwalizada@cityofmadison.com;
cgloede@cityofmadisonDEV.com;
fhodge@cityofmadisonDEV.com;
klamberty@cityofmadisonDEV.com;
dmccaw@cityofmadisonDEV.com;
tmohr@cityofmadisonDEV.com;
sniesen@cityofmadisonDEV.com;
mobrien@cityofmadisonDEV.com;
cpedretti@cityofmadisonDEV.com;
jpratt@cityofmadisonDEV.com;
bputnam@cityofmadisonDEV.com;
rschwenn@cityofmadisonDEV.com;
ksellner@cityofmadisonDEV.com;
jvillarreal@cityofmadisonDEV.com;
mwinter@cityofmadisonDEV.com;
";
emailSubject = "Application " + capIDString + " Submitted for " + cName;
emailText = "<p>Please see attached.  Let me know if there are any edits or additions.<!p>";
emailText += "<p>Thank you,<BR>Kelli Lamberty<BR>Community Events Coordinator<BR>Parks Division<BR>City of Madison<BR>210 MLK Jr. Blvd. Rm. 104<BR>Madison, WI 53703<BR>608-266-6033<BR>Like us on Facebook.  Follow us on Twitter @PlayMadison.<!p><!body><!html>";
aa.sendEmail("klamberty@cityofmadisonDEV.com", "jmoyer@cityofmadisonDEV.com", "jmoyer@cityofmadisonDEV.com;
",  emailSubject, emailText, reportFile);
`^
EML;Permitting!Parks;TempPermit^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var bIsDailyPermit = false;
reportName =  "Parks Temp Permit";
if (AInfo['GENERAL INFORMATION.Permit Type'] == "Daily") {
	bIsDailyPermit = true;
	}

contactEmail = AInfo['MAILING INFORMATION.Email'];
contactName = AInfo['MAILING INFORMATION.First Name'] + " " + AInfo['MAILING INFORMATION.Last Name'];
contactCSZ = AInfo['MAILING INFORMATION.City'] + ", " + AInfo['MAILING INFORMATION.State'] + " " + AInfo['MAILING INFORMATION.Zip'];
if (bIsDailyPermit == false) {
	emailSubject = "Temp Parks " + cmnSubType + " Permit Attached";
	}

if (bIsDailyPermit == true) {
	emailSubject = "Parks Daily " + cmnSubType + " Permit Attached";
	}

emailText = "<html><body>";
emailText += "<p>Hello " + contactName + ",<!p>";
if (bIsDailyPermit == false) {
	emailText += "<p>Thank you for applying for a Parks " + cmnSubType + " Permit, you will find attached a temporary permit to show that you have paid for your permit. <!p>";
	}

if (bIsDailyPermit == true) {
	emailText += "<p>Thank you for applying for a Parks Daily " + cmnSubType + " Permit. The daily permit is attached. <!p>";
	}

if (bIsDailyPermit == false) {
	emailText += "<p>We will mail your permanant permit to <!p>";
	}

emailText += "<p>" + contactName + "<br>";
emailText += AInfo['MAILING INFORMATION.Address line 1'] + "<br>";
if (AInfo['MAILING INFORMATION.Address Line 2'] != null) {
	emailText +=AInfo['MAILING INFORMATION.Address Line 2'] + "<br>";
	}

emailText += contactCSZ + "<!p>";
if (bIsDailyPermit == false) {
	emailText += "<p>Your permanant permit should arrive in the mail within 14 days but until then, please keep this temp permit on you or have it available to show if asked by a Park Ranger.<!p>";
	}

if (bIsDailyPermit == true) {
	emailText += "<p>Please keep this permit on you or have it available to show if asked by a Park Ranger.<!p>";
	}

emailText += "<p>Again, Thank you,<!p>";
emailText += "<p>Parks Division<br>";
emailText += "210 Martin Luther King Jr Blvd<br>";
emailText += "Room 104<br>";
emailText += "Madison, WI 53703<br>";
emailText += "<a href='http;!!www.cityofmadison.com!Parks'>http;!!www.cityofmadison.com!Parks<!a><!p>";
emailText += "<!body><!html>";
if (contactEmail != "") {
	reportViewAttachEmail(true, true, reportName, "noreply@cityofmadison.com", contactEmail, "mwalizada@cityofmadison.com", emailSubject, emailText, false,"");
	}

if (contactEmail != "") {
	aa.sendEmail("noreply@cityofmadison.com", "mwalizada@cityofmadison.com", "mwalizada@cityofmadison.com",  emailSubject, emailText, "");
	}
`^
EML;Permitting!Traffic Engineering!Bicycle Registration!~;Submitted^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = true;
contactEmail = "";
emailText = "";
emailSubject ="";
ca = getContactArray();
contactEmail = ca[0]["email"];
emailSubject = "Bicycle Registration Received";
emailText += "<p>Thank you for registering your bicycle or renewing your bicycle registration online.<!p>";
emailText += "<p>Online registrations are usually processed within one week, but this process may occasionally take up to two weeks.<!p>";
emailText += "<p>Your Bicycle Registration Decal will be mailed to you once your registration has been processed.<!p>";
emailText += "<p>If you have questions or concerns, please contact the Bicycle Registration Program at;  bikereg@cityofmadisonDEV.com<!p>";
if (contactEmail != "") {
	aa.sendEmail("noreply@cityofmadisonDEV.com", contactEmail, contactEmail,  emailSubject, emailText, "");
	}
`^
EML;Permitting!Traffic Engineering!Driveway!Commercial;IntakeComplete^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
emailText = "<html><body><p>" + cmnType + " Record created by " + currentUserID + "<!p>";
ca = getContactArray();
emailSubject = "Record " + capIDString + " ready for Electrical Review.";
emailText += "<b>Category<!b> " + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
include("EML;AddressInformation");
emailText += "<!p><!body><!html>";
aa.sendEmail("noreply@cityofmadison.com", "cehagen@cityofmadison.com", "", emailSubject, emailText, "");
`^
EML;Permitting!Traffic Engineering!Driveway!Commercial;Issued^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
emailText = "<html><body><p>" + cmnType + " Record created by " + currentUserID + "<!p>";
ca = getContactArray();
emailSubject = "Record " + capIDString + " Issued.";
emailText += "<b>Category<!b> " + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
include("EML;AddressInformation");
emailText += "<!p><!body><!html>";
reportName = "Commercial Driveway Permit";
reportViewAttachEmail(false, true, reportName, "noreply@cityofmadison.com", "kgrittner@cityofmadison.com", "", emailSubject, emailText, false, "" );
`^
EML;Permitting!Traffic Engineering!Driveway!Commercial;SigningAssigned^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
emailText = "<html><body><p>" + cmnType + " Record created by " + currentUserID + "<!p>";
ca = getContactArray();
emailSubject = "Record " + capIDString + " has been assigned for Signing and Marking.";
emailText += "<b>Category<!b> " + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
include("EML;AddressInformation");
emailText += "<!p><!body><!html>";
aa.sendEmail("noreply@cityofmadison.com", "kgrittner@cityofmadison.com", "", emailSubject, emailText, "");
`^
EML;Permitting!Traffic Engineering!Street Occupancy!NA;Fees^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "noEmail@cityofmadisonDEV.com";
include("EML;GetContactEmail");
reportFile = "";
cName = "Street Occupancy";
emailSubject = "Fees are Ready for your " + cName + " Application (" + capIDString + ")";
emailText = "<html><body><p>Hello " + contactFName + " " + contactLName + ",<!p>";
emailText += "<p>The application materials for your " + cName + "  have been successfully processed and approved.<!p>";
if (contactEmail != "") {
	puResult = aa.publicUser.getPublicUserByEmail(contactEmail).getOutput();
	}

if (puResult == null) {
	emailText += "<p>You may now pay your fee(s).  Please mail a check to the address below.<!p>";
	}

if (puResult == null) {
	emailText += "<p>Please login to the <a href='https;!!elam.cityofmadison.com!CitizenAccess!'>City of Madison Licenses & Permits<!a> website to pay the fees.<br>";
	}

if (puResult == null) {
	emailText += "Once logged in click on 'Search Permit Applications'.<br>";
	}

if (puResult == null) {
	emailText += "Locate the Permit number (" + capIDString + ").<br>";
	}

if (puResult == null) {
	emailText += "In the Status column click on the 'Pay Fees Due' and follow the remaining steps.<br>";
	}

if (puResult == null) {
	emailText += "MasterCard and Visa are accepted by the City of Madison.<br>";
	}

if (puResult == null) {
	emailText += "You are able to print a receipt at the end of the process.<br>";
	}

if (puResult != null) {
	emailText += "<p>You may now pay your fee(s).  Directions below;<!p>";
	}

if (puResult != null) {
	emailText += "<p>Please login to the <a href='https;!!elam.cityofmadison.com!CitizenAccess!'>City of Madison Licenses & Permits<!a> website to pay the fees.<br>";
	}

if (puResult != null) {
	emailText += "Once logged in click on 'Search Permit Applications'.<br>";
	}

if (puResult != null) {
	emailText += "Locate the Permit number (" + capIDString + ").<br>";
	}

if (puResult != null) {
	emailText += "In the Status column click on the 'Pay Fees Due' and follow the remaining steps.<br>";
	}

if (puResult != null) {
	emailText += "MasterCard and Visa are accepted by the City of Madison.<br>";
	}

if (puResult != null) {
	emailText += "You are able to print a receipt at the end of the process.<br>";
	}

emailText += "<p>Thank you,<BR>Traffic Engineering<BR><!p><!body><!html>";
emailText += "<BR>215 Martin Luther King, Jr. Blvd.,Suite 100<BR>P.O. Box 2983<BR>City of Madison, Wisconsin 53701-2983<!p>";
if (contactEmail != "") {
	aa.sendEmail("noreply@cityofmadisonDEV.com", contactEmail, "rsjachrani@cityofmadisonDEV.com",  emailSubject, emailText, reportFile);
	}
`^
EML;Permitting!Traffic Engineering!Street Occupancy!NA;Issued^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
reportFile = "";
!!reportRunSave("Street Occupancy", false, false, true);
include("EML;GetContactEmail");
cName = "Street Occupancy";
emailSubject = "Permit Issued (" + capIDString + ") for " + cName;
emailText = "<html><body><p>Hello " + contactFName + " " + contactLName + ",<!p>";
emailText += "<p>Thank you for applying for and receiving your " + cName + " Permit. <!p>";
emailText += "<p>Your permit has been issued. If you did not apply online, you will receive a copy of your permit in a separate email.<!p>";
if (contactEmail != "") {
	puResult = aa.publicUser.getPublicUserByEmail(contactEmail).getOutput();
	}

if (puResult != null) {
	emailText += "<p>At any time you may login to <a href='https;!!elam.cityofmadison.com!CitizenAccess!'>City of Madison Licenses & Permits<!a> website to download the permit from attached documents.  Directions below;<!p>";
	}

if (puResult != null) {
	emailText += "Once logged in click on 'Search Permit Applications'.<br>";
	}

if (puResult != null) {
	emailText += "Locate the Permit number (" + capIDString + ") and click on the number.<br>";
	}

if (puResult != null) {
	emailText += "Near the bottom of the page is the Documents section.  Expand and review!print your documents.<br>";
	}

emailText += "<p>Thank you,<BR>Traffic Engineering<BR>";
emailText += "<BR>215 Martin Luther King, Jr. Blvd., Suite 100<BR>P.O. Box 2983<BR>City of Madison, Wisconsin 53701-2983<!p>";
emailText += "<p>608 266-4761 Phone<BR>608 267-1158 Fax<BR>traffic@cityofmadisonDEV.com<!p><!body><!html>";
if (contactEmail != "") {
	aa.sendEmail("noreply@cityofmadisonDEV.com", contactEmail, "jmoyer@cityofmadisonDEV.com",  emailSubject, emailText, reportFile);
	}
`^
EML;Permitting!Vending!Banner!NA;CRCAAppSubmitted^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "noEmail@cityofmadisonDEV.com";
include("EML;GetCurrentUserEmail");
reportFile = "";
cName = "Banner Permit";
emailSubject = "Application " + capId.getCustomID() + " Submitted for " + cName;
emailText = "<html><body><p>Hello " + userFirst + " " + userLast + ",<!p>";
emailText += "<p>Thank you for submitting your application for a " + cName + ".<!p>";
emailText += "<p>Your  " + cName + " application (" + capId.getCustomID() + ") has been received and is being reviewed by the City of Madison Street Vending Coordinator.<!p>";
emailText += "<p>Please keep this number available for future reference. <!p>";
emailText += "<p>You may login to the <a href='https;!!elam.cityofmadison.com!CitizenAccess!'>City of Madison Licenses & Permits<!a> website to review the status of your application, pay fees when they are available for payment, view the permit and!or receipt when they are available, and attach needed documents.<!p>";
emailText += "<p>Additional emails will be sent at key points in the process as reminders of action needed or updates in the status of your application.<!p>";
emailText += "<p>Thank you,<BR>Eric Melton-White<BR>Street Vending Monitor<BR>Office of Business Resources<BR>Department of Planning & Community & Economic Development";
emailText += "<BR>30 W Mifflin Street<BR>P.O. Box 2983<BR>City of Madison, Wisconsin 53703<!p>";
emailText += "608 261 9149 Phone<BR>608 261 6126 Fax<BR>emelton-white@cityofmadison.com<!body><!html>";
aa.sendEmail("emelton-white@cityofmadisonDEV.com", userEmail, "jgoltz@cityofmadisonDEV.com",  emailSubject, emailText, reportFile);
`^
EML;Permitting!Vending!Banner!NA;Fees^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "";
include("EML;GetContactEmail_Banner");
reportFile = "";
cName = "Banner Assignment";
emailSubject = "Fees are Ready for " + cName + " Application (" + capIDString + ")";
if (contactLName != "lastName" && contactFName != "firstName") {
	emailText = "<html><body><p>Hello " + contactFName + " " + contactLName + ",<!p>";
	}

if (contactLName == "lastName" && contactFName == "firstName") {
	emailText = "<html><body><p>Hello Banner Applicant,<!p>";
	}

emailText += "<p>The application materials for your " + cName + "  have been successfully processed and approved.<!p>";
if (contactEmail != "") {
	puResult = aa.publicUser.getPublicUserByEmail(contactEmail).getOutput();
	}

if (puResult == null) {
	emailText += "<p>You may now pay your fee(s).  Please mail a check to the address below.  Checks are payable to City Treasurer.<!p>";
	}

if (puResult != null) {
	emailText += "<p>You may now pay your fee(s).  Directions below;<!p>";
	}

if (puResult != null) {
	emailText += "<p>Please login to the <a href='https;!!elam.cityofmadison.com!CitizenAccess!'>City of Madison Licenses & Permits<!a> website to pay the fees.<br>";
	}

if (puResult != null) {
	emailText += "Once logged in click on 'Search Permit Applications'.<br>";
	}

if (puResult != null) {
	emailText += "Locate the Permit number (" + capIDString + ").<br>";
	}

if (puResult != null) {
	emailText += "In the Status column click on the 'Pay Fees Due' and follow the remaining steps.<br>";
	}

if (puResult != null) {
	emailText += "MasterCard and Visa are accepted by the City of Madison.<br>";
	}

if (puResult != null) {
	emailText += "You are able to print a receipt at the end of the process.<br>";
	}

emailText += "<p>Thank you,<BR>Eric Melton-White<BR>Street Vending Monitor<BR>Office of Business Resources<BR>Department of Planning & Community & Economic Development";
emailText += "<BR>30 W Mifflin Street<BR>P.O. Box 2983<BR>City of Madison, Wisconsin 53703<!p>";
emailText += "<p>608 261 9171 Phone<BR>608 261 6126 Fax<BR>emelton-white@cityofmadison.com<!p><!body><!html>";
if (contactEmail != "") {
	aa.sendEmail("jgoltz@cityofmadisonDEV.com", contactEmail, "jgoltz@cityofmadisonDEV.com",  emailSubject, emailText, reportFile);
	}
`^
EML;Permitting!Vending!Banner!NA;InsDeclined^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "noEmail@cityofmadisonDEV.com";
include("EML;GetContactEmail_Banner");
reportFile = "";
cName = "Banner Assignment";
emailSubject = "Insurance for " + cName + " Application (" + capIDString + ")";
emailText = "<html><body><p>Hello " + contactFName + " " + contactLName + ",<!p>";
emailText += "<p>The insurance you submitted on your application for a " + cName + " permit was denied. <!p>";
emailText += "<p>If no reason is given below someone will be in contact with you.<!p>";
if (wfComment != null) {
	emailText += "<p>Reason; " + wfComment + "<!p>";
	}

emailText += "<p>The application process for this application(" + capIDString + ") has closed.<!p>";
emailText += "<p>Thank you,<BR>Eric Melton-White<BR>Street Vending Monitor<BR>Office of Business Resources<BR>Department of Planning & Community & Economic Development";
emailText += "<BR>30 W Mifflin Street<BR>P.O. Box 2983<BR>City of Madison, Wisconsin 53703<!p>";
emailText += "<p>608 261 9171 Phone<BR>608 261 true;
if (contactEmail != "") {
	aa.sendEmail("jgoltz@cityofmadisonDEV.com", contactEmail, "mcouper@cityofmadisonDEV.com",  emailSubject, emailText, reportFile);
	}
`^
EML;Permitting!Vending!Banner!NA;InsInfo^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "noEmail@cityofmadisonDEV.com";
include("EML;GetContactEmail_Banner");
reportFile = "";
cName = "Banner Assignment";
emailSubject = "Insurance for " + cName + " Application (" + capIDString + ")";
emailText = "<html><body><p>Hello " + contactFName + " " + contactLName + ",<!p>";
emailText += "<p>The insurance you submitted on your application for a " + cName + " permit was incomplete. <!p>";
emailText += "<p>If no reason is given below someone will be in contact with you.<!p>";
if (wfComment != null) {
	emailText += "<p>Reason; " + wfComment + "<!p>";
	}

if (contactEmail != "") {
	puResult = aa.publicUser.getPublicUserByEmail(contactEmail).getOutput();
	}

if (puResult != null) {
	emailText += "<p>You may login to <a href='https;!!elam.cityofmadison.com!CitizenAccess!'>City of Madison Licenses & Permits<!a> website to review!attach needed documents.<!p>";
	} else {
	emailText += "<p>Contact the Street Vending Coordinator to correct this issue.<!p>";
	}

emailText += "<p>The application process will not continue until this matter is completed.<!p>";
emailText += "<p>Thank you,<BR>Eric Melton-White<BR>Street Vending Monitor<BR>Office of Business Resources<BR>Department of Planning & Community & Economic Development";
emailText += "<BR>30 W Mifflin Street<BR>P.O. Box 2983<BR>City of Madison, Wisconsin 53703<!p>";
emailText += "<p>608 261 9149 Phone<BR>608 261 6126 Fax<BR>emelton-white@cityofmadison.com<!p><!body><!html>";
if (contactEmail != "") {
	aa.sendEmail("jgoltz@cityofmadisonDEV.com", contactEmail, "jgoltz@cityofmadisonDEV.com",  emailSubject, emailText, reportFile);
	}
`^
EML;Permitting!Vending!Banner!NA;InsNeeded^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "noEmail@cityofmadisonDEV.com";
include("EML;GetContactEmail_Banner");
reportFile = "";
cName = "Banner Assignment";
emailSubject = "Insurance for " + cName + " Application (" + capIDString + ")";
emailText = "<html><body><p>Hello " + contactFName + " " + contactLName + ",<!p>";
emailText += "<p>The insurance information needed was not submitted with your application for a " + cName + " permit.<!p>";
emailText += "<p>To submit the insurance;<!p>";
if (contactEmail != "") {
	puResult = aa.publicUser.getPublicUserByEmail(contactEmail).getOutput();
	}

if (puResult != null) {
	emailText += "<p>You may login to <a href='https;!!elam.cityofmadison.com!CitizenAccess!'>City of Madison Licenses & Permits<!a> website to review!attach needed documents or mail the needed documents to the address below.<!p>";
	} else {
	emailText += "<p>Please, mail the needed documents to the address below.<!p>";
	}

if (puResult != null) {
	emailText += "Once logged in click on 'Search Permit Applications.<br>";
	}

if (puResult != null) {
	emailText += "Locate the Permit number (" + capIDString + ") and click on it.<br>";
	}

if (puResult != null) {
	emailText += "Click on the arrow to the left of the word Attachments.<br>";
	}

if (puResult != null) {
	emailText += "Search for the file you wish to attach, fill in the appropriate boxes and click Attach.<br>";
	}

emailText += "<p>The application process will not continue until this matter is resolved.<!p>";
emailText += "<p>Thank you,<BR>Eric Melton-White<BR>Street Vending Monitor<BR>Office of Business Resources<BR>Department of Planning & Community & Economic Development";
emailText += "<BR>30 W Mifflin Street<BR>P.O. Box 2983<BR>City of Madison, Wisconsin 53703<!p>";
emailText += "<p>608 261 9149 Phone<BR>608 261 6126 Fax<BR>emelton-white@cityofmadison.com<!p><!body><!html>";
if (contactEmail != "") {
	aa.sendEmail("jgoltz@cityofmadisonDEV.com", contactEmail, "jgoltz@cityofmadisonDEV.com",  emailSubject, emailText, reportFile);
	}
`^
EML;Permitting!Vending!Banner!NA;Issuance^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
true;
include("EML;GetContactEmail_Banner");
cName = "Banner Assignment";
include("CMN;Banner_Store_Report_To_Disk");
emailSubject = "Permit Issued (" + capIDString + ") for " + cName;
emailText = "<html><body><p>Hello " + contactFName + " " + contactLName + ",<!p>";
emailText += "<p>Thank you for applying for and receiving your " + cName + " Permit. <!p>";
emailText += "<p>Your permit has been issued. If you did not apply online, you will receive a copy of your permit in a separate email.<!p>";
varLocTable = new Array();
varLocTable = loadASITable("DATES REQUESTED");
for(x in varLocTable) include("CMN;BANNERASIT");
if (contactEmail != "") {
	puResult = aa.publicUser.getPublicUserByEmail(contactEmail).getOutput();
	}

if (puResult != null) {
	emailText += "<p>At any time you may login to <a href='https;!!elam.cityofmadison.com!CitizenAccess!'>City of Madison Licenses & Permits<!a> website to download the permit from attached documents.  Directions below;<!p>";
	}

if (puResult != null) {
	emailText += "Once logged in click on 'Search Permit Applications'.<br>";
	}

if (puResult != null) {
	emailText += "Locate the Permit number (" + capIDString + ") and click on the number.<br>";
	}

if (puResult != null) {
	emailText += "Near the bottom of the page is the Documents section.  Expand and review!print your documents.<br>";
	}

emailText += "<p>Thank you,<BR>Eric Melton-White<BR>Street Vending Monitor<BR>Office of Business Resources<BR>Department of Planning & Community & Economic Development";
emailText += "<BR>30 W Mifflin Street<BR>P.O. Box 2983<BR>City of Madison, Wisconsin 53703<!p>";
emailText += "<p>608 261 9149 Phone<BR>608 261 6126 Fax<BR>emelton-white@cityofmadison.com<!p><!body><!html>";
if (contactEmail != "") {
	aa.sendEmail("emelton-white@cityofmadisonDEV.com", contactEmail, "jgoltz@cityofmadisonDEV.com",  emailSubject, emailText, reportFile);
	}
`^
EML;Permitting!Vending!TEM!NA;CRCAAppSubmitted^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "noEmail@cityofmadisonDEV.com";
include("EML;GetCurrentUserEmail");
reportFile = "";
cName = "TEM Permit";
emailSubject = "Application " + capId.getCustomID() + " Submitted for " + cName;
emailText = "<html><body><p>Hello " + userFirst + " " + userLast + ",<!p>";
emailText += "<p>Thank you for submitting your application for a " + cName + ".<!p>";
emailText += "<p>Your  " + cName + " application (" + capId.getCustomID() + ") has been received and is being reviewed by the City of Madison Street Vending Coordinator.<!p>";
emailText += "<p>Please keep this number available for future reference. <!p>";
emailText += "<p>You may login to the <a href='https;!!elam.cityofmadison.com!CitizenAccess!'>City of Madison Licenses & Permits<!a> website to review the status of your application, pay fees when they are available for payment, view the permit and!or receipt when they are available, and attach needed documents.<!p>";
emailText += "<p>Additional emails will be sent at key points in the process as reminders of action needed or updates in the status of your application.<!p>";
emailText += "<p>Thank you,<BR>Warren Hansen<BR>Street Vending Coordinator<BR>Office of Business Resources<BR>Department of Planning & Community & Economic Development";
emailText += "<BR>215 Martin Luther King, Jr. Blvd., Room 312<BR>P.O. Box 2983<BR>City of Madison, Wisconsin 53701-2983<!p>";
emailText += "608 261 9171 Phone<BR>608 261 6126 Fax<BR>whansen@cityofmadisonDEV.com<!body><!html>";
aa.sendEmail("whansen@cityofmadisonDEV.com", userEmail, "jmoyer@cityofmadisonDEV.com",  emailSubject, emailText, reportFile);
`^
EML;Permitting!Vending!TEM!NA;Fees^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "noEmail@cityofmadisonDEV.com";
include("EML;GetContactEmail");
reportFile = "";
cName = "Table (TEM) Permit";
emailSubject = "Fees are Ready for " + cName + " Application (" + capIDString + ")";
emailText = "<html><body><p>Hello " + contactFName + " " + contactLName + ",<!p>";
emailText += "<p>The application materials for your " + cName + "  have been successfully processed and approved.<!p>";
if (contactEmail != "") {
	puResult = aa.publicUser.getPublicUserByEmail(contactEmail).getOutput();
	}

if (puResult == null) {
	emailText += "<p>You may now pay your fee(s).  Please mail a check to the address below.  Checks are payable to City Treasurer.<!p>";
	}

if (puResult != null) {
	emailText += "<p>You may now pay your fee(s).  Directions below;<!p>";
	}

if (puResult != null) {
	emailText += "<p>Please login to the <a href='https;!!elam.cityofmadison.com!CitizenAccess!'>City of Madison Licenses & Permits<!a> website to pay the fees.<br>";
	}

if (puResult != null) {
	emailText += "Once logged in click on 'Search Permit Applications'.<br>";
	}

if (puResult != null) {
	emailText += "Locate the Permit number (" + capIDString + ").<br>";
	}

if (puResult != null) {
	emailText += "In the Status column click on the 'Pay Fees Due' and follow the remaining steps.<br>";
	}

if (puResult != null) {
	emailText += "MasterCard and Visa are accepted by the City of Madison.<br>";
	}

if (puResult != null) {
	emailText += "You are able to print a receipt at the end of the process.<br>";
	}

emailText += "<p>Thank you,<BR>Warren Hansen<BR>Street Vending Coordinator<BR>Office of Business Resources<BR>Department of Planning & Community & Economic Development";
emailText += "<BR>215 Martin Luther King, Jr. Blvd., Room 312<BR>P.O. Box 2983<BR>City of Madison, Wisconsin 53701-2983<!p>";
emailText += "<p>608 261 9171 Phone<BR>608 261 6126 Fax<BR>whansen@cityofmadisonDEV.com<!p><!body><!html>";
if (contactEmail != "") {
	aa.sendEmail("jmoyer@cityofmadisonDEV.com", contactEmail, "mcouper@cityofmadisonDEV.com",  emailSubject, emailText, reportFile);
	}
`^
EML;Permitting!Vending!TEM!NA;LicenseIssued^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
reportFile = "";
include("EML;GetContactEmail");
cName = "Tables(TEM) ";
include("CMN;Vending_Store_Report_To_Disk");
emailSubject = "Permit Issued (" + capIDString + ") for " + cName;
emailText = "<html><body><p>Hello " + contactFName + " " + contactLName + ",<!p>";
emailText += "<p>Thank you for applying for and receiving your " + cName + " Permit. <!p>";
emailText += "<p>Your permit has been issued. If you did not apply online, you will receive a copy of your permit in a separate email.<!p>";
if (contactEmail != "") {
	puResult = aa.publicUser.getPublicUserByEmail(contactEmail).getOutput();
	}

if (puResult != null) {
	emailText += "<p>At any time you may login to <a href='https;!!elam.cityofmadison.com!CitizenAccess!'>City of Madison Licenses & Permits<!a> website to download the permit from attached documents.  Directions below;<!p>";
	}

if (puResult != null) {
	emailText += "Once logged in click on 'Search Permit Applications'.<br>";
	}

if (puResult != null) {
	emailText += "Locate the Permit number (" + capIDString + ") and click on the number.<br>";
	}

if (puResult != null) {
	emailText += "Near the bottom of the page is the Documents section.  Expand and review!print your documents.<br>";
	}

emailText += "<p>Thank you,<BR>Eric Melton-White<BR>Street Vending Monitor<BR>Office of Business Resources<BR>Department of Planning & Community & Economic Development";
emailText += "<BR>30 W Mifflin Street<BR>P.O. Box 2983<BR>City of Madison, Wisconsin 53703<!p>";
emailText += "<p>608 261 9149 Phone<BR>608 261 6126 Fax<BR>emelton-white@cityofmadison.com<!p><!body><!html>";
if (contactEmail != "") {
	aa.sendEmail("jgoltz@cityofmadisonDEV.com", contactEmail, "jgoltz@cityofmadisonDEV.com",  emailSubject, emailText, reportFile);
	}
`^
EML;ServiceRequest!~!~!~;UpdateAssignedBy^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
emailTo = "";
emailCc = "";
statusUpdate = "";
strComment = "";
strAssignedBy = "";
!!vEventName to determine from Event;
if (cmnType == "Information Technology") {
	lblShortNotes = "Iteration;";
	} else {
	lblShortNotes = "Location;";
	}

recDescription = workDescGet(capId);
recShortDescription = recDescription.replace("R"," ");
recShortNotes = getShortNotes(capId);
recType = cmnType + "!" + cmnSubType + "!" + cmnCategory;
recType = recType.toUpperCase();
recType = recType.replace("!NA","");
if (vEventName == "ApplicationStatusUpdateAfter") {
	statusUpdate = appStatus;
	if(statusComment != null) strComment = statusComment;
	}

if (vEventName == "WorkflowTaskUpdateAfter") {
	statusUpdate = wfStatus;
	if(wfComment != null) strComment = wfComment;
	}

userId = currentUserID;
include("EML;GetUserIdEmail");
emailCc = userEmail + ";
";
userEmail = "";
if (AInfo['TRACKING INFORMATION.Record Assigned By'] != null && AInfo['TRACKING INFORMATION.Record Assigned By'] != "") {
	strAssignedBy = AInfo['TRACKING INFORMATION.Record Assigned By'];
	}

if (AInfo['TRACKING INFORMATION.Task Assigned By'] != null && AInfo['TRACKING INFORMATION.Task Assigned By'] != "" && strAssignedBy.indexOf("ITRMS") == -1) {
	strAssignedBy = strAssignedBy.concat(AInfo['TRACKING INFORMATION.Task Assigned By']);
	}

if (strAssignedBy  != "") {
	arrAssignedBy = strAssignedBy.split(',');
	for(i=0;
	i < arrAssignedBy.length;
	i++) include("ConcatUserIdEmail");
	}

if (userEmail != "") {
	emailTo = userEmail.replace(emailCc,"");
	}

emailSubject = "Status updated; "+statusUpdate;
!!Default Subject;
if (statusUpdate == "Administrative Close" || statusUpdate == "Work Order Review" || statusUpdate == "Ready for Response") {
	emailSubject = "Ready for Primary Engineer Response";
	}

if (statusUpdate == "Complete") {
	emailSubject="Completed";
	}

emailSubject = emailSubject + " (" + capIDString + ") " + recShortNotes;
emailText = "<html><body>";
emailText += "<p>This is an Accela auto-notification letting you know that a Request you assigned has been updated.<!p>";
emailText += "<p><b>Work Description<!b>;<br> "+ recDescription + "<!p>";
if (recShortNotes != "") {
	emailText += "<p><b>" + lblShortNotes + "<!b>; " + recShortNotes + "<!p>";
	}

if (strComment != "") {
	emailText += "<p><b>Comment<!b>; " + strComment + "<!p>";
	}

emailText += "<b>Record;<!b> <a href=" + "" + "https;!!avdev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=Permitting&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a><br><br><!body><!html>";
emailText += "<p>For Additional Information please log into Accela<!p>";
if (emailTo != "") {
	aa.sendEmail("noreply@cityofmadisonDEV.com", emailTo, emailCc, emailSubject, emailText, "");
	}
`^
EML;ServiceRequest!Engineering - Facility!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emailSubject =  "Service Request# " + capIDString + " "+ capStatus;
include("EML;ApplicantInformation");
emailText = "<b>Category; <!b>" + cmnType + " " + cmnSubType + "; " + cmnCategory + "<br><br>";
emailText += "<p><b>Facility; <!b>" + getAppSpecific("SR - ENGINEERING MAINTENANCE.Facility");
emailText += "<p><b>Service Request;<!b>  <a href=" + "" + "https;!!avdev.cityofmadison.com;444!portlets!cap!capDetail.do?mode=list&module=ServiceRequest&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a> " + capStatus + "<br><br>";
emailText += "<p><b>Description;<!b>" + workDescGet(capId) + "<!p>";
if (wfComment != null) {
	emailText += "<p><b>Task Comments;<!b>" + wfComment + "<!p>";
	}

ci = getChildren("~!~!~!~");
if (ci != null) {
	emailText += "<b>Work Order Information<!b><br><br>";
	for (ci1 in ci) emailText += "<a href=" + "" + "https;!!avdev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=AMS&serviceProviderCode=MADISON&ID1=" + ci[ci1].getID1() + "&ID2=" + ci[ci1].getID2()  + "&ID3=" + ci[ci1].getID3()  + "&clearForm=clearForm" + "" + ">" + ci[ci1].getCustomID() + "<!a><br>";
	}

emailText += "<!body><!html>";
`^
EML;ServiceRequest!Engineering!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emailSubject =  "Service Request# " + capIDString + " "+ capStatus;
include("EML;ApplicantInformation");
emailText = "<b>Category; <!b>" + cmnType + " " + cmnSubType + "; " + cmnCategory + "<br><br>";
emailText += "<p><b>Service Request;<!b>  <a href=" + "" + "https;!!avdev.cityofmadison.com;444!portlets!cap!capDetail.do?mode=list&module=ServiceRequest&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a><br><br> " + capStatus + "<br><br>";
emailText += "<p><b>Description;<!b>" + workDescGet(capId) + "<!p>";
if (wfComment != null) {
	emailText += "<p><b>Task Comments;<!b>" + wfComment + "<!p>";
	}

ci = getChildren("~!~!~!~");
if (ci != null) {
	emailText += "<b>Work Order Information<!b><br><br>";
	for (ci1 in ci) emailText += "<a href=" + "" + "https;!!avdev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=AMS&serviceProviderCode=MADISON&ID1=" + ci[ci1].getID1() + "&ID2=" + ci[ci1].getID2()  + "&ID3=" + ci[ci1].getID3()  + "&clearForm=clearForm" + "" + ">" + ci[ci1].getCustomID() + "<!a><br>";
	}

emailText += "<!body><!html>";
`^
EML;ServiceRequest!Engineering!Dead Animal Collection!NA;Internal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emailSubject = "Dead Animal Collection  ";
include("EML;ApplicantInformation");
emailText += "<b>Category; Dead Animal Collection<!b><br><br>  ";
emailText += "<p>Location Type; 	" + AInfo['SR-DEADANIMAL.Location Type'] + "<br>";
emailText += "Traffic Lane; 	" + AInfo['SR-DEADANIMAL.Traffic Lane']  + "<br>";
emailText += "Location; 	" + AInfo['SR-DEADANIMAL.Location']  + "<br>";
emailText += "Traffic Lane; 	" + AInfo['SR-DEADANIMAL.Traffic Lane']  + "<br>";
emailText += "Request Contact; 	" + AInfo['SR-DEADANIMAL.Contact']  + "<br>";
emailText += "<p>Description<br>" + workDescGet(capId) + "<!p><!body><!html>";
`^
EML;ServiceRequest!Information Technology!Accela Change Request!NA;AgencyReview^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
approverEmail = "";
approverFirst = "";
approverLast = "";
include("CMN;SR-IT_GetApproverRoles");
var workDes = workDescGet(capId);
workDes.length() > 250;
if (approverUID != null) {
	userId = approverUID;
	include("EML;GetUserIdEmail");
	approverEmail = userEmail;
	approverFirst = userFirst;
	approverLast = userLast;
	}

if (approverUID == "NOEMAIL") {
	approverEmail = " ";
	}

if (approverEmail != undefined && approverEmail != null && approverEmail != "") {
	var emailOK = true;
	} else {
	var emailOK = false;
	}

itAssignEmail = "glabelle-brown@cityofmadisonDEV.com;
";
!!poleary@cityofmadisonDEV.com;
rsjachrani@cityofmadisonDEV.com;
skauffeld@cityofmadisonDEV.com";
emailSubject = cmnSubType + " (" + capIDString + ") - " + wfTask + " - " + wfStatus;
emailText = "<html><body><p>" + cmnSubType + "; <a href='https;!!av.cityofmadison.com!portlets!cap!capDetail.do?mode=view&serviceProviderCode=MADISON&ID1="  + capId.getID1() + "&ID2=" + capId.getID2() + "&ID3=" + capId.getID3() + "&requireNotice=YES&clearForm=clearForm&module=" + cmnGroup + "&isGeneralCAP=Y'>" + capIDString + "<!a> has been set to; <b>" + wfStatus + "<!b> by " + approverFirst + " " + approverLast + ".<!p>";
emailText += "Service Request Reported By; " + reportByFirstName + " " + reportByLastName + "<br>";
emailText += "Service Request Status; " + capStatus + "<br>";
emailText += "Service Request Created; " + fileDate + "<!p>";
emailText += "Service Request Workflow Task; "  + wfTask +  "<!p>";
emailText += "Service Request Workflow Status; "  + wfStatus +  "<!p>";
if (workDes != null) {
	emailText += "<p>Service Request Description; " + workDescGet(capId)  + "<!p>";
	}

if (wfComment != null) {
	emailText += "<p>Comments; " + wfComment + "<!p>";
	}

emailText += "<!body><!html>";
if ((wfStatus == "Accepted" || wfStatus == "Declined" || wfStatus == "Withdrawn") && emailOK == true) {
	aa.sendEmail("noreply@cityofmadisonDEV.com", reportByEmail, itAssignEmail,  emailSubject, emailText, "");
	}

if (wfStatus == "Additional Info Required" && emailOK == true) {
	aa.sendEmail("noreply@cityofmadisonDEV.com", reportByEmail, "",  emailSubject, emailText, "");
	}

if (emailOK == false) {
	emailText += "<p><b>Error;<!b> Could not find email address for Agency Approver (" + approverUID + ")<!p>";
	emailSubject = "Error; IT Service Request Notification failed for " + capIDString;
	aa.sendEmail("noreply@cityofmadisonDEV.com", "elamsupport@cityofmadisonDEV.com", "",  emailSubject, emailText, "");
	}

if (emailOK == false) {
	showMessage = true;
	comment("Invalid email address for Agency Approver (" + approverUID + ").  An email was sent to Elam Support to correct this issue.");
	}
`^
EML;ServiceRequest!Information Technology!Accela Change Request!NA;AgencySupervisorSignoff^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
approverEmail = "";
approverFirst = "";
approverLast = "";
itDevEmail = "";
itDevFirst = "";
itDevLast = "";
itAssignEmail = "";
itAssignFirst = "";
itAssignLast = "";
include("CMN;SR-IT_GetApproverRoles");
var workDes = workDescGet(capId);
workDes.length() > 250;
if (approverUID != null) {
	userId = approverUID;
	include("EML;GetUserIdEmail");
	approverEmail = userEmail;
	approverFirst = userFirst;
	approverLast = userLast;
	}

if (approverUID == "NOEMAIL") {
	approverEmail = " ";
	}

if (approverEmail != undefined && approverEmail != null && approverEmail != "") {
	var emailOK = true;
	} else {
	var emailOK = false;
	}

if (cmnSubType == "Accela Issue") {
	itDevtId = getAppSpecific("ISSUE DETAILS.Developer", capId);
	} else {
	itDevId = getAppSpecific("REQUEST DETAILS.Developer", capId);
	}

if (itDevId != null) {
	userId = itDevId;
	include("EML;GetUserIdEmail");
	itDevEmail = userEmail;
	itDevFirst = userFirst;
	itDevLast = userLast;
	}

if (itDevEmail != undefined && itDevEmail != null && itDevEmail != "") {
	true;
	} else {
	itDevEmail = "jmoyer@cityofmadisonDEV.com;
	";
	!! jschneider@cityofmadisonDEV.com;
	jtessman@cityofmadisonDEV.com;
	mcouper@cityofmadisonDEV.com;
	";
	}

itAssignId = capDetail.getAsgnStaff();
if (itAssignId != null) {
	userId = itAssignId;
	include("EML;GetUserIdEmail");
	itAssignEmail = userEmail;
	itAssignFirst = userFirst;
	itAssignLast = userLast;
	}

if (itAssignEmail != undefined && itAssignEmail != null && itAssignEmail != "") {
	true;
	} else {
	itAssignEmail = "glabelle-brown@cityofmadisonDEV.com;
	";
	!! poleary@cityofmadisonDEV.com;
	rsjachrani@cityofmadisonDEV.com;
	skauffeld@cityofmadisonDEV.com";
	}

emailSubject = cmnSubType + " (" + capIDString + ") - " + wfTask + " - " + wfStatus;
emailText = "<html><body><p>"+cmnSubType + "; <a href='https;!!av.cityofmadison.com!portlets!cap!capDetail.do?mode=view&serviceProviderCode=MADISON&ID1="  + capId.getID1() + "&ID2=" + capId.getID2() + "&ID3=" + capId.getID3() + "&requireNotice=YES&clearForm=clearForm&module=" + cmnGroup + "&isGeneralCAP=Y'>" + capIDString + "<!a> has been set to <b>" + wfStatus + "<!b> by " + approverFirst + " " + approverLast + ".<!p>";
emailText += "Service Request Reported By; " + reportByFirstName + " " + reportByLastName + "<br>";
emailText += "Service Request Created; " + fileDate + "<!p>";
emailText += "Service Request Workflow Task; "  + wfTask +  "<!p>";
emailText += "Service Request Workflow Status; "  + wfStatus +  "<!p>";
if (itDevId != null) {
	emailText += "Service Request IT Developer; "  + itDevFirst + " " + itDevLast +  "<!p>";
	} else {
	emailText += "Service Request IT Developer; not assigned at this time<!p>";
	}

if (itAssignId != null) {
	emailText += "Service Request IT Assigned; "  + itAssignFirst + " " + itAssignLast +  "<!p>";
	} else {
	emailText += "Service Request IT Assigned; not assigned at this time<!p>";
	}

if (workDes != null) {
	emailText += "<p>Service Request Description; " + workDescGet(capId)  + "<!p>";
	}

if (wfComment != null) {
	emailText += "<p>Comments; " + wfComment + "<!p>";
	}

emailText += "<!body><!html>";
if (wfStatus == "More Testing Needed") {
	aa.sendEmail("noreply@cityofmadisonDEV.com", reportByEmail, "poleary@cityofmadisonDEV.com",  emailSubject, emailText, "");
	}

if ((wfStatus == "Approved" || wfStatus == "Withdrawn") && emailOK == true) {
	aa.sendEmail("noreply@cityofmadisonDEV.com", reportByEmail + ";
	" + itDevEmail, "poleary@cityofmadisonDEV.com",  emailSubject, emailText, "");
	}

if (emailOK == false) {
	emailText += "<p><b>Error;<!b> Could not find email address for Agency Approver (" + approverUID + ")<!p>";
	emailSubject = "Error; IT Service Request Notification failed for " + capIDString;
	aa.sendEmail("noreply@cityofmadisonDEV.com", "elamsupport@cityofmadisonDEV.com", "",  emailSubject, emailText, "");
	}

if (emailOK == false) {
	showMessage = true;
	comment("Invalid email address for Agency Approver (" + approverUID + ").  An email was sent to Elam Support to correct this issue.");
	}
`^
EML;ServiceRequest!Information Technology!Accela Change Request!NA;CreationEmail^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
emailSubject = "Service Request - " + cmnSubType + " - " + capIDString;
emailText = "<html><body><p>Service Request; " + capIDString + "<!p>";
emailText += "<p>Service Request Type; " + cmnSubType + "<!p>";
emailText += "Service Request Status; " + capStatus + "<!p>";
emailText += "Service Request Created; " + fileDate + "<!p>";
if (workDescGet(capId) != null) {
	emailText += "<p>Description; " + workDescGet(capId)  + "<!p>";
	}

if (cmnSubType == "Accela Change Request") {
	emailText += "<p>Service Request Details; " + AInfo['REQUEST DETAILS.This request is for ...'] + " for Module - " + AInfo['REQUEST DETAILS.Module']  +  "<!p>";
	} else {
	emailText += "<p>Issue Details; " + AInfo['ISSUE DETAILS.This issue is about'] + " for Module - " + AInfo['ISSUE DETAILS.Module']  +  "<!p>";
	}

userId =  capDetail.getCompleteStaff();
include("EML;GetUserIdEmail");
emailText += "<p>Service Request Reported By; " + userFirst + " " + userLast + " - ID; " + userId  + " <!p><!body><!html>";
sendAsyncEmail("noreply@cityofmadisonDEV.com", "glabelle-brown@cityofmadisonDEV.com", "poleary@cityofmadisonDEV.com", emailSubject, emailText, "");
`^
EML;ServiceRequest!Information Technology!Accela Change Request!NA;Deployment^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
approverEmail = "";
approverFirst = "";
approverLast = "";
itDevEmail = "";
itDevFirst = "";
itDevLast = "";
itAssignEmail = "";
itAssignFirst = "";
itAssignLast = "";
include("CMN;SR-IT_GetApproverRoles");
var workDes = workDescGet(capId);
workDes.length() > 250;
if (approverUID != null) {
	userId = approverUID;
	include("EML;GetUserIdEmail");
	approverEmail = userEmail;
	approverFirst = userFirst;
	approverLast = userLast;
	}

if (approverUID == "NOEMAIL") {
	approverEmail = " ";
	}

if (approverEmail != undefined && approverEmail != null && approverEmail != "") {
	var emailOK = true;
	} else {
	var emailOK = false;
	}

if (cmnSubType == "Accela Issue") {
	itDevId = getAppSpecific("ISSUE DETAILS.Developer", capId);
	} else {
	itDevId = getAppSpecific("REQUEST DETAILS.Developer", capId);
	}

if (itDevId != null) {
	userId = itDevId;
	include("EML;GetUserIdEmail");
	itDevEmail = userEmail;
	itDevFirst = userFirst;
	itDevLast = userLast;
	}

if (itDevEmail != undefined && itDevEmail != null && itDevEmail != "") {
	true;
	} else {
	itDevEmail = "jmoyer@cityofmadisonDEV.com;
	";
	!!jschneider@cityofmadisonDEV.com;
	jtessman@cityofmadisonDEV.com;
	mcouper@cityofmadisonDEV.com;
	";
	}

itAssignId = capDetail.getAsgnStaff();
if (itAssignId != null) {
	userId = itAssignId;
	include("EML;GetUserIdEmail");
	itAssignEmail = userEmail;
	itAssignFirst = userFirst;
	itAssignLast = userLast;
	}

if (itAssignEmail != undefined && itAssignEmail != null && itAssignEmail != "") {
	true;
	} else {
	itAssignEmail = "glabelle-brown@cityofmadisonDEV.com;
	";
	!! poleary@cityofmadisonDEV.com;
	rsjachrani@cityofmadisonDEV.com;
	skauffeld@cityofmadisonDEV.com";
	}

emailSubject = cmnSubType + " (" + capIDString + ") - " + wfTask + " - " + wfStatus;
emailText = "<html><body><p>" + cmnSubType + "; <a href='https;!!av.cityofmadison.com!portlets!cap!capDetail.do?mode=view&serviceProviderCode=MADISON&ID1="  + capId.getID1() + "&ID2=" + capId.getID2() + "&ID3=" + capId.getID3() + "&requireNotice=YES&clearForm=clearForm&module=" + cmnGroup + "&isGeneralCAP=Y'>" + capIDString + "<!a> has been set to <b>" + wfStatus + "<!b> by " + itDevFirst + " " + itDevLast + ".<!p>";
emailText += "Service Request Reported By; " + reportByFirstName + " " + reportByLastName + "<br>";
emailText += "Service Request Created; " + fileDate + "<!p>";
emailText += "Service Request Workflow Task; "  + wfTask +  "<!p>";
emailText += "Service Request Workflow Status; "  + wfStatus +  "<!p>";
if (itDevId != null) {
	emailText += "Service Request IT Developer; "  + itDevFirst + " " + itDevLast +  "<!p>";
	} else {
	emailText += "Service Request IT Developer; not assigned at this time<!p>";
	}

if (itAssignId != null) {
	emailText += "Service Request IT Assigned; "  + itAssignFirst + " " + itAssignLast +  "<!p>";
	} else {
	emailText += "Service Request IT Assigned; not assigned at this time<!p>";
	}

if (workDes != null) {
	emailText += "<p>Service Request Description; " + workDescGet(capId)  + "<!p>";
	}

if (wfComment != null) {
	emailText += "<p>Comments; " + wfComment + "<!p>";
	}

emailText += "<!body><!html>";
if (wfStatus == "Closed" && emailOK == true) {
	aa.sendEmail("noreply@cityofmadisonDEV.com", reportByEmail + ";
	" + approverEmail, itAssignEmail, emailSubject, emailText, "");
	}

if (emailOK == false) {
	emailText += "<p><b>Error;<!b> Could not find email address for Agency Approver (" + approverUID + ")<!p>";
	emailSubject = "Error; IT Service Request Notification failed for " + capIDString;
	aa.sendEmail("noreply@cityofmadisonDEV.com", "elamsupport@cityofmadisonDEV.com", "",  emailSubject, emailText, "");
	}

if (emailOK == false) {
	showMessage = true;
	comment("Invalid email address for Agency Approver (" + approverUID + ").  An email was sent to Elam Support to correct this issue.");
	}
`^
EML;ServiceRequest!Information Technology!Accela Change Request!NA;ITAction^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
approverEmail = "";
approverFirst = "";
approverLast = "";
itDevEmail = "";
itDevFirst = "";
itDevLast = "";
itAssignEmail = "";
itAssignFirst = "";
itAssignLast = "";
include("CMN;SR-IT_GetApproverRoles");
var workDes = workDescGet(capId);
workDes.length() > 250;
if (approverUID != null) {
	userId = approverUID;
	include("EML;GetUserIdEmail");
	approverEmail = userEmail;
	approverFirst = userFirst;
	approverLast = userLast;
	}

if (approverUID == "NOEMAIL") {
	approverEmail = " ";
	}

if (approverEmail != undefined && approverEmail != null && approverEmail != "") {
	var emailOK = true;
	} else {
	var emailOK = false;
	}

if (cmnSubType == "Accela Issue") {
	itDevId = getAppSpecific("ISSUE DETAILS.Developer", capId);
	} else {
	itDevId = getAppSpecific("REQUEST DETAILS.Developer", capId);
	}

if (itDevId != null) {
	userId = itDevId;
	include("EML;GetUserIdEmail");
	itDevEmail = userEmail;
	itDevFirst = userFirst;
	itDevLast = userLast;
	}

if (itDevEmail != undefined && itDevEmail != null && itDevEmail != "") {
	true;
	} else {
	itDevEmail = "jmoyer@cityofmadisonDEV.com;
	";
	!!jschneider@cityofmadisonDEV.com;
	jtessman@cityofmadisonDEV.com;
	mcouper@cityofmadisonDEV.com;
	";
	}

itAssignId = capDetail.getAsgnStaff();
if (itAssignId != null) {
	userId = itAssignId;
	include("EML;GetUserIdEmail");
	itAssignEmail = userEmail;
	itAssignFirst = userFirst;
	itAssignLast = userLast;
	}

if (itAssignEmail != undefined && itAssignEmail != null && itAssignEmail != "") {
	true;
	} else {
	itAssignEmail = "glabelle-brown@cityofmadisonDEV.com;
	";
	!! rsjachrani@cityofmadisonDEV.com;
	poleary@cityofmadisonDEV.com;
	skauffeld@cityofmadisonDEV.com";
	}

emailSubject = cmnSubType + " (" + capIDString + ") - " + wfTask + " - " + wfStatus;
emailText = "<html><body><p>" + cmnSubType + "; <a href='https;!!av.cityofmadison.com!portlets!cap!capDetail.do?mode=view&serviceProviderCode=MADISON&ID1="  + capId.getID1() + "&ID2=" + capId.getID2() + "&ID3=" + capId.getID3() + "&requireNotice=YES&clearForm=clearForm&module=" + cmnGroup + "&isGeneralCAP=Y'>" + capIDString + "<!a> has been set to <b>" + wfStatus + "<!b> by " + itDevFirst + " " + itDevLast + ".<!p>";
emailText += "Service Request Reported By; " + reportByFirstName + " " + reportByLastName + "<br>";
emailText += "Service Request Created; " + fileDate + "<!p>";
emailText += "Service Request Workflow Task; "  + wfTask +  "<!p>";
emailText += "Service Request Workflow Status; "  + wfStatus +  "<!p>";
if (itDevId != null) {
	emailText += "Service Request IT Developer; "  + itDevFirst + " " + itDevLast +  "<!p>";
	} else {
	emailText += "Service Request IT Developer; not assigned at this time<!p>";
	}

if (itAssignId != null) {
	emailText += "Service Request IT Assigned; "  + itAssignFirst + " " + itAssignLast +  "<!p>";
	} else {
	emailText += "Service Request IT Assigned; not assigned at this time<!p>";
	}

if (workDes != null) {
	emailText += "<p>Service Request Description; " + workDescGet(capId)  + "<!p><br>";
	}

if (wfComment != null) {
	emailText += "<p>Comments; " + wfComment + "<!p><br>";
	}

emailText += "<!body><!html>";
if (wfStatus == "IT Quality Assurance") {
	aa.sendEmail("noreply@cityofmadisonDEV.com", itAssignEmail, "poleary@cityofmadisonDEV.com",  emailSubject, emailText, "");
	}

if (wfStatus == "Additional Info Required" && emailOK == true) {
	aa.sendEmail(itAssignEmail, reportByEmail, approverEmail + ";
	poleary@cityofmadisonDEV.com;
	",  emailSubject, emailText, "");
	}

if (wfStatus == "Developer Assigned") {
	aa.sendEmail("noreply@cityofmadisonDEV.com", itDevEmail, "poleary@cityofmadisonDEV.com;
	",  emailSubject, emailText, "");
	}

if (emailOK == false) {
	emailText += "<p><b>Error;<!b> Could not find email address for Agency Approver (" + approverUID + ")<!p>";
	emailSubject = "Error; IT Service Request Notification failed for " + capIDString;
	aa.sendEmail("noreply@cityofmadisonDEV.com", "elamsupport@cityofmadisonDEV.com", "",  emailSubject, emailText, "");
	}

if (emailOK == false) {
	showMessage = true;
	comment("Invalid email address for Agency Approver (" + approverUID + ").  An email was sent to Elam Support to correct this issue.");
	}
`^
EML;ServiceRequest!Information Technology!Accela Change Request!NA;ITQualityAssurance^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
approverEmail = "";
approverFirst = "";
approverLast = "";
itDevEmail = "";
itDevFirst = "";
itDevLast = "";
itAssignEmail = "";
itAssignFirst = "";
itAssignLast = "";
include("CMN;SR-IT_GetApproverRoles");
var workDes = workDescGet(capId);
workDes.length() > 250;
if (approverUID != null && approverUID != "NOEMAIL") {
	userId = approverUID;
	include("EML;GetUserIdEmail");
	approverEmail = userEmail;
	approverFirst = userFirst;
	approverLast = userLast;
	}

if (approverUID == "NOEMAIL") {
	approverEmail = " ";
	}

if (approverEmail != undefined && approverEmail != null && approverEmail != "") {
	var emailOK = true;
	} else {
	var emailOK = false;
	}

if (cmnSubType == "Accela Issue") {
	itDevId = getAppSpecific("ISSUE DETAILS.Developer", capId);
	} else {
	itDevId = getAppSpecific("REQUEST DETAILS.Developer", capId);
	}

if (itDevId != null) {
	userId = itDevId;
	include("EML;GetUserIdEmail");
	itDevEmail = userEmail;
	itDevFirst = userFirst;
	itDevLast = userLast;
	}

if (itDevEmail != undefined && itDevEmail != null && itDevEmail != "") {
	true;
	} else {
	itDevEmail = "jmoyer@cityofmadisonDEV.com;
	";
	!!jschneider@cityofmadisonDEV.com;
	jtessman@cityofmadisonDEV.com;
	mcouper@cityofmadisonDEV.com;
	";
	}

itAssignId = capDetail.getAsgnStaff();
if (itAssignId != null) {
	userId = itAssignId;
	include("EML;GetUserIdEmail");
	itAssignEmail = userEmail;
	itAssignFirst = userFirst;
	itAssignLast = userLast;
	}

if (itAssignEmail != undefined && itAssignEmail != null && itAssignEmail != "") {
	true;
	} else {
	itAssignEmail = "glabelle-brown@cityofmadisonDEV.com;
	";
	!! rsjachrani@cityofmadisonDEV.com;
	poleary@cityofmadisonDEV.com;
	skauffeld@cityofmadisonDEV.com";
	}

emailSubject = cmnSubType + " (" + capIDString + ") - " + wfTask + " - " + wfStatus;
if (wfStatus == "Ready to Test") {
	emailText = "<html><body><p>" + cmnSubType + "; <a href='https;!!av.cityofmadison.com!portlets!cap!capDetail.do?mode=view&serviceProviderCode=MADISON&ID1="  + capId.getID1() + "&ID2=" + capId.getID2() + "&ID3=" + capId.getID3() + "&requireNotice=YES&clearForm=clearForm&module=" + cmnGroup + "&isGeneralCAP=Y'>" + capIDString + "<!a> has been set to <b>" + wfStatus + "<!b> by " + itDevFirst + " " + itDevLast + ".<!p>";
	}

if (wfStatus != "Ready to Test") {
	emailText = "<html><body><p>" + cmnSubType + "; <a href='https;!!av.cityofmadison.com!portlets!cap!capDetail.do?mode=view&serviceProviderCode=MADISON&ID1="  + capId.getID1() + "&ID2=" + capId.getID2() + "&ID3=" + capId.getID3() + "&requireNotice=YES&clearForm=clearForm&module=" + cmnGroup + "&isGeneralCAP=Y'>" + capIDString + "<!a> has been set to <b>" + wfStatus + "<!b> by " + itAssignFirst + " " + itAssignLast + ".<!p>";
	}

emailText += "Service Request Reported By; " + reportByFirstName + " " + reportByLastName + "<br>";
emailText += "Service Request Created; " + fileDate + "<!p>";
emailText += "Service Request Workflow Task; "  + wfTask +  "<!p>";
emailText += "Service Request Workflow Status; "  + wfStatus +  "<!p>";
if (itDevId != null) {
	emailText += "Service Request IT Developer; "  + itDevFirst + " " + itDevLast +  "<!p>";
	} else {
	emailText += "Service Request IT Contact; not assigned at this time<!p>";
	}

if (itAssignId != null) {
	emailText += "Service Request IT Assigned; "  + itAssignFirst + " " + itAssignLast +  "<!p>";
	} else {
	emailText += "Service Request IT Assigned; not assigned at this time<!p>";
	}

if (workDes != null) {
	emailText += "<p>Service Request Description; " + workDescGet(capId)  + "<!p>";
	}

if (wfComment != null) {
	emailText += "<p>Comments; " + wfComment + "<!p>";
	}

emailText += "<!body><!html>";
if ((wfStatus == "Issue(s) found" || wfStatus == "Quality Assurance Complete") && emailOK == true) {
	aa.sendEmail("noreply@cityofmadisonDEV.com", itDevEmail, "poleary@cityofmadisonDEV.com", emailSubject, emailText, "");
	}

if (wfStatus == "Ready to Test" && emailOK == true) {
	aa.sendEmail("noreply@cityofmadisonDEV.com", reportByEmail + ";
	" + approverEmail, itAssignEmail,  emailSubject, emailText, "");
	}

if (emailOK == false) {
	emailText += "<p><b>Error;<!b> Could not find email address for Agency Approver (" + approverUID + ")<!p>";
	emailSubject = "Error; IT Service Request Notification failed for " + capIDString;
	aa.sendEmail("noreply@cityofmadisonDEV.com", "elamsupport@cityofmadisonDEV.com", "",  emailSubject, emailText, "");
	}

if (emailOK == false) {
	showMessage = true;
	comment("Invalid email address for Agency Approver (" + approverUID + ").  An email was sent to Elam Support to correct this issue.");
	}
`^
EML;ServiceRequest!Information Technology!Accela Change Request!NA;ITReview^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
approverEmail = "";
approverFirst = "";
approverLast = "";
itAssignEmail = "";
itAssignFirst = "";
itAssignLast = "";
include("CMN;SR-IT_GetApproverRoles");
var workDes = workDescGet(capId);
workDes.length() > 250;
if (approverUID != null && approverUID != "NOEMAIL") {
	userId = approverUID;
	include("EML;GetUserIdEmail");
	approverEmail = userEmail;
	approverFirst = userFirst;
	approverLast = userLast;
	}

if (approverUID == "NOEMAIL") {
	approverEmail = " ";
	}

if (approverEmail != undefined && approverEmail != null && approverEmail != "") {
	var emailOK = true;
	} else {
	var emailOK = false;
	}

itAssignId = capDetail.getAsgnStaff();
if (itAssignId != null) {
	userId = itAssignId;
	include("EML;GetUserIdEmail");
	itAssignEmail = userEmail;
	itAssignFirst = userFirst;
	itAssignLast = userLast;
	}

if (itAssignEmail != undefined && itAssignEmail != null && itAssignEmail != "") {
	true;
	} else {
	itAssignEmail = "glabelle-brown@cityofmadisonDEV.com;
	";
	!! rsjachrani@cityofmadisonDEV.com;
	poleary@cityofmadisonDEV.com;
	skauffeld@cityofmadisonDEV.com";
	}

emailSubject = cmnSubType + " (" + capIDString + ") - " + wfTask + " - " + wfStatus;
emailText = "<html><body><p>" + cmnSubType + "; <a href='https;!!av.cityofmadison.com!portlets!cap!capDetail.do?mode=view&serviceProviderCode=MADISON&ID1="  + capId.getID1() + "&ID2=" + capId.getID2() + "&ID3=" + capId.getID3() + "&requireNotice=YES&clearForm=clearForm&module=" + cmnGroup + "&isGeneralCAP=Y'>" + capIDString + "<!a> has been set to; <b>" + wfStatus + "<!b> by " + itAssignFirst + " " + itAssignLast + ".<!p>";
emailText += "Service Request Reported By; " + reportByFirstName + " " + reportByLastName + "<br>";
emailText += "Service Request Status; " + capStatus + "<br>";
emailText += "Service Request Created; " + fileDate + "<!p>";
emailText += "Service Request Workflow Task; "  + wfTask +  "<!p>";
if (itAssignId != null) {
	emailText += "Service Request IT Assigned; "  + itAssignFirst + " " + itAssignLast +  "<!p>";
	} else {
	emailText += "Service Request IT Assigned; not assigned at this time<!p>";
	}

if (workDes != null) {
	emailText += "<p>Service Request Description; " + workDescGet(capId)  + "<!p>";
	}

if (wfComment != null) {
	emailText += "<p>Comments; " + wfComment + "<!p>";
	}

emailText += "<!body><!html>";
if ((wfStatus == "Accepted" || wfStatus == "Declined") && emailOK == true) {
	aa.sendEmail("noreply@cityofmadisonDEV.com", reportByEmail, approverEmail,  emailSubject, emailText, "");
	}

if (wfStatus == "Additional Info Required" && emailOK == true) {
	aa.sendEmail("noreply@cityofmadisonDEV.com", reportByEmail, approverEmail,  emailSubject, emailText, "");
	}

if (emailOK == false) {
	emailText += "<p><b>Error;<!b> Could not find email address for Agency Approver (" + approverUID + ")<!p>";
	emailSubject = "Error; IT Service Request Notification failed for " + capIDString;
	aa.sendEmail("noreply@cityofmadisonDEV.com", "elamsupport@cityofmadisonDEV.com", "",  emailSubject, emailText, "");
	}

if (emailOK == false) {
	showMessage = true;
	comment("Invalid email address for Agency Approver (" + approverUID + ").  An email was sent to Elam Support to correct this issue.");
	}
`^
EML;ServiceRequest!Information Technology!Accela Change Request!NA;NotifyAgencyApproverOnSubmit^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;SR-IT_GetApproverRoles");
if (approverUID != "") {
	userId = approverUID;
	include("EML;GetUserIdEmail");
	}

emailSubject = "Service Request " + cmnSubType + " (" + capIDString + ")";
emailText = "<html><body><p>This is an Accela auto-notification email to inform you that you have an IT Service Request that requires your approval to begin work.<!p>";
emailText += "<p>Service Request CAP ID; <a href='https;!!av.cityofmadison.com!portlets!cap!capDetail.do?mode=view&serviceProviderCode=MADISON&ID1="  + capId.getID1() + "&ID2=" + capId.getID2() + "&ID3=" + capId.getID3() + "&requireNotice=YES&clearForm=clearForm&module=" + cmnGroup + "&isGeneralCAP=Y'>" + capIDString + "<!a><br>";
emailText += "Service Request Type; " + cmnSubType + "<br>";
emailText += "Service Request Reported By; " + reportByFirstName + " " + reportByLastName + "<br>";
emailText += "Service Request Status; " + capStatus + "<br>";
emailText += "Service Request Created; " + fileDate + "<!p>";
if (workDescGet(capId) != null) {
	emailText += "<p>Service Request Description; " + workDescGet(capId)  + "<!p>";
	}

emailText += "<!body><!html>";
if ((userEmail == undefined || userEmail == null || userEmail == "")) {
	var emailOK = false;
	} else {
	var emailOK = true;
	}

if (reportByUID == approverUID) {
	approverReporterSame = true;
	} else {
	approverReporterSame = false;
	}

if (reportByUID != approverUID && emailOK == true) {
	aa.sendEmail("noreply@cityofmadisonDEV.com", userEmail, "", emailSubject, emailText, "");
	}

if (reportByUID != approverUID && emailOK == false) {
	emailText += "<p><b>Error;<!b> Could not find email address for Agency Approver (" + approverUID + " " + approverRole + ")<!p>";
	emailSubject = "Error; IT Service Request Notification failed for " + capIDString;
	aa.sendEmail("noreply@cityofmadisonDEV.com", "elamsupport@cityofmadisonDEV.com", "",  emailSubject, emailText, "");
	}
`^
EML;ServiceRequest!Information Technology!Accela Change Request!NA;Test^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
approverEmail = "";
approverFirst = "";
approverLast = "";
itDevEmail = "";
itDevFirst = "";
itDevLast = "";
itAssignEmail = "";
itAssignFirst = "";
itAssignLast = "";
include("CMN;SR-IT_GetApproverRoles");
var workDes = workDescGet(capId);
workDes.length() > 250;
if (approverUID != null) {
	userId = approverUID;
	include("EML;GetUserIdEmail");
	approverEmail = userEmail;
	approverFirst = userFirst;
	approverLast = userLast;
	}

if (approverUID == "NOEMAIL") {
	approverEmail = " ";
	}

if (approverEmail != undefined && approverEmail != null && approverEmail != "") {
	var emailOK = true;
	} else {
	var emailOK = false;
	}

if (cmnSubType == "Accela Issue") {
	itDevId = getAppSpecific("ISSUE DETAILS.Developer", capId);
	} else {
	itDevId = getAppSpecific("REQUEST DETAILS.Developer", capId);
	}

if (itDevId != null) {
	userId = itDevId;
	include("EML;GetUserIdEmail");
	itDevEmail = userEmail;
	itDevFirst = userFirst;
	itDevLast = userLast;
	}

if (itDevEmail != undefined && itDevEmail != null && itDevEmail != "") {
	true;
	} else {
	itDevEmail = "jmoyer@cityofmadisonDEV.com;
	";
	!!jschneider@cityofmadisonDEV.com;
	jtessman@cityofmadisonDEV.com;
	mcouper@cityofmadisonDEV.com;
	";
	}

itAssignId = capDetail.getAsgnStaff();
if (itAssignId != null) {
	userId = itAssignId;
	include("EML;GetUserIdEmail");
	itAssignEmail = userEmail;
	itAssignFirst = userFirst;
	itAssignLast = userLast;
	}

if (itAssignEmail != undefined && itAssignEmail != null && itAssignEmail != "") {
	true;
	} else {
	itAssignEmail = "glabelle-brown@cityofmadisonDEV.com;
	";
	!! rsjachrani@cityofmadisonDEV.com;
	poleary@cityofmadisonDEV.com;
	skauffeld@cityofmadisonDEV.com";
	}

emailSubject = cmnSubType + " (" + capIDString + ") - " + wfTask + " - " + wfStatus;
emailText = "<html><body><p>" +cmnSubType + "; <a href='https;!!av.cityofmadison.com!portlets!cap!capDetail.do?mode=view&serviceProviderCode=MADISON&ID1="  + capId.getID1() + "&ID2=" + capId.getID2() + "&ID3=" + capId.getID3() + "&requireNotice=YES&clearForm=clearForm&module=" + cmnGroup + "&isGeneralCAP=Y'>" + capIDString + "<!a> has been set to <b>" + wfStatus + "<!b> by " + reportByFirstName + " " + reportByLastName + ".<!p>";
emailText += "Service Request Reported By; " + reportByFirstName + " " + reportByLastName + "<br>";
emailText += "Service Request Created; " + fileDate + "<!p>";
emailText += "Service Request Workflow Task; "  + wfTask +  "<!p>";
emailText += "Service Request Workflow Status; "  + wfStatus +  "<!p>";
if (itDevId != null) {
	emailText += "Service Request IT Developer; "  + itDevFirst + " " + itDevLast +  "<!p>";
	} else {
	emailText += "Service Request IT Developer; not assigned at this time<!p>";
	}

if (itAssignId != null) {
	emailText += "Service Request IT Assigned; "  + itAssignFirst + " " + itAssignLast +  "<!p>";
	} else {
	emailText += "Service Request IT Assigned; not assigned at this time<!p>";
	}

if (workDes != null) {
	emailText += "<p>Service Request Description; " + workDescGet(capId)  + "<!p>";
	}

if (wfComment != null) {
	emailText += "<p>Comments; " + wfComment + "<!p>";
	}

emailText += "<!body><!html>";
if (wfStatus == "Approved" && emailOK == true) {
	aa.sendEmail("noreply@cityofmadisonDEV.com", itAssignEmail, approverEmail + ";
	poleary@cityofmadisonDEV.com" ,  emailSubject, emailText, "");
	}

if (wfStatus == "Incomplete" && emailOK == true) {
	aa.sendEmail("noreply@cityofmadisonDEV.com", itAssignEmail, "poleary@cityofmadisonDEV.com",  emailSubject, emailText, "");
	}

if (emailOK == false) {
	emailText += "<p><b>Error;<!b> Could not find email address for Agency Approver (" + approverUID + ")<!p>";
	emailSubject = "Error; IT Service Request Notification failed for " + capIDString;
	aa.sendEmail("noreply@cityofmadisonDEV.com", "elamsupport@cityofmadisonDEV.com", "",  emailSubject, emailText, "");
	}

if (emailOK == false) {
	showMessage = true;
	comment("Invalid email address for Agency Approver (" + approverUID + ").  An email was sent to Elam Support to correct this issue.");
	}
`^
EML;ServiceRequest!TrafficEngineering!~!~;RequestClosed^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
emailSubject = "Service Request " + requestCap + " Closed";
emailText = "<html><body><p>Hello " + requestFirst + " " + requestLast + ",<!p>";
emailText += "<p>This is an Accela auto-notification email letting you know that this Request has been completed; " + requestCap + ".<!p><!body><!html>";
sendAsyncEmail("noreply@cityofmadisonDEV.com", requestEmail, "",  emailSubject, emailText, "");
emailText = "requestEmail = " + requestEmail;
aa.sendEmail("noreply@cityofmadisonDEV.com", "kgrittner@cityofmadisonDEV.com", "",  emailSubject, emailText, "");
`^
EML;ServiceRequest!TrafficEngineering!~!~;StudyCreated^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var assignEmail = "";
curWfTask = "";
userEmail = "";
include("CMN;ServiceRequest!TrafficEngineering!~!~;GetAppName");
userId = currentUserID;
include("EML;GetUserIdEmail");
createEmail = userEmail;
var cd = aa.cap.getCapDetail(capId).getOutput().getCapDetailModel();
if (cd != null) {
	userId = cd.getAsgnStaff();
	}

if (vEventName == "WorkflowTaskUpdateAfter") {
	curWfTask = wfTask;
	for (i in wfObj) include("CMN;getAssignedUser");
	}

if (userId != "" && userId != null) {
	include("EML;GetUserIdEmail");
	assignEmail = userEmail;
	}

emailSubject = "Traffic Engineering " + appName + " (" + capIDString + ") Assigned to you";
emailText = "<html><body><p>Hello " + userFirst + " " + userLast + ",<!p>";
emailText += "<p>This is an Accela auto-notification letting you know that you have been assigned Traffic Engineering " + appName +"; "+ capIDString + ".<!p><!body><!html>";
assetId = getShortNotes(capId);
if (assetId) {
	emailText += "Location; "+assetId;
	}

if (curWfTask != "") {
	emailText += "<br>Task; "+ curWfTask;
	}

emailText += "<br>Work Description; "+ workDescGet(capId);
emailText += "<br>Record;<!b> <a href=" + "" + "https;!!avdev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=Permitting&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a><br><br>";
if (vEventName == "WorkflowTaskUpdateAfter" && wfComment != null) {
	emailText += "Comment; "+ wfComment;
	}

if (assignEmail != "" && !currentUserID.equals(userId)) {
	aa.sendEmail("noreply@cityofmadisonDEV.com", assignEmail, createEmail, emailSubject, emailText, "");
	}
`^
EML;ServiceRequest!Water!Problem!~;Internal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emailSubject =  "Report A Problem; " + cmnCategory;
include("EML;ApplicantInformation");
include("EML;AddressInformation");
emailText += "<b>Category; " + cmnType + " " + cmnSubType + "; " + cmnCategory + "<!b><br><br>";
if (AInfo['SR LOCATION2.Location'] != null) {
	emailText += "Location; 	" + AInfo['SR LOCATION2.Location'] + "<br>";
	}

if (AInfo['SR-WATERQUALITY.Contact'] != null) {
	emailText += "Request Contact; 	" + AInfo['SR-WATERQUALITY.Contact'] + "<br>";
	}

if (AInfo['SR-WATERQUALITY.Location']  != null) {
	emailText += "Location; 	" + AInfo['SR-WATERQUALITY.Location'] + "<br>";
	}

emailText += "<p>Description<br>" + workDescGet(capId) + "<!p><!body><!html>";
`^
EML;ServiceRequestReceived!Engineering!Facility!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (user && user.getFirstName() && user.getLastName()) {
	emailText = "<b>Service Request Reported By;<!b> " + user.getFirstName() + " " +  user.getLastName() + "<br>";
	}

var user = aa.person.getUser("ENKMS");
user = user.getOutput();
userEmail= user.getEmail();
emailSubject =  "Service Request# " + capIDString + " Received";
emailText += "<p><b>Facility; <!b>" + getAppSpecific("SR - ENGINEERING MAINTENANCE.Facility");
emailText += "<p><b>Description; <!b>" + workDescGet(capId) + "<!p>";
emailText += "<b>Service Request;<!b>  <a href=" + "" + "https;!!avdev.cityofmadison.com;444!portlets!cap!capDetail.do?mode=list&module=ServiceRequest&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a><br><br>";
if (capId) {
	docList = aa.document.getCapDocumentList(capId, currentUserID);
	}

if (docList.getSuccess()) {
	DocList = docList.getOutput();
	emailText += "<p><b>Attached Documents;<!b> ";
	}

if (docList.getSuccess()) {
	for(doc in DocList) emailText += "<br>"+DocList[doc].docName;
	}

sendAsyncEmail("noreply@cityofmadison.com", userEmail, "elamsupport@cityofmadison.com", emailSubject, emailText, "");
`^
EML;ServiceRequestReceived!Engineering!Facility!~;Update^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var user = aa.person.getUser(currentUserID);
user = user.getOutput();
userEmail= user.getEmail();
emailSubject =  "Service Request# " + capIDString + " Updated";
emailText = "<b>Service Request # <a href=" + "" + "https;!!avdev.cityofmadison.com;444!portlets!cap!capDetail.do?mode=list&module=ServiceRequest&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a> <br> Updated By;<!b> " + user.getFirstName() + " " +  user.getLastName() + "<br>";
emailText += "<p><b>Facility; <!b>" + getAppSpecific("SR - ENGINEERING MAINTENANCE.Facility");
emailText += "<p><b>Description; <!b>" + workDescGet(capId) + "<!p>";
if (callType == "ASIUA") {
	emailText += "<p><b>Additional Information was added;<!b> " + addlInfos;
	}

if (callType == "WTUA") {
	emailText += "<p><b>Workflow Information was updated.<!b><!p>";
	}

if (callType == "DUA") {
	emailText += "<p><b>New document(s) were attached;<!b><!p>";
	}

if (callType == "DUA") {
	documentModelArray = aa.env.getValue("DocumentModelList");
	for (var i = 0;
	i < documentModelArray.size();
	i++) emailText += documentModelArray.get(i).docName + " " + documentModelArray.get(i).docStatusDate + "<BR>";
	}

sendAsyncEmail("noreply@cityofmadison.com", "kstoneDEV@cityofmadison.com", "elamsupport@cityofmadison.com", emailSubject, emailText, "");
`^
EML;TAXIDENIED^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emailText = "<html><body><p>Notice of Taxi License denial<!p>";
emailSubject = "Taxi License Denied " + capIDString;
emailText += "<b>Category<!b> " + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
emailText += "<b>CAP<!b> <a href=" + "" + "https;!!av73dev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=Permitting&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a><br><br>";
if (workDescGet(capId) != null) {
	emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
	}

include("EML;ApplicantInformation");
emailText += "<p>For Additional Information please log into Accela<!p>";
email("rsjachrani@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
`^
EML;URBANDESIGNDIST^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
emailText = "<html><body><p>Notice of Permit Application on a Address in the Urban Design District <!p>";
emailSubject = "Urban Design District Notification " + capIDString + " - Permit App Submitted";
emailText += "<b>Category<!b> " + cmnType + "!" + cmnSubType + "!" + cmnCategory + "<br><br>";
emailText += "<b>CAP<!b> <a href=" + "" + "https;!!av73dev.cityofmadison.com;444!portlets!cap!capsummary!CapTabSummary.do?mode=list&module=Permitting&serviceProviderCode=MADISON&ID1=" + capId.getID1() + "&ID2=" + capId.getID2()  + "&ID3=" + capId.getID3()  + "&clearForm=clearForm" + "" + ">" + capIDString + "<!a><br><br>";
emailText += "<p><b>Description<!b><br>" + workDescGet(capId) + "<!p>";
include("EML;AddressInformation");
emailText += "<p>For Additional Information please log into Accela<!p>";
email("rsjachrani@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
email("amartin@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
email("wfruhling@cityofmadisonDEV.com","noreply@cityofmadisonDEV.com",emailSubject,emailText);
`^
FAA;Licenses!Building Inspection!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
feeResult = loadFees();
for (feeItem in feeResult) include("CMN;Licenses!Building Inspection!~!~;UpdateCityBondInfo");
`^
FEACA;Permitting!Building!RepairReplace!Electrical^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;Permitting!Building!RepairReplace!Electrical;FeeEstimate");
`^
FEACA;Permitting!Building!RepairReplace!Plumbing^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;Permitting!Building!RepairReplace!Plumbing;FeeEstimate");
`^
FEACA;Permitting!Parks!Lake Access!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Parks!Lake Access!NA;FeeEstimate");
`^
FEACA;Permitting!Parks!SkiTrail!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;Permitting!Parks!SkiTrail!NA;FeeEstimate");
`^
FEACA;Permitting!Parks!Special Event!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;Permitting!Parks!Special Event!NA;FeeEstimate");
`^
FeeAssessAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("FAA;" + cmnGroup + "!~!~!~");
include("FAA;" + cmnGroup + "!" + cmnType + "!~!~");
include("FAA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("FAA;" + appTypeString);
`^
FeeEstimateAfter4ACA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("FEACA;" + cmnGroup + "!~!~!~");
include("FEACA;" + cmnGroup + "!" + cmnType + "!~!~");
include("FEACA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("FEACA;" + appTypeString);
`^
GetWorkflowAssignedEmailName^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
workflowGroups = aa.workflow.getProcessRelationByCapID(capId, null).getOutput();
workflowGroup = workflowGroups[wfg];
childTasks = aa.workflow.getProcess(capId, workflowGroup.getProcessID()).getOutput();
if (childTasks != null) {
	for (ctask in childTasks) include("GetWorkflowAssignedEmailNameLoop");
	}
`^
GetWorkflowAssignedEmailNameLoop^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
whoToEmail = "";
assignedPerson = childTasks[ctask].getAssignedStaff();
assignedUser = assignedPerson.getFullName();
if (childTasks[ctask].activeFlag == "Y" && assignedUser != "") {
	whoToEmail = "Assigned";
	assignedPersonDept = assignedPerson.getDeptOfUser();
	}

if (childTasks[ctask].activeFlag == "Y" && assignedUser != "") {
	deptList = aa.people.getSysUserListByDepartmentName(assignedPersonDept).getOutput();
	}

if (whoToEmail == "Assigned") {
	for (sUser in deptList) if (deptList[sUser].getFullName().equals(assignedUser)) assignedUserEmail = deptList[sUser].getEmail();
	assignedUserPhone = deptList[sUser].getPhoneNumber();
	}
`^
InspectionResultModifyAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("IRMA;" + cmnGroup + "!~!~!~");
include("IRMA;" + cmnGroup + "!" + cmnType + "!~!~");
include("IRMA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("IRMA;" + appTypeString);
`^
InspectionResultSubmitAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("IRSA;" + cmnGroup + "!~!~!~");
include("IRSA;" + cmnGroup + "!" + cmnType + "!~!~");
include("IRSA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("IRSA;" + appTypeString);
`^
InspectionResultSubmitBefore^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("IRSB;" + cmnGroup + "!~!~!~");
include("IRSB;" + cmnGroup + "!" + cmnType + "!~!~");
include("IRSB;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("IRSB;" + appTypeString);
`^
InspectionScheduleBefore^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("ISB;" + cmnGroup + "!~!~!~");
include("ISB;" + cmnGroup + "!" + cmnType + "!~!~");
include("ISB;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("ISB;" + appTypeString);
`^
InvoiceFeeAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("IFA;" + cmnGroup + "!~!~!~");
include("IFA;" + cmnGroup + "!" + cmnType + "!~!~");
include("IFA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("IFA;" + appTypeString);
if (currentUserID=="ITJBS") {
	showDebug = true;
	showMessage = true;
	comment("Hello from InvoiceFeeAfter");
	}
`^
IRMA;LICENSES!HEALTH!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("cmn;HealthInspections");
`^
IRMA;Permitting!Building!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;CloseFromFinalInspection");
`^
IRMA;Permitting!Engineering!ROW!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("EML;Permitting!Engineering!ROW!NA;FailedInsp");
`^
IRSA;DaneCounty!Zoning!Shoreland Permit!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;DaneCounty!Zoning!~!~");
`^
IRSA;Enforcement!Building Inspection!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
branch ("CMN;Enforcement!Building Inspection!~!~;Building Inspection Workflow Update");
`^
IRSA;Enforcement!Building Inspection!Construction!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;IRSA;Enforcement!Building Inspection;CITATION");
`^
IRSA;Enforcement!Building Inspection!Housing!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;IRSA;Enforcement!Building Inspection;CITATION");
`^
IRSA;Enforcement!Building Inspection!Property Maintenance!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;IRSA;Enforcement!Building Inspection;CITATION");
`^
IRSA;Enforcement!Building Inspection!Property Maintenance!Snow Removal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var dtToday = new Date();
var iMonth = dtToday.getMonth() + 1;
var iYear = dtToday.getFullYear();
if(iMonth > 5) iYear = iYear + 1;
var sDueDateYr = iYear + "";
var sDueDate = "6!1!" + sDueDateYr;
if (inspType == "Initial Inspection" && (inspResult == "Citation" || inspResult == "No Fee Citation")) {
	editTaskSpecific("Initial Inspection","Due Date",sDueDate);
	}

if (inspType == "Reinspection" && (inspResult == "Citation" || inspResult == "No Fee Citation")) {
	editTaskSpecific("Reinspection","Reinspection Due Date",sDueDate);
	}
`^
IRSA;Enforcement!Building Inspection!Weights and Measures!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;IRSA;Enforcement!Building Inspection;CITATION");
`^
IRSA;Enforcement!Building Inspection!Zoning!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;IRSA;Enforcement!Building Inspection;CITATION");
`^
IRSA;Enforcement!Engineering!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
branch ("CMN;Enforcement!Engineering!~!~;Engineering Workflow Update");
`^
IRSA;Enforcement!Fire!Prevention!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
cd = aa.cap.getCapDetail(capId).getOutput().getCapDetailModel();
capAsgnStaff = cd.getAsgnStaff();
capAsgnDept = cd.getAsgnDept();
if (inspResult == "Written Orders") {
	scheduleInspectDateGroup(inspGroup,"Reinspection",nextWorkDay(dateAdd(null,30)),capAsgnStaff);
	aa.set.add("FPWRITTEN",capId);
	closeTask("Inspection",inspResult,"Updated via Inspection","Updated via Inspection");
	}

if (inspResult == "Citation Issued") {
	scheduleInspectDateGroup(inspGroup,"Reinspection",nextWorkDay(dateAdd(null,15)),capAsgnStaff);
	branchTask("Inspection",inspResult,"Updated via Inspection","Updated via Inspection");
	}

if (inspResult == "City Attorney Referral") {
	loopTask("Inspection",inspResult,"Updated via Inspection","Updated via Inspection");
	}

if (inspResult == "Verbal Orders") {
	aa.set.add("FPVERBAL",capId);
	}

if (inspResult == "No Violations" || inspResult == "Verbal Orders" || inspResult == "Bldg Insp Ref") {
	branchTask("Inspection",inspResult,"Updated via Inspection","Updated via Inspection");
	updateAppStatus("Closed",inspResult);
	}

if (inspType == "Reinspection" && countIdenticalInspectionTypes() > 1) {
	addFeeWithExtraData("CEFIRREINSP","CEFIR","FINAL",1,"Y",capId,inspId);
	aa.set.add("FPREINSP",capId);
	}

if (inspResult == "Violations Corrected") {
	branchTask("Reinspection",inspResult,"Updated via Inspection","Updated via Inspection");
	}

if (inspResult == "Reinspection Failed") {
	closeTask("Reinspection",inspResult,"Updated via Inspection","Updated via Inspection");
	}
`^
IRSA;Enforcement!Traffic Engineering!Street Occupancy!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
if (inspResult == "Citation") {
	include("CMN;Traffic Engineering!Street Occupancy;Inspection;Citation");
	if (isTaskActive("Initial Inspection")) closeTask("Initial Inspection","Citation","Updated by Inspection Results","");
	if (isTaskActive("Reinspection")) loopTask("Reinspection","Citation","Updated by Inspection Results","");
	}

if (inspResult == "In Compliance") {
	if (isTaskActive("Initial Inspection")) branchTask("Initial Inspection","No Violation","Updated by Inspection Results","");
	if (isTaskActive("Reinspection")) closeTask("Reinspection","Compliance","Updated by Inspection Results","");
	}
`^
IRSA;Land!Landmark!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var sInspectionType = "Landmark Inspection";
var userId = "BIAFV";
if (inspType == sInspectionType && inspResult == "Correctly Installed") {
	closeTask("Inspection", "Work Completed", sInspectionType + " - Correctly Installed", "Updated by inspection script");
	}

if (inspType == sInspectionType && inspResult == "Incomplete Installation") {
	scheduleInspectDateGroup("LNDMRKINSP", sInspectionType, nextWorkDay(dateAdd(null,41)), userId);
	updateAppStatus("Incomplete Installation","Updated by inspection script");
	}

if (inspType == sInspectionType && inspResult == "Incorrect Installation") {
	updateAppStatus("Incorrect Installation","Updated by inspection script");
	include("CMN;Land!Landmark!NA!NA;CreateEnforcementCase");
	}
`^
IRSA;LICENSES!~!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;LICENSEBIISNP");
`^
IRSA;LICENSES!HEALTH!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;HealthInspections");
if ((inspType == "First Reinspection Chargeable" || inspType == "Re-Inspection Chargeable") && cmnSubType == "FoodandDrink") {
	addFeeWithExtraData("FDFIRSTRI","LICFDMISC","FINAL",1,"Y",capId,inspId);
	aa.set.add("HEREINSPFEE",capId);
	}

if (inspType == "Subsequent Reinspection Chargeable" && cmnSubType == "FoodandDrink") {
	addFeeWithExtraData("FDSUBRI","LICFDMISC","FINAL",1,"Y",capId,inspId);
	aa.set.add("HEREINSPFEE",capId);
	}

if (inspType == "First Reinspection Chargeable" && (cmnSubType == "Beach" || cmnSubType == "SwimmingPool")) {
	addFeeWithExtraData("FIRSTRI32135","LICMISC","FINAL",1,"Y",capId,inspId);
	aa.set.add("HEREINSPFEE",capId);
	}

if (inspType == "Subsequent Reinspection Chargeable" && (cmnSubType == "Beach" || cmnSubType == "SwimmingPool")) {
	addFeeWithExtraData("SUBRI32135","LICMISC","FINAL",1,"Y",capId,inspId);
	aa.set.add("HEREINSPFEE",capId);
	}

if (inspType == "First Reinspection Chargeable" && cmnSubType == "TattooAndOrBodyPiercing") {
	addFeeWithExtraData("TATBPFIRSTRI","LICTBP","FINAL",1,"Y",capId,inspId);
	aa.set.add("HEREINSPFEE",capId);
	}

if (inspType == "Subsequent Reinspection Chargeable" && cmnSubType == "TattooAndOrBodyPiercing") {
	addFeeWithExtraData("TATBPSUBRI","LICTBP","FINAL",1,"Y",capId,inspId);
	aa.set.add("HEREINSPFEE",capId);
	}

if (inspType == "First Reinspection Chargeable" && (cmnSubType == "HotelMotelTRH" || cmnSubType == "BedAndBreakfast" || cmnSubType == "Campgrounds" || cmnSubType == "RecreationEducationCamps" || cmnSubType == "MobileHomePark")) {
	addFeeWithExtraData("FIRSTRI32136","LICMISC","FINAL",1,"Y",capId,inspId);
	aa.set.add("HEREINSPFEE",capId);
	}

if (inspType == "Subsequent Reinspection Chargeable" && (cmnSubType == "HotelMotelTRH" || cmnSubType == "BedAndBreakfast" || cmnSubType == "Campgrounds" || cmnSubType == "RecreationEducationCamps" || cmnSubType == "MobileHomePark")) {
	addFeeWithExtraData("SUBRI32136","LICMISC","FINAL",1,"Y",capId,inspId);
	aa.set.add("HEREINSPFEE",capId);
	}

inspDate = inspObj.getScheduledDate();
if (currentUserID == "ITJBS") {
	showDebug = true;
	}
`^
IRSA;Permitting!Building!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;CloseFromFinalInspection");
`^
IRSA;Permitting!Building!~!New Electrical^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (inspResult != null) {
	reportName ="Certificate of Electrical Inspection";
	include("CMN;RUN_REPORT");
	}
`^
IRSA;Permitting!Engineering!Erosion Control!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
include("IRSA;Permitting!Engineering;CITATION");
`^
IRSA;Permitting!Engineering!ROW!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if ((inspType == "Initial" ||  inspType == "Re-Inspection") && inspResult == "Completed with Warranty Insp") {
	closeTask("Inspection","Completed","Inspection Result","");
	editTaskDueDate("Warranty Period",nextWorkDay(dateAdd(null,1095)));
	updateTask("Warranty Period", "Warranty Period", "This task was automatically updated because it is needed for a batch script.  ROWWarrantyExpire", "", "ENGROWEXC");
	}

if ((inspType == "Initial" ||  inspType == "Re-Inspection") && inspResult == "Completed No Warranty Insp") {
	closeTask("Inspection","Completed","Inspection Result","");
	editTaskDueDate("Warranty Period",nextWorkDay(dateAdd(null,1095)));
	updateTask("Warranty Period", "Warranty Period", "This task was automatically updated because it is needed for a batch script.  ROWWarrantyExpire", "", "ENGROWEXC");
	}

if (inspType == "Final" && (inspResult == "Failed" || inspResult == "Completed")) {
	closeTask("Inspection","Completed","Inspection Result","");
	closeTask("Warranty Period", "Closed", "Not Applicable", "");
	closeTask("Closed");
	}

if ((inspType == "Warranty Inspection" ||  inspType == "Warranty Re-Inspection") && inspResult == "Completed") {
	closeTask("Inspection","Completed","Inspection Result","");
	}

include("CMN;Permitting!Engineering!ROW!~;Schedule Reinspection");
if (inspType != "Final" && (inspResult == "Failed" || inspResult == "Stop Work")) {
	include("EML;Permitting!Engineering!ROW!NA;FailedInsp");
	}
`^
IRSA;Permitting!Engineering;CITATION^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (inspResult == "Citation") {
	include("CMN;Permitting!Engineering;Inspection;Citation");
	}
`^
IRSA;Permitting!Fire!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Fire!~!~;InspectionCompletion");
include("CMN;Permitting!Fire!~!~;Schedule Reinspection");
if ((appMatch("Permitting!Fire!Alarm!NA") || appMatch("Permitting!Fire!AltFireSuppression!NA") || appMatch("Permitting!Fire!ControlledEgress!NA") || appMatch("Permitting!Fire!FireCommandCenter!NA") || appMatch("Permitting!Fire!KitchenHood!NA") || appMatch("Permitting!Fire!SmokeControlPanels!NA") || appMatch("Permitting!Fire!SmokeHeatVents!NA") || appMatch("Permitting!Fire!Sprinkler!NA") || appMatch("Permitting!Fire!Standpipe!NA") || appMatch("Permitting!Fire!HighPiledStorage!NA"))) {
	include("CMN;Permitting!Fire!~!~;InspectionStatused");
	}
`^
IRSA;Permitting!Fire!Elevator!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Fire!Elevator!~;ResultInspection");
showDebug = true;
`^
IRSA;Permitting!Fire!RoutineFireInspection!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug=false;
if (!(inspResult == "" && inspObj.inspectionStatus == "Attempted Inspection")) {
	inspObj.setInspector(systemUserObj);
	aa.inspection.editInspection(inspObj);
	logDebug("Insp result is blank and insp status is Attempted Inspection, so change the inspector name to current user.");
	inspObj.setInspector(systemUserObj);
	aa.inspection.editInspection(inspObj);
	} else {
	logDebug("An Attempted Inspection, so keep inspector as station and platoon.");
	}
`^
IRSA;Permitting!Traffic Engineering!Street Occupancy!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
if (inspResult == "Citation") {
	include("CMN;Traffic Engineering!Street Occupancy;Inspection;Citation");
	}
`^
IRSA;Permitting!Zoning!Sign!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
if (inspType == "Sign Inspection" && inspResult == "Correctly Installed") {
	closeTask("Inspection", "Completed", "Sign Inspection - Correctly Installed", "Updated by inspection script");
	}

if (inspType == "Sign Inspection" && inspResult == "Incorrect Installation") {
	updateAppStatus("Incorrect Installation","Updated by inspection script");
	include("CMN;CreateSignEnforcementCase");
	}
`^
IRSB;Permitting!Fire!RoutineFireInspection!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
gs=loadGuideSheetItems(inspId);
bolFail=false;
for(gsi in gs) include("IRSB;Permitting!Fire!RoutineFireInspection!NA;CheckGS");
if (bolFail && inspResult == "No Violation" && (inspType == "Routine" || inspType == "Special")) {
	showMessage=true;
	logMessage("Guidesheet contains Failed items;
	Please result inspection as Written Orders");
	cancel=true;
	}

if (bolFail != true && (inspResult == "Written Orders" || inspResult == "Verbal Orders") && (inspType == "Routine" || inspType == "Special")) {
	showMessage=true;
	message = "";
	logMessage("Guidesheet contains No Failed items;
	Please go to the Guidesheet and enter violations");
	cancel=true;
	}

if (bolFail && inspResult != "Not Corrected" && (inspType == "Reinspection" || inspType == "10 Day Notice Reinspection" || inspType == "Prevention Reinspection")) {
	showMessage=true;
	logMessage("Guidesheet contains Failed items;
	Please result inspection as Written Orders");
	cancel=true;
	}

if (bolFail!=true && inspResult == "Not Corrected" && (inspType == "Reinspection" || inspType == "10 Day Notice Reinspection" || inspType == "Prevention Reinspection")) {
	showMessage=true;
	message = "";
	logMessage("Guidesheet contains No Failed items;
	Please go to the Guidesheet and enter violations");
	cancel=true;
	}

showDebug = true;
`^
IRSB;Permitting!Fire!RoutineFireInspection!NA;CheckGS^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (gs[gsi]=="Fail") {
	bolFail=true;
	}
`^
Land Use Reviews^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (PLANNING REVIEW) {
	}

if (ENGINEERING REVIEW) {
	}

if (TE REVIEW) {
	}

if (ZONING REVIEW) {
	}

if (FIRE REVIEW) {
	}

if (PARKS FORESTRY REVIEW) {
	}

if (WATER UTILITY REVIEW) {
	}

if (METRO REVIEW) {
	}

if (LANDMARKS REVIEW) {
	}

if (ASSESSOR REVIEW) {
	}

if (ENG MAPPING REVIEW) {
	}

if (POLICE REVIEW) {
	}

if (RECYCLING REVIEW) {
	}

if (URBAN DESIGN REVIEW) {
	}
`^
Land!Land Use!NA!NAReview^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (testassessr@cityofmadison.com; elamsupport@cityofmadison.com;) {
	}

if (elamsupport@cityofmadison.com;testengmapr@cityofmadison.com;) {
	}

if (elamsupport@cityofmadison.com; jschneider@cityofmadison.com; elamsupport@cityofmadison.com;) {
	}

if (testfirer@cityofmadison.com; elamsupport@cityofmadison.com;) {
	}

if (testlandmarkr@cityofmadison.com; elamsupport@cityofmadison.com;) {
	}

if (testmetror@cityofmadison.com; elamsupport@cityofmadison.com;) {
	}

if (testparksr@cityofmadison.com; elamsupport@cityofmadison.com;) {
	}

if (testplanr@cityofmadison.com;elamsupport@cityofmadison.com;) {
	}

if (testpolicer@cityofmadison.com; elamsupport@cityofmadison.com;) {
	}

if (testrealr@cityofmadison.com; elamsupport@cityofmadison.com;) {
	}

if (testrecycler@cityofmadison.com; elamsupport@cityofmadison.com;) {
	}

if (testtrafficr@cityofmadison.com;elamsupport@cityofmadison.com;) {
	}

if (testurbanr@cityofmadison.com; elamsupport@cityofmadison.com;) {
	}

if (testwaterr@cityofmadison.com; elamsupport@cityofmadison.com;) {
	}

if (testzoner@cityofmadison.com; elamsupport@cityofmadison.com;) {
	}
`^
Land!Land Use!NA!NAVerification^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (jmoyer@cityofmadison.com; testv@cityofmadison.com;) {
	}

if (jmoyer@cityofmadison.com; testv1@cityofmadison.com;) {
	}

if (elamsupport@cityofmadison.com) {
	}
`^
Land!Permitted Use!Site Plan Review!NAVerification^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (elamsupport@cityofmadison.com) {
	}

if (jschneider@cityofmadison.com;) {
	}

if (jmoyer@cityofmadison.com) {
	}

if (jmoyer@cityofmadison.com; elamsupport@cityofmadison.com;) {
	}
`^
LicClerkPoliceReviewEmailBody^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (<p>The police background check is completed and this license application has been sent to ALRC Captain Consultation.<!p><p>Thank you,<br>Madison Police Department<!p>) {
	}

if (<p>The police background check is completed and this license application is sent to Captain Consultation.<!p><p>Thank you,<br>Madison Police Department<!p>) {
	}

if (<p>The police District Captain review is completed and this license is approved.<!p><p>Thank you,<br>Madison Police Department<!p>) {
	}

if (<p>The police District Captain review is completed and this license is rejected.<!p><p>Thank you,<br>Madison Police Department<!p>) {
	}

if (<p>A police background check is needed for this new license application.<!p><p><a href="https;!!avdev.cityofmadison.com">Link to Accela<!a><!p> <br><p>Thank you,<br>City of Madison Clerk's Office<!p>) {
	}

if (<p>A police background check and district captain review is needed for this new license application.<!p><p><a href="https;!!avdev.cityofmadison.com">Link to Accela<!a><!p> <br><p>Thank you,<br>City of Madison Clerk's Office<!p>) {
	}

if (<p>A police background check and district captain review is needed for this new license application.<!p><p><a href="https;!!avdev.cityofmadison.com">Link to Accela<!a><!p> <br><p>Thank you,<br>City of Madison Clerk's Office<!p>) {
	}

if (<p>A police review is needed for this application.<!p><p><a href="https;!!avdev.cityofmadison.com">Link to Accela<!a><!p> <br><p>Thank you,<br>City of Madison Clerk's Office<!p>) {
	}

if (<p>The police review completed and application is accepted.<!p><p>Thank you,<br>Madison Police Department<!p>) {
	}

if (<p>The police review is in progress and additional info is required.<!p><p>Thank you,<br>Madison Police Department<!p>) {
	}

if (<p>The police background check is completed and this license is denied.<!p><p>Thank you,<br>Madison Police Department<!p>) {
	}

if (<p>A police background check and police captain review is needed for this new license application.<!p><p>Link to Accela; https;!!avdev.cityofmadison.com;<!p> <br><p>Thank you,<br>City of Madison Clerk's Office<!p>) {
	}
`^
LicClerkPoliceReviewEmailsSendTo^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (jgoltz@cityofmadison.com; jmoyer@cityofmadison.com) {
	}

if (jgoltz@cityofmadison.com; jmoyer@cityofmadison.com) {
	}

if (jgoltz@cityofmadison.com; jmoyer@cityofmadison.com) {
	}

if (jgoltz@cityofmadison.com; jmoyer@cityofmadison.com) {
	}

if (jgoltz@cityofmadison.com; jmoyer@cityofmadison.com) {
	}

if (jgoltz@cityofmadison.com; jmoyer@cityofmadison.com) {
	}

if (jgoltz@cityofmadison.com; jmoyer@cityofmadison.com) {
	}

if (jgoltz@cityofmadison.com; jmoyer@cityofmadison.com) {
	}

if (jgoltz@cityofmadison.com; jmoyer@cityofmadison.com) {
	}

if (jgoltz@cityofmadison.com; jmoyer@cityofmadison.com) {
	}

if (jgoltz@cityofmadison.com; jmoyer@cityofmadison.com) {
	}

if (jgoltz@cityofmadison.com; jmoyer@cityofmadison.com) {
	}

if (jgoltz@cityofmadison.com; jmoyer@cityofmadison.com) {
	}

if (jgoltz@cityofmadison.com; jmoyer@cityofmadison.com) {
	}
`^
LicClerkPoliceReviewEmailsSubject^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (Background Check Completed and Rejected) {
	}

if (Background Check Completed and Rejected) {
	}

if (Background Check Completed and Approved) {
	}

if (District Captain Review Completed and Approved) {
	}

if (District Captain Review Completed and Rejected) {
	}

if (License requires Background Check and Captain's Review) {
	}

if (License requires Background Check and Captain's Review) {
	}

if (Police Review Required.) {
	}

if (Police Review Completed and Accepted) {
	}

if (Police Review In Progress and Additional Information is Required) {
	}

if (Police Review Completed and Approved) {
	}

if (Police Review Completed and Rejected) {
	}

if (License requires Background Check and Captain's Review) {
	}
`^
LKU;LandAgencyReviews^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (jschneider@cityofmadison.com) {
	}

if (jschneider@cityofmadison.com) {
	}

if (jschneider@cityofmadison.com) {
	}

if (jschneider@cityofmadison.com) {
	}

if (jschneider@cityofmadison.com) {
	}

if (jschneider@cityofmadison.com) {
	}

if (jschneider@cityofmadison.com) {
	}

if (jschneider@cityofmadison.com) {
	}

if (jschneider@cityofmadison.com) {
	}

if (jschneider@cityofmadison.com) {
	}

if (jschneider@cityofmadison.com) {
	}

if (jschneider@cityofmadison.com) {
	}

if (jschneider@cityofmadison.com) {
	}

if (jschneider@cityofmadison.com) {
	}

if (jschneider@cityofmadison.com) {
	}

if (jschneider@cityofmadison.com) {
	}

if (jschneider@cityofmadison.com) {
	}
`^
PaymentReceiveAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("PRA;" + cmnGroup + "!~!~!~");
include("PRA;" + cmnGroup + "!" + cmnType + "!~!~");
include("PRA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("PRA;" + appTypeString);
if (isTaskActive("Fire Inspection")) {
	include("CMN;AssignFireInspectionTaskPrevention");
	}
`^
PermClerkPermitEmailsSendTo^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (jgoltz@cityofmadison.com; jmoyer@cityofmadison.com) {
	}

if (jgoltz@cityofmadison.com; jmoyer@cityofmadison.com) {
	}

if (jgoltz@cityofmadison.com; jmoyer@cityofmadison.com) {
	}

if (jgoltz@cityofmadison.com; jmoyer@cityofmadison.com) {
	}

if (jgoltz@cityofmadison.com; jmoyer@cityofmadison.com) {
	}

if (jgoltz@cityofmadison.com; jmoyer@cityofmadison.com) {
	}

if (jgoltz@cityofmadison.com; jmoyer@cityofmadison.com) {
	}
`^
Permitting!Fire!Elevator!~;PTOIssued^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Permit to Operate" && wfStatus == "Issued") {
	scheduleInspectDate("Initial Inspection",nextWorkDay(dateAdd(AInfo['Enter the expiration date for the PTO'],60)));
	}
`^
PRA;Licenses!~!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
bLicenseIssued = false;
if (appMatch("Licenses!Engineering!Prequalified Contractor!~") == false && appMatch("Licenses!Clerk!Operator!~") == false && (capStatus == "About to Expire" || capStatus == "Expired") && balanceDue <= 0 && cmnSubType != "DischofNonStrmwtr") {
	include("CMN;LICENSE;ExpJune30");
	if(cmnType != "Building Inspection") updateAppStatus("Active","Updated due to renewal fees payment");
	}

if ((capStatus == "About to Expire" || capStatus == "Expired") && balanceDue <= 0 && cmnSubType == "DischofNonStrmwtr") {
	include("CMN;LICENSE;ExpJune30");
	updateAppStatus("Annual Survey Pending","Updated due to renewal fees payment");
	aa.set.add("CL LIC DAILY",capId);
	}

include("CMN;GetMuni");
isDischofNonStrmwtr = appMatch("Licenses!Health!DischofNonStrmwtr!Madison");
if (isTaskActive("Intake") && isDischofNonStrmwtr) {
	assignCap("HEGAP");
	include("EML;NewNonStormLicense");
	}

if (isTaskActive("Intake") && appMatch("Licenses!Clerk!Operator!NA") == false && appMatch("Licenses!Vending!~!~") == false && appMatch("Licenses!Building Inspection!~!~") == false) {
	closeTask("Intake", "Completed", "Intake has been completed due to license fee payment", "Automated process");
	}

if (isTaskActive("License Issuance") && (appMatch("Licenses!Clerk!AmusementDevice!NA") || appMatch("Licenses!Clerk!BicycleDealer!NA") || appMatch("Licenses!Clerk!CigaretteTobaccoProduct!NA"))) {
	include("CMN;LicenseIssuanceProcess");
	}

if ((appMatch("Licenses!Clerk!AmusementDevice!NA") || appMatch("Licenses!Clerk!BicycleDealer!NA") || appMatch("Licenses!Clerk!CigaretteTobaccoProduct!NA")) && bLicenseIssued) {
	include("CMN;LICENSE;ExpJune30");
	}

if (appMatch("Licenses!Health!~!~")) {
	include("CMN;CloseTaskWellOrSepticReview");
	}
`^
PRA;Licenses!Building Inspection!Foreclosure Registration!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
updateTask("Registration Status","Registered","Task automatically updated by PRA script","");
`^
PRA;Licenses!Building Inspection!Landlord Registration!Bundle^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
childsLICLR = getChildren("Licenses!~!~!~", capId);
if (childsLICLR.length > 0) {
	for(eachrecord in childsLICLR) include("CMN;Licenses!Building Inspection!Landlord Registration;ProcessChildren");
	}

updateTask("Intake","Paid","","");
`^
PRA;Licenses!Building Inspection!Landlord Registration!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
rsEXPStatus = "Active";
updateTask("Registration Status","Registered","","");
include("CMN;GENERIC;ExpDec31");
if (publicUser == false) {
	reportName = "RPEC Receipt Posting";
	include("CMN;RUN_REPORT_NO_MSG");
	}
`^
PRA;Licenses!Building Inspection!Landlord Registration!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;Licenses!Building Inspection!Landlord Registration!Renewal;UpdateRenwal");
`^
PRA;Licenses!Clerk!Operator!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if ((capStatus == "About to Expire" || capStatus == "Expired") && balanceDue <= 0) {
	include("CMN;LICENSE;2YrExpJune30");
	updateAppStatus("Active");
	updateTask("License Status", "Active", "Updated By PRA script", "");
	aa.set.add("CL LIC DAILY",capId);
	}

if (cap.isCreatedByACA() && getAppSpecific("ADDITIONAL APPLICANT INFO.Do you need a provisional license") == "Yes") {
	include("EML;Licenses!Clerk!Operator!NA;ProvisionalLicense");
	}

if (!cap.isCreatedByACA() && isTaskActive("Intake")) {
	include("EML;Licenses!Clerk!Operator!NA;PoliceBackgroundCheck");
	}

if (!cap.isCreatedByACA() && isTaskActive("Intake")) {
	closeTask("Intake","Completed","Intake has been completed due to license fee payment","Automated process");
	}

if (getAppSpecific("ADDITIONAL APPLICANT INFO.Employer Paying Fees") == "Yes") {
	updateAppStatus("Online Submittal", "Employer Paying Fees", capId);
	}
`^
PRA;Licenses!Clerk!Operator!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
proj = aa.cap.getProjectByChildCapID(capId, "Renewal", "Incomplete");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	proj[0].setStatus("Review");
	aa.cap.updateProject(proj[0]);
	}

proj1 = aa.cap.getProjectByChildCapID(capId, "Renewal", "Review");
projSuccess1 = proj1.getSuccess();
if (projSuccess1 == true) {
	proj1 = proj1.getOutput();
	parentCapId = proj1[0].getProjectID();
	pCap = aa.cap.getCapID(parentCapId.getID1(), parentCapId.getID2(), parentCapId.getID3()).getOutput();
	pAltId = pCap.getCustomID();
	}

if (projSuccess1 == true) {
	closeTask("Renewal", "Closed", "This task was automatically closed because it was not needed.", "", "LICOPRR");
	}

if (projSuccess1 == true) {
	updateAppStatus("Complete", "Renewal Complete", capId);
	}

if (projSuccess1 == true) {
	pConArray = getContactArray(parentCapId);
	}

if (projSuccess1 == true) {
	for (pC in pConArray) include("CMN;Licenses!Clerk!Operator!NA;ContactRemove");
	}

if (projSuccess1 == true) {
	copyContacts(capId, parentCapId);
	}

if (projSuccess1 == true) {
	copyASIFields(capId, parentCapId);
	}

if (projSuccess1 == true) {
	aa.appSpecificTableScript.removeAppSpecificTableInfos("CITY STATES LIVED IN SINCE 18", parentCapId, "Renew");
	aa.appSpecificTableScript.removeAppSpecificTableInfos("PENDING TICKETS OR CONVICTIONS", parentCapId, "Renew");
	aa.appSpecificTableScript.removeAppSpecificTableInfos("TICKETS OR CONVICTIONS", parentCapId, "Renew");
	}

if (projSuccess1 == true) {
	copyASITables(capId, parentCapId);
	}

if (projSuccess1 == true && balanceDue <= 0) {
	tempCapId = capId;
	capId = parentCapId;
	include("CMN;LICENSE;2YrExpJune30");
	capId = tempCapId;
	}

if (projSuccess1 == true) {
	updateTask("License Status", "Active", "Updated by WTUA Operator renewal process", "", "LICOPR", parentCapId);
	}

if (projSuccess1 == true) {
	r = aa.cap.getProjectByChildCapID(capId, "Renewal", "Review").getOutput();
	r[0].setStatus("Complete");
	aa.cap.updateProject(r[0]);
	}

if (projSuccess1 == true) {
	include("EML;GetContactEmail");
	}

if (projSuccess1 == true && (contactEmail == "" || contactEmail == null)) {
	aa.set.add("CL LIC DAILYACA",capId);
	}

if (projSuccess1 == true && contactEmail != "" && contactEmail != null) {
	capId = parentCapId;
	include("EML;Licenses!Clerk!Operator!NA;LicenseIssued");
	}

if (projSuccess1 == true) {
	capId = tempCapId;
	}
`^
PRA;Licenses!Health!Temp Food Establishment!DaneCounty^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (publicUser) {
	include("EML;Licenses!Health!Temp Food Establishment!DaneCounty;AppSubmitted");
	}
`^
PRA;Licenses!Vending!HighDensityVending!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("EML;Licenses!Vending!~!~;FeesPaid");
closeTask("Fee Review", "Fees Paid", "This task was automatically closed because payment was made.", "", "LICVEN");
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	}

if (projSuccess == true) {
	pConArray = getContactArray(capId);
	}

if (projSuccess == true && pConArray != null) {
	for (pC in pConArray) include("CMN;Licenses!Vending!~!~;ContactCompare");
	}

if (projSuccess == true) {
	copyContacts(rnwCapId, capId);
	}

if (projSuccess == true) {
	copyASIFields(rnwCapId, capId, "OFFICE USE ONLY");
	}

if (projSuccess == true) {
	aa.appSpecificTableScript.removeAppSpecificTableInfos("Associated Vendors", capId, "itjsm");
	copyASITables(rnwCapId, capId);
	}

include("CMN;Licenses!Vending!~!~;ExpirationDate");
`^
PRA;Licenses!Vending!LateNightVendor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("EML;Licenses!Vending!~!~;FeesPaid");
closeTask("Fee Review", "Fees Paid", "This task was automatically closed because payment was made.", "", "LICVEN");
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	}

if (projSuccess == true) {
	pConArray = getContactArray(capId);
	}

if (projSuccess == true && pConArray != null) {
	for (pC in pConArray) include("CMN;Licenses!Vending!~!~;ContactCompare");
	}

if (projSuccess == true) {
	copyContacts(rnwCapId, capId);
	}

if (projSuccess == true) {
	copyASIFields(rnwCapId, capId, "OFFICE USE ONLY");
	}

if (projSuccess == true) {
	aa.appSpecificTableScript.removeAppSpecificTableInfos("Associated Vendors", capId, "itjsm");
	copyASITables(rnwCapId, capId);
	}

include("CMN;Licenses!Vending!~!~;ExpirationDate");
`^
PRA;Licenses!Vending!MallCraftVendor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("EML;Licenses!Vending!~!~;FeesPaid");
closeTask("Fee Review", "Fees Paid", "This task was automatically closed because payment was made.", "", "LICVEN");
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	}

if (projSuccess == true) {
	pConArray = getContactArray(capId);
	}

if (projSuccess == true && pConArray != null) {
	for (pC in pConArray) include("CMN;Licenses!Vending!~!~;ContactCompare");
	}

if (projSuccess == true) {
	copyContacts(rnwCapId, capId);
	}

if (projSuccess == true) {
	copyASIFields(rnwCapId, capId, "OFFICE USE ONLY");
	}

if (projSuccess == true) {
	aa.appSpecificTableScript.removeAppSpecificTableInfos("Associated Vendors", capId, "itjsm");
	copyASITables(rnwCapId, capId);
	}

include("CMN;Licenses!Vending!~!~;ExpirationDate");
`^
PRA;Licenses!Vending!MallFoodVendor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("EML;Licenses!Vending!HighDensityVending!NA;FeesPaid");
closeTask("Fee Review", "Fees Paid", "This task was automatically closed because payment was made.", "", "LICVEN");
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	}

if (projSuccess == true) {
	pConArray = getContactArray(capId);
	}

if (projSuccess == true && pConArray != null) {
	for (pC in pConArray) include("CMN;Licenses!Vending!~!~;ContactCompare");
	}

if (projSuccess == true) {
	copyContacts(rnwCapId, capId);
	}

if (projSuccess == true) {
	copyASIFields(rnwCapId, capId, "OFFICE USE ONLY");
	}

if (projSuccess == true) {
	aa.appSpecificTableScript.removeAppSpecificTableInfos("Associated Vendors", capId, "itjsm");
	copyASITables(rnwCapId, capId);
	}

include("CMN;Licenses!Vending!~!~;ExpirationDate");
`^
PRA;Licenses!Vending!MerchantVendor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
include("EML;Licenses!Vending!~!~;FeesPaid");
closeTask("Fee Review", "Fees Paid", "This task was automatically closed because payment was made.", "", "LICVEN");
include("CMN;Licenses!Vending!~!~;ExpirationDate");
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	}

if (projSuccess == true) {
	pConArray = getContactArray(capId);
	}

if (projSuccess == true && pConArray != null) {
	for (pC in pConArray) include("CMN;Licenses!Vending!~!~;ContactCompare");
	}

if (projSuccess == true) {
	copyContacts(rnwCapId, capId);
	}

if (projSuccess == true) {
	copyASIFields(rnwCapId, capId);
	}
`^
PRA;Licenses!Vending!SidewalkCafe!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("EML;Licenses!Vending!~!~;FeesPaid");
closeTask("Fee Review", "Fees Paid", "This task was automatically closed because payment was made.", "", "LICVEN");
include("CMN;Licenses!Vending!~!~;ExpirationDate");
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	}

if (projSuccess == true) {
	pConArray = getContactArray(capId);
	}

if (projSuccess == true && pConArray != null) {
	for (pC in pConArray) include("CMN;Licenses!Vending!~!~;ContactCompare");
	}

if (projSuccess == true) {
	copyContacts(rnwCapId, capId);
	}

if (projSuccess == true) {
	copyASIFields(rnwCapId, capId);
	}
`^
PRA;Licenses!Vending!SoutheastCampusVending!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("EML;Licenses!Vending!~!~;FeesPaid");
closeTask("Fee Review", "Fees Paid", "This task was automatically closed because payment was made.", "", "LICVEN");
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	}

if (projSuccess == true) {
	pConArray = getContactArray(capId);
	}

if (projSuccess == true && pConArray != null) {
	for (pC in pConArray) include("CMN;Licenses!Vending!~!~;ContactCompare");
	}

if (projSuccess == true) {
	copyContacts(rnwCapId, capId);
	}

if (projSuccess == true) {
	copyASIFields(rnwCapId, capId, "OFFICE USE ONLY");
	}

if (projSuccess == true) {
	aa.appSpecificTableScript.removeAppSpecificTableInfos("Associated Vendors", capId, "itjsm");
	copyASITables(rnwCapId, capId);
	}

include("CMN;Licenses!Vending!~!~;ExpirationDate");
`^
PRA;Licenses!Vending!StreetVendor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("EML;Licenses!Vending!~!~;FeesPaid");
closeTask("Fee Review", "Fees Paid", "This task was automatically closed because payment was made.", "", "LICVEN");
include("CMN;Licenses!Vending!~!~;ExpirationDate");
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	}

if (projSuccess == true) {
	pConArray = getContactArray(capId);
	}

if (projSuccess == true && pConArray != null) {
	for (pC in pConArray) include("CMN;Licenses!Vending!~!~;ContactCompare");
	}

if (projSuccess == true) {
	copyContacts(rnwCapId, capId);
	}

if (projSuccess == true) {
	copyASIFields(rnwCapId, capId);
	}
`^
PRA;Licenses!Vending!TOSVOD!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("EML;Licenses!Vending!~!~;FeesPaid");
closeTask("Fee Review", "Fees Paid", "This task was automatically closed because payment was made.", "", "LICTOS");
include("CMN;Licenses!Vending!~!~;ExpirationDate");
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	}

if (projSuccess == true) {
	pConArray = getContactArray(capId);
	}

if (projSuccess == true && pConArray != null) {
	for (pC in pConArray) include("CMN;Licenses!Vending!~!~;ContactCompare");
	}

if (projSuccess == true) {
	copyContacts(rnwCapId, capId);
	}

if (projSuccess == true) {
	copyASIFields(rnwCapId, capId);
	}
`^
PRA;Permitting!Building!RepairReplace!Construction^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var dpcheck = parseInt(getAppSpecific("OFFICIAL USE ONLY.DPCheck"));
if (dpcheck == 1) {
	include("EML;Permitting!Building!RepairReplace!Construction;FeeACAPaid");
	updateAppStatus("Ready to Issue", "Ready to Issue");
	}
`^
PRA;Permitting!Building!Residential!Construction^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var dpcheck = parseInt(getAppSpecific("OFFICIAL USE ONLY.DPCheck"));
if (dpcheck == 1) {
	include("EML;Permitting!Building!Residential!Construction;FeeACAPaid");
	updateAppStatus("Ready to Issue", "Ready to Issue");
	}
`^
PRA;Permitting!Clerk!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (isTaskActive("Intake") && cmnSubType != "AnimalTrapping" && cmnSubType != "Solicitor" && cmnSubType != "Transient Merchant") {
	closeTask("Intake","Submitted","Intake has been completed due to fee payment","Automated process");
	}

if ((cmnSubType == "Solicitor" || cmnSubType == "Transient Merchant")) {
	include("CMN;Permitting!Clerk!~!~;PermitIssueActions");
	}
`^
PRA;Permitting!Clerk!AnimalTrapping!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (balanceDue <= 0 && isTaskActive("Intake")) {
	closeTask("Intake","Fees Paid","updated via script",null);
	}
`^
PRA;Permitting!Engineering!Sewer Plug!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
isTaskActiveFees = isTaskActive("Fees");
if (isTaskActiveFees && !publicUser && balanceDue == 0) {
	include("EML;Permitting!Engineering!Sewer Plug!NA;IssuanceEmail");
	}

if (isTaskActiveFees && !publicUser && balanceDue == 0) {
	closeTask("Fees", "Fees Paid", "This task was automatically closed because the fees have been paid.", "");
	}

if (isTaskActiveFees && !publicUser && balanceDue == 0) {
	closeTask("Issuance", "Issued", "This task was automatically closed because the fees have been paid.", "");
	}

if (isTaskActiveFees && !publicUser && balanceDue == 0) {
	reportName = "Sewer Plug Permit";
	include("CMN;RUN_REPORT_NO_MSG");
	}
`^
PRA;Permitting!Fire!Alarm!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Fire!~!~;AlarmSprinklerPlansRequiredCheck");
include("CMN;Permitting!Fire!~!~;PlanReviewAutoAssign");
`^
PRA;Permitting!Fire!AltFireSuppression!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Fire!AltFireSuppression!NA;PlansRequiredCheck");
`^
PRA;Permitting!Fire!ControlledEgress!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Fire!ControlledEgress!NA;ControlledEgressPlansRequiredCheck");
`^
PRA;Permitting!Fire!KitchenHood!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Fire!~!~;KitchenHoodPlansRequiredCheck");
`^
PRA;Permitting!Fire!Sprinkler!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Fire!~!~;AlarmSprinklerPlansRequiredCheck");
include("CMN;Permitting!Fire!~!~;PlanReviewAutoAssign");
`^
PRA;Permitting!Health!Temp Food Establishment!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
isAca = cap.isCreatedByACA();
if (isTaskActive("Intake")) {
	closeTask("Intake","Submitted","Intake has been completed due to fee payment","Automated process");
	}

if (isAca) {
	include("EML;Permitting!Health!Temp Food Establishment");
	}
`^
PRA;Permitting!Health!Temp Tattoo And Or Piercing!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (isTaskActive("Intake")) {
	closeTask("Intake","Submitted","Intake has been completed due to fee payment","Automated process");
	}
`^
PRA;Permitting!Parks!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
process = false;
if (!publicUser && (appMatch("Permitting!Parks!SkiTrail!~") || appMatch("Permitting!Parks!Lake Access!~") || appMatch("Permitting!Parks!DiscGolf!~") || appMatch("Permitting!Parks!DogPark!~"))) {
	process = true;
	}

if (process) {
	reportName = "Parks Receipt";
	include("CMN;RUN_REPORT");
	}

if (publicUser && (appMatch("Permitting!Parks!SkiTrail!~") || appMatch("Permitting!Parks!Lake Access!~") || appMatch("Permitting!Parks!DiscGolf!~") || appMatch("Permitting!Parks!DogPark!~"))) {
	include("EML;Permitting!Parks;TempPermit");
	include("CMN;Permitting!Parks!~!~;CreateContactfromASI");
	}
`^
PRA;Permitting!Parks!Block Party!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
deactivateTask("Issuance");
`^
PRA;Permitting!Parks!Dailies!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
if (balanceDue <= 0) {
	updateAppStatus("Closed","Updated via Script");
	}
`^
PRA;Permitting!Parks!Electrical Amplification!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
ca = getContactArray();
reportName = aa.util.newHashtable();
var repParams = aa.util.newHashtable();
reportModule = "Permitting";
reportName.put(0, "Parks Permit");
addParameter(repParams, "AltID", capIDString);
var params  = aa.util.newHashtable();
getRecordParams4Notification(params);
getContactParams4Notification(params, ca[0]);
contactEmail = ca[0]["email"];
addParameter(params, "$$siteRequested$$", AInfo['EVENT INFORMATION.Site Requested']);
addParameter(params, "$$siteDate$$", AInfo['EVENT INFORMATION.Date Requested']);
addParameter(params, "$$siteTimes$$", AInfo['EVENT INFORMATION.Site Times']);
getACARecordParam4Notification(params, madisonACAUrl, "Base");
sendNotification("madisonevents@cityofmadison.com", contactEmail, "", "PARKSFARMISSUED", params, reportName, repParams, reportModule);
closeTask("Application Review", "Application Received", "Application Reviewed", "Application paid for");
closeTask("Calendar Check", "Date Approved", "Application Reviewed", "Application paid for");
closeTask("Issuance", "Issued", "Issued", "Application paid for");
`^
PRA;Permitting!Parks!Farmers Market Electric!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
ca = getContactArray();
reportName = aa.util.newHashtable();
var repParams = aa.util.newHashtable();
reportModule = "Permitting";
reportName.put(0, "Parks Permit");
addParameter(repParams, "AltID", capIDString);
var params  = aa.util.newHashtable();
getRecordParams4Notification(params);
getContactParams4Notification(params, ca[0]);
contactEmail = ca[0]["email"];
getACARecordParam4Notification(params, madisonACAUrl);
sendNotification("madisonevents@cityofmadison.com", contactEmail, "", "PARKSFARMISSUED", params, reportName, repParams, reportModule);
closeTask("Application Review", "Application Reviewed", "Application Reviewed", "Application paid for");
closeTask("Issuance", "Issued", "Issued", "Application paid for");
`^
PRA;Permitting!Parks!Street Use!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
updateTask("Create Fees", "Fees Paid", "Fees Paid", "Fees Paid For");
`^
PRA;Permitting!Traffic Engineering!Bicycle Registration!renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
proj = aa.cap.getProjectByChildCapID(capId, "Renewal", "Incomplete");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	parentCapId = proj[0].getProjectID();
	aa.cap.updateRenewalCapStatus(parentCapId, capId);
	}

proj1 = aa.cap.getProjectByChildCapID(capId, "Renewal", "Review");
projSuccess1 = proj1.getSuccess();
if (projSuccess1 == true) {
	proj1 = proj1.getOutput();
	parentCapId = proj[0].getProjectID();
	}

if (projSuccess1 == true) {
	aa.cap.updateAccessByACA(capId, "N");
	}

if (projSuccess1 == true) {
	closeTask("Intake", "Submitted", "This task was automatically closed because it was not needed.", "", "LICHDV");
	}

if (projSuccess1 == true) {
	closeTask("Closed", "Closed", "This task was automatically closed because it was not needed.", "", "LICHDV");
	}

if (projSuccess1 == true) {
	updateAppStatus("Complete", "Renewal Complete", capId);
	}

if (projSuccess1 == true) {
	r = aa.cap.getProjectByChildCapID(capId, "Renewal", "Review").getOutput();
	r[0].setStatus("Complete");
	aa.cap.updateProject(r[0]);
	}

if (projSuccess1 == true) {
	pConArray = getContactArray(parentCapId);
	}

if (projSuccess1 == true && pConArray != null) {
	for (pC in pConArray) include("CMN;Permitting!Traffic Enginnering!Bicycle Registration!~;ContactRemove");
	}

if (projSuccess1 == true) {
	copyContacts(capId, parentCapId);
	}

if (projSuccess1 == true) {
	copyASIFields(capId, parentCapId);
	}

if (projSuccess1 == true) {
	updateAppStatus("Online Submittal", "Renewal Complete", parentCapId);
	}

if (projSuccess1 == true && publicUser == false) {
	tempCapId = capId;
	capId = parentCapId;
	licEditExpInfo("Active", "5!15!" + renewalYear);
	capId = tempCapId;
	}

if (projSuccess1 == true && publicUser == false) {
	editAppSpecific("DECAL INFORMATION.Expiration Date", "5!15!" + renewalYear, parentCapId);
	}
`^
PRA;Permitting!Traffic Engineering!Street Occupancy!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("EML;Permitting!Traffic Engineering!Street Occupancy!NA;Issued");
updateTask("Issuance","Issued","Updated By Payment Received After Script","");
`^
PRA;Permitting!Vending!Banner!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
closeTask("Fee Review", "Fees Paid", "This task was automatically closed because payment was made.", "", "PERVENBAN");
updateTask("Issuance","Scheduled","Updated by script because receipt works as the permit","Note");
`^
PRA;Permitting!Vending!TEM!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
closeTask("Fee Review", "Fees Paid", "This task was automatically closed because payment was made.", "", "PERVENTEM");
include("EML;Licenses!Vending!~!~;FeesPaid");
`^
PRA;WeightsMeasures!~!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;WeightsMeasuresLicenseIssueProcess");
`^
PublishCommentsAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("PCA;" + cmnGroup + "!~!~!~");
include("PCA;" + cmnGroup + "!" + cmnType + "!~!~");
include("PCA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("PCA;" + appTypeString);
`^
PublishCommentsBefore^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("PCB;" + cmnGroup + "!~!~!~");
include("PCB;" + cmnGroup + "!" + cmnType + "!~!~");
include("PCB;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("PCB;" + appTypeString);
`^
RelatedCapUpdateAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("RCUA;" + cmnGroup + "!~!~!~");
include("RCUA;" + cmnGroup + "!" + cmnType + "!~!~");
include("RCUA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("RCUA;" + appTypeString);
`^
RenewalInfoUpdateAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("RUA;" + cmnGroup + "!~!~!~");
include("RUA;" + cmnGroup + "!" + cmnType + "!~!~");
include("RUA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("RUA;" + appTypeString);
`^
ReportServiceRunAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("RSRA;" + cmnGroup + "!~!~!~");
include("RSRA;" + cmnGroup + "!" + cmnType + "!~!~");
include("RSRA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("RSRA;" + appTypeString);
`^
ReportServiceRunBefore^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug  = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("RSRB;" + cmnGroup + "!~!~!~");
include("RSRB;" + cmnGroup + "!" + cmnType + "!~!~");
include("RSRB;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("RSRB;" + appTypeString);
aa.sendEmail("noreply@cityofmadisonDEV.com", "jmoyer@cityofmadisonDEV.com", "jmoyer@cityofmadisonDEV.com", "Report Service Run Before Test", debug, "");
`^
RezCUComments^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (The construction of this project will require that the applicant shall enter into a City ! Developer agreement for the required infrastructure improvements.  The applicant shall contact City Engineering to schedule the development of the plans and the agreement. The City Engineer will not sign off on this project without the agreement executed by the developer.  Obtaining a developer’s agreement generally takes approximately 4-6 weeks, minimum.    (MGO 16.23(9)c)) {
	}

if (This development is subject to impact fees for the This development is subject to impact fees for the_____________ Impact Fee District.  All impact fees are due and payable at the time building permits are issued. (MGO Ch 20)The following note shall put on the face of the plans;LOTS ! BUILDINGS WITHIN THIS DEVELOPMENT ARE SUBJECT TO IMPACT FEES THAT ARE DUE AND PAYABLE AT THE TIME BUILDING PERMIT(S) ARE ISSUED.) {
	}

if (This property has deferred assessments for the_____________assessment district that will be due upon _____________.) {
	}

if (The proposed new building will cross an underlying platted lot line. Current fire code and City enforcement requires the underlying platted lot line be dissolved by Certified Survey Map (CSM) prior to issuance of a building permit. A CSM and required supporting information shall be prepared and submitted to the City of Madison Planning Department. The CSM shall be approved by the City and recorded with the Dane County Register of Deeds prior to issuance of a building permit.) {
	}

if (The pending Certified Survey Map application for this property shall be completed and recorded with the Dane County Register of Deeds (ROD) prior to issuance of any building permits for new construction. When the recorded CSM image is available from the ROD, the Assessor's Office can then create the new Address-Parcel-Owner (APO) data in GEO so that the Accela system can upload this data and permit issuance made available for this new land record) {
	}

if (The Site Plan indicates _______________ that will encroach into the _____________ right of way. The Applicant shall confirm all other portions of the proposed building and!or any private site improvements that will encroach into the adjacent right of ways. This includes (not limited to) balconies, roof overhangs and underground vaults. If any private improvements should encroach into the right of way, the Applicant shall make an application with City of Madison for a privilege in streets administered by the City of Madison Office of Real Estate Services. Use the following link for application information http;!!www.cityofmadison.com!developmentcenter!landdevelopment!streetencroachment.cfm. An approval of the development does not constitute or guarantee approval of any encroachments within a public right of way.) {
	}

if (For underground encroachments, the Applicant shall provide a signed and sealed Plat of Survey and legal description by a Professional Land Surveyor compliant with Chapter A-E 7 of the Wisconsin Administrative Code showing the improvements with a fully dimensioned and legally described perimetrical boundary of the encroachment area referenced to the Dane County Coordinate System tied to a quarter section line as required by Chapter 236 of the Wisconsin Statutes. The map and legal description shall also define and describe the three dimensional location of the upper and lower limits of the improvements. All vertical locations shall be referenced to the NAVD 88 (91) datum. Provide an electronic copy of the survey and word document of the legal description to the Land Records Coordinator, (Jeff Quamme – jrquamme@cityofmadison.com) for review, comment and coordination of the exhibits and documentation required for the proposed encroachment area.

The Applicant shall become a member of Diggers Hotline and shall maintain that  membership throughout the term of this agreement.  The applicant shall mark the location of underground features located within the right-of-way when notified by Diggers Hotline to do so.) {
	}

if (The site plan shall identify lot and block numbers of recorded Certified Survey Map or Plat.) {
	}

if (The site plan shall include all lot!ownership lines, existing building locations, proposed building additions, demolitions, parking stalls, driveways, sidewalks (public and!or private), existing and proposed signage, existing and proposed utility locations and landscaping.) {
	}

if (The site plan shall identify the difference between existing and proposed impervious areas.) {
	}

if (The site plan shall reflect a proper street address of the property as reflected by official City of Madison Assessor's and Engineering Division records.) {
	}

if (Submit a PDF of all floor plans to lzenchenko@cityofmadison.com so that a preliminary interior addressing plan can be developed prior to plans being submitted for permit review. If there are any changes pertaining to the location of a unit, the deletion or addition of a unit, or to the location of the entrance into any unit, (before, during, or after construction) the addresses may need to be changed. The interior address plan is subject to the review and approval of the Fire Marshal.) {
	}

if (Submit a PDF of all floor plans for each separate building to Lori Zenchenko (Lzenchenko@cityofmadison.com); so that a preliminary building and preliminary interior addressing plan can be developed prior to plans being submitted for permit review. If there are any changes pertaining to the location of a unit, the deletion or addition of a unit, or to the location of the entrance into any unit, (before, during or after construction) the addresses may need to be changed. The interior address plan is subject to the review and approval of the Fire Marshal.) {
	}

if (Submit a PDF floor plan to Lori Zenchenko (Lzenchenko@cityofmadison.com); so that a preliminary tenant space addressing plan can be developed prior to plans being submitted for permit review. If there are any changes pertaining to the location of a unit, the deletion or addition of a unit, or to the location of the entrance into any unit, (before, during or after construction) the addresses may need to be changed. The interior address plan is subject to the review and approval of the Fire Marshal.) {
	}

if (The site plan shall include a full and complete legal description of the site or property being subjected to this application.) {
	}

if ([SubCSM or Project Specific General Engineering Comment - Edit As Needed]) {
	}

if (The Applicant shall Dedicate a (     ) foot wide strip of Right of Way along (     ), (MGO 16.23(3)(a)(2)(c) (plats) & 16.23(5)(g)1 (CSM))) {
	}

if (The Public Storm Sewer Easement(s) dedicated to the City of Madison (“City”) on the face of this Certified Survey Map or Subdivision Plat is!are subject to the following conditions;a. The property owner reserves the right to use and occupy the Public Storm Sewer Easement Area(s) in a manner consistent with the rights herein conveyed, provided that such use and occupancy shall not interfere with or disturb the installation, operation, maintenance, repair, replacement and!or modification of the public storm sewer facilities.b. No above-ground improvements shall be located in the Public Storm Sewer Easement Area(s) by the City or the property owner, with the exception that grates, sewer access structure (SAS) covers, and other access points to the public storm sewer facilities shall be permitted at grade level. (Optional;  and with the exception that pavement and!or concrete for driveway purposes shall be permitted.)c. Plantings and landscaping within the Public Storm Sewer Easement Area(s) shall not obstruct routine maintenance by the City. In the event of repair or reconstruction, plantings and landscaping may be removed by the City without replacement or compensation to the property owner.d. The property owner shall not change the grade of the Public Storm Sewer Easement Area(s) without the prior written approval of the City’s Engineering Division.The Public Storm Sewer Easement(s) may not be amended, modified, terminated, or released without the written consent of all the parties hereto, or their respective successors-in-interest.(MGO 16.23)(3)(a)(2)(c) (plats) & 16.23(5)(g)1 (CSM)) {
	}

if (The Public Water Main Easement(s) dedicated to the City of Madison (“City”) on the face of this Certified Survey Map or Subdivision Plat is!are subject to the following conditions;a. The property owner reserves the right to use and occupy the Public Water Main Easement Area(s) in a manner consistent with the rights herein conveyed, provided that such use and occupancy shall not interfere with or disturb the installation, operation, maintenance, repair, replacement and!or modification of the public water main facilities.b. No above-ground improvements will be allowed in the Public Water Main Easement Area(s) by the property owner. (Optional; with the exception that pavement and!or concrete for driveway purposes shall be permitted.)c. Plantings and landscaping within the Public Water Main Easement Area(s) shall not obstruct routine maintenance by the City. In the event of repair or reconstruction, plantings and landscaping may be removed by the City without replacement or compensation to the property owner.d. The property owner shall not change the grade of the Public Water Main Easement Area(s) without the prior written approval of the City’s Engineering Division.e. The Public Water Main Easement(s) may not be amended, modified, terminated, or released without the written consent of all the parties hereto, or their respective successors-in-interest.(MGO 16.23)(3)(a)(2)(c) (plats) & 16.23(5)(g)1 (CSM)) {
	}

if (The Applicant shall Dedicate a (     ) foot wide strip of Right of Way along (     ), (MGO 16.23(3)(a)(2)(c) (plats) & 16.23(5)(g)1 (CSM))) {
	}

if (The applicant shall Dedicate a Permanent Limited Easement for grading and sloping (     ) feet wide along (     )(MGO 16.23(3)(a)(2)(c) (plats) & 16.23(5)(g)1 (CSM))) {
	}

if (The City Engineer has reviewed the need for pedestrian and bicycle connections through the development and finds that no connections are required. (MGO 16.23)(3)(a)(2)(c) (plats) & 16.23(5)(g)1 (CSM)) {
	}

if (The applicant shall dedicate a Permanent Limited Easement for a pedestrian ! bicycle easement (     ) feet wide from (     ) to (     ). (MGO 16.23)(3)(a)(2)(c) (plats) & 16.23(5)(g)1 (CSM)) {
	}

if (The Developer shall provide a private easement for public pedestrian and bicycle use through the property running from (     ) to (     ). (MGO 16.23)(3)(a)(2)(c) (plats) & 16.23(5)(g)1 (CSM)) {
	}

if (The developer shall be responsible for the ongoing construction and maintenance of a path within the easement. The maintenance responsibilities shall include, but not be limited to, paving, repaving, repairing, marking and plowing. The developer shall work with the City of Madison Real Estate Staff to administer this easement. Applicable fees shall apply. (MGO 16.23)(3)(a)(2)(c) (plats) & 16.23(5)(g)1 (CSM)) {
	}

if (The Public Sanitary Sewer Easement(s) dedicated to the City of Madison (“City”) on the face of this Certified Survey Map or Subdivision Plat is!are subject to the following conditions;a. The property owner reserves the right to use and occupy the Public Sanitary Sewer Easement Area(s) in a manner consistent with the rights herein conveyed, provided that such use and occupancy shall not interfere with or disturb the installation, operation, maintenance, repair, replacement and!or modification of the public sanitary sewer facilities.b. No above-ground improvements shall be located in the Public Sanitary Sewer Easement Area(s) by the City or the property owner, with the exception that grates, sewer access structure (SAS) covers, and other access points to the public sanitary sewer facilities shall be permitted at grade level. (Optional;  and with the exception that pavement and!or concrete for driveway purposes shall be permitted.)c. Plantings and landscaping within the Public Sanitary Sewer Easement Area(s) shall not obstruct routine maintenance by the City. In the event of repair or reconstruction, plantings and landscaping may be removed by the City without replacement or compensation to the property owner.d. The property owner shall not change the grade of the Public Sanitary Sewer Easement Area(s) without the prior written approval of the City’s Engineering Division.e. The Public Sanitary Sewer Easement(s) may not be amended, modified, terminated, or released without the written consent of all the parties hereto, or their respective successors-in-interest. (MGO 16.23)(3)(a)(2)(c) (plats) & 16.23(5)(g)1 (CSM)) {
	}

if (The Public Sidewalk Easement(s) dedicated to the City of Madison (“City”) on the face of this Certified Survey Map or Subdivision Plat is!are subject to the following conditions;a. The property owner reserves the right to use and occupy the Public Sidewalk Easement Area(s) in a manner consistent with the rights herein conveyed, provided that such use and occupancy shall not interfere with or disturb the installation, operation, maintenance, repair, replacement and!or modification of the public sidewalk improvements.b. No above-ground improvements will be allowed in the Public Sidewalk Easement Area(s) by the property owner. (Optional; with the exception that pavement and!or concrete for driveway purposes shall be permitted.)c. Plantings and landscaping within the Public Sidewalk Easement Area(s) shall not obstruct routine maintenance by the City. In the event of repair or reconstruction, plantings and landscaping may be removed by the City without replacement or compensation to the property owner.d. The property owner shall not change the grade of the Public Sidewalk Easement Area(s) without the prior written approval of the City’s Engineering Division.e. The Public Sidewalk Easement(s) may not be amended, modified, terminated, or released without the written consent of all the parties hereto, or their respective successors-in-interest.(MGO 16.23)(3)(a)(2)(c) (plats) & 16.23(5)(g)1 (CSM)) {
	}

if ([SubCSM or Project Specific Right of Way!Easement Comment - Edit As Needed]) {
	}

if (The Applicant shall execute a waiver of notice and hearing on the assessments for the improvement of [roadway]____________________________ in accordance with Section 66.0703(7)(b) Wisconsin Statutes and Section 4.09 of the MGO.  (MGO 16.23(9)(d)(6)) {
	}

if (The approval of this zoning approval does not include the approval of the changes to roadways, sidewalks or utilities.   The applicant shall obtain separate approval by the Board of Public Works and the Common Council for the restoration of the public right of way including any changes requested by developer.  The City Engineer shall complete the final plans for the restoration with input from the developer..  (MGO 16.23(9)(d)(6)) {
	}

if (The Applicant shall provide the City Engineer with a survey indicating the grade of the existing sidewalk and street. The Applicant shall hire a Professional Engineer to set the grade of the building entrances adjacent to the public right of way.  The Applicant shall provide the City Engineer the proposed grade of the building entrances.  The City Engineer shall approve the grade of the entrances prior to signing off on this development. (POLICY)) {
	}

if (The Applicant shall replace all sidewalk and curb and gutter which abuts the property which is damaged by the construction or any sidewalk and curb and gutter which the City Engineer determines needs to be replaced because it is not at a desirable grade regardless of whether the condition existed prior to beginning construction. (POLICY)) {
	}

if (The Applicant shall obtain a privilege in streets agreement for any encroachments inside the public right of way.  The approval of this development does not constitute or guarantee approval of the encroachments. (INFORMATIONAL)) {
	}

if (The Applicant shall provide the City Engineer with the proposed earth retention system to accommodate the restoration.  The earth retention system must be stamped by a Professional Engineer.  The City Engineer may reject or require modifications to the retention system.  (POLICY)) {
	}

if (The Applicant shall complete work on exposed aggregate sidewalk in accordance with specifications provided by the city.  The stone used for the exposed aggregate shall be approved by the City.  The Construction Engineer shall be notified prior to beginning construction.  Any work that does not match the adjacent work or which the City Construction Engineer finds is unacceptable shall be removed and replaced. (POLICY)) {
	}

if (All work in the public right-of-way shall be performed by a City licensed contractor.   (MGO 16.23(9)(c)5) and MGO 23.01)) {
	}

if (Installation of "Private" street signage in accordance with 10.34 MGO is required.) {
	}

if (All street tree locations and tree species within the right of way shall be reviewed and approved by City Forestry. Please submit a tree planting plan (in PDF format) to Dean Kahl, of the City Parks Department dkahl@cityofmadison.com or 266-4816. Approval and permitting of any tree removal or replacement shall be obtained from the City Forester and!or the Board of Public Works prior to the approval of the site plan. (POLICY)) {
	}

if (All damage to the pavement on ___________________________, adjacent to this development shall be restored in accordance with the City of Madison's Pavement Patching Criteria.  For additional information please see the following link; http;!!www.cityofmadison.com!engineering!patchingCriteria.cfm (POLICY)) {
	}

if (The Applicant shall Construct Sidewalk to a plan approved by the City) {
	}

if (The Applicant shall install public sidewalk along _______________.  The Applicant shall obtain a Street Excavation Permit for the sidewalk work, which is available from the City Engineering Division.  The applicant shall pay all fees associated with the permit including inspection fees.  All work must be completed within six months or the succeeding June 1, whichever is later.  (MGO 16.23(9)(d)(6)This permit application is available on line at   http;!!www.cityofmadison.com!engineering!permits.cfm.) {
	}

if (The Applicant shall  execute a waiver of their right to notice and hearings on the assessments for the installation of sidewalk along [roadway] ________________________________________________ in accordance with Section 66.0703(7)(b) Wisconsin Statutes and Section 4.09 of the MGO.  (MGO 16.23(9)(d)(6)) {
	}

if (The Applicant shall grade the property line along _______ to a grade established by the City Engineer.  The grading shall be suitable to allow the installation of sidewalk in the future without the need to grade beyond the property line.  The Applicant shall obtain a Street Excavation permit prior to the City Engineer signing off on this development.  (MGO 16.23(9)(d)(6)This permit application is available on line at http;!!www.cityofmadison.com!engineering!permits.cfm.) {
	}

if (The Applicant shall close all abandoned driveways by replacing the curb in front of the driveways and restoring the terrace with grass. (POLICY)) {
	}

if (The Applicant's project requires the minor restoration of the street and sidewalk.  The Applicant shall obtain a Street Excavation Permit for the street restoration work, which is available from the City Engineering Division.  The applicant shall pay all fees associated with the permit including inspection fees.  (MGO 16.23(9)(d)(6)This permit application is available on line at   http;!!www.cityofmadison.com!engineering!permits.cfm.) {
	}

if (The Applicant shall make improvements to _______________________________ in order to facilitate ingress and egress to the development.   The improvement shall include a (Describe what the  work involves or strike this part of the comment.) _____________________.  (MGO 16.23(9)(d)(6)) {
	}

if (The Applicant shall make improvements to _______________________________ . The improvements shall consist of _______________________________.   (MGO 16.23(9)(d)(6)) {
	}

if ([SubCSM or Project Specific Streets and Sidewalk Comment - Edit As Needed]) {
	}

if (This project falls in the area subject to increased erosion control enforcement as authorized by the fact that it is in a TMDL ZONE. The project will be expected to meet a higher standard of erosion control than the minimum standards set by the WDNR in order to comply with TMDL limits.) {
	}

if (The site plans shall be revised to show the location of all rain gutter down spout discharges.  (POLICY)) {
	}

if (The plan set shall be revised to show more information on proposed drainage for the site. This shall be accomplished by using spot elevations and drainage arrows or through the use of proposed contours.  It is necessary to show the location of drainage leaving the site to the public right-of-way.  It may be necessary to provide information off the site to fully meet this requirement.  (POLICY)) {
	}

if (A portion of this project comes under the jurisdiction of the US Army Corp of Engineers and WDNR for wetland or flood plain issues.  A permit for those matters shall be required prior to construction on any of the lots currently within the jurisdictional flood plain. (NOTIFICATION)) {
	}

if (The Applicant shall submit, prior to plan sign-off, a digital CAD file (single file) to the Engineering Program Specialist in the Engineering Division (Lori Zenchenko). The digital CAD file shall be to scale and represent final construction. The CAD file shall be in a designated coordinate system (preferably Dane County WISCRS, US Ft).  The single CAD file submittal can be either AutoCAD (dwg) Version 2013 or older, MicroStation (dgn) V8i Select Series 3 or older, or Universal (dxf) format and shall contain the only the following data, each on a separate layer name!level number;
a) Building Footprints
b) Internal Walkway Areas
c) Internal Site Parking Areas
d) Other Miscellaneous Impervious Areas (i.e. gravel, crushed stone, bituminous!asphalt, concrete, etc.)e) Right-of-Way lines (public and private)
f) Lot lines or parcel lines if unplatted
g) Lot numbers or the words unplatted
h) Lot!Plat dimensions
i) Street names
All other levels (contours, elevations, etc) are not to be included with this file submittal.

NOTE; Email file transmissions preferred lzenchenko@cityofmadison.com .  Include the site address in the subject line of this transmittal.  Any changes or additions to the location of the building, sidewalks, parking!pavement during construction will require a new CAD file.) {
	}

if (The Applicant shall submit, prior to plan sign-off but after all revisions have been completed, a digital CAD file (single file) to the Engineering Division with any private storm and sanitary sewer utilities.  The digital CAD file shall be to scale and represent final construction. The CAD file shall be in a designated coordinate system (preferably Dane County WISCRS, US Ft).  The single CAD file submittal can be either AutoCAD (dwg) Version 2013 or older, MicroStation (dgn) V8i Select Series 3 or older, or Universal (dxf) format and shall contain the only the following data, each on a separate layer name!level number;
a) Building Footprints
b) Internal Walkway Areas
c) Internal Site Parking Areas
d) Other Miscellaneous Impervious Areas (i.e. gravel, crushed stone, bituminous!asphalt, concrete, etc.)
e) Right-of-Way lines (public and private)
f) Lot lines or parcel lines if unplatted
g) Lot numbers or the words unplatted
h) Lot!Plat dimensions
i) Street names
j) Private on-site sanitary sewer utilities (including all connections to public sanitary)
k) Private on-site storm sewer utilities (including all connections to public storm)

All other levels (contours, elevations, etc) are not to be included with this file submittal.

NOTE; Email CAD file transmissions are preferred to; bstanley@cityofmadison.com (East) or ttroester@cityofmadison.com (West). Include the site address in the subject line of this transmittal.  Any changes or additions to the location of the building, sidewalks, parking!pavement, private on-site sanitary sewer utilities, or private on-site storm sewer utilities during construction will require a new CAD file.) {
	}

if (The applicant shall submit, prior to plan sign-off but after all revisions have been completed, digital PDF files to the Engineering Division. Email PDF file transmissions are preferred to; bstanley@cityofmadison.com (East) or ttroester@cityofmadison.com (West). The digital copies shall be to scale, and shall have a scale bar on the plan set.  (POLICY and MGO 37.09(2))
PDF submittals shall contain the following information;
a) Building Footprints
b) Internal Walkway Areas
c) Internal Site Parking Areas
d) Other Miscellaneous Impervious Areas (i.e. gravel, crushed stone, bituminous!asphalt, concrete, etc.)
e) Right-of-Way lines (public and private)
f) Lot lines or parcel lines if unplatted
g) Lot numbers or the words unplatted
h) Lot!Plat dimensions
i) Street names
j) Stormwater Management Facilities
k) Detail drawings associated with Stormwater Management Facilities (including if applicable planting plans).) {
	}

if (The Applicant shall submit prior to plan sign-off, electronic copies of any Stormwater Management Files including;
a) SLAMM DAT files
b) Internal Walkway Areas
c) TR-55!HYDROCAD!Etc
d) Sediment loading calculations. If calculations are done by hand or are not available electronically the hand copies or printed output shall be scanned to a PDF file and provided.  (POLICY and MGO 37.09(2))) {
	}

if (The area adjacent to this proposed development has a known flooding risk.  All entrances shall be 2-feet above the adjacent sidewalk elevation or 1-foot above the 100-year regional flood elevation (whichever is greater). This includes garage entrances. (POLICY).) {
	}

if (This project appears to require construction dewatering.  A dewatering plan shall be submitted to City Engineering as part of the Erosion Control Permit application and plan.  If contaminated soil or groundwater conditions exist on or adjacent to this project additional WDNR, Public Health, and!or City Engineering approvals may be required prior to the issuance of the required Erosion Control Permit.) {
	}

if (This project appears to require construction dewatering and!or possibly permanent dewatering and is in an area with potential groundwater contamination.  The applicant shall be required obtain the approval of Public Health - Madison & Dane County for this discharge. It can be anticipated that this will required completion of a boring on site and testing of water encountered for possible contaminates.  Approval shall be granted before plans are approved for building permit release. Contact Kirsti Sorsa for more information at 608-243-0356 or  ksorsa@publichealthmdc.com).) {
	}

if (This project appears to require construction dewatering.  A dewatering plan shall be submitted to City Engineering as part of the Erosion Control Permit application and plan.  If contaminated soil or groundwater conditions exist on or adjacent to this project additional WDNR, Public Health, and!or City Engineering approvals may be required prior to the issuance of the required Erosion Control Permit.) {
	}

if (This project appears to require permanent dewatering.  A permit to connect to the public stormwater system shall be required from City Engineering.  Additionally, a permit for non-storm discharge to the storm sewer system from the City!County Health Department shall also be required. If contaminated soil or groundwater conditions exist on or adjacent to this project additional WDNR, Public Health, and!or City Engineering approvals may be required prior to issuance of the connection and non-storm discharge permits.) {
	}

if (This project appears to require permanent dewatering.  A permit to connect to the public stormwater system shall be required from City Engineering.  Additionally, a permit for non-storm discharge to the storm sewer system from the City!County Health Department shall also be required. If contaminated soil or groundwater conditions exist on or adjacent to this project additional WDNR, Public Health, and!or City Engineering approvals may be required prior to issuance of the connection and non-storm discharge permits.) {
	}

if (Storm sewer to serve this development has been designed and constructed.  The site plans shall be revised to identify the location of this storm sewer and to show connection of an internal drainage system to the existing public storm sewer. (POLICY AND MGO OVER 10,000 SF OF IMPERVIOUS AREA  10.29 and 37.05(7)(b))) {
	}

if (This project appears to require fire system testing that can result in significant amounts of water to be discharged to the project grade.  The Contractor shall coordinate this testing with the erosion control measures and notify City Engineering 608-266-4751 prior to completing the test to document that appropriate measures have been taken to prevent erosion as a result of this testing.) {
	}

if (Submit a draft Stormwater Management Maintenance Agreement (SWMA) for review and approval that covers inspection and maintenance requirements for any BMP used to meet stormwater management requirements on this project. Include copies of all stormwater, utility, and detail plan sheets that contain stormwater practices on 8.5x14 size paper in the draft document. These drawings do not need to be to scale as they are for informational purposes only. Once City Engineering staff have reviewed the draft document and approved it with any required revisions submit a signed and notarized original copy to City Engineering. Include a check for $30.00 made out to Dane County Register of Deeds for the recording fee. City Engineering will forward the document and fee for recording at the time of issuance of the stormwater management permit. Draft document can be emailed to Tim Troester (west) at ttroester@cityofmadison.com, or Jeff Benedict at jbenedict@cityofmadison.com final document and fee should be submitted to City Engineering.) {
	}

if (Provide additional detail how the enclosed depression(s) created by the parking entrance(s) to the below building parking area(s) is!are served for drainage purposes.  The building must be protected from receiving runoff up through the 24-hr, 100-yr design storm.  If the enclosed depression(s) is!are to be served by a gravity system provide calculations stamped by a Wisconsin P.E. that show inlet and pipe capacities meet this requirement.  If the enclosed depression(s) is!are to be served by a pump system provide pump sizing calculations stamped by a Wisconsin P.E. or licensed Plumber that show this requirement has been met.) {
	}

if (The plan set shall be revised to show a proposed private internal drainage system on the site.  This information shall include the depths and locations of structures and the type of pipe to be used. POLICY AND MGO 10.29) {
	}

if (The applicant shall show storm water "overflow" paths that will safely route runoff when the storm sewer is at capacity.  (POLICY)) {
	}

if (The applicant shall demonstrate compliance with Section 37.07 and 37.08 of the Madison General Ordinances regarding permissible soil loss rates.  The erosion control plan shall include Universal Soil Loss Equation (USLE) computations for the construction period.  Measures shall be implemented in order to maintain a soil loss rate below 5.0 tons per acre per year.) {
	}

if (For Commercial sites < 1 acre in disturbance the City of Madison is an approved agent of the Department of Commerce and WDNR.  As this project is on a site with disturbance area less than one (1) acres, and contains a commercial building, the City of Madison is authorized to review infiltration, stormwater management, and erosion control on behalf of the Department of Commerce.  No separate submittal to Commerce or the WDNR is required.  (NOTIFICATION)) {
	}

if (This site appears to disturb over one (1) acre of land and requires a permit from the WDNR for stormwater management and erosion control.    The City of Madison has been required by the WDNR to review projects for compliance with NR216 and NR-151 however a separate permit submittal is still required to the WDNR for this work.  The City of Madison cannot issue our permit until concurrence is obtained from the WDNR via their NOI or WRAPP permit process. Contact Eric Rortvedt at 273-5612 of the WDNR to discuss this requirement.  Information on this permit application is available on line http;!!dnr.wi.gov!Runoff!stormwater!constrformsinfo.htm (NOTIFICATION)) {
	}

if (This development includes multiple building permits within a single lot.  The City Engineer and!or the Director of the Inspection Unit may require individual control plans and measures for each building. (POLICY)) {
	}

if (This project will require a concrete management plan as part of the erosion control plan to be reviewed and approved by the City Engineer's Office. (POLICY)) {
	}

if (The lots within this site plan are inter-dependent upon one another for stormwater runoff conveyance, and!or a private drainage system exists for the entire site an agreement shall be provided for the rights and responsibilities of all lot owners.  Said agreement shall be reviewed and placed on file by the City Engineer, referenced on the site plan and recorded at the Dane Co Register of Deeds. (POLICY)) {
	}

if (Prior to approval, this project shall comply with Chapter 37 of the Madison General Ordinances regarding stormwater management.  Specifically, this development is required to detain the 2, 10, & 100 -year storm events, matching post development rates to predevelopment rates.) {
	}

if ([SubCSM Specific Storm Sewer and Drainage Comment - Edit As Needed]) {
	}

if (Prior to approval, this project shall comply with Chapter 37 of the Madison General Ordinances regarding stormwater management.  Specifically, this development is required to reduce TSS by 40% (control the 20 micron particle) off of new paved surfaces as compared to no controls.) {
	}

if (Prior to approval, this project shall comply with Chapter 37 of the Madison General Ordinances regarding stormwater management.  Specifically, this development is required to reduce TSS by 80% (control the 5 micron particle) off of newly developed areas compared to no controls.) {
	}

if (Prior to approval, this project shall comply with Chapter 37 of the Madison General Ordinances regarding stormwater management.  Specifically, this development is required to Reduce TSS by 80% off of the proposed development when compared with the existing site.) {
	}

if (Prior to approval, this project shall comply with Chapter 37 of the Madison General Ordinances regarding stormwater management.  Specifically, this development is required to provide infiltration in accordance with Chapter 37 of the Madison General Ordinances.) {
	}

if (Prior to approval, this project shall comply with Chapter 37 of the Madison General Ordinances regarding stormwater management.  Specifically, this development is required to provide onsite volumetric control limiting the post construction volumetric discharge to the predevelopment discharge volume as calculated using the 10-year storm event.) {
	}

if (Prior to approval, this project shall comply with Chapter 37 of the Madison General Ordinances regarding stormwater management.  Specifically, this site shall provide substantial thermal control.) {
	}

if (Complete an erosion control plan and complete weekly self-inspection of the erosion control practices and post these inspections to the City of Madison website - as required by Chapter 37 of the Madison General Ordinances.) {
	}

if ([Project Specific Stormwater Comment - Edit As Needed]) {
	}

if (The Applicant shall obtain a Street Excavation permit for the installation of utilities required to serve this project.  The Applicant shall pay the permit fee, inspection fee and street degradation fee as applicable and shall comply with all the conditions of the permit.  (MGO 10.05(6)) This permit application is available on line at   http;!!www.cityofmadison.com!engineering!permits.cfm.) {
	}

if (Prior to approval, the owner or owner's representative shall obtain all necessary sewer connection permits and sewer plugging permits prior to any utility work. These permit applications are available on line at   http;!!www.cityofmadison.com!engineering!permits.cfm.  (MGO 10.05(6)) and MGO 35.02(4)(c)(2))) {
	}

if (All proposed and existing utilities including gas, electric, phone, steam, chilled water, etc shall be shown on the plan. (POLICY)) {
	}

if (The applicant's utility contractor shall obtain a connection permit and excavation permit prior to commencing the storm sewer construction.  MGO 37.05(7) This permit application is available on line at   http;!!www.cityofmadison.com!engineering!permits.cfm.) {
	}

if (The site plans shall be revised to show the location of existing utilities, including depth, type, and size in the adjacent right-of-way. (POLICY)) {
	}

if (The developer shall provide information on how the Department of Commerce's requirements regarding treatment of storm water runoff, from parking structures, shall satisfied prior to discharge to the public sewer system.  Additionally, information shall be provided on which system (storm or sanitary) the pipe shall be connected to. (POLICY)) {
	}

if (Prior to approval, the owner or owner's representative shall obtain a permit to plug each existing sanitary sewer lateral that serves a building which is proposed for demolition. For each lateral to be plugged the owner shall complete a sewer lateral plugging application and pay the applicable permit fees. The permit application is available on line at http;!!www.cityofmadison.com!engineering!permits.cfm. (MGO CH 35.02(14))) {
	}

if (Prior to approval, the owner or owner's representative shall obtain a permit to plug each existing storm sewer. This permit application is available on line at http;!!www.cityofmadison.com!engineering!permits.cfm. (MGO CH 37.05(7))) {
	}

if (This project appears to have proposed uses which could require sanitary sewer demand charges or monitoring of the discharge of sanitary sewerage. The applicant shall install a monitoring manhole on the exterior of the building in compliance with City of Madison Engineering criteria.) {
	}

if ([SubCSM Specific Sanitary Comment - Edit As Needed]) {
	}

if ([Project Specific Utilities General Comment - Edit As Needed]) {
	}

if (Prior to approval, the owner or owner's representative shall obtain a permit to plug each existing sanitary sewer lateral that serves a building which is proposed for demolition. For each lateral to be plugged the owner shall complete a sewer lateral plugging application and pay the applicable permit fees. The permit application is available on line at http;!!www.cityofmadison.com!engineering!permits.cfm. (MGO CH 35.02(14))) {
	}

if (Applicant shall provide proof of septic system abandonment from Public Health- Madison and Dane County as a condition of plan approval.  Septic System abandonment application is available online at http;!!www.publichealthmdc.com!environmental!septage!) {
	}

if (All outstanding Madison Metropolitan Sewerage District (MMSD) charges are due and payable prior to Engineering sign-off, unless otherwise collected with a Developer's ! Subdivision Contract. Contact Mark Moder (608-261-9250) to obtain the final MMSD billing a minimum of two (2) working days prior to requesting City Engineering signoff.  (MGO 16.23(9)(d)(4)) {
	}

if (All outstanding City of Madison sanitary sewer connection charges are due and payable prior to Engineering sign-off, unless otherwise collected with a Developer's ! Subdivision Contract.  This property is subject to Sanitary Connection charges for the ______________________________ District.) {
	}

if (Each unit of a duplex building shall be served by a separate and independent sanitary sewer lateral or an ownership!maintenance agreement (recorded) shall be in place prior to plan approval. (POLICY)) {
	}

if (The site plan shall be revised to show all existing public sanitary sewer facilities in the project area as well as the size, invert elevation, and alignment of the proposed service. (POLICY)) {
	}

if (This project appears to have proposed uses which could require sanitary sewer demand charges or monitoring of the discharge of sanitary sewerage.  The applicant shall install a monitoring manhole on the exterior of the building in compliance with City of Madison Engineering criteria.) {
	}

if (Applicant shall dedicate a ____' wide sanitary sewer easement as a condition of plan approval.) {
	}

if (Applicant shall construct a 12' wide sanitary sewer access path for the sanitary sewer serving the development.  Construct access path in conformance with City of Madison Standard Specifications for Public Works Construction Standard Detail Drawing 5.1.3, 5.1.4 or 5.1.4A.  Access Path is required where there is no hard surface above sanitary sewer (concrete, asphalt).  Native ground is not considered a hard surface.) {
	}

if (Add Note to Plans; Contractor shall notify Ray Schneider (608)347-3628, rays@madsewer.org, 5 days prior to making the connection to the MMSD manhole to arrange for inspection of the connection.  Sewer connection shall conform to all MMSD connection specification criteria.  Contractor is responsible for taking out the MMSD connection permit as well as the permit connection fee ($950.00, 2015 rate) if applicable.) {
	}

if ([SubCSM Specific Mapping!Land Records Comment - Edit As Needed]) {
	}

if ([Project Specific Sanitary Comment - Edit As Needed]) {
	}

if (A Phase 1 environmental site assessment (Phase 1 ESA), compliant with ASTM E1527-13, is required for the project area.  The applicant shall provide one (1) digital copy and a paper copy only if specifically requested.  Staff review of this Phase 1 ESA will determine if a Phase 2 ESA is also required.  Please submit report(s) to Brynn Bemis (608-267-1986, bbemis@cityofmadison.com) for review.) {
	}

if (Per the WDNR closure letter, this property was closed with residual soil and!or groundwater contamination (BRRTS #____________________).  Written approval from the WDNR is required prior to distrubing the existing barrier cap.  Proof of coordination with the WDNR shall be submitted to Brynn Bemis (608.267.1986, bbemis@cityofmadison.com).) {
	}

if (The property is an open contaminant site with the WDNR (BRRTS #____________________).  A digital copy of the site investigation report and remedial actions report shall be submitted to Brynn Bemis (608.267.1986, bbemis@cityofmadison.com).   Applicant shall submit proof of coordination with the WDNR to remediate the site and address residual contaminant concerns associated with the proposed site plan (i.e. vapor mitigation, dewatering).) {
	}

if (Based on historical documents (WDNR records; BRRTS #________________, Sanborn maps, or businesses listed in City Directories), the property may contain residual contaminated soil.   If  contaminated  soil  is  encountered  as  part  of  this redevelopment, all WDNR and DSPS regulations must be followed for proper handling and disposal.) {
	}

if (This site appears to require construction or permanent dewatering that may be impacted by on-site or adjacent groundwater contamination.  Confirm with James Brodzeller of the WDNR regarding whether a WPDES permit for contaminated water is required (608.275.3281).  Send proof of WDNR’s determination to Brynn Bemis (608.267.1986, bbemis@cityofmadison.com).) {
	}

if ([SubCSM or Project Specific Environmental Comment - Edit As Needed]) {
	}
`^
ROW_CUST_LOOKUP^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (4) {
	}

if (10) {
	}

if (13) {
	}

if (3) {
	}

if (22) {
	}

if (17) {
	}

if (11) {
	}

if (12) {
	}

if (20) {
	}

if (16) {
	}

if (14) {
	}

if (21) {
	}

if (25) {
	}

if (18) {
	}

if (15) {
	}

if (23) {
	}

if (200) {
	}

if (1) {
	}

if (24) {
	}

if (19) {
	}
`^
ROW_CUST_SEQ^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (26) {
	}
`^
SUA;ServiceRequest!Traffic Engineering!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (getShortNotes(capId) == "") {
	include("CMN;AddAssetIDtoShortNotes");
	}
`^
UTIL;MethodsofObject_Loop^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
comment(xobj);
if ((typeof(objectToParse[xobj]) != "function")) {
	aa.print("     " + xobj + " = " + objectToParse[xobj]);
	}
`^
V360InspectionResultSubmitBefore^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
`^
WorkflowTaskUpdateAfter^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("WTUA;" + cmnGroup + "!~!~!~");
include("WTUA;" + cmnGroup + "!" + cmnType + "!~!~");
include("WTUA;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("WTUA;" + appTypeString);
include("WTUA;" + cmnGroup + "!" + cmnType + "!~" + "!" + cmnCategory);
if (appMatch("ServiceRequest!~!~!~") && wfTask == "Submitted" && wfStatus == "Rejected") {
	updateAppStatus("Closed","ViaScript");
	}

if (appMatch("ServiceRequest!~!~!~") && wfTask == "Submitted" && wfStatus == "More Information Required") {
	emailContact("Subject Here, more information required", "Thank you for using Madison's online Service Request system.  A City representative will be contacting you soon in order to obtain more information on service request number " + capIDString + ".  Comments; " + wfComment + ".  Thank you and have a great day. ", "Contact");
	}

if (isTaskActive("Fire Inspection") && (wfTask == "Intake" || wfTask == "Permit Issuance" || wfTask  == "Common Council Hearing" || wfTask  == "ALRC Hearing")) {
	include("CMN;AssignFireInspectionTaskPrevention");
	}

if (isTaskActive("Building Inspection") && (wfTask == "Intake" || wfTask == "Permit Issuance" || wfTask  == "Common Council Hearing" || wfTask  == "ALRC Hearing")) {
	include("CMN;AssignBIInspectionTask");
	}
`^
WorkflowTaskUpdateBefore^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;~!~!~!~;GET_APP_PARTS");
include("WTUB;" + cmnGroup + "!~!~!~");
include("WTUB;" + cmnGroup + "!" + cmnType + "!~!~");
include("WTUB;" + cmnGroup + "!" + cmnType + "!" + cmnSubType + "!~");
include("WTUB;" + appTypeString);
`^
WTUA; DaneCounty!Zoning!Zoning Permit!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Permit Issuance" && wfStatus == "Complete") {
	scheduleInspectDate("Initial Inspection",nextWorkDay(dateAdd(wfDateMMDDYYYY,30)));
	}

if (wfTask == "Inspections" && wfStatus == "Violations Found") {
	scheduleInspectDate("Reinspection", nextWorkDay(dateAdd(wfDateMMDDYYYY,30)));
	}

if (wfTask == "Inspections" && wfStatus == "First Inspection Complete") {
	scheduleInspectDate("Reinspection", nextWorkDay(dateAdd(wfDateMMDDYYYY,30)));
	}
`^
WTUA;AMS!~!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Open" && wfStatus == "Closed") {
	closeTask("Close","Closed","Closed via script","");
	}

if (wfTask == "Close" && wfStatus == "Closed" && ( getParent() != false )) {
	arrParents = getParents("ServiceRequest!~!~!~");
	if (arrParents.length == 1)  updateAppStatus("Closed", "ViaScript", arrParents[0] );
	}

if (wfTask == "Complete" && wfStatus == "Work Complete") {
	completeCAP(currentUserID);
	}
`^
WTUA;AMS!Engineering Facility Maint!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if ((wfTask == "Open") && (wfStatus == "Additional Info Required")) {
	include("EML;AMS!Engineering Facility Maint!~!~");
	}

if ((wfTask == "Open") && (wfStatus == "Additional Info Received")) {
	include("EML;AMS!Engineering Facility Maint!InfoReceived");
	}

if (wfStatus == "Completed") {
	include("EML;AMS!Engineering Facility Maint!~!~");
	}

if (wfStatus== "Completed" || wfStatus == "Closed") {
	editAppName("Yes");
	}

if (wfStatus == "Closed") {
	include("EML;AMS!Engineering Facility Maint!Invoice");
	}

if (wfStatus == "Closed") {
	include("CMN;CloseAndCloseParent");
	}
`^
WTUA;AMS!Engineering Sanitary!Cleaning!Emergency Response SBU^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug=false;
showMessage=false;
BlockageType = getAppSpecific ("Blockage Type",capId);
if (wfTask == "Complete" && wfStatus == "Work Complete" && BlockageType == "Main") {
	createChild("AMS","Engineering Sanitary","Cleaning","Pre-CCTV Inspection","");
	}

if (wfTask == "Complete" && wfStatus == "Work Complete" && BlockageType == "Main") {
	createChild("AMS","Engineering Sanitary","CCTV Inspection","Post-Sewer Back Up","");
	}
`^
WTUA;AMS!Forestry!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (appMatch("AMS!Forestry!Tree Maintenance!~") && AInfo['Work Required'] == "Planting" && wfStatus == "Closed") {
	createChild("AMS","Forestry","Planting","NA","A new tree needs to be planted because of a tree removal work order.");
	}

if (appMatch("AMS!Forestry!Tree Maintenance!~")  && AInfo['Work Required'] == "Planting and Stump Grubbing" && wfStatus == "Closed") {
	createChild("AMS","Forestry","Planting","NA","~");
	}

if (appMatch("AMS!Forestry!Tree Maintenance!~")  && AInfo['Work Required'] == "Planting and Stump Grubbing" && wfStatus == "Closed") {
	childId = createChild("AMS","Streets","Stump Grubbing","NA","~");
	addASITable("GRUB",GRUB,childId);
	}

if (appMatch("AMS!Forestry!Tree Maintenance!~")  && AInfo['Work Required'] == "Stump Grubbing" && wfStatus == "Closed") {
	childId = createChild("AMS","Streets","Stump Grubbing","NA","~");
	addASITable("GRUB",GRUB,childId);
	}
`^
WTUA;AMS!Traffic!Electrical!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
isParent = false;
incompCount = 0;
if (wfTask == "Open" && wfStatus == "Closed") {
	p = aa.cap.getProjectByChildCapID(capId, "R", "");
	isParent = p.getSuccess();
	}

if (isParent == true) {
	p = p.getOutput();
	parentCapId = p[0].getProjectID();
	proj = aa.cap.getProjectByMasterID(parentCapId, "R", "");
	proj = proj.getOutput();
	}

if (isParent == true) {
	for (child in proj) include("CMN;ServiceRequest!TrafficEngineering!~!~;CheckChildWOClosed");
	}

if (isParent == true && incompCount < 1) {
	tempCapId = capId;
	capId = parentCapId;
	closeTask("TE Shop", "Work Complete", "Auto Closed", "All Studies Complete", "TE_SR");
	capId = tempCapId;
	}
`^
WTUA;AMS!Traffic!Sign!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
isParent = false;
incompCount = 0;
if (wfTask == "Open" && wfStatus == "Closed") {
	p = aa.cap.getProjectByChildCapID(capId, "R", "");
	isParent = p.getSuccess();
	}

if (isParent == true) {
	p = p.getOutput();
	parentCapId = p[0].getProjectID();
	proj = aa.cap.getProjectByMasterID(parentCapId, "R", "");
	proj = proj.getOutput();
	}

if (isParent == true) {
	for (child in proj) include("CMN;ServiceRequest!TrafficEngineering!~!~;CheckChildWOClosed");
	}

if (isParent == true && incompCount < 1) {
	tempCapId = capId;
	capId = parentCapId;
	closeTask("TE Shop", "Work Complete", "Auto Closed", "All Studies Complete", "TE_SR");
	capId = tempCapId;
	}
`^
WTUA;AnimalServices!Bite!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (isTaskActive("Follow-up") && countActiveTasks("HEBITE") == 2) {
	updateAppStatus("Follow-up", "App status updated to Follow-up due to Review being closed");
	}

if (isTaskActive("Review") && countActiveTasks("HEBITE") == 2) {
	updateAppStatus("Review", "App status updated to Review due to Follow-up being closed");
	}

if (wfTask =="Review" && wfStatus =="Reviewed" && countActiveTasks("HEBITE") < 2) {
	closeTask("Closed", "Closed", "This task was automatically closed because the Follow-up status determined to close workflow.", "", "HEBITE");
	}

if (wfTask =="Follow-up" && wfStatus !="Animal Located" && countActiveTasks("HEBITE") < 2) {
	closeTask("Closed", "Closed", "This task was automatically closed because the Follow-up status determined to close workflow.", "", "HEBITE");
	}
`^
WTUA;AnimalServices!General!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask =="Investigation" && wfStatus !="Founded") {
	closeTask("Closed", "Closed", "This task was automatically closed because the Investigation status determined Application closed.", "", "HEANIM");
	}

if (wfTask =="Follow-up" && wfStatus =="Issue Resolved") {
	closeTask("Closed", "Closed", "This task was automatically closed because the Follow Up status determined Application closed.", "", "HEANIM");
	}
`^
WTUA;AnimalServices!Rabies Exposure!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask =="First Contact" && (wfStatus == "No Animal" || wfStatus == "Phone Consultation")) {
	closeTask("Closed", "Closed", "This task was automatically closed because the First Contact status determined Application closed.", "", "HERABX");
	}

if (wfTask =="Follow-up" && wfStatus == "Letter Sent") {
	closeTask("Closed", "Closed", "This task was automatically closed because the Follow Up status determined Application closed.", "", "HERABX");
	}
`^
WTUA;AnimalServices!Welfare!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask =="Investigation" && wfStatus !="Founded") {
	closeTask("Closed", "Closed", "This task was automatically closed because the Investigation status determined Application closed.", "", "HEWELF");
	}

if (wfStatus == "Issue Resolved") {
	closeTask("Closed", "Closed", "This task was automatically closed because the Follow Up status determined Application closed.", "", "HEWELF");
	}

if (wfTask =="Adjudication" && (wfStatus == "Dismissed" || wfStatus == "Forfeiture")) {
	closeTask("Closed", "Closed", "This task was automatically closed because the Adjudication status determined Application closed.", "", "HEWELF");
	}
`^
WTUA;AnimalServices!Wildlife!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask =="Investigation" && wfStatus !="Founded") {
	closeTask("Closed", "Closed", "This task was automatically closed because the Investigation status determined Application closed.", "", "HEWILD");
	}
`^
WTUA;Dane County!Zoning!Request for Service!Water Determination^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Verification" && wfStatus == "Further Invistigation") {
	scheduleInspectDate("Initial Inspection", nextWorkDay(dateAdd(wfDateMMDDYYYY,30)));
	}

if (wfTask == "Intake" && wfStatus == "Intake") {
	scheduleInspectDate("Initial Inspection", nextWorkDay(dateAdd(wfDateMMDDYYYY,30)));
	}
`^
WTUA;DaneCounty!Complaint!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Verification" && wfStatus == "Further Invistigation") {
	scheduleInspectDate("Initial Inspection", nextWorkDay(dateAdd(wfDateMMDDYYYY,30)));
	}

if (wfTask == "Inspection" && wfStatus == "Violation Found") {
	scheduleInspectDate("Reinspection",nextWorkDay(dateAdd(wfDateMMDDYYYY,30));
	}

if (wfTask == "Adjudication" && wfStatus == "Final Inspection Complete") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}

if (wfTask == "Inspection" && wfStatus == "No Violation") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}

if (wfTask == "Verification" && wfStatus == "Not Valid") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}
`^
WTUA;DaneCounty!Planning!Request for Service!Density Study^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Letter to Applicant" && wfStatus == "Complete") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}
`^
WTUA;DaneCounty!Planning!Request for Service!Determination of Parcel Status^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Letter to Applicant" && wfStatus == "Complete") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}
`^
WTUA;DaneCounty!Planning!Request for Service!Farmland Preservation^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Intake" && wfStatus == "Completed") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}
`^
WTUA;DaneCounty!Zoning!Conditional Use!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "ZLR Decision" && wfStatus == "Denied") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}

if (wfTask == "ZLR Decision" && wfStatus == "No Action") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}

if (wfTask == "Second Town Review" && wfStatus == "Denied") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}

if (wfTask == "Inspection" && wfStatus == "Completed") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}

if (wfTask == "Inspection" && wfStatus == "Not Performed") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}
`^
WTUA;DaneCounty!Zoning!Floodplain Permit!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Letter to Applicant" && wfStatus == "Complete") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}
`^
WTUA;DaneCounty!Zoning!Request for Service!Water Determination^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Letter to Applicant" && wfStatus == "Complete") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}
`^
WTUA;DaneCounty!Zoning!Request for Service!Zoning Status^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Letter to Applicant" && wfStatus == "Final Inspection Complete") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}
`^
WTUA;DaneCounty!Zoning!Rezone!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "County Board" && wfStatus == "Denied") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}

if (wfTask == "County Executive" && wfStatus == "Veto") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}

if (wfTask == "Conditions Verified" && wfStatus == "Compliant") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}

if (wfTask == "Conditions Verified" && wfStatus == "Expired") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}
`^
WTUA;DaneCounty!Zoning!Variance!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Applicant Notified" && wfStatus == "Not Required") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}

if (wfTask == "Applicant Notified" && wfStatus == "Not Required") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}
`^
WTUA;Enforcement!~!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
capClosed = false;
hasExpire = null;
if ((wfStatus == "Business Dissolved" || wfStatus == "Delinquent" || wfStatus == "Inactive")) {
	capClosed = true;
	}

result = aa.expiration.isExpiredLicenses(capId);
hasExpire = result.getErrorMessage();
if (capClosed && hasExpire != null) {
	licEditExpInfo("Inactive", null);
	}

if (capClosed) {
	include("CMN;AssignCapBlank");
	}

if (capClosed) {
	inspCancelAll();
	}
`^
WTUA;Enforcement!Building Inspection!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var cd = null;
var cdMod = null;
var parentCapId = null;
var capAsgnStaff = null;
var isParentLndmrk = false;
var isLandmarkCase = false;
cd = aa.cap.getCapDetail(capId);
parentCapId = getParent();
if (parentCapId != false && parentCapId != null) {
	if(parentCapId.customID.slice(0,6) == "LNDMRK" ) isParentLndmrk = true;
	}

if (cd != null) {
	if(cd.getSuccess()) cdMod = cd.getOutput().getCapDetailModel();
	}

if (cdMod != null) {
	capAsgnStaff = cdMod.getAsgnStaff();
	}

if (isParentLndmrk == true && appMatch("Enforcement!Building Inspection!Housing!General Maintenance Exterior") == true) {
	isLandmarkCase = true;
	}

if ((isLandmarkCase == true || appMatch("Enforcement!Building Inspection!Zoning!Sign") == true) && capAsgnStaff != null && wfTask == "Initial Inspection" && (wfStatus == "Issued" || wfStatus == "Posted No Occupancy")) {
	scheduleInspectDateGroup("CODEBLD","Reinspection",nextWorkDay(AInfo['Due Date']),capAsgnStaff);
	}

if (appMatch("Enforcement!Building Inspection!Zoning!Sign") == false && isLandmarkCase == false && wfTask == "Initial Inspection" && (wfStatus == "Issued" || wfStatus == "Posted No Occupancy")) {
	scheduleInspectDateGroup("CODEBLD","Reinspection",nextWorkDay(AInfo['Due Date']),getLastInspectorMadAlt("Initial Inspection"));
	}

if ((wfTask == "Initial Inspection" && wfStatus == "Issued Abatement")) {
	scheduleInspectDate("Reinspection",nextWorkDay(AInfo['Due Date']),getLastInspectorMadAlt("Initial Inspection"),"AM","Reinspection due to abatement issued");
	}

if ((wfTask == "Initial Inspection" && wfStatus == "Citation Issued")) {
	scheduleInspectDate("Reinspection",nextWorkDay(AInfo['Due Date']),getLastInspectorMadAlt("Initial Inspection"),"AM","Reinspection due to a Initial Inspection Citation Issued");
	}

if (wfTask == "Reinspection" && (wfStatus == "Reinspection" || wfStatus == "Extension Mailed" || wfStatus == "Posted No Occupancy" || wfStatus == "Ongoing Enforcement Processed")) {
	scheduleInspectDateGroup("CODEBLD","Reinspection",nextWorkDay(AInfo['Reinspection Due Date']),getLastInspectorMadAlt("Reinspection"));
	}

if ((wfTask == "Reinspection" && wfStatus == "Citation Issued")) {
	scheduleInspectDate("Reinspection",nextWorkDay(AInfo['Reinspection Due Date']),getLastInspectorMadAlt("Reinspection"),"AM","Reinspection due to a Citation Issued");
	}

if (wfStatus == "Close New Case") {
	childId = createChild("Enforcement","Building Inspection",cmnSubType,cmnCategory,capName);
	copyContacts(capId,childId);
	copyParcels(capId,childId);
	updateAppStatus("Open","Updated via script",childId);
	holdId = capId;
	holdinspector = getLastInspectorMadAlt("Initial Inspection");
	capId = childId;
	scheduleInspectDate("Initial Inspection",nextWorkDay(null),holdinspector ,"AM","Initial Inspection Due to new case");
	copyParcelGisObjects();
	capId = holdId;
	}

if ((wfTask == "Initial Inspection" && wfStatus == "Issued Non-Summary Abate")) {
	scheduleInspectDate("Reinspection",nextWorkDay(AInfo['Due Date']),getLastInspectorMadAlt("Initial Inspection"),"AM","Reinspection due to a Issued Non-Summary Abate");
	}

if ((wfTask == "Initial Inspection" && wfStatus == "Issued Summary Abate")) {
	scheduleInspectDate("Reinspection",nextWorkDay(AInfo['Due Date']),getLastInspectorMadAlt("Initial Inspection"),"AM","Reinspection due to Issued Summary Abate");
	}

if ((wfTask == "Court" && wfStatus == "Trial Scheduled")) {
	scheduleInspectDate("CA Reinspection",nextWorkDay(dateAdd(AInfo['Trial Date'], -8)),getLastInspectorMadAlt("Reinspection"),"AM","CA Reinspection due to Court Trial Scheduled");
	}

if ((wfTask == "Court" && wfStatus == "High Low")) {
	scheduleInspectDate("CA Reinspection",nextWorkDay(dateAdd(AInfo['High Low Date'], 0)),getLastInspectorMadAlt("Reinspection"),"AM","CA Reinspection due to Court High Low");
	}
`^
WTUA;Enforcement!Fire!Prevention!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
cd = aa.cap.getCapDetail(capId).getOutput().getCapDetailModel();
capAsgnStaff = cd.getAsgnStaff();
capAsgnDept = cd.getAsgnDept();
if (wfStatus == "Inspection Required") {
	scheduleInspectDate(AInfo['APPLICATION INFORMATION.Type of Code Enforcement Case'],dateAdd(null,0),capAsgnStaff,"AM","Scheduled for Immediate Inspection");
	}

if (wfStatus == "10-Day Notice" || wfStatus == "Citation Issued") {
	scheduleInspectDate("Reinspection",dateAdd(null,15),capAsgnStaff,"AM","Scheduled for 15 day Re-Inspection");
	aa.set.add("FP10DAY",capId);
	}

if (wfStatus == "Re-Issue Orders") {
	scheduleInspectDate("Reinspection",nextWorkDay(dateAdd(null,30)),capAsgnStaff,"AM","Written Orders - Scheduled for 30 day Re-Inspection");
	aa.set.add("FPWRITTEN",capId);
	}

if (wfStatus == "Reinspection Required") {
	scheduleInspectDate("Reinspection",dateAdd(null,0),capAsgnStaff,"AM","Scheduled for Immediate Inspection");
	}

if (wfStatus == "Closed") {
	include("CMN;AssignCapBlank");
	}
`^
WTUA;Enforcement!Health!Complaint!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
contactEmail = "";
if (wfTask == "Intake" && wfStatus == "No Violation") {
	closeTask("Closed", "Closed", "Closed by WTUA script");
	}

if (wfTask == "Closed" && wfStatus == "Reinstate to Investigation") {
	activateTask("Investigation");
	}

if (wfTask == "Intake" && wfStatus == "Pending Investigation") {
	include("EML;Enforcement!Health!Complaint!~;NotifySanitarian");
	}

if (isTaskStatus("Closed", "Closed")) {
	include("CMN;AssignCapBlank");
	}
`^
WTUA;Enforcement!Traffic Engineering!Street Occupancy!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (wfStatus == "Reinspection") {
	scheduleInspection("Reinspection", 7, capDetail.getAsgnStaff(), null, workDescGet(capId));
	}
`^
WTUA;Land!~!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
workflowGroups = null;
childTasks = null;
pDueDate = null;
typeReviewVerif = "None";
callType = "WTUA";
cDueDate = "";
if (wfTask == "LM Agency Verification") {
	typeReviewVerif = "Verification";
	}

if (wfTask == "LM Agency Review") {
	typeReviewVerif = "Review";
	}

if (wfTask == "LM Agency Verification" || wfTask == "LM Agency Review") {
	jsDueDate = new Date(getTaskDueDate(wfTask, wfProcess));
	pDueDate = (jsDueDate.getMonth() + 1) + "!" + jsDueDate.getDate() + "!" + jsDueDate.getFullYear();
	}

if (wfTask == "LM Agency Verification" || wfTask == "LM Agency Review") {
	workflowGroups =  aa.workflow.getProcessRelationByCapID(capId, null).getOutput();
	}

if (workflowGroups != null && wfStatus == "Ready to Review") {
	for (wfg in workflowGroups) include("CMN;SendLandNotificationsAndSetDueDate");
	}

if (wfProcess == "LMAGENCYSIGN" && wfTask == "Signing and Marking" && wfStatus == "Assigned") {
	include("EML;Land!~!~!~;SigningMarkingAssigned");
	}

if (wfProcess == "LMAGENCYSIGN" && wfTask == "Electrical Review" && wfStatus == "Assigned") {
	include("EML;Land!~!~!~;ElectricalAssigned");
	}

if (wfTask == "Traffic Engineering Review" && wfStatus == "Completed" && isTaskActive("Signing and Marking",  "LMAGENCYSIGN")) {
	closeTask("Signing and Marking","Complete","Complete","Closed by Traffic Engineering Review completed.", "LMAGENCYSIGN");
	}

if (wfTask == "Traffic Engineering Review" && wfStatus == "Completed" && isTaskActive("Electrical Review",  "LMAGENCYSIGN")) {
	closeTask("Electrical Review","Complete","Complete","Closed by Traffic Engineering Review completed.", "LMAGENCYSIGN");
	}

if (wfTask == "LM Agency Review" && wfStatus == "Reset and Notify Reviewers") {
	dtDueDate = pDueDate;
	include("CMN;Land;AgencyReviews;ResetNotifyReviewers");
	}
`^
WTUA;Land!Appeal Ord Interpretation!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Zoning Board Hearing" && wfStatus == "Ruling in Favor of Applicant" || wfStatus == "Ruling in Favor of Staff") {
	editAppSpecific("OFFICE USE ONLY.Meeting Date - Zoning Board of Appeals",AInfo['Date of Meeting']);
	}
`^
WTUA;Land!Area Exception!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Zoning Board Hearing" && wfStatus == "Approved") {
	editAppSpecific("OFFICE USE ONLY.Meeting Date - Zoning Board of Appeals",AInfo['Date of Meeting']);
	}
`^
WTUA;Land!Engineering!SICDA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "BPW CC Review" && wfStatus == "Approved" editAppSpecific("ROUTING EXECUTION.Date CC Resolution Approved",AInfo['Date CC Resolution Approved']); editAppSpecific("ROUTING EXECUTION.CC Resolution Number",AInfo['CC Resolution Number']); editAppSpecific("ROUTING EXECUTION.CC Resolution ID",AInfo['CC Resolution ID");) {
	}
`^
WTUA;Land!Land Use!Cond Use Demo!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Zoning Board Hearing" && wfStatus == "Approved" || wfStatus == "Rejected") {
	editAppSpecific("OFFICE USE ONLY.Meeting Date - Plan Commission",AInfo['Plan Commission Date']);
	}
`^
WTUA;Land!Land Use!Conditional Use!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Zoning Board Hearing" && wfStatus == "Approved" || wfStatus == "Rejected") {
	editAppSpecific("OFFICE USE ONLY.Meeting Date - Plan Commission",AInfo['Plan Commission Date']);
	}
`^
WTUA;Land!Land Use!Demolition!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "LM Agency Verification" && wfStatus == "Ready to Review") {
	}
`^
WTUA;Land!Land Use!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
mapping = false;
wfRev = getAppSpecific("PROJECT INFORMATION.Revision Number");
sCurentTask = "";
sEmailTo = "";
if ((isTaskComplete("Engineering Mapping", "LMAGENCYVER") || isTaskComplete("City Eng. Review Mapping", "LMAGENCYVER"))) {
	mapping = true;
	}

if (wfTask == "LM Agency Verification" && wfStatus == "Reject!Redraft") {
	editAppSpecific("PROJECT INFORMATION.Revision Number", 1 + parseInt(getAppSpecific("PROJECT INFORMATION.Revision Number")));
	}

if (wfTask == "Issuance" && wfStatus == "Issued") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}

if (wfTask == "Plan Resubmittal" && wfStatus == "Plans Accepted") {
	include("CMN;LMAgencyVer;Rev");
	include("EML;LAND!~!~!~;IntakeApplicant");
	}

if (wfTask == "LM Agency Verification" && wfStatus == "Approved") {
	include("EML;LAND!~!~!~;AgencyApproval");
	}

if (mapping && wfTask == "Issuance" && wfStatus == "Issued") {
	include("EML;LandAgencyApprovedNotify");
	}

if (wfTask == "Intake" && wfStatus == "Application Accepted") {
	assignCap("PLJCW");
	include("EML;Land!Land Use!NA!NA;IntakeAccepted");
	include("CMN;Land!Land Use!NA!NA;DeactivateSubTasks");
	}

if (wfTask == "Intake" && wfStatus == "Application Accepted" && AInfo['PROJECT INFORMATION.Plan Commission'] != "") {
	dtDueDate=dateAdd(AInfo['PROJECT INFORMATION.Plan Commission'],0);
	include("CMN;LAND;SetLMAgencyReviewDueDate");
	}

if (AInfo['PROJECT INFORMATION.Urban Design Commission'] != null && isTaskActive("UDC Recommendation")) {
	editTaskDueDate("UDC Recommendation",AInfo['PROJECT INFORMATION.Urban Design Commission']);
	}

if (AInfo['PROJECT INFORMATION.Plan Commission'] != null && isTaskActive("Plan Commission Hearing")) {
	editTaskDueDate("Plan Commission Hearing",AInfo['PROJECT INFORMATION.Plan Commission']);
	}

if (AInfo['PROJECT INFORMATION.Common Council'] != null && isTaskActive("Common Council Hearing")) {
	editTaskDueDate("Common Council Hearing",AInfo['PROJECT INFORMATION.Common Council']);
	}

if (wfProcess = "LMENGRVWMAINOFFCE" && wfTask == "Environmental Review" && wfStatus == "Completed") {
	setTask("Engineering Final Review", "N", "N", "LMENGRVWMAINOFFCE");
	}

if (wfProcess = "LMENGRVWMAINOFFCE" && wfTask == "Sewer - Sanitary Review" && wfStatus == "Completed" && isTaskComplete("Sewer - Sanitary Review", "LMENGRVWMAINOFFCE")) {
	sCurentTask = "Sewer - Storm Review";
	sEmailTo = "cehagen@cityofmadison.com";
	include("EML;Land!Land Use!NA!NA;EngReviewMainOfficeNotify");
	}

if (wfProcess = "LMENGRVWMAINOFFCE" && wfTask == "Sewer - Storm Review" && wfStatus == "Completed") {
	sCurentTask = "Street Review";
	sEmailTo = "elamsupport@cityofmadison.com";
	include("EML;Land!Land Use!NA!NA;EngReviewMainOfficeNotify");
	}

if (wfProcess = "LMENGRVWMAINOFFCE" && wfTask == "Street Review" && wfStatus == "Completed") {
	setTask("Engineering Final Review", "N", "N", "LMENGRVWMAINOFFCE");
	}

if (wfProcess = "LMENGRVWMAINOFFCE" && (wfTask == "Environmental Review" || wfTask == "Street Review") && wfStatus == "Completed" && isTaskComplete("Environmental Review", "LMENGRVWMAINOFFCE") && isTaskComplete("Street Review", "LMENGRVWMAINOFFCE")) {
	setTask("Engineering Final Review", "Y", "N", "LMENGRVWMAINOFFCE");
	sCurentTask = "Engineering Final Review";
	sEmailTo = "elamsupport@cityofmadison.com";
	include("EML;Land!Land Use!NA!NA;EngReviewMainOfficeNotify");
	}

if (wfProcess = "LMENGRVWMAINOFFCE" && wfTask == "Engineering Final Review" && wfStatus == "Completed") {
	closeTask("Engineering Review Main Office", "Completed", "Closed by script", "", "LMAGENCY");
	}
`^
WTUA;Land!Land Use!Parking Stall Reduction!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Letter to Applicant" && wfStatus == "Sent") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}
`^
WTUA;Land!Landmark!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
userId = "BIAFV";
objTSI = null;
aryTSI = null;
if (wfTask == "Certificate of Appropriateness") {
	objTSI = aa.taskSpecificInfo.getTaskSpecifiInfoByDesc(capId, wfProcessID, wfStep, "Estimated Completion Date");
	}

if (objTSI != null) {
	if(objTSI.getSuccess()) aryTSI = objTSI.getOutput();
	}

if (wfTask == "Certificate of Appropriateness" && (wfStatus == "Issued" || wfStatus == "Issued with Conditions")) {
	assignCap(userId);
	scheduleInspectDateGroup("LNDMRKINSP", "Landmark Inspection", aryTSI.checklistComment, userId);
	include("EML;Land!Landmark!NA!NA;NotifyBuildInspector");
	}

if (wfTask == "Public Notification" && wfStatus == "Ready for Publishing & Mailing") {
	assignTask("Public Notification","PLRAE");
	}

if (currentUserID == "ITJBS") {
	showDebug = true;
	}
`^
WTUA;Land!Minor Alteration!Conditional Use!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
mapping = false;
wfRev = getAppSpecific("ALTERATION INFORMATION.Revision Number");
if ((isTaskComplete("Engineering Mapping", "LMAGENCYVER") || isTaskComplete("City Eng. Review Mapping", "LMAGENCYVER"))) {
	mapping = true;
	}

if (wfTask == "LM Agency Verification" && wfStatus == "Rejected") {
	editAppSpecific("ALTERATION INFORMATION.Revision Number", 1 + parseInt(getAppSpecific("ALTERATION INFORMATION.Revision Number")));
	}

if (wfTask == "Issuance" && wfStatus == "Issued") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}

if (wfTask == "Intake" && wfStatus == "Application Accepted") {
	include("CMN;LMAgencyVer;Rev");
	include("EML;LAND!~!~!~;IntakeApplicant");
	}

if (wfTask == "Plan Director Review" && wfStatus == "Administrative Approval") {
	include("EML;LAND!~!~!~;AgencyApproval");
	}

if (wfTask == "LM Agency Verification" && (wfStatus == "Completed" || wfStatus == "Not Required")) {
	include("EML;LAND!~!~!~;PlanDirectorReview");
	}

if (mapping && wfTask == "Plan Director Review" && wfStatus == "Administrative Approval") {
	include("EML;LandAgencyApprovedNotify");
	}
`^
WTUA;Land!Minor Alteration!PUDSIP!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
mapping = false;
wfRev = getAppSpecific("ALTERATION INFORMATION.Revision Number");
if ((isTaskComplete("Engineering Mapping", "LMAGENCYVER") || isTaskComplete("City Eng. Review Mapping", "LMAGENCYVER"))) {
	mapping = true;
	}

if (wfTask == "LM Agency Verification" && wfStatus == "Rejected") {
	editAppSpecific("ALTERATION INFORMATION.Revision Number", 1 + parseInt(getAppSpecific("ALTERATION INFORMATION.Revision Number")));
	}

if (wfTask == "Issuance" && wfStatus == "Issued") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}

if (wfTask == "Intake" && wfStatus == "Application Accepted") {
	include("CMN;LMAgencyVer;Rev");
	include("EML;LAND!~!~!~;IntakeApplicant");
	}

if (wfTask == "Plan Director Review" && wfStatus == "Administrative Approval") {
	include("EML;LAND!~!~!~;PlanDirectorApproval");
	}

if (wfTask == "LM Agency Verification" && (wfStatus == "Completed" || wfStatus == "Not Required")) {
	include("EML;LAND!~!~!~;PlanDirectorReview");
	}

if (mapping && wfTask == "Plan Director Review" && wfStatus == "Administrative Approval") {
	include("EML;LandAgencyApprovedNotify");
	}
`^
WTUA;Land!Permitted Use!Site Plan Review!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
mapping = false;
bCloseByScript = false;
var aryTasks = null;
var bCloseByScript = false;
wfRev = getAppSpecific("PROJECT INFORMATION.Revision Number");
if ((isTaskComplete("Engineering Mapping", "LMAGENCYVER") || isTaskComplete("City Eng. Review Mapping", "LMAGENCYVER"))) {
	mapping = true;
	}

if (wfTask == "LM Agency Verification" && wfStatus == "Reject!Redraft") {
	editAppSpecific("PROJECT INFORMATION.Revision Number", 1 + parseInt(getAppSpecific("PROJECT INFORMATION.Revision Number")));
	}

if (wfTask == "Issuance" && wfStatus == "Issued") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}

if (wfTask == "Intake" && wfStatus == "Submitted") {
	include("CMN;LMAgencyVer;Rev");
	include("EML;LAND!~!~!~;IntakeApplicant");
	}

if (wfTask == "LM Agency Verification" && wfStatus == "Approved") {
	include("EML;LAND!~!~!~;AgencyApproval");
	}

if (mapping && wfTask == "Issuance" && wfStatus == "Issued") {
	include("EML;LandAgencyApprovedNotify");
	}

if (wfTask == "LM Agency Verification" && wfStatus == "Closed") {
	aryTasks = aa.workflow.getTasks(capId).getOutput();
	bCloseByScript = true;
	}

if (bCloseByScript && aryTasks != null) {
	for(idx in aryTasks) if(aryTasks[idx].processCode == "LMAGENCYVER") setTask(aryTasks[idx].taskDescription,"N",aryTasks[idx].completeFlag,"LMAGENCYVER");
	}

if (bCloseByScript) {
	setTask("LM Agency Verification","N","Y","LMSTPLNAPP");
	closeTask("Closed","Closed","Closed by script");
	updateAppStatus("Closed","App Status updated by script");
	}
`^
WTUA;Land!Subdivision!Certified Survey Map!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = true;
if (wfTask == "Common Council" && wfStatus == "Completed") {
	editAppSpecific("OFFICE USE ONLY.Meeting Date - Common Council",AInfo['Common Council Date']);
	}

if (wfTask == "Closed") {
	var capParcelResult = aa.parcel.getParcelandAttribute(capId,null);
	}

if (wfTask == "Closed" && capParcelResult.getSuccess()) {
	var Parcels = capParcelResult.getOutput().toArray();
	}

if (wfTask == "Closed" && (Parcels.length > 0)) {
	for (eachrow in Parcels) parcelNum = Parcels[eachrow].getParcelNumber();
	include("CMN;Land!Subdivision!Certified Survey Map!NA;RemoveParcelCondition");
	}
`^
WTUA;Land!Subdivision!Subdivision Plat!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Common Council Resolution" && wfStatus == "Completed") {
	editAppSpecific("OFFICE USE ONLY.Meeting Date - Common Council",AInfo['Common Council Date']);
	}
`^
WTUA;Licenses!~!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
capClosed = false;
hasExpire = null;
if (appMatch("Licenses!Engineering!Prequalified Contractor!~") == false && appMatch("Licenses!Vending!~!~") == false && appMatch("Licenses!Clerk!Operator!~") == false && (wfTask == "License Issuance" && wfStatus == "Issued")) {
	include("CMN;LICENSE;ExpJune30");
	if(appMatch("Licenses!Health!DischofNonStrmwtr!Madison")) aa.set.add("CL LIC DAILY",capId);
	}

if (appMatch("Licenses!Engineering!Prequalified Contractor!~") == false && appMatch("Licenses!Vending!~!~") == false && appMatch("Licenses!Clerk!Operator!~") == false && (wfTask == "License Status" && wfStatus == "Active")) {
	include("CMN;LICENSE;ExpJune30");
	}

if (appMatch("Licenses!Building Inspection!~!~") && wfTask == "License Status" && wfStatus == "Inactive") {
	include("CMN;LICENSE;ExpJune30");
	}

include("CEA;Licenses!~!~!~");
if ((wfStatus == "Business Dissolved" || wfStatus == "Delinquent" || wfStatus == "Inactive")) {
	capClosed = true;
	}

result = aa.expiration.isExpiredLicenses(capId);
hasExpire = result.getErrorMessage();
if (capClosed && hasExpire != null) {
	licEditExpInfo("Inactive", null);
	}

if (capClosed) {
	include("CMN;AssignCapBlank");
	}

if (capClosed) {
	inspCancelAll();
	}
`^
WTUA;Licenses!Building Inspection!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (wfTask.equals("License Issuance") && wfStatus.equals("Issued")) {
	include("CMN;Licenses!Building Inspection!~;UpdateRefProfessional");
	}

if (wfTask.equals("License Status") && (wfStatus.equals("Active") || wfStatus.equals("Inactive"))) {
	include("CMN;Licenses!Building Inspection!~;UpdateRefProfessional");
	}

if ((wfStatus == "Active" ||wfStatus == "Business Dissolved" || wfStatus == "Inactive" || wfStatus == "Expired")) {
	lp = getRefLicenseProf(capIDString);
	}

if ((wfStatus == "Business Dissolved" || wfStatus == "Inactive" || wfStatus == "Expired")) {
	logDebug("Setting audit status " );
	lp.setAuditStatus("I");
	lp.setAuditDate(sysDate);
	lp.setAuditID(currentUserID);
	aa.licenseScript.editRefLicenseProf(lp);
	}

if ((wfStatus == "Active")) {
	logDebug("Setting audit status " );
	lp.setAuditStatus("A");
	lp.setAuditDate(sysDate);
	lp.setAuditID(currentUserID);
	aa.licenseScript.editRefLicenseProf(lp);
	}
`^
WTUA;Licenses!Civil Rights!AA Plan!CBO^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var prequalCapId = getParent();
if ((startDate.getMonth() == 10 || startDate.getMonth() == 11)) {
	newYear = startDate.getFullYear() + 3;
	expDate = "03!01!" + newYear;
	} else {
	newYear = startDate.getFullYear() + 2;
	expDate = "03!01!" + newYear;
	}

if (wfTask == "AA Plan Review" && wfStatus == "Approved") {
	updateTask("AA Plan Status", "Active", "Updated by WTUA script");
	}

if (wfTask == "AA Plan Review" && wfStatus == "Approved") {
	licEditExpInfo("Active", expDate);
	}

if (wfTask == "AA Plan Review" && wfStatus == "Approved") {
	include("CMN;Licenses!Civil Rights!AA Plan!CBO;CreateCBOLPCard");
	}

if (wfStatus == "Disapproved!Add'l Info Req'd") {
	editTaskDueDate(wfTask, dateAdd(null,14));
	}

if (wfStatus == "Disapproved!Add'l Info Req'd") {
	include("EML;Licenses!DCR!AA Plan!NA;AdditionalInfo");
	}

if (wfTask == "AA Plan Review" && wfStatus == "Denied") {
	activateTask("AA Plan Status");
	}

if (wfTask == "AA Plan Review" && wfStatus == "Denied") {
	closeTask("Closed", "Closed", "Closed", "Closed");
	}

if (wfTask == "AA Plan Review" && wfStatus == "Denied") {
	licEditExpInfo("Inactive", null);
	}

if (wfTask =="AA Plan Status" && wfStatus == "Ready to Renew") {
	licEditExpInfo("About to Expire", null);
	}

if (wfTask =="AA Plan Status" && wfStatus == "Reinstate") {
	licEditExpInfo("About to Expire", null);
	}

if (wfTask =="AA Plan Status" && wfStatus == "Inactive") {
	licEditExpInfo("Inactive", null);
	}

if (wfTask =="AA Plan Status" && wfStatus == "Expired") {
	licEditExpInfo("Expired", null);
	}

if (wfTask =="AA Plan Status" && wfStatus == "Active") {
	licEditExpInfo("Active", expDate);
	}

if (wfTask =="AA Plan Status" && wfStatus == "Ready to Renew") {
	aa.workflow.deleteAndAssignWorkflow(capId, "AA PLAN", true);
	}

if (wfTask =="AA Plan Status" && wfStatus == "Reinstate") {
	aa.workflow.deleteAndAssignWorkflow(capId, "AA PLAN", true);
	}
`^
WTUA;Licenses!Civil Rights!AA Plan!Developer^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (wfTask == "AA Dev Review" && wfStatus == "Approved") {
	include("EML;Licenses!DCR!AA Plan!NA;PlanReviewDeveloper");
	}

if ((startDate.getMonth() == 10 || startDate.getMonth() == 11)) {
	newYear = startDate.getFullYear() + 3;
	expDate = "03!01!" + newYear;
	} else {
	newYear = startDate.getFullYear() + 2;
	expDate = "03!01!" + newYear;
	}

if (wfTask == "AA Dev Status" && wfStatus == "Active") {
	licEditExpInfo("Active", expDate);
	updateAppStatus("Active", "Set by workflow", capId);
	}
`^
WTUA;Licenses!Civil Rights!AA Plan!Exempt Under $25,000^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = true;
if (wfTask == "AA Exemption Review" && wfStatus == "Approved") {
	include("EML;Licenses!DCR!AA Plan!NA;PlanReviewExempt25K");
	}

if ((startDate.getMonth() == 10 || startDate.getMonth() == 11)) {
	newYear = startDate.getFullYear() + 3;
	expDate = "03!01!" + newYear;
	} else {
	newYear = startDate.getFullYear() + 2;
	expDate = "03!01!" + newYear;
	}

if (wfTask == "AA Exemption Status" && wfStatus == "Active") {
	licEditExpInfo("Active", expDate);
	updateAppStatus("Active", "Set by workflow", capId);
	}
`^
WTUA;Licenses!Civil Rights!AA Plan!Public Works^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug =false;
showMessage = true;
projSuccess = false;
projType = "";
if ((startDate.getMonth() == 10 || startDate.getMonth() == 11)) {
	newYear = startDate.getFullYear() + 3;
	ApproveExpDate = "03!01!" + newYear;
	} else {
	newYear = startDate.getFullYear() + 2;
	ApproveExpDate = "03!01!" + newYear;
	}

if (wfTask == "AA Plan Review" && wfStatus == "Approved") {
	updateTask("AA Plan Status","Active","Updated by WTUA script");
	}

if (wfTask == "AA Plan Review" && wfStatus == "Approved") {
	licEditExpInfo("Active", ApproveExpDate);
	}

if (wfTask == "AA Plan Review" && wfStatus == "Approved") {
	updateTask("AA Plan Status","Active","Updated by WTUA script");
	licEditExpInfo("Active", ApproveExpDate);
	editAppSpecific("GENERAL INFO.Expiration Date", ApproveExpDate);
	editTaskDueDate("AA Plan Status", ApproveExpDate);
	}

if (wfTask == "AA Plan Review" && wfStatus == "Approved") {
	include("EML;Licenses!DCR!AA Plan!NA;PlanOrDataUpdateApproval");
	}

if (wfTask == "AA Plan Review" && wfStatus == "Approved") {
	editTaskDueDate("AA Plan Status", ApproveExpDate);
	}

if (wfStatus == "Disapproved!Add'l Info Req'd") {
	editTaskDueDate(wfTask, dateAdd(null,14));
	}

if (wfStatus == "Disapproved!Add'l Info Req'd") {
	include("EML;Licenses!DCR!AA Plan!NA;AdditionalInfo");
	}
`^
WTUA;Licenses!Civil Rights!AA Plan!Vendors and Suppliers^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var prequalCapId = getParent();
if ((startDate.getMonth() == 10 || startDate.getMonth() == 11)) {
	newYear = startDate.getFullYear() + 3;
	expDate = "03!01!" + newYear;
	} else {
	newYear = startDate.getFullYear() + 2;
	expDate = "03!01!" + newYear;
	}

if (wfTask == "AA Plan Review" && wfStatus == "Approved") {
	updateTask("AA Plan Status", "Active", "Updated by WTUA script");
	}

if (wfTask == "AA Plan Review" && wfStatus == "Approved") {
	licEditExpInfo("Active", expDate);
	}

if (wfStatus == "Disapproved!Add'l Info Req'd") {
	editTaskDueDate(wfTask, dateAdd(null,14));
	}

if (wfStatus == "Disapproved!Add'l Info Req'd") {
	include("EML;Licenses!DCR!AA Plan!NA;AdditionalInfo");
	}

if (wfTask == "AA Plan Review" && wfStatus == "Denied") {
	activateTask("AA Plan Status");
	}

if (wfTask == "AA Plan Review" && wfStatus == "Denied") {
	closeTask("Closed", "Closed", "Closed", "Closed");
	}

if (wfTask == "AA Plan Review" && wfStatus == "Denied") {
	licEditExpInfo("Inactive", null);
	}

if (wfTask =="AA Plan Status" && wfStatus == "Ready to Renew") {
	licEditExpInfo("About to Expire", null);
	}

if (wfTask =="AA Plan Status" && wfStatus == "Reinstate") {
	licEditExpInfo("About to Expire", null);
	}

if (wfTask =="AA Plan Status" && wfStatus == "Inactive") {
	licEditExpInfo("Inactive", null);
	}

if (wfTask =="AA Plan Status" && wfStatus == "Expired") {
	licEditExpInfo("Expired", null);
	}

if (wfTask =="AA Plan Status" && wfStatus == "Active") {
	licEditExpInfo("Active", expDate);
	}

if (wfTask =="AA Plan Status" && wfStatus == "Ready to Renew") {
	aa.workflow.deleteAndAssignWorkflow(capId, "AA PLAN", true);
	}

if (wfTask =="AA Plan Status" && wfStatus == "Reinstate") {
	aa.workflow.deleteAndAssignWorkflow(capId, "AA PLAN", true);
	}
`^
WTUA;Licenses!Clerk!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
bLicenseIssued = false;
if (wfTask == "Common Council Hearing" && wfStatus == "Granted" && cmnSubType == "ClassABeerLiquor") {
	include("EML;HEIntake");
	}

if (wfTask == "Common Council Hearing" && wfStatus == "Granted" && cmnSubType == "ClassBBeerLiquor") {
	include("EML;HEIntake");
	}

if (wfTask == "Common Council Hearing" && wfStatus == "Granted" && cmnSubType == "TransLocLiquorBeerLicense") {
	include("EML;HEIntake");
	}

if (isTaskActive("License Issuance") && cmnSubType != "ClassABeerLiquor" && cmnSubType != "ClassBBeerLiquor") {
	include("CMN;LicenseIssuanceProcess");
	}

if (bLicenseIssued && appMatch("Licenses!Clerk!Operator!NA")) {
	include("CMN;Licenses!Clerk!Operator!NA;LicenseIssueActions");
	}

if (bLicenseIssued && cmnSubType != "Operator") {
	include("CMN;LICENSE;ExpJune30");
	}

if (isTaskActive("Building Inspection") && isTaskStatus("Building Inspection","Completed") && (cmnSubType == "ClassABeerLiquor" || cmnSubType == "ClassBBeerLiquor")) {
	setTask("Building Inspection","N","Y");
	}

if (isTaskActive("Fire Inspection") && isTaskStatus("Fire Inspection","Completed") && (cmnSubType == "ClassABeerLiquor" || cmnSubType == "ClassBBeerLiquor")) {
	setTask("Fire Inspection","N","Y");
	}

if (isTaskActive("Health Review") && isTaskStatus("Health Review","Complete") && (cmnSubType == "ClassABeerLiquor" || cmnSubType == "ClassBBeerLiquor")) {
	setTask("Health Review","N","Y");
	}

if (bLicenseIssued && cmnSubType == "SecondHandDealer") {
	include("EML;Licenses!Clerk!SecondHandDealer!~;Issuance");
	}
`^
WTUA;Licenses!Clerk!ClassABeerLiquor!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Legistar" && wfStatus == "Received") {
	include("EML;FoodDrink;Land;Zoning");
	}

if (wfTask == "License Issuance" && wfStatus == "Issued") {
	include("EML;Licenses!Clerk!ClassABeerLiquor!~;Issued");
	}

procComp = closeSubWorkflow(wfProcessID, "Complete", capId);
if (wfTask == "Legistar" && wfStatus == "Received") {
	include("EML;Licenses!Clerk!ClassABeerLiquor!~;BackgroundCheckNeeded");
	}

if (wfTask == "District Captain Review" && wfStatus == "Complete") {
	include("EML;Licenses!Clerk!ClassABeerLiquor!~;CaptainReviewComp");
	}

if (wfTask == "District Captain Review" && wfStatus == "Rec. Rejection") {
	include("EML;Licenses!Clerk!ClassABeerLiquor!~;CaptainReviewComp");
	}

if (wfTask == "Background Check" && wfStatus == "ALRC Captain Consultation") {
	include("EML;Licenses!Clerk!ClassABeerLiquor!~;BackgroundCheckComp");
	}
`^
WTUA;Licenses!Clerk!ClassBBeerLiquor!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Legistar" && wfStatus == "Received") {
	include("EML;FoodDrink;Land;Zoning");
	}

if (wfTask == "License Issuance" && wfStatus == "Issued") {
	include("EML;Licenses!Clerk!ClassBBeerLiquor!~;Issued");
	}

procComp = closeSubWorkflow(wfProcessID, "Complete", capId);
if (wfTask == "Legistar" && wfStatus == "Received") {
	include("EML;Licenses!Clerk!ClassBBeerLiquor!~;BackgroundCheckNeeded");
	}

if (wfTask == "District Captain Review" && wfStatus == "Complete") {
	include("EML;Licenses!Clerk!ClassbBeerLiquor!~;CaptainReviewComp");
	}

if (wfTask == "District Captain Review" && wfStatus == "Rec. Rejection") {
	include("EML;Licenses!Clerk!ClassbBeerLiquor!~;CaptainReviewComp");
	}

if (wfTask == "Background Check" && wfStatus == "ALRC Captain Consultation") {
	include("EML;Licenses!Clerk!ClassBBeerLiquor!~;BackgroundCheckcomp");
	}
`^
WTUA;Licenses!Clerk!MallSecondHandDealer!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var sWFStatus = "";
procComp = closeSubWorkflow(wfProcessID, "Approved", capId);
if (wfTask == "Legistar" && wfStatus == "Entered") {
	include("EML;Licenses!Clerk!MallSecondHandDealer!NA;BackgroundCheckNeeded");
	}

if (wfTask == "District Captain Review" && wfStatus == "Complete") {
	include("EML;Licenses!Clerk!MallSecondHandDealer!NA;CaptainReviewComplete");
	}

if (wfTask == "District Captain Review" && wfStatus == "Rec. Rejection") {
	include("EML;Licenses!Clerk!MallSecondHandDealer!NA;CaptainReviewComplete");
	}

if (wfTask == "Background Check" && wfStatus == "Captain Consultation") {
	include("EML;Licenses!Clerk!MallSecondHandDealer!NA;BackgroundCheckComp");
	}
`^
WTUA;Licenses!Clerk!Operator!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
bALRCemailSent = false;
bPoliceInfoRequestEmailSent = false;
if (wfTask == "Intake" && wfStatus == "Completed") {
	include("EML;Licenses!Clerk!Operator!NA;PoliceBackgroundCheck");
	}

if (wfTask == "Police Review" && (wfStatus == "Court Fees Past Due" || wfStatus == "Pending Criminal Case" || wfStatus == "Submit to Council" || wfStatus == "Submit to ALRC")) {
	include("EML;Licenses!Clerk!Operator!NA;EmailTemplate");
	}

if (bALRCemailSent == true) {
	updateTask("ALRC Review", "ALRC Invitation Sent", "Updated by WTUA Operator process", "");
	editTaskDueDate("ALRC Review", dateAdd(null,30));
	}

if (wfTask == "ALRC Review" && wfStatus == "ALRC Invitation Sent") {
	editTaskDueDate("ALRC Review", dateAdd(null,30));
	}

if (wfTask == "Police Review" && wfStatus == "Additional Info Required") {
	editTaskDueDate("Police Review", dateAdd(null,7));
	include("EML;Licenses!Clerk!Operator!NA;PoliceAdditionalInfo");
	}

if (wfTask == "Police Review" && wfStatus == "Clerk Contact") {
	updateTaskDepartment(wfTask,"MADISON!LIC!CTYCLERK!CLERK!NA!NA!NA");
	include("EML;Licenses!Clerk!Operator!NA;PoliceAdditionalInfo");
	}

if (bPoliceInfoRequestEmailSent == true) {
	updateTask(wfTask, "Add'l Info Request Sent", "Updated by WTUA Operator process", "");
	editTaskDueDate(wfTask, dateAdd(null,30));
	}

if (wfTask == "Police Review" && wfStatus == "Add'l Info Request Sent") {
	editTaskDueDate("Police Review", dateAdd(null,30));
	}

if (wfTask == "Police Review" && wfStatus == "Captain's Review") {
	updateTaskDepartment(wfTask,"MADISON!LIC!CTYCLERK!CLERK!NA!NA!NA");
	include("EML;Licenses!Clerk!Operator!NA;EmailTemplate");
	}

if (wfTask == "ALRC Review" && wfStatus == "ALRC Appearance Scheduled") {
	include("EML;Licenses!Clerk!Operator!NA;ALRCScheduled");
	}

if (wfTask == "Common Council Hearing" && wfStatus == "Denied") {
	include("EML;Licenses!Clerk!Operator!NA;OperatorDenied");
	}

if (wfTask == "Common Council Hearing" && wfStatus == "Approved") {
	include("CMN;Licenses!Clerk!Operator!NA;LicenseIssueActions");
	}

if (wfTask == "License Issuance" && wfStatus == "Issued") {
	include("CMN;Licenses!Clerk!Operator!NA;LicenseIssueActions");
	}

if (wfTask == "License Status" && wfStatus == "Active") {
	include("CMN;LICENSE;2YrExpJune30");
	}

if (wfTask == "License Status" && wfStatus == "About to Expire") {
	licEditExpInfo("About to Expire");
	}
`^
WTUA;Licenses!Clerk!ParaTransitOperating!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask.equals("License Issuance") && wfStatus.equals("Issued")) {
	include("CMN;Licenses!Clerk!ParaTransitOperating!~;UpdateRefProfessional");
	}
`^
WTUA;Licenses!Clerk!SecondHandBicycleDealer!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
procComp = closeSubWorkflow(wfProcessID, "Recommendation", capId);
if (wfTask == "Legistar" && wfStatus == "Entered") {
	include("EML;Licenses!Clerk!SecondHandBicycleDealer!NA;BackgroundCheckNeeded");
	}

if (wfTask == "District Captain Review" && wfStatus == "Complete") {
	include("EML;Licenses!Clerk!SecondHandBicycleDealer!NA;CaptainReviewComplete");
	}

if (wfTask == "District Captain Review" && wfStatus == "Rec. Rejection") {
	include("EML;Licenses!Clerk!SecondHandBicycleDealer!NA;CaptainReviewComplete");
	}

if (wfTask == "Background Check" && wfStatus == "Captain Consultation") {
	include("EML;Licenses!Clerk!SecondHandBicycleDealer!NA;BackgroundCheck");
	}
`^
WTUA;Licenses!Clerk!SecondHandDealer!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var sWFStatus = "";
procComp = closeSubWorkflow(wfProcessID, "Approved", capId);
if (wfTask == "Legistar" && wfStatus == "Entered") {
	include("EML;Licenses!Clerk!SecondHandDealer!NA;BackgroundCheckNeeded");
	}

if (wfTask == "District Captain Review" && wfStatus == "Complete") {
	include("EML;Licenses!Clerk!SecondHandDealer!NA;CaptainReviewComplete");
	}

if (wfTask == "District Captain Review" && wfStatus == "Rec. Rejection") {
	include("EML;Licenses!Clerk!SecondHandDealer!NA;CaptainReviewComplete");
	}

if (wfTask == "Background Check" && wfStatus == "Captain Consultation") {
	include("EML;Licenses!Clerk!SecondHandDealer!NA;BackgroundCheckComp");
	}

if (wfTask == "License Issuance" && wfStatus == "Issued") {
	include("EML;Licenses!Clerk!SecondHandDealer!~;Issuance");
	}
`^
WTUA;Licenses!Clerk!SecondHandDealer!NoLicense^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var sWFStatus = "";
procComp = closeSubWorkflow(wfProcessID, "Approved", capId);
if (wfTask == "License Clerk Review" && wfStatus == "Under Review") {
	include("EML;Licenses!Clerk!SecondHandDealer!NoLicense;BackgroundCheckNeeded");
	}

if (wfTask == "Police Review" && wfStatus == "Accepted") {
	include("EML;Licenses!Clerk!SecondHandDealer!NoLicense;BackgroundCheckComp");
	}

if (wfTask == "Police Review" && wfStatus == "Denied") {
	include("EML;Licenses!Clerk!SecondHandDealer!NoLicense;BackgroundCheckComp");
	}

if (wfTask == "Police Review" && wfStatus == "Add'l Info Req'd") {
	include("EML;Licenses!Clerk!SecondHandDealer!NoLicense;BackgroundCheckComp");
	}

if (wfTask == "Permit Issuance" && wfStatus == "Issued") {
	include("EML;Licenses!Clerk!SecondHandDealer!~;Issuance");
	}
`^
WTUA;Licenses!Engineering!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
`^
WTUA;Licenses!Engineering!Prequalified Contractor!Na^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
setAAPlanStatus = true;
issueLicense = false;
intakeComplete = false;
appComplete = false;
aaComplete = false;
licenseIssued = false;
if (isTaskStatus("Affirmative Action Review", "Not Required", "LIC_PREQUAL")) {
	setAAPlanStatus = false;
	}

if (isTaskStatus("Affirmative Action Review", "Denied", "LIC_PREQUAL")) {
	setAAPlanStatus = false;
	}

if (AInfo['CATEGORIES.B'] == "CHECKED" && (AInfo['CATEGORIES.AA Plan Number'] == "" || AInfo['CATEGORIES.AA Plan Number'] == null)) {
	cancel = true;
	showMessage = true;
	comment("An AA Plan Number needs to be entered.");
	setAAPlanStatus = false;
	deactivateTask("Application Review");
	activateTask("Intake");
	}

if (AInfo['CATEGORIES.B'] == "CHECKED" && setAAPlanStatus) {
	include("CMN;Licenses!Engineering!Prequalified Contractor!Na;GetAAPlanStatus");
	}

if (AInfo['CATEGORIES.B'] != "CHECKED" && setAAPlanStatus) {
	deactivateTask("Affirmative Action Review");
	}

if (AInfo['CATEGORIES.B'] != "CHECKED" && setAAPlanStatus) {
	closeTask("Affirmative Action Review", "Not Required", "Not Required", "Affirmative Action Not Required");
	}

if (AInfo['CATEGORIES.B'] == "CHECKED" && setAAPlanStatus && !isTaskComplete("Affirmative Action Review", "LIC_PREQUAL")) {
	activateTask("Affirmative Action Review");
	}

if (isTaskComplete("Intake", "LIC_PREQUAL")) {
	intakeComplete = true;
	}

if (isTaskComplete("Application Review", "LIC_PREQUAL")) {
	appComplete = true;
	}

if (isTaskComplete("Affirmative Action Review", "LIC_PREQUAL")) {
	aaComplete = true;
	}

if (wfTask == "Application Review" && (wfStatus == "Additional Info - Johanna" || wfStatus == "Additional Info - Keana")) {
	activateTask("Intake");
	deactivateTask("Application Review");
	}

if (wfTask == "Application Review" && wfStatus == "Additional Info - Johanna") {
	emailType = "AddInfoJo";
	include("EML;Licenses!Engineering!Prequalified Contractor!Na");
	}

if (wfTask == "Application Review" && wfStatus == "Additional Info - Keana") {
	emailType = "AddInfoKe";
	include("EML;Licenses!Engineering!Prequalified Contractor!Na");
	}

if (wfTask == "Application Review" && (wfStatus == "Approved" || wfStatus == "Not Approved")) {
	appComplete = true;
	closeTask("Application Review", wfStatus, wfStatus, wfStatus);
	}

if (isTaskStatus("License Issuance", "Issued", "LIC_PREQUAL")) {
	licenseIssued = true;
	}

if (isTaskStatus("License Issuance", "Denied", "LIC_PREQUAL")) {
	licenseIssued = true;
	}

if (intakeComplete && appComplete && aaComplete) {
	issueLicense = true;
	}

if (issueLicense && !licenseIssued) {
	activateTask("License Issuance");
	} else {
	deactivateTask("License Issuance");
	}

if ((startDate.getMonth() == 10 || startDate.getMonth() == 11)) {
	newYear = startDate.getFullYear() + 3;
	expDate = "03!01!" + newYear;
	} else {
	newYear = startDate.getFullYear() + 2;
	expDate = "03!01!" + newYear;
	}

if (wfTask == "License Issuance" && wfStatus == "Issued") {
	licEditExpInfo("Active", expDate);
	updateAppStatus("Active", "Set by workflow", capId);
	}

if (wfTask == "License Issuance" && wfStatus == "Issued") {
	branchTask("License Status", "Active", "Approved", "Approved");
	}

if (wfTask == "License Issuance" && wfStatus == "Issued") {
	activateTask("License Status");
	}

if (wfTask == "License Issuance" && wfStatus == "Issued") {
	include("CMN;PREQUAL");
	}

if (wfTask == "License Issuance" && wfStatus == "Issued" && AInfo['CATEGORIES.C'] == "CHECKED") {
	include("CMN;ROWLPCARD");
	}

if (wfTask == "License Issuance" && wfStatus == "Issued" && AInfo['CATEGORIES.A'] == "CHECKED") {
	include("CMN;TERLPCARD");
	}

if (wfTask == "License Issuance" && wfStatus == "Denied") {
	licEditExpInfo("Inactive", null);
	updateAppStatus("Inactive", "Set by workflow", capId);
	}

if (wfTask == "License Issuance" && wfStatus == "Denied") {
	branchTask("License Status", "Inactive", "Not Approved", "Not Approved");
	}

if (wfTask == "License Issuance" && wfStatus == "Denied") {
	activateTask("License Status");
	}

if (wfTask == "License Issuance" && wfStatus == "Denied") {
	closeTask("Closed", "Closed", "Closed", "Closed");
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	licEditExpInfo("About to Expire", null);
	updateAppStatus("About to Expire", "Set by workflow", capId);
	}

if (wfTask =="License Status" && wfStatus == "Ready to Renew") {
	licEditExpInfo("About to Expire", null);
	updateAppStatus("About to Expire", "Set by workflow", capId);
	}

if (wfTask =="License Status" && wfStatus == "Reinstate") {
	licEditExpInfo("Pending", null);
	updateAppStatus("Amendment In Progress", "Set by workflow", capId);
	}

if (wfTask =="License Status" && wfStatus == "Inactive") {
	licEditExpInfo("Inactive", null);
	updateAppStatus("Inactive", "Set by workflow", capId);
	}

if (wfTask =="License Status" && wfStatus == "Expired") {
	licEditExpInfo("Expired", null);
	updateAppStatus("Expired", "Set by workflow", capId);
	}

if (wfTask =="License Status" && wfStatus == "Active") {
	licEditExpInfo("Active", expDate);
	updateAppStatus("Active", "Set by workflow", capId);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	aa.workflow.deleteAndAssignWorkflow(capId, "LIC_PREQUAL", true);
	}

if (wfTask =="License Status" && wfStatus == "Ready to Renew") {
	aa.workflow.deleteAndAssignWorkflow(capId, "LIC_PREQUAL", true);
	}

if (wfTask =="License Status" && wfStatus == "Reinstate") {
	aa.workflow.deleteAndAssignWorkflow(capId, "LIC_PREQUAL", true);
	}

if (wfTask == "License Issuance" && wfStatus == "Issued") {
	emailType = "Issued";
	include("EML;Licenses!Engineering!Prequalified Contractor!Na");
	}

if (wfStatus == "Amendment") {
	emailType = "Amend";
	include("EML;Licenses!Engineering!Prequalified Contractor!Na");
	}
`^
WTUA;Licenses!Fire!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
bLicenseIssued = false;
if (isTaskActive("License Issuance")) {
	include("CMN;LicenseIssuanceProcess");
	}

if (bLicenseIssued) {
	include("CMN;LICENSE;ExpJune30");
	}
`^
WTUA;Licenses!Health!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
bLicenseIssued = false;
include("CMN;GetMuni");
isDischofNonStrmwtr = appMatch("Licenses!Health!DischofNonStrmwtr!Madison");
if (cmnSubType != "Temp Food Establishment" && wfTask == "Intake" && wfStatus == "Completed") {
	include("CMN;CloseTaskWellOrSepticReview");
	}

if (cmnSubType != "Temp Food Establishment" && wfTask == "License Issuance" && wfStatus == "Issued") {
	include("CMN;LicenseIssuanceProcess");
	}

if (wfTask == "License Issuance" && wfStatus == "Issued - Conditional") {
	include("CMN;ConditionalLicenseIssuance");
	}

if (bLicenseIssued && cmnSubType == "FoodandDrink" && muni == "City of Madison") {
	include("EML;Licenses!Health!FoodandDrink!Madison;PersonalProperty");
	}

if (bLicenseIssued) {
	include("CMN;LICENSE;ExpJune30");
	}

if (bLicenseIssued && isDischofNonStrmwtr) {
	aa.set.add("CL LIC DAILY",capId);
	}

if (wfTask == "Health Inspection" && wfStatus == "Withdrawn") {
	include("CMN;Licenses!Health!~!~;CloseAllTasks");
	}

if (wfTask == "Intake" && isDischofNonStrmwtr) {
	assignCap("HEGAP");
	include("EML;NewNonStormLicense");
	}

if (currentUserID == "ITJBS") {
	showDebug = true;
	}
`^
WTUA;Licenses!Health!FoodandDrink!DaneCounty^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
cartOnly = false;
if (AInfo['RESTAURANT MOBILE CART.Gross food sales per year'] != null || AInfo['RETAIL MOBILE CART ONLY.Gross food sales per year'] != null || AInfo['FARMERS MARKET.Gross food sales per year'] != null) {
	cartOnly = true;
	}

include("email_template_test");
`^
WTUA;Licenses!Health!FoodandDrink!Madison^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (wfTask == "Intake" && wfStatus == "Completed" && (AInfo['RESTAURANT MOBILE CART.Gross food sales per year'] != null || AInfo['RETAIL MOBILE CART ONLY.Gross food sales per year'] != null || AInfo['FARMERS MARKET.Gross food sales per year'] != null)) {
	closeTask("Building Inspection","Not Required","Not Required","");
	closeTask("Fire Inspection","Not Required","Not Required","");
	closeTask("Zoning Review","Not Required","Not Required","");
	comment("This is getting triggered");
	}

if (wfTask == "Intake" && wfStatus == "Completed" && AInfo['RESTAURANT MOBILE CART.Gross food sales per year'] == null && AInfo['RESTAURANT MOBILE BASE ONLY.C; All of the above and also transport of food, banquet facilities'] == null && AInfo['RESTAURANT MOBILE BASE ONLY.S; Meals prepared when food is ordered, limited food prep - mixing prepackaged foods'] == null && AInfo['RESTAURANT MOBILE BASE ONLY.M; Raw food handled, buffet, drive through, delivery, food cooled or reheated, unlimited food prep'] == null && AInfo['RETAIL MOBILE CART ONLY.Gross food sales per year'] == null && AInfo['FARMERS MARKET.Gross food sales per year'] == null) {
	include("CMN;SanDist");
	include("CMN;AssignFireInspectionTaskPrevention");
	}

if (wfTask == "Health Inspection" && wfStatus == "Completed") {
	include("EML;FoodDrink;Land;Zoning");
	}

if (wfTask == "License Issuance" && wfStatus == "Issued") {
	include("EML;Licenses!Health!FoodandDrink!Madison;PersonalProperty");
	}
`^
WTUA;Licenses!Health!Temp Food Establishment!DaneCounty^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var bIsIssuance = false;
var bLicenseIssued = false;
if (wfTask == "License Issuance" && (wfStatus == "Issued" || wfStatus == "Issued - Emailed")) {
	bIsIssuance = true;
	}

if (bIsIssuance && feesInvoicedTotal > 0 && balanceDue <= 0) {
	bLicenseIssued = true;
	}

if (bIsIssuance && bLicenseIssued == false) {
	include("EML;Licenses!~!~!~;LicenseNotIssued");
	logDebug("License NOT issued");
	}

if (bLicenseIssued) {
	updateTask("License Status", "Active", "Updated by Temp Food workflow script", "");
	}

if (bLicenseIssued) {
	include("CMN;LICENSE;ExpJune30");
	}

if (bLicenseIssued && wfStatus == "Issued - Emailed") {
	include("EML;Licenses!Health!Temp Food Establishment!DaneCounty;Issued");
	}

if (bLicenseIssued && wfStatus == "Issued") {
	reportViewAttachEmail(false, true, "Business License", "noreply@cityofmadisonDEV.com", "PlaceholderEmail@cityofmadisonDEV.com", "", "Temp Food Lic Issued", "No intention of sending email here. Only attaching Business License to Temp Food License record.", false, "jschneider@cityofmadison.com");
	}

if (currentUserID == "ITJBS") {
	showDebug = true;
	}
`^
WTUA;Licenses!Police!Taxi Driver!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Captain Review" && wfStatus == "Denied") {
	include("EML;TAXIDENIED");
	}
`^
WTUA;Licenses!Treasurer!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
appLic = aa.expiration.getLicensesByCapID(capId).getOutput();
if (wfTask == "Intake" && wfStatus == "Missing Info") {
	include("EML;Licenses!Treasurer!~!~;InfoNeeded");
	}

if (wfTask == "License Status" && wfStatus == "Active") {
	licEditExpInfo("Active",null);
	}

include("CMN;Licenses!Treasurer!~!~;SetRenewalInfo");
`^
WTUA;Licenses!Treasurer!Cat Registration!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Incomplete");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	aa.cap.updateRenewalCapStatus(capId, rnwCapId);
	licEditExpInfo("About to Expire", null);
	}

proj1 = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess1 = proj1.getSuccess();
if (projSuccess1 == true) {
	proj1 = proj1.getOutput();
	rnwCapId = proj1[0].getCapID();
	}

if (wfTask == "Intake" && wfStatus == "Approved") {
	editAppSpecific("ANIMAL DETAILS.Tag Number Issued",AInfo['New Tag Number']);
	}

if (wfTask == "Intake" && wfStatus == "Approved") {
	updateTask("License Status","Active","","");
	updateAppStatus("Active");
	licEditExpInfo("Active", null);
	}

if (wfTask == "Intake" && wfStatus == "Approved" && projSuccess1 == true) {
	r = aa.cap.getProjectByMasterID(capId, "Renewal", "Review").getOutput();
	r[0].setStatus("Complete");
	aa.cap.updateProject(r[0]);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	aa.workflow.deleteAndAssignWorkflow(capId, "TREDCREG", false);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	licEditExpInfo("About to Expire", null);
	}
`^
WTUA;Licenses!Treasurer!Chicken Owner!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Incomplete");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	aa.cap.updateRenewalCapStatus(capId, rnwCapId);
	licEditExpInfo("About to Expire", null);
	}

proj1 = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess1 = proj1.getSuccess();
if (projSuccess1 == true) {
	proj1 = proj1.getOutput();
	rnwCapId = proj1[0].getCapID();
	}

if (wfTask == "Intake" && wfStatus == "Approved") {
	updateTask("License Status","Active","","");
	updateAppStatus("Active");
	}

if (wfTask == "Intake" && wfStatus == "Approved" && projSuccess1 == true) {
	r = aa.cap.getProjectByMasterID(capId, "Renewal", "Review").getOutput();
	r[0].setStatus("Complete");
	aa.cap.updateProject(r[0]);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	aa.workflow.deleteAndAssignWorkflow(capId, "TREDCREG", false);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	licEditExpInfo("About to Expire", null);
	}
`^
WTUA;Licenses!Treasurer!Dog Registration!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Incomplete");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	aa.cap.updateRenewalCapStatus(capId, rnwCapId);
	licEditExpInfo("About to Expire", null);
	}

proj1 = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess1 = proj1.getSuccess();
if (projSuccess1 == true) {
	proj1 = proj1.getOutput();
	rnwCapId = proj1[0].getCapID();
	}

if (wfTask == "Intake" && wfStatus == "Approved") {
	editAppSpecific("ANIMAL DETAILS.Tag Number Issued",AInfo['New Tag Number']);
	}

if (wfTask == "Intake" && wfStatus == "Approved") {
	updateTask("License Status","Active","","");
	updateAppStatus("Active");
	}

if (wfTask == "Intake" && wfStatus == "Approved" && projSuccess1 == true) {
	r = aa.cap.getProjectByMasterID(capId, "Renewal", "Review").getOutput();
	r[0].setStatus("Complete");
	aa.cap.updateProject(r[0]);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	aa.workflow.deleteAndAssignWorkflow(capId, "TREDCREG", false);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	licEditExpInfo("About to Expire", null);
	}
`^
WTUA;Licenses!Treasurer!Kennel!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Incomplete");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	aa.cap.updateRenewalCapStatus(capId, rnwCapId);
	licEditExpInfo("About to Expire", null);
	}

proj1 = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess1 = proj1.getSuccess();
if (projSuccess1 == true) {
	proj1 = proj1.getOutput();
	rnwCapId = proj1[0].getCapID();
	}

if (wfTask == "Intake" && wfStatus == "Approved") {
	updateTask("License Status","Active","","");
	updateAppStatus("Active");
	}

if (wfTask == "Intake" && wfStatus == "Approved" && projSuccess1 == true) {
	r = aa.cap.getProjectByMasterID(capId, "Renewal", "Review").getOutput();
	r[0].setStatus("Complete");
	aa.cap.updateProject(r[0]);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	aa.workflow.deleteAndAssignWorkflow(capId, "TREDCREG", false);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	licEditExpInfo("About to Expire", null);
	}
`^
WTUA;Licenses!Vending!HighDensityVending!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Incomplete");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	aa.cap.updateRenewalCapStatus(capId, rnwCapId);
	licEditExpInfo("About to Expire", null);
	}

proj1 = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess1 = proj1.getSuccess();
if (projSuccess1 == true) {
	proj1 = proj1.getOutput();
	rnwCapId = proj1[0].getCapID();
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess != true) {
	reportName ="Vending Application";
	include("CMN;RUN_REPORT_NO_MSG");
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	reportName ="Vending Renew Application";
	include("CMN;RUN_REPORT_NO_MSG");
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	tempCapId = capId;
	capId = rnwCapId;
	closeTask("Intake", "Submitted", "This task was automatically closed because it was not needed.", "", "LICHDV");
	capId = tempCapId;
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	tempCapId = capId;
	capId = rnwCapId;
	closeTask("Closed", "Closed", "This task was automatically closed because it was not needed.", "", "LICHDV");
	capId = tempCapId;
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	updateAppStatus("Complete", "Renewal Complete", rnwCapId);
	}

if (wfTask =="Applicant Conference" && wfStatus == "No Follow Up Needed") {
	closeTask("Conference", "Not Needed", "This task was automatically closed because it was not needed.", "", "LICVENSUB");
	}

if (wfTask =="Applicant Conference" && wfStatus == "No Follow Up Needed") {
	closeTask("Inspection", "Not Needed", "This task was automatically closed because it was not needed.", "", "LICVENSUB");
	}

if (wfTask =="Insurance Review" && wfStatus == "Additional Info Required") {
	include("EML;Licenses!Vending!~!~;InsInfo");
	}

if (wfTask =="Insurance Review" && wfStatus == "Denied") {
	include("EML;Licenses!Vending!~!~;InsDeclined");
	}

if (wfTask =="Insurance Review" && wfStatus == "Insurance Not Attached") {
	include("EML;Licenses!Vending!~!~;InsNeeded");
	}

if (wfTask =="Health Dept. Notification" && wfStatus == "Additional Info Required") {
	include("EML;Licenses!Vending!~!~;InformHealth");
	}

if (wfTask =="Health Dept. Notification" && (wfStatus == "Approved" || wfStatus == "Failed")) {
	include("EML;Licenses!Vending!~!~;HealthComplete");
	}

if (projSuccess1 == true && wfTask =="Fee Review" && (wfStatus == "Create Fees Email" || wfStatus == "Create Fees No Email")) {
	include("CMN;Licenses!Vending!HighDensityVending!Renewal;Fee");
	}

if (projSuccess1 != true && wfTask == "Fee Review" && (wfStatus == "Create Fees Email" || wfStatus == "Create Fees No Email")) {
	include("CMN;Licenses!Vending!HighDensityVending!NA;Fee");
	}

if (wfTask =="Fee Review" && (wfStatus == "Create Fees Email" || wfStatus == "Email Only")) {
	include("EML;Licenses!Vending!~!~;FeesReady");
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	licEditExpInfo("Active", AInfo['APPLICANT TYPE.End Date']);
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	reportName = "Vending Business License";
	include("CMN;RUN_REPORT");
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	include("EML;Licenses!Vending!~!~;LicenseIssued");
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	updateAppStatus("Active", "Updated due to license Issued", capId);
	}

if (wfTask =="License Issuance" && wfStatus == "Issued" && projSuccess1 == true) {
	r = aa.cap.getProjectByMasterID(capId, "Renewal", "Review").getOutput();
	r[0].setStatus("Complete");
	aa.cap.updateProject(r[0]);
	}

if (wfTask =="License Status" && wfStatus == "Ready to Renew") {
	aa.workflow.deleteAndAssignWorkflow(capId, "LICVEN", false);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	aa.workflow.deleteAndAssignWorkflow(capId, "LICVEN", false);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	licEditExpInfo("About to Expire", null);
	}
`^
WTUA;Licenses!Vending!LateNightVendor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Incomplete");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	aa.cap.updateRenewalCapStatus(capId, rnwCapId);
	licEditExpInfo("About to Expire", null);
	}

proj1 = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess1 = proj1.getSuccess();
if (projSuccess1 == true) {
	proj1 = proj1.getOutput();
	rnwCapId = proj1[0].getCapID();
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess != true) {
	reportName ="Vending Application";
	include("CMN;RUN_REPORT_NO_MSG");
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	reportName ="Vending Renew Application";
	include("CMN;RUN_REPORT_NO_MSG");
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	tempCapId = capId;
	capId = rnwCapId;
	closeTask("Intake", "Submitted", "This task was automatically closed because it was not needed.", "", "LICHDV");
	capId = tempCapId;
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	tempCapId = capId;
	capId = rnwCapId;
	closeTask("Closed", "Closed", "This task was automatically closed because it was not needed.", "", "LICHDV");
	capId = tempCapId;
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	updateAppStatus("Complete", "Renewal Complete", rnwCapId);
	}

if (wfTask =="Applicant Conference" && wfStatus == "No Follow Up Needed") {
	closeTask("Conference", "Not Needed", "This task was automatically closed because it was not needed.", "", "LICVENSUB");
	}

if (wfTask =="Applicant Conference" && wfStatus == "No Follow Up Needed") {
	closeTask("Inspection", "Not Needed", "This task was automatically closed because it was not needed.", "", "LICVENSUB");
	}

if (wfTask =="Insurance Review" && wfStatus == "Additional Info Required") {
	include("EML;Licenses!Vending!~!~;InsInfo");
	}

if (wfTask =="Insurance Review" && wfStatus == "Denied") {
	include("EML;Licenses!Vending!~!~;InsDeclined");
	}

if (wfTask =="Insurance Review" && wfStatus == "Insurance Not Attached") {
	include("EML;Licenses!Vending!~!~;InsNeeded");
	}

if (wfTask =="Health Dept. Notification" && wfStatus == "Additional Info Required") {
	include("EML;Licenses!Vending!~!~;InformHealth");
	}

if (wfTask =="Health Dept. Notification" && (wfStatus == "Approved" || wfStatus == "Failed")) {
	include("EML;Licenses!Vending!~!~;HealthComplete");
	}

if (projSuccess1 == true && wfTask =="Fee Review" && (wfStatus == "Create Fees Email" || wfStatus == "Create Fees No Email")) {
	include("CMN;Licenses!Vending!LateNightVendor!Renewal;Fee");
	}

if (projSuccess1 != true && wfTask == "Fee Review" && (wfStatus == "Create Fees Email" || wfStatus == "Create Fees No Email")) {
	include("CMN;Licenses!Vending!LateNightVendor!NA;Fee");
	}

if (wfTask =="Fee Review" && (wfStatus == "Create Fees Email" || wfStatus == "Email Only")) {
	include("EML;Licenses!Vending!~!~;FeesReady");
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	licEditExpInfo("Active", AInfo['APPLICANT TYPE.End Date']);
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	reportName = "Vending Business License";
	include("CMN;RUN_REPORT");
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	include("EML;Licenses!Vending!~!~;LicenseIssued");
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	updateAppStatus("Active", "Updated due to license Issued", capId);
	}

if (wfTask =="License Issuance" && wfStatus == "Issued" && projSuccess1 == true) {
	r = aa.cap.getProjectByMasterID(capId, "Renewal", "Review").getOutput();
	r[0].setStatus("Complete");
	aa.cap.updateProject(r[0]);
	}

if (wfTask =="License Status" && wfStatus == "Ready to Renew") {
	aa.workflow.deleteAndAssignWorkflow(capId, "LICVEN", false);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	aa.workflow.deleteAndAssignWorkflow(capId, "LICVEN", false);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	licEditExpInfo("About to Expire", null);
	}
`^
WTUA;Licenses!Vending!MallCraftVendor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Incomplete");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	aa.cap.updateRenewalCapStatus(capId, rnwCapId);
	licEditExpInfo("About to Expire", null);
	}

proj1 = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess1 = proj1.getSuccess();
if (projSuccess1 == true) {
	proj1 = proj1.getOutput();
	rnwCapId = proj1[0].getCapID();
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess != true) {
	reportName ="Vending Application";
	include("CMN;RUN_REPORT_NO_MSG");
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	reportName ="Vending Renew Application";
	include("CMN;RUN_REPORT_NO_MSG");
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	tempCapId = capId;
	capId = rnwCapId;
	closeTask("Intake", "Submitted", "This task was automatically closed because it was not needed.", "", "LICHDV");
	capId = tempCapId;
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	tempCapId = capId;
	capId = rnwCapId;
	closeTask("Closed", "Closed", "This task was automatically closed because it was not needed.", "", "LICHDV");
	capId = tempCapId;
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	updateAppStatus("Complete", "Renewal Complete", rnwCapId);
	}

if (wfTask =="Applicant Conference" && wfStatus == "No Follow Up Needed") {
	closeTask("Conference", "Not Needed", "This task was automatically closed because it was not needed.", "", "LICVENSUB");
	}

if (wfTask =="Applicant Conference" && wfStatus == "No Follow Up Needed") {
	closeTask("Inspection", "Not Needed", "This task was automatically closed because it was not needed.", "", "LICVENSUB");
	}

if (wfTask =="Insurance Review" && wfStatus == "Additional Info Required") {
	include("EML;Licenses!Vending!~!~;InsInfo");
	}

if (wfTask =="Insurance Review" && wfStatus == "Denied") {
	include("EML;Licenses!Vending!~!~;InsDeclined");
	}

if (wfTask =="Insurance Review" && wfStatus == "Insurance Not Attached") {
	include("EML;Licenses!Vending!~!~;InsNeeded");
	}

if (wfTask =="Health Dept. Notification" && wfStatus == "Additional Info Required") {
	include("EML;Licenses!Vending!~!~;InformHealth");
	}

if (wfTask =="Health Dept. Notification" && (wfStatus == "Approved" || wfStatus == "Failed")) {
	include("EML;Licenses!Vending!~!~;HealthComplete");
	}

if (projSuccess1 == true && wfTask =="Fee Review" && (wfStatus == "Create Fees Email" || wfStatus == "Create Fees No Email")) {
	include("CMN;Licenses!Vending!MallCraftVendor!Renewal;Fee");
	}

if (projSuccess1 != true && wfTask == "Fee Review" && (wfStatus == "Create Fees Email" || wfStatus == "Create Fees No Email")) {
	include("CMN;Licenses!Vending!MallCraftVendor!NA;Fee");
	}

if (wfTask =="Fee Review" && (wfStatus == "Create Fees Email" || wfStatus == "Email Only")) {
	include("EML;Licenses!Vending!~!~;FeesReady");
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	licEditExpInfo("Active", AInfo['APPLICANT TYPE.End Date']);
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	reportName = "Vending Business License";
	include("CMN;RUN_REPORT");
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	include("EML;Licenses!Vending!~!~;LicenseIssued");
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	updateAppStatus("Active", "Updated due to license Issued", capId);
	}

if (wfTask =="License Issuance" && wfStatus == "Issued" && projSuccess1 == true) {
	r = aa.cap.getProjectByMasterID(capId, "Renewal", "Review").getOutput();
	r[0].setStatus("Complete");
	aa.cap.updateProject(r[0]);
	}

if (wfTask =="License Status" && wfStatus == "Ready to Renew") {
	aa.workflow.deleteAndAssignWorkflow(capId, "LICVEN", false);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	aa.workflow.deleteAndAssignWorkflow(capId, "LICVEN", false);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	licEditExpInfo("About to Expire", null);
	}
`^
WTUA;Licenses!Vending!MallFoodVendor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
tsiResults = aa.taskSpecificInfo.getTaskSpecificInfoByTask(capId, wfProcessID, wfStep);
if (tsiResults.getSuccess()) {
	tsiArr = tsiResults.getOutput();
	}

if (tsiResults.getSuccess()) {
	for(tsi in tsiArr) debugObject(tsiArr[tsi]);
	}

for(tsi in tsiArr) if (tsiArr[tsi].getCheckboxDesc()  == "Half Price") halfPrice = tsiArr[tsi].getChecklistComment();
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Incomplete");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	aa.cap.updateRenewalCapStatus(capId, rnwCapId);
	licEditExpInfo("About to Expire", null);
	}

proj1 = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess1 = proj1.getSuccess();
if (projSuccess1 == true) {
	proj1 = proj1.getOutput();
	rnwCapId = proj1[0].getCapID();
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess != true) {
	reportName ="Vending Application";
	include("CMN;RUN_REPORT_NO_MSG");
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	reportName ="Vending Renew Application";
	include("CMN;RUN_REPORT_NO_MSG");
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	tempCapId = capId;
	capId = rnwCapId;
	closeTask("Intake", "Submitted", "This task was automatically closed because it was not needed.", "", "LICHDV");
	capId = tempCapId;
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	tempCapId = capId;
	capId = rnwCapId;
	closeTask("Closed", "Closed", "This task was automatically closed because it was not needed.", "", "LICHDV");
	capId = tempCapId;
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	updateAppStatus("Complete", "Renewal Complete", rnwCapId);
	}

if (wfTask =="Applicant Conference" && wfStatus == "No Follow Up Needed") {
	closeTask("Conference", "Not Needed", "This task was automatically closed because it was not needed.", "", "LICVENSUB");
	}

if (wfTask =="Applicant Conference" && wfStatus == "No Follow Up Needed") {
	closeTask("Inspection", "Not Needed", "This task was automatically closed because it was not needed.", "", "LICVENSUB");
	}

if (wfTask =="Insurance Review" && wfStatus == "Additional Info Required") {
	include("EML;Licenses!Vending!~!~;InsInfo");
	}

if (wfTask =="Insurance Review" && wfStatus == "Denied") {
	include("EML;Licenses!Vending!~!~;InsDeclined");
	}

if (wfTask =="Insurance Review" && wfStatus == "Insurance Not Attached") {
	include("EML;Licenses!Vending!~!~;InsNeeded");
	}

if (wfTask =="Health Dept. Notification" && wfStatus == "Additional Info Required") {
	include("EML;Licenses!Vending!~!~;InformHealth");
	}

if (wfTask =="Health Dept. Notification" && (wfStatus == "Approved" || wfStatus == "Failed")) {
	include("EML;Licenses!Vending!~!~;HealthComplete");
	}

if (projSuccess1 == true && wfTask =="Fee Review" && (wfStatus == "Create Fees Email" || wfStatus == "Create Fees No Email")) {
	include("CMN;Licenses!Vending!MallFoodVendor!Renewal;Fee");
	}

if (projSuccess1 != true && wfTask == "Fee Review" && (wfStatus == "Create Fees Email" || wfStatus == "Create Fees No Email")) {
	include("CMN;Licenses!Vending!MallFoodVendor!NA;Fee");
	}

if (wfTask =="Fee Review" && (wfStatus == "Create Fees Email" || wfStatus == "Email Only")) {
	include("EML;Licenses!Vending!~!~;FeesReady");
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	licEditExpInfo("Active", AInfo['APPLICANT TYPE.End Date']);
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	reportName = "Vending Business License";
	include("CMN;RUN_REPORT");
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	include("EML;Licenses!Vending!~!~;LicenseIssued");
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	updateAppStatus("Active", "Updated due to license Issued", capId);
	}

if (wfTask =="License Issuance" && wfStatus == "Issued" && projSuccess1 == true) {
	r = aa.cap.getProjectByMasterID(capId, "Renewal", "Review").getOutput();
	r[0].setStatus("Complete");
	aa.cap.updateProject(r[0]);
	}

if (wfTask =="License Status" && wfStatus == "Ready to Renew") {
	aa.workflow.deleteAndAssignWorkflow(capId, "LICVEN", false);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	aa.workflow.deleteAndAssignWorkflow(capId, "LICVEN", false);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	licEditExpInfo("About to Expire", null);
	}
`^
WTUA;Licenses!Vending!MerchantVendor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
nextYear = startDate.getFullYear();
nextYear = nextYear +1;
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Incomplete");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	aa.cap.updateRenewalCapStatus(capId, rnwCapId);
	licEditExpInfo("About to Expire", null);
	}

proj1 = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess1 = proj1.getSuccess();
if (projSuccess1 == true) {
	proj1 = proj1.getOutput();
	rnwCapId = proj1[0].getCapID();
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess != true) {
	reportName ="Vending Application";
	include("CMN;RUN_REPORT_NO_MSG");
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	reportName ="Vending Renew Application";
	include("CMN;RUN_REPORT_NO_MSG");
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	tempCapId = capId;
	capId = rnwCapId;
	closeTask("Intake", "Submitted", "This task was automatically closed because it was not needed.", "", "LICHDV");
	capId = tempCapId;
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	tempCapId = capId;
	capId = rnwCapId;
	closeTask("Closed", "Closed", "This task was automatically closed because it was not needed.", "", "LICHDV");
	capId = tempCapId;
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	updateAppStatus("Complete", "Renewal Complete", rnwCapId);
	}

if (wfTask =="Applicant Conference" && wfStatus == "No Follow Up Needed") {
	closeTask("Conference", "Not Needed", "This task was automatically closed because it was not needed.", "", "LICVENSUB");
	}

if (wfTask =="Applicant Conference" && wfStatus == "No Follow Up Needed") {
	closeTask("Inspection", "Not Needed", "This task was automatically closed because it was not needed.", "", "LICVENSUB");
	}

if (wfTask =="Insurance Review" && wfStatus == "Additional Info Required") {
	include("EML;Licenses!Vending!~!~;InsInfo");
	}

if (wfTask =="Insurance Review" && wfStatus == "Denied") {
	include("EML;Licenses!Vending!~!~;InsDeclined");
	}

if (wfTask =="Insurance Review" && wfStatus == "Insurance Not Attached") {
	include("EML;Licenses!Vending!~!~;InsNeeded");
	}

if (wfTask =="Health Dept. Notification" && wfStatus == "Additional Info Required") {
	include("EML;Licenses!Vending!~!~;InformHealth");
	}

if (wfTask =="Health Dept. Notification" && (wfStatus == "Approved" || wfStatus == "Failed")) {
	include("EML;Licenses!Vending!~!~;HealthComplete");
	}

if (projSuccess1 == true && wfTask =="Fee Review" && (wfStatus == "Create Fees Email" || wfStatus == "Create Fees No Email")) {
	include("CMN;Licenses!Vending!MerchantVendor!Renewal;Fee");
	}

if (projSuccess1 != true && wfTask == "Fee Review" && (wfStatus == "Create Fees Email" || wfStatus == "Create Fees No Email")) {
	include("CMN;Licenses!Vending!MerchantVendor!NA;Fee");
	}

if (wfTask =="Fee Review" && (wfStatus == "Create Fees Email" || wfStatus == "Email Only")) {
	include("EML;Licenses!Vending!~!~;FeesReady");
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	licEditExpInfo("Active","04!14!" + nextYear);
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	reportName = "Vending Business License";
	include("CMN;RUN_REPORT");
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	include("EML;Licenses!Vending!~!~;LicenseIssued");
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	updateAppStatus("Active", "Updated due to license Issued", capId);
	}

if (wfTask =="License Issuance" && wfStatus == "Issued" && projSuccess1 == true) {
	r = aa.cap.getProjectByMasterID(capId, "Renewal", "Review").getOutput();
	r[0].setStatus("Complete");
	aa.cap.updateProject(r[0]);
	}

if (wfTask =="License Status" && wfStatus == "Ready to Renew") {
	aa.workflow.deleteAndAssignWorkflow(capId, "LICVEN", false);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	aa.workflow.deleteAndAssignWorkflow(capId, "LICVEN", false);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	licEditExpInfo("About to Expire", null);
	}
`^
WTUA;Licenses!Vending!SidewalkCafe!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
nextYear = startDate.getFullYear();
nextYear = nextYear +1;
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Incomplete");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	aa.cap.updateRenewalCapStatus(capId, rnwCapId);
	licEditExpInfo("About to Expire", null);
	}

proj1 = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess1 = proj1.getSuccess();
if (projSuccess1 == true) {
	proj1 = proj1.getOutput();
	rnwCapId = proj1[0].getCapID();
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess != true) {
	reportName ="Vending Application";
	include("CMN;RUN_REPORT_NO_MSG");
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	reportName ="Vending Renew Application";
	include("CMN;RUN_REPORT_NO_MSG");
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	tempCapId = capId;
	capId = rnwCapId;
	closeTask("Intake", "Submitted", "This task was automatically closed because it was not needed.", "", "LICHDV");
	capId = tempCapId;
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	tempCapId = capId;
	capId = rnwCapId;
	closeTask("Closed", "Closed", "This task was automatically closed because it was not needed.", "", "LICHDV");
	capId = tempCapId;
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	updateAppStatus("Complete", "Renewal Complete", rnwCapId);
	}

if (wfTask =="Applicant Conference" && wfStatus == "No Follow Up Needed") {
	closeTask("Conference", "Not Needed", "This task was automatically closed because it was not needed.", "", "LICVENSUB");
	}

if (wfTask =="Applicant Conference" && wfStatus == "No Follow Up Needed") {
	closeTask("Inspection", "Not Needed", "This task was automatically closed because it was not needed.", "", "LICVENSUB");
	}

if (wfTask =="Insurance Review" && wfStatus == "Additional Info Required") {
	include("EML;Licenses!Vending!~!~;InsInfo");
	}

if (wfTask =="Insurance Review" && wfStatus == "Denied") {
	include("EML;Licenses!Vending!~!~;InsDeclined");
	}

if (wfTask =="Insurance Review" && wfStatus == "Insurance Not Attached") {
	include("EML;Licenses!Vending!~!~;InsNeeded");
	}

if (wfTask =="Health Dept. Notification" && wfStatus == "Additional Info Required") {
	include("EML;Licenses!Vending!~!~;InformHealth");
	}

if (wfTask =="Health Dept. Notification" && (wfStatus == "Approved" || wfStatus == "Failed")) {
	include("EML;Licenses!Vending!~!~;HealthComplete");
	}

if (projSuccess1 == true && wfTask =="Fee Review" && (wfStatus == "Create Fees Email" || wfStatus == "Create Fees No Email")) {
	include("CMN;Licenses!Vending!SidewalkCafe!Renewal;Fee");
	}

if (projSuccess1 != true && wfTask == "Fee Review" && (wfStatus == "Create Fees Email" || wfStatus == "Create Fees No Email")) {
	include("CMN;Licenses!Vending!SidewalkCafe!NA;Fee");
	}

if (wfTask =="Fee Review" && (wfStatus == "Create Fees Email" || wfStatus == "Email Only")) {
	include("EML;Licenses!Vending!~!~;FeesReady");
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	licEditExpInfo("Active","04!14!" + nextYear);
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	reportName = "Vending Business License";
	include("CMN;RUN_REPORT");
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	reportName = "Vending Business License";
	include("EML;Licenses!Vending!~!~;LicenseIssued");
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	updateAppStatus("Active", "Updated due to license Issued", capId);
	}

if (wfTask =="License Issuance" && wfStatus == "Issued" && projSuccess1 == true) {
	r = aa.cap.getProjectByMasterID(capId, "Renewal", "Review").getOutput();
	r[0].setStatus("Complete");
	aa.cap.updateProject(r[0]);
	}

if (wfTask =="License Status" && wfStatus == "Ready to Renew") {
	aa.workflow.deleteAndAssignWorkflow(capId, "LICVEN", false);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	aa.workflow.deleteAndAssignWorkflow(capId, "LICVEN", false);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	licEditExpInfo("About to Expire", null);
	}

if (currentUserID == "ITJBS") {
	showDebug = true;
	}
`^
WTUA;Licenses!Vending!SoutheastCampusVending!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Incomplete");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	aa.cap.updateRenewalCapStatus(capId, rnwCapId);
	licEditExpInfo("About to Expire", null);
	}

proj1 = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess1 = proj1.getSuccess();
if (projSuccess1 == true) {
	proj1 = proj1.getOutput();
	rnwCapId = proj1[0].getCapID();
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess != true) {
	reportName ="Vending Application";
	include("CMN;RUN_REPORT_NO_MSG");
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	reportName ="Vending Renew Application";
	include("CMN;RUN_REPORT_NO_MSG");
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	tempCapId = capId;
	capId = rnwCapId;
	closeTask("Intake", "Submitted", "This task was automatically closed because it was not needed.", "", "LICHDV");
	capId = tempCapId;
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	tempCapId = capId;
	capId = rnwCapId;
	closeTask("Closed", "Closed", "This task was automatically closed because it was not needed.", "", "LICHDV");
	capId = tempCapId;
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	updateAppStatus("Complete", "Renewal Complete", rnwCapId);
	}

if (wfTask =="Applicant Conference" && wfStatus == "No Follow Up Needed") {
	closeTask("Conference", "Not Needed", "This task was automatically closed because it was not needed.", "", "LICVENSUB");
	}

if (wfTask =="Applicant Conference" && wfStatus == "No Follow Up Needed") {
	closeTask("Inspection", "Not Needed", "This task was automatically closed because it was not needed.", "", "LICVENSUB");
	}

if (wfTask =="Insurance Review" && wfStatus == "Additional Info Required") {
	include("EML;Licenses!Vending!~!~;InsInfo");
	}

if (wfTask =="Insurance Review" && wfStatus == "Denied") {
	include("EML;Licenses!Vending!~!~;InsDeclined");
	}

if (wfTask =="Insurance Review" && wfStatus == "Insurance Not Attached") {
	include("EML;Licenses!Vending!~!~;InsNeeded");
	}

if (wfTask =="Health Dept. Notification" && wfStatus == "Additional Info Required") {
	include("EML;Licenses!Vending!~!~;InformHealth");
	}

if (wfTask =="Health Dept. Notification" && (wfStatus == "Approved" || wfStatus == "Failed")) {
	include("EML;Licenses!Vending!~!~;HealthComplete");
	}

if (projSuccess1 == true && wfTask =="Fee Review" && (wfStatus == "Create Fees Email" || wfStatus == "Create Fees No Email")) {
	include("CMN;Licenses!Vending!SoutheastCampusVening!Renewal;Fee");
	}

if (projSuccess1 != true && wfTask == "Fee Review" && (wfStatus == "Create Fees Email" || wfStatus == "Create Fees No Email")) {
	include("CMN;Licenses!Vending!SoutheastCampusVening!NA;Fee");
	}

if (wfTask =="Fee Review" && (wfStatus == "Create Fees Email" || wfStatus == "Email Only")) {
	include("EML;Licenses!Vending!~!~;FeesReady");
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	licEditExpInfo("Active", AInfo['APPLICANT TYPE.End Date']);
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	reportName = "Vending Business License";
	include("CMN;RUN_REPORT");
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	include("EML;Licenses!Vending!~!~;LicenseIssued");
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	updateAppStatus("Active", "Updated due to license Issued", capId);
	}

if (wfTask =="License Issuance" && wfStatus == "Issued" && projSuccess1 == true) {
	r = aa.cap.getProjectByMasterID(capId, "Renewal", "Review").getOutput();
	r[0].setStatus("Complete");
	aa.cap.updateProject(r[0]);
	}

if (wfTask =="License Status" && wfStatus == "Ready to Renew") {
	aa.workflow.deleteAndAssignWorkflow(capId, "LICVEN", false);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	aa.workflow.deleteAndAssignWorkflow(capId, "LICVEN", false);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	licEditExpInfo("About to Expire", null);
	}
`^
WTUA;Licenses!Vending!StreetVendor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Incomplete");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	aa.cap.updateRenewalCapStatus(capId, rnwCapId);
	licEditExpInfo("About to Expire", null);
	}

proj1 = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess1 = proj1.getSuccess();
if (projSuccess1 == true) {
	proj1 = proj1.getOutput();
	rnwCapId = proj1[0].getCapID();
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess != true) {
	reportName ="Vending Application";
	include("CMN;RUN_REPORT_NO_MSG");
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	reportName ="Vending Renew Application";
	include("CMN;RUN_REPORT_NO_MSG");
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	tempCapId = capId;
	capId = rnwCapId;
	closeTask("Intake", "Submitted", "This task was automatically closed because it was not needed.", "", "LICHDV");
	capId = tempCapId;
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	tempCapId = capId;
	capId = rnwCapId;
	closeTask("Closed", "Closed", "This task was automatically closed because it was not needed.", "", "LICHDV");
	capId = tempCapId;
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	updateAppStatus("Complete", "Renewal Complete", rnwCapId);
	}

if (wfTask =="Applicant Conference" && wfStatus == "No Follow Up Needed") {
	closeTask("Conference", "Not Needed", "This task was automatically closed because it was not needed.", "", "LICVENSUB");
	}

if (wfTask =="Applicant Conference" && wfStatus == "No Follow Up Needed") {
	closeTask("Inspection", "Not Needed", "This task was automatically closed because it was not needed.", "", "LICVENSUB");
	}

if (wfTask =="Insurance Review" && wfStatus == "Additional Info Required") {
	include("EML;Licenses!Vending!~!~;InsInfo");
	}

if (wfTask =="Insurance Review" && wfStatus == "Denied") {
	include("EML;Licenses!Vending!~!~;InsDeclined");
	}

if (wfTask =="Insurance Review" && wfStatus == "Insurance Not Attached") {
	include("EML;Licenses!Vending!~!~;InsNeeded");
	}

if (wfTask =="Health Dept. Notification" && wfStatus == "Additional Info Required") {
	include("EML;Licenses!Vending!~!~;InformHealth");
	}

if (wfTask =="Health Dept. Notification" && (wfStatus == "Approved" || wfStatus == "Failed")) {
	include("EML;Licenses!Vending!~!~;HealthComplete");
	}

if (projSuccess1 == true && wfTask =="Fee Review" && (wfStatus == "Create Fees Email" || wfStatus == "Create Fees No Email")) {
	include("CMN;Licenses!Vending!StreetVendor!Renewal;Fee");
	}

if (projSuccess1 != true && wfTask == "Fee Review" && (wfStatus == "Create Fees Email" || wfStatus == "Create Fees No Email")) {
	include("CMN;Licenses!Vending!StreetVendor!NA;Fee");
	}

if (wfTask =="Fee Review" && (wfStatus == "Create Fees Email" || wfStatus == "Email Only")) {
	include("EML;Licenses!Vending!~!~;FeesReady");
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	licEditExpInfo("Active", AInfo['APPLICANT TYPE.End Date']);
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	reportName = "Vending Business License";
	include("EML;Licenses!Vending!~!~;LicenseIssued");
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	reportName = "Vending Business License";
	include("CMN;RUN_REPORT_NO_MSG");
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	updateAppStatus("Active", "Updated due to license Issued", capId);
	}

if (wfTask =="License Issuance" && wfStatus == "Issued" && projSuccess1 == true) {
	r = aa.cap.getProjectByMasterID(capId, "Renewal", "Review").getOutput();
	r[0].setStatus("Complete");
	aa.cap.updateProject(r[0]);
	}

if (wfTask =="License Status" && wfStatus == "Ready to Renew") {
	aa.workflow.deleteAndAssignWorkflow(capId, "LICVEN", false);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	aa.workflow.deleteAndAssignWorkflow(capId, "LICVEN", false);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	licEditExpInfo("About to Expire", null);
	}

aa.sendEmail("whansen@cityofmadison.com", "jmoyer@cityofmadison.com", "jmoyer@cityofmadison.com",  "Test", "Test", "");
`^
WTUA;Licenses!Vending!TOSVOD!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
proj = aa.cap.getProjectByMasterID(capId, "Renewal", "Incomplete");
projSuccess = proj.getSuccess();
if (projSuccess == true) {
	proj = proj.getOutput();
	rnwCapId = proj[0].getCapID();
	aa.cap.updateRenewalCapStatus(capId, rnwCapId);
	licEditExpInfo("About to Expire", null);
	}

proj1 = aa.cap.getProjectByMasterID(capId, "Renewal", "Review");
projSuccess1 = proj1.getSuccess();
if (projSuccess1 == true) {
	proj1 = proj1.getOutput();
	rnwCapId = proj1[0].getCapID();
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess != true) {
	reportName ="TOSVOD Application";
	include("CMN;RUN_REPORT_NO_MSG");
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	reportName ="Vending Renew Application";
	include("CMN;RUN_REPORT_NO_MSG");
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	tempCapId = capId;
	capId = rnwCapId;
	closeTask("Intake", "Submitted", "This task was automatically closed because it was not needed.", "", "LICHDV");
	capId = tempCapId;
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	tempCapId = capId;
	capId = rnwCapId;
	closeTask("Closed", "Closed", "This task was automatically closed because it was not needed.", "", "LICHDV");
	capId = tempCapId;
	}

if (wfTask =="Intake" && wfStatus =="Submitted" && projSuccess == true) {
	updateAppStatus("Complete", "Renewal Complete", rnwCapId);
	}

if (projSuccess1 == true && wfTask =="Fee Review" && (wfStatus == "Create Fees Email" || wfStatus == "Create Fees No Email")) {
	include("CMN;Licenses!Vending!SidewalkCafe!Renewal;Fee");
	}

if (projSuccess1 != true && wfTask == "Fee Review" && (wfStatus == "Create Fees Email" || wfStatus == "Create Fees No Email")) {
	include("CMN;Licenses!Vending!TOSVOD!NA;Fee");
	}

if (wfTask =="Fee Review" && (wfStatus == "Create Fees Email" || wfStatus == "Email Only")) {
	include("EML;Licenses!Vending!~!~;FeesReady");
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	licEditExpInfo("Active", AInfo['APPLICANT TYPE.End Date']);
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	reportName = "Vending Business License";
	include("CMN;RUN_REPORT");
	}

if (wfTask =="License Issuance" && wfStatus == "Issued") {
	reportName = "Vending Business License";
	include("EML;Licenses!Vending!~!~;LicenseIssued");
	}

if (wfTask == "License Issuance" && wfStatus == "Issued") {
	updateTask("License Status", "Active", "Approved", "");
	updateAppStatus("Active");
	}

if (wfTask =="License Issuance" && wfStatus == "Issued" && projSuccess1 == true) {
	r = aa.cap.getProjectByMasterID(capId, "Renewal", "Review").getOutput();
	r[0].setStatus("Complete");
	aa.cap.updateProject(r[0]);
	}

if (wfTask =="License Status" && wfStatus == "Ready to Renew") {
	aa.workflow.deleteAndAssignWorkflow(capId, "LICVEN", false);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	aa.workflow.deleteAndAssignWorkflow(capId, "LICVEN", false);
	}

if (wfTask =="License Status" && wfStatus == "Ready to Renew") {
	licEditExpInfo("About to Expire", null);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	licEditExpInfo("About to Expire", null);
	}
`^
WTUA;Permitting!~!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
capClosed = false;
hasExpire = null;
if ((wfStatus == "Business Dissolved" || wfStatus == "Delinquent" || wfStatus == "Inactive")) {
	capClosed = true;
	}

result = aa.expiration.isExpiredLicenses(capId);
hasExpire = result.getErrorMessage();
if (capClosed && hasExpire != null) {
	licEditExpInfo("Inactive", null);
	}

if (capClosed) {
	include("CMN;AssignCapBlank");
	}

if (capClosed) {
	inspCancelAll();
	}
`^
WTUA;Permitting!Building!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (wfProcess.equals("BLDRAZE") && wfTask.equals("Permit Issuance") && wfStatus.equals("Issued")) {
	include("CMN;Permitting!Building!~!Raze;ProcessTimeLimit");
	}

include("CMN;Permitting!Building!~!~;ResubmitTimeLimit");
if ((appMatch("Permitting!Building!Commercial!NewConstruction") || appMatch("Permitting!Building!Industrial!NewConstruction")) && wfTask.equals("Intake") && wfStatus.equals("Package Submitted")) {
	include("CMN;Permitting!Building!~!NewConstruction;ShellOnlyFeeAdjustment");
	}

if (wfTask.equals("Intake") && wfStatus.equals("No Plan Review")) {
	closeTask("Plan Review","Not Required","No Plan Review at Intake","Plan Review Not Required");
	}

if (wfTask.equals("Intake") && wfStatus.equals("No Zoning Review")) {
	closeTask("Zoning Review","Not Required","No Zoning Review at Intake","Zoning Review Not Required");
	}

if ((wfProcess.equals("BLDCOMIND") || wfProcess.equals("BLDPERMIT") || wfProcess.equals("BLDPERMITDISTREV")) && wfTask.equals("Certificate of Occupancy") && wfStatus.equals("Issued")) {
	include("EML;ENCertOccupancyNotice");
	}
`^
WTUA;Permitting!Building!~!Construction^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (wfTask =="Permit Issuance" && wfStatus =="Issued") {
	reportName ="Building Permit 3";
	include("CMN;RUN_REPORT");
	include("CMN;AssignBldgInsp");
	}

if (wfTask =="Certificate of Occupancy" && wfStatus =="Certificate of Occupancy") {
	reportName ="Certificate of Occupancy";
	include("CMN;RUN_REPORT");
	}

if (wfTask =="Intake" && wfStatus =="No Zoning or Plan Review" && appMatch("Permitting!Building!RepairReplace!Construction")) {
	closeTask("Plan Review","Not Required","No Plan Review at Intake","Plan Review Not Required");
	closeTask("Zoning Review","Not Required","No Zoning Review at Intake","Zoning Review Not Required");
	}

if (AInfo['OCCUPANCY TYPE.First Certificate of Occupancy Requested - Enter 1'] != 1 && wfTask =="Permit Issuance" && wfStatus =="Issued") {
	closeTask("Fire Inspection","Not Required","No CoO requested","Not required because a Certification of Occuancy was not requested");
	}
`^
WTUA;Permitting!Building!~!New HVAC^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (wfTask =="Permit Issuance" && wfStatus =="Issued") {
	reportName ="HVAC Permit";
	include("CMN;RUN_REPORT");
	include("CMN;AssignHeatInsp");
	}
`^
WTUA;Permitting!Building!Commercial!EarlyStartProgram^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (wfTask =="Issuance" && wfStatus =="Issued") {
	reportName ="Early Start Permit";
	include("CMN;RUN_REPORT");
	}
`^
WTUA;Permitting!Building!Commercial!New Electrical^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (wfTask =="Permit Issuance" && wfStatus =="Issued") {
	reportName ="Electrical Permit";
	include("CMN;RUN_REPORT");
	include("CMN;AssignElecInsp");
	}
`^
WTUA;Permitting!Building!Commercial!New Plumbing^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (wfTask =="Permit Issuance" && wfStatus =="Issued") {
	reportName ="Plumbing Permit";
	include("CMN;RUN_REPORT");
	include("CMN;AssignPlumbInsp");
	}
`^
WTUA;Permitting!Building!Industrial!New Electrical^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (wfTask =="Permit Issuance" && wfStatus =="Issued") {
	reportName ="Electrical Permit";
	include("CMN;RUN_REPORT");
	include("CMN;AssignElecInsp");
	}
`^
WTUA;Permitting!Building!Industrial!New Plumbing^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (wfTask =="Permit Issuance" && wfStatus =="Issued") {
	reportName ="Plumbing Permit";
	include("CMN;RUN_REPORT");
	include("CMN;AssignPlumbInsp");
	}
`^
WTUA;Permitting!Building!Moving!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (wfProcess == "BLDMOVE" && wfTask == "Building Relocated" && wfStatus == "Complete") {
	include("CMN;Permitting!Building!Moving!~;CompletionNotification");
	}
`^
WTUA;Permitting!Building!RepairReplace!Construction^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
newIntakeStatus = "Pending Payment";
if (wfTask == "Intake") {
	include("CMN;CloseTasksHistoricLandmarkUrbanIfNA");
	}

if (wfTask.equals("Intake") && wfStatus.equals("No Plan Review") || wfStatus.equals("No Zoning or Plan Review")) {
	closeTask("Plan Review","Not Required","No Plan Review at Intake","Plan Review Not Required");
	}

if (wfTask.equals("Intake") && wfStatus.equals("No Zoning Review") || wfStatus.equals("No Zoning or Plan Review")) {
	closeTask("Zoning Review","Not Required","No Zoning Review at Intake","Zoning Review Not Required");
	}

if (wfTask == "Intake" && isTaskActive("Zoning Review") || isTaskActive("Plan Review") || isTaskActive("Local Historic Review") || isTaskActive("Urban Design Review") || isTaskActive("Landmark Review")) {
	newIntakeStatus = "Reviews in Process";
	}

if (wfTask == "Intake") {
	updateAppStatus(newIntakeStatus, newIntakeStatus);
	}

var dpcheck = parseInt(getAppSpecific("OFFICIAL USE ONLY.DPCheck"));
if (cap.isCreatedByACA() && dpcheck == 1 && (wfTask == "Zoning Review" || wfTask == ("Plan Review") || wfTask == "Local Historic Review" || wfTask == "Urban Design Review" || wfTask == "Landmark Review")) {
	include("CMN;Permitting!Building!RepairReplace!Construction;FeeACAReadyToPay");
	}
`^
WTUA;Permitting!Building!RepairReplace!Electrical^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (wfTask =="Permit Issuance" && wfStatus =="Issued") {
	reportName ="Electrical Permit";
	include("CMN;RUN_REPORT");
	include("CMN;AssignElecInsp");
	}
`^
WTUA;Permitting!Building!RepairReplace!HVAC^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask =="Permit Issuance" && wfStatus =="Issued") {
	reportName ="HVAC Permit";
	include("CMN;RUN_REPORT");
	include("CMN;AssignHeatInsp");
	}
`^
WTUA;Permitting!Building!RepairReplace!Plumbing^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (wfTask =="Permit Issuance" && wfStatus =="Issued") {
	reportName ="Plumbing Permit";
	include("CMN;RUN_REPORT");
	include("CMN;AssignPlumbInsp");
	}
`^
WTUA;Permitting!Building!Residential!Construction^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
newIntakeStatus = "Pending Payment";
if (wfTask == "Intake") {
	include("CMN;CloseTasksHistoricLandmarkUrbanIfNA");
	}

if (wfTask.equals("Intake") && wfStatus.equals("No Plan Review") || wfStatus.equals("No Zoning or Plan Review")) {
	closeTask("Plan Review","Not Required","No Plan Review at Intake","Plan Review Not Required");
	}

if (wfTask.equals("Intake") && wfStatus.equals("No Zoning Review") || wfStatus.equals("No Zoning or Plan Review")) {
	closeTask("Zoning Review","Not Required","No Zoning Review at Intake","Zoning Review Not Required");
	}

if (wfTask == "Intake" && isTaskActive("Zoning Review") || isTaskActive("Plan Review") || isTaskActive("Local Historic Review") || isTaskActive("Urban Design Review") || isTaskActive("Landmark Review")) {
	newIntakeStatus = "Reviews in Process";
	}

if (wfTask == "Intake") {
	updateAppStatus(newIntakeStatus, newIntakeStatus);
	}

var dpcheck = parseInt(getAppSpecific("OFFICIAL USE ONLY.DPCheck"));
if (cap.isCreatedByACA() && dpcheck == 1 && (wfTask == "Intake" || wfTask == "Zoning Review" || wfTask == ("Plan Review") || wfTask == "Local Historic Review" || wfTask == "Urban Design Review" || wfTask == "Landmark Review")) {
	include("CMN;Permitting!Building!Residential!Construction;FeeACAReadyToPay");
	}
`^
WTUA;Permitting!Building!Residential!EarlyStartProgram^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (wfTask =="Issuance" && wfStatus =="Issued") {
	reportName ="Early Start Permit";
	include("CMN;RUN_REPORT");
	}
`^
WTUA;Permitting!Building!Residential!New Electrical^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (wfTask =="Permit Issuance" && wfStatus =="Issued") {
	reportName ="Electrical Permit";
	include("CMN;RUN_REPORT");
	include("CMN;AssignElecInsp");
	}
`^
WTUA;Permitting!Building!Residential!New Plumbing^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (wfTask =="Permit Issuance" && wfStatus =="Issued") {
	reportName ="Plumbing Permit";
	include("CMN;RUN_REPORT");
	include("CMN;AssignPlumbInsp");
	}
`^
WTUA;Permitting!Building!TerraceRecyclingDumpster!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (wfTask =="Issuance" && wfStatus =="Issued") {
	reportName ="Dumpster Permit";
	include("CMN;RUN_REPORT");
	}
`^
WTUA;Permitting!Clerk!Picnic Beer!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Intake" && wfStatus == "Completed" && AInfo['GENERAL INFORMATION.Will the street be used?'] == "Yes") {
	activateTask("Street Use Process");
	deactivateTask("Reviews - No Street Use");
	}

if (wfTask == "Intake" && wfStatus == "Completed" && AInfo['GENERAL INFORMATION.Will the street be used?'] == "No") {
	activateTask("Reviews - No Street Use");
	deactivateTask("Street Use Process");
	}

if (wfProcess == "PERCLKBERSTREET") {
	include("CMN;Permitting!Clerk!Picnic Beer!NA;StreetProcess");
	}

if (wfProcess == "PERCLKBERNOSTREET" && allTasksComplete(wfProcess)) {
	include("CMN;Permitting!Clerk!Picnic Beer!NA;NoStreetProcess");
	}

if (wfProcess == "PERCLKBER" && wfTask =="Permit Issuance" && wfStatus =="Issued") {
	aa.set.add("CL LIC DAILY",capId);
	}
`^
WTUA;Permitting!Clerk!Solicitor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
var sWFStatus = "Police Review|" + wfStatus;
if (wfTask == "Intake" && wfStatus == "Submitted") {
	include("EML;Permitting!Clerk!Solicitor!~;PoliceBackgroundCheck");
	}

if (wfTask == "Police Review" && wfStatus == "Approved") {
	include("EML;Permitting!Clerk!Solicitor!~;PoliceBackgroundCheckApproved");
	}

if (wfTask == "Police Review" && wfStatus == "Captain Consultation") {
	include("EML;Permitting!Clerk!Solicitor!~;PoliceBackgroundCheckApproved");
	}

if (wfTask == "Police Review" && wfStatus == "Outstanding Warrants") {
	include("EML;Permitting!Clerk!Solicitor!~;PoliceBackgroundCheckApproved");
	}

if (wfTask == "Police Review" && wfStatus == "Not Required") {
	include("EML;Permitting!Clerk!Solicitor!~;PoliceBackgroundCheckApproved");
	}

if (wfTask == "Police Review" && wfStatus == "Pending Criminal Case") {
	include("EML;Permitting!Clerk!Solicitor!~;EmailTemplate");
	}

if (wfTask == "Police Review" && wfStatus == "Court Fees Past Due") {
	include("EML;Permitting!Clerk!Solicitor!~;EmailTemplate");
	}

if (wfTask == "Issuance" && wfStatus == "Issued") {
	include("CMN;Permitting!Clerk!~!~;PermitIssueActions");
	}
`^
WTUA;Permitting!Clerk!Solicitor!NoFee^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Intake" && wfStatus == "Submitted") {
	closeTask("Police Review","","Task not used for NoFee Solicitor","");
	}

if (wfTask == "Issuance" && wfStatus == "Issued") {
	include("CMN;Permitting!Clerk!~!~;PermitIssueActions");
	setTask("Police Review","N","N");
	}
`^
WTUA;Permitting!Clerk!Transient Merchant!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Intake" && wfStatus == "Submitted") {
	include("EML;Permitting!Clerk!Transient Merchant!NA;PoliceBackgroundCheck");
	}

if (wfTask == "Police Review" && wfStatus == "Approved") {
	include("EML;Permitting!Clerk!Transient Merchant!NA;PoliceBackgroundCheckApproved");
	}

if (wfTask == "Police Review" && wfStatus == "Captain Consultation") {
	include("EML;Permitting!Clerk!Transient Merchant!NA;PoliceBackgroundCheckApproved");
	}

if (wfTask == "Police Review" && wfStatus == "Not Required") {
	include("EML;Permitting!Clerk!Transient Merchant!NA;PoliceBackgroundCheckApproved");
	}

if (wfTask == "Police Review" && wfStatus == "Outstanding Warrants") {
	include("EML;Permitting!Clerk!Transient Merchant!NA;PoliceBackgroundCheckApproved");
	}

if (wfTask == "Issuance" && wfStatus == "Issued") {
	include("CMN;Permitting!Clerk!~!~;PermitIssueActions");
	}

if (wfTask == "Police Review" && wfStatus == "Pending Criminal Case") {
	include("EML;Permitting!Clerk!Transient Merchant!NA;EmailTemplate");
	}

if (wfTask == "Police Review" && wfStatus == "Court Fees Past Due") {
	include("EML;Permitting!Clerk!Transient Merchant!NA;EmailTemplate");
	}
`^
WTUA;Permitting!Engineering!Attach to Bridge!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!Attach to Bridge!~;Issued");
`^
WTUA;Permitting!Engineering!Attach to Bridge!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Engineering Review" && wfStatus == "Rejected") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}

if (wfTask == "Engineering Review" && wfStatus == "Withdrawn") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}

if (wfTask == "Inspection" && wfStatus == "Work Complete") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}
`^
WTUA;Permitting!Engineering!Erosion Control!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (wfTask =="Issuance" && wfStatus =="Issued") {
	reportName ="Erosion Control Permit";
	include("CMN;RUN_REPORT");
	}
`^
WTUA;Permitting!Engineering!Erosion Control!Inspection^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Review" && wfStatus == "Measures Correct") {
	closeTask("Closed");
	updateAppStatus("Closed","Inspection Acceptable");
	}

if (wfTask == "Review" && wfStatus == "Incomplete") {
	closeTask("Closed");
	updateAppStatus("Closed","Inspection Incomplete");
	}

if (wfTask == "Review" && wfStatus == "Failed") {
	closeTask("Closed");
	updateAppStatus("Closed","Inspection Failed");
	}
`^
WTUA;Permitting!Engineering!ROW!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
if (wfTask == "Issuance" && wfStatus == "Issued") {
	include("CMN;AddPermitToCustRowSet");
	}

if (wfTask == "Issuance" && wfStatus == "Issued") {
	include("EML;Permitting!Engineering!ROW!~;IssuanceEmail");
	}

if (wfTask == "Inspection" && wfStatus == "Completed") {
	closeTask("Inspection","Completed","Inspection Result","");
	include("EML;Permitting!Engineering!ROW!NA;Inspection");
	editTaskDueDate("Warranty Period",nextWorkDay(dateAdd(null,1095)));
	}

if (wfTask == "Inspection" && wfStatus == "Completed") {
	updateTask("Warranty Period", "Warranty Period", "This task was automatically updated because it is needed for a batch script.  ROWWarrantyExpire", "", "ENGROWEXC");
	}

if (wfTask == "Inspection" && wfStatus == "Complete - No Inspection") {
	closeTask("Inspection","Complete - No Inspection","Inspection Result","");
	include("EML;Permitting!Engineering!ROW!NA;Inspection");
	editTaskDueDate("Warranty Period",nextWorkDay(dateAdd(null,1095)));
	}

if (wfTask == "Inspection" && wfStatus == "Complete - No Inspection") {
	updateTask("Warranty Period", "Warranty Period", "This task was automatically updated because it is needed for a batch script.  ROWWarrantyExpire", "", "ENGROWEXC");
	}

if (wfTask == "Issuance" && wfStatus == "Issued") {
	assignCap("ENWJM");
	cd = aa.cap.getCapDetail(capId).getOutput().getCapDetailModel();
	capAsgnStaff = cd.getAsgnStaff();
	capAsgnDept = cd.getAsgnDept();
	}

if (wfTask == "Issuance" && wfStatus == "Issued") {
	include("CMN;invoiceAssessedFees");
	dtCompletion = AInfo['2 PROPOSED SCHEDULE.Estimated Completion Date'];
	scheduleInspectDateGroup("ROWINSP","Initial",nextWorkDay(dateAdd(dtCompletion, 7)), capAsgnStaff);
	}
`^
WTUA;Permitting!Engineering!Sewer Addition Meter!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
createWO = false;
currTask = wfTask;
if (wfTask == "Intake" && wfStatus == "Application Accepted" && (balanceDue == 0)) {
	createWO = true;
	activateTask("Inspection");
	assignTask("Inspection", "WUATJ");
	activateTask("Installation");
	}

if (createWO == true) {
	woCategory = "Addition";
	include("CMN;Permitting!Engineering!~!NA;createWO");
	}

if (createWO == true) {
	include("EML;Permitting!Engineering!~!NA;SewerMeterPermit");
	}

if (wfTask == "Inspection" && wfStatus == "Completed") {
	deactivateTask("Inspection");
	}

if (wfTask == "Installation" && wfStatus == "Completed") {
	deactivateTask("Installation");
	}

if ((currTask == "Inspection" || currTask == "Installation") && (isTaskStatus("Inspection", "Completed") && isTaskStatus("Installation", "Completed"))) {
	activateTask("Closed");
	}
`^
WTUA;Permitting!Engineering!Sewer Deduct Meter!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
createWO = false;
currTask = wfTask;
if (wfTask == "Intake" && wfStatus == "Application Accepted") {
	createWO = true;
	activateTask("Inspection");
	assignTask("Inspection", "WUATJ");
	activateTask("Installation");
	}

if (createWO == true) {
	woCategory = "Deduct";
	include("CMN;Permitting!Engineering!~!NA;createWO");
	}

if (createWO == true) {
	include("EML;Permitting!Engineering!~!NA;SewerMeterPermit");
	}

if (wfTask == "Inspection" && wfStatus == "Completed") {
	deactivateTask("Inspection");
	}

if (wfTask == "Installation" && wfStatus == "Completed") {
	deactivateTask("Installation");
	}

if ((currTask == "Inspection" || currTask == "Installation") && (isTaskStatus("Inspection", "Completed") && isTaskStatus("Installation", "Completed"))) {
	activateTask("Closed");
	}
`^
WTUA;Permitting!Engineering!Sewer Plug!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!Sewer Plug!NA;GetCounts");
if (wfTask == "Review" && wfStatus == "Complete" && varTotAll > 0) {
	include("CMN;Permitting!Engineering!Sewer Plug!NA;Fee");
	}

if (!publicUser && wfTask == "Review" && wfStatus == "Complete" && varTotAll > 0) {
	include("EML;Permitting!Engineering!Sewer Plug!NA;ProcessFees");
	}

if (wfTask == "Lining Complete" && wfStatus == "Completed") {
	include("EML;Permitting!Engineering!Sewer Plug!NA;ProcessRefund");
	}

if (wfTask == "Lining Complete" && wfStatus == "Completed") {
	include("EML;Permitting!Engineering!Sewer Plug!NA;EmailForCIP");
	}

if (wfTask  == "Inspection" && varTotNumPerms == 0) {
	closeTask("Lining Complete", "Not Required", "WTUA Scripting");
	closeTask("Mapping", "Not Required", "WTUA Scripting");
	}

if (wfTask  == "Inspection" && varNumPermSans > 0) {
	include("EML;Permitting!Engineering!Sewer Plug!NA;EmailForCIP");
	}

if (((isTaskStatus("Mapping","Completed") || isTaskStatus("Mapping","Not Required")) && isTaskStatus("Closeout","Completed"))) {
	updateAppStatus("Closed","Closed");
	}
`^
WTUA;Permitting!Engineering!StormWaterManagement!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask =="Issuance" && wfStatus =="Issued") {
	reportName ="Storm Water Permit";
	include("CMN;RUN_REPORT");
	}

include("CMN;Permitting!Engineering!StormWaterManagement!~;Inspection");
`^
WTUA;Permitting!Engineering!Temporary Sign!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Internal Review" && wfStatus == "Withdrawn") {
	closeTask("Closed");
	updateAppStatus("Closed","Withdrawn");
	}

if (wfTask == "Inspection" && wfStatus == "Removed") {
	closeTask("Closed");
	updateAppStatus("Closed","Closed");
	}
`^
WTUA;Permitting!Engineering!TemporarySign!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Engineering!TemporarySign!~;FutureInsp");
`^
WTUA;Permitting!Fire!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if ((appMatch("Permitting!Fire!Alarm!NA") || appMatch("Permitting!Fire!AltFireSuppression!NA") || appMatch("Permitting!Fire!ControlledEgress!NA") || appMatch("Permitting!Fire!FireCommandCenter!NA") || appMatch("Permitting!Fire!KitchenHood!NA") || appMatch("Permitting!Fire!SmokeControlPanels!NA") || appMatch("Permitting!Fire!SmokeHeatVents!NA") || appMatch("Permitting!Fire!Sprinkler!NA") || appMatch("Permitting!Fire!Standpipe!NA") || appMatch("Permitting!Fire!HighPiledStorage!NA")) && (wfTask == "Intake" || wfTask == "Plan Review") && wfStatus == "Additional Info Required") {
	addFee("FIRSTCH","FIRSPRNK","FINAL",1,"N");
	}

if (validateGisObjects() == undefined) {
	copyParcelGisObjects();
	}

if (validateGisObjects() && wfTask == "Plan Review" && wfStatus == "Approved") {
	var varInsp = getGISInfo("agis_madison","Fire Inspect Dist","UserID");
	if(varInsp != undefined) assignTask("Inspection",varInsp.toUpperCase());
	if(varInsp != undefined) assignTask("Fire Inspection",varInsp.toUpperCase());
	if(varInsp != undefined) userId = varInsp.toUpperCase();
	if(varInsp != undefined) assignCap(varInsp.toUpperCase());
	}

if ((wfTask == "Plan Review") && wfStatus == "Approved" && appMatch("Permitting!Fire!Alarm!NA") && (AInfo['PROJECT INFORMATION.State Approved Plans?'] == "CHECKED" || AInfo['PROJECT INFORMATION.New DACT Only?'] == "CHECKED" || AInfo['PROJECT INFORMATION.Project Area'] > 0)) {
	var varInsp = getGISInfo("agis_madison","Fire Inspect Dist","UserID");
	if(varInsp != undefined) assignTask("Fire Inspection",varInsp.toUpperCase());
	if(varInsp != undefined) userId = varInsp.toUpperCase();
	if(varInsp != undefined) assignCap(varInsp.toUpperCase());
	}

if ((wfTask == "Plan Review") && wfStatus == "Approved" && appMatch("Permitting!Fire!SmokeControlPanels!NA") && (AInfo['SCOPE OF WORK.New Smoke Control Panel - Enter 1'] > 0)) {
	var varInsp = getGISInfo("agis_madison","Fire Inspect Dist","UserID");
	if(varInsp != undefined) assignTask("Fire Inspection",varInsp.toUpperCase());
	if(varInsp != undefined) userId = varInsp.toUpperCase();
	if(varInsp != undefined) assignCap(varInsp.toUpperCase());
	}

if ((wfTask == "Plan Review") && wfStatus == "Approved" && appMatch("Permitting!Fire!FireCommandCenter!NA") && (AInfo['PROJECT INFORMATION.New Fire Command Center - Enter 1'] > 0)) {
	var varInsp = getGISInfo("agis_madison","Fire Inspect Dist","UserID");
	if(varInsp != undefined) assignTask("Fire Inspection",varInsp.toUpperCase());
	if(varInsp != undefined) userId = varInsp.toUpperCase();
	if(varInsp != undefined) assignCap(varInsp.toUpperCase());
	}

if ((wfTask == "Plan Review") && wfStatus == "Approved" && appMatch("Permitting!Fire!ControlledEgress!NA") && (AInfo['SCOPE OF WORK.New Controlled Egress - Enter 1'] > 0)) {
	var varInsp = getGISInfo("agis_madison","Fire Inspect Dist","UserID");
	if(varInsp != undefined) assignTask("Fire Inspection",varInsp.toUpperCase());
	if(varInsp != undefined) userId = varInsp.toUpperCase();
	if(varInsp != undefined) assignCap(varInsp.toUpperCase());
	}

if ((wfTask == "Plan Review") && wfStatus == "Approved" && appMatch("Permitting!Fire!KitchenHood!NA") && (AInfo['SCOPE OF WORK.New Kitchen Hood Extinguishing System - Enter 1'] > 0)) {
	var varInsp = getGISInfo("agis_madison","Fire Inspect Dist","UserID");
	if(varInsp != undefined) assignTask("Fire Inspection",varInsp.toUpperCase());
	if(varInsp != undefined) userId = varInsp.toUpperCase();
	if(varInsp != undefined) assignCap(varInsp.toUpperCase());
	}

if ((wfTask == "Plan Review") && wfStatus == "Approved" && appMatch("Permitting!Fire!AltFireSuppression!NA") && (AInfo['SCOPE OF WORK.New Alternate Fire Suppression System - Enter 1'] > 0)) {
	var varInsp = getGISInfo("agis_madison","Fire Inspect Dist","UserID");
	if(varInsp != undefined) assignTask("Fire Inspection",varInsp.toUpperCase());
	if(varInsp != undefined) userId = varInsp.toUpperCase();
	if(varInsp != undefined) assignCap(varInsp.toUpperCase());
	}

if ((wfTask == "Plan Review") && wfStatus == "Approved" && appMatch("Permitting!Fire!Standpipe!NA") && (AInfo['SCOPE OF WORK.New Standpipe Project - Enter 1'] > 0)) {
	var varInsp = getGISInfo("agis_madison","Fire Inspect Dist","UserID");
	if(varInsp != undefined) assignTask("Fire Inspection",varInsp.toUpperCase());
	if(varInsp != undefined) userId = varInsp.toUpperCase();
	if(varInsp != undefined) assignCap(varInsp.toUpperCase());
	}

if ((wfTask == "Plan Review") && wfStatus == "Approved" && appMatch("Permitting!Fire!SmokeHeatVents!NA") && (AInfo['SCOPE OF WORK.New Smoke and Heat Vent - Enter 1'] > 0)) {
	var varInsp = getGISInfo("agis_madison","Fire Inspect Dist","UserID");
	if(varInsp != undefined) assignTask("Fire Inspection",varInsp.toUpperCase());
	if(varInsp != undefined) userId = varInsp.toUpperCase();
	if(varInsp != undefined) assignCap(varInsp.toUpperCase());
	}

if ((wfTask == "Plan Review") && wfStatus == "Approved" && appMatch("Permitting!Fire!Sprinkler!NA") && (AInfo['PROJECT INFORMATION.State Approved Plans'] == "CHECKED" || AInfo['PROJECT INFORMATION.New Backflow Prevention Valve'] == "CHECKED" || AInfo['PROJECT INFORMATION.New Fire Pump'] == "CHECKED" || AInfo['PROJECT INFORMATION.Project Area'] > 0 ||  AInfo['PROJECT INFORMATION.Private Fire Hydrant!Main'] == "CHECKED" )) {
	var varInsp = getGISInfo("agis_madison","Fire Inspect Dist","UserID");
	if(varInsp != undefined) assignTask("Fire Inspection",varInsp.toUpperCase());
	if(varInsp != undefined) userId = varInsp.toUpperCase();
	if(varInsp != undefined) assignCap(varInsp.toUpperCase());
	}

if (validateGisObjects() && wfTask == "Plan Review" && wfStatus == "Approved") {
	if(varInsp != undefined) include("EML;AssignInspectorNoASI");
	}

if (isTaskActive("Plan Review") == true && !appMatch("Permitting!Fire!Elevator!NA")) {
	include("CMN;Permitting!Fire!~!~;PlanReviewAutoAssign");
	}

if (isTaskActive("Plan Review") == true) {
	editTaskDueDate("~",dateAdd(null,5));
	}

if (isTaskActive("Intake") == true) {
	editTaskDueDate("~",dateAdd(null,3));
	}
`^
WTUA;Permitting!Fire!Alarm!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfStatus == "Additional Info Required") {
	include("EML;Permitting!Fire!~!~;AdditionalInfo");
	}

if (wfTask == "Intake" && wfStatus == "Send Fees Invoiced eMail") {
	include("EML;Permitting!Fire!~!~;FeeACAReadyToPay");
	updateAppStatus("Payment Pending");
	}

if (wfTask == "Plan Review" && wfStatus == "Approved") {
	include("EML;Permitting!Fire!~!~;IssuanceEmail");
	}
`^
WTUA;Permitting!Fire!AltFireSuppression!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfStatus == "Additional Info Required") {
	include("EML;Permitting!Fire!~!~;AdditionalInfo");
	}

if (wfTask == "Intake" && wfStatus == "Send Fees Invoiced eMail") {
	include("EML;Permitting!Fire!~!~;FeeACAReadyToPay");
	updateAppStatus("Payment Pending");
	}

if (wfTask == "Plan Review" && wfStatus == "Approved") {
	include("EML;Permitting!Fire!~!~;IssuanceEmail");
	}

if (currentUserID == "ITJBS") {
	showDebug = true;
	}
`^
WTUA;Permitting!Fire!ControlledEgress!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfStatus == "Additional Info Required") {
	include("EML;Permitting!Fire!~!~;AdditionalInfo");
	}

if (wfTask == "Intake" && wfStatus == "Send Fees Invoiced eMail") {
	include("EML;Permitting!Fire!~!~;FeeACAReadyToPay");
	updateAppStatus("Payment Pending");
	}

if (wfTask == "Intake" && wfStatus == "Payment Rec'd; Plan Pending"; updateAppStatus("Payment rec’d, Pending Plan Submittal", "Updated due to payment received");) {
	}

if (wfTask == "Plan Review" && wfStatus == "Approved") {
	include("EML;Permitting!Fire!~!~;IssuanceEmail");
	}
`^
WTUA;Permitting!Fire!Elevator!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Fire!Elevator!~;PTOIssued");
`^
WTUA;Permitting!Fire!Elevator!PeriodicTest^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (wfTask == "Reinspection" && wfStatus != "Corrected") {
	childId = createChild("Enforcement","Fire","Elevator","NA",capName);
	holdId = capId;
	capId = childId;
	copyParcelGisObjects();
	capId = holdId;
	closeTask("Reinspection","Closed","Closed and enforcement CAP created",wfNote);
	closeTask("Closed","Closed","Closed and enforcement CAP created",wfNote);
	}
`^
WTUA;Permitting!Fire!KitchenHood!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfStatus == "Additional Info Required") {
	include("EML;Permitting!Fire!~!~;AdditionalInfo");
	}

if (wfTask == "Intake" && wfStatus == "Send Fees Invoiced eMail") {
	include("EML;Permitting!Fire!~!~;FeeACAReadyToPay");
	updateAppStatus("Payment Pending");
	}

if (wfTask == "Plan Review" && wfStatus == "Approved") {
	include("EML;Permitting!Fire!~!~;IssuanceEmail");
	}
`^
WTUA;Permitting!Fire!Sprinkler!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
if (wfStatus == "Additional Info Required") {
	include("EML;Permitting!Fire!~!~;AdditionalInfo");
	}

if (wfTask == "Intake" && wfStatus == "Send Fees Invoiced eMail") {
	include("EML;Permitting!Fire!~!~;FeeACAReadyToPay");
	updateAppStatus("Payment Pending");
	}

if (wfTask == "Plan Review" && wfStatus == "Approved") {
	include("EML;Permitting!Fire!~!~;IssuanceEmail");
	}
`^
WTUA;Permitting!Health!POWTS!Holding Tank^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
parentCapId = getParent();
if (wfTask == "Application Acceptance" && wfStatus == "Accepted") {
	closeTask("Closed","Closed","Closed via WTUA script","");
	updateAppStatus("Closed","Closed via WTUA script");
	}

if (wfTask == "Application Acceptance" && wfStatus == "Needs Attention" && parentCapId != false) {
	updateAppStatus("Malfunctioning System","", parentCapId);
	}
`^
WTUA;Permitting!Health!POWTS!Old Sanitary^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if ((isTaskActive("Operational") || isTaskActive("Closed") || isTaskStatus("Closed","Closed"))) {
	include("CMN;AssignCapBlank");
	}
`^
WTUA;Permitting!Health!POWTS!Sanitary^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
oTaskStatusHist = null;
var aryTasks = null;
var oPermitIssueTask = null;
var iPermitIssueCnt = 0;
var sPrevIssueDt = "";
var sPrevIssueDtFormatted = "";
var bRenew = false;
if ((wfTask == "Inspection" && wfStatus == "Repair!Reconnection!Upgrade Complete")) {
	activateTask("Closed");
	updateAppStatus("Closed","Updated via Script");
	}

if ((wfTask == "Inspection" && wfStatus == "Approved")) {
	var dtStatus = new Date(taskStatusDate("Inspection"));
	var sMonth = (dtStatus.getMonth() + 1) + "";
	var sYear = (dtStatus.getFullYear() + 3) + "";
	var sTAMDueDate = sMonth + "!1!" + sYear;
	editAppSpecific("OFFICE USE ONLY.Date TAM Due", sTAMDueDate);
	updateTask("Operational","System in Compliance","","");
	updateAppStatus("System in Compliance", "Updated via WTUA script.");
	}

if ((wfTask == "Operational" && wfStatus == "WI Fund Application Filed")) {
	include("CMN;Permitting!Health!POWTS!Sanitary;WIFundAppFee");
	}

if ((isTaskActive("Operational") || isTaskActive("Closed") || isTaskStatus("Closed","Closed"))) {
	include("CMN;AssignCapBlank");
	}

if ((wfTask == "Intake")) {
	dtStatus = new Date(taskStatusDate("Intake"));
	sTAMDueDate = dateAddMonths(dtStatus,1,"Y");
	editAppSpecific("OFFICE USE ONLY.Date TAM Due", sTAMDueDate);
	}

if (wfTask == "Inspection" && (wfStatus == "Transfer - Plumber" || wfStatus == "Transfer - Owner")) {
	setTask("Inspection","N","N");
	activateTask("Sanitarian Review");
	editAppSpecific("TYPE OF PERMIT.Change of " + wfStatus.slice(11), "CHECKED");
	}

if (wfTask == "Inspection" && wfStatus == "Renewal of Permit") {
	setTask(wfTask,"N","N");
	activateTask("Agent Review");
	if(feeExists("PRBEHMDC") == false) addFee("PRBEHMDC","PERPOWTS","FINAL",1,"N");
	}

if (wfTask == "Inspection" && wfStatus == "Revision Required!Requested") {
	setTask(wfTask,"N","N");
	activateTask("Agent Review");
	}

if (wfTask == "Permit Issuance" && wfStatus == "Issued") {
	aTaskStatuses = new Array();
	iCnt = -1;
	}

if (wfTask == "Permit Issuance" && wfStatus == "Issued") {
	oTaskStatusHist = aa.workflow.getHistory(capId).getOutput();
	}

if (wfTask == "Permit Issuance" && wfStatus == "Issued" && oTaskStatusHist.length > 0) {
	for(item in oTaskStatusHist) if(oTaskStatusHist[item].taskDescription == "Inspection")  include("CMN;LoadTaskStatusHistory");
	}

if (wfTask == "Permit Issuance" && wfStatus == "Issued" && aTaskStatuses.length > 0) {
	if(aTaskStatuses[0] == "Renewal of Permit") bRenew = true;
	}

if (wfTask == "Permit Issuance" && wfStatus == "Issued") {
	oPermitIssueTask = aa.workflow.getWorkflowHistory(capId,"Permit Issuance",null).getOutput();
	}

if (wfTask == "Permit Issuance" && wfStatus == "Issued" && oPermitIssueTask != null) {
	iPermitIssueCnt = oPermitIssueTask.length;
	}

if (wfTask == "Permit Issuance" && wfStatus == "Issued" && iPermitIssueCnt > 1) {
	sPrevIssueDt = oPermitIssueTask[iPermitIssueCnt - 2].statusDate;
	sPrevIssueDtFormatted = sPrevIssueDt.toString().slice(5,7) + "!" + sPrevIssueDt.toString().slice(8,10) + "!" + sPrevIssueDt.toString().slice(0,4);
	}

if (wfTask == "Permit Issuance" && wfStatus == "Issued" && sPrevIssueDtFormatted != null &&  sPrevIssueDtFormatted != "") {
	editAppSpecific("TYPE OF PERMIT.Date Previous Permit Issued", sPrevIssueDtFormatted);
	editAppSpecific("TYPE OF PERMIT.List Previous Permit Number", capIDString);
	}

if (wfTask == "Permit Issuance" && wfStatus == "Issued" && (iPermitIssueCnt == 1 || bRenew == true)) {
	editAppSpecific("OFFICE USE ONLY.Permit Expiration Date", dateAddMonths(wfDateMMDDYYYY,24));
	}

debugObject(wfTaskObj.getTaskItem());
showDebug = true;
`^
WTUA;Permitting!Health!POWTS!Soil Study^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Issue SSR" && wfStatus == 'Issued') {
	closeTask("Closed","Closed","","");
	}

if ((isTaskStatus("Closed","Closed") || isTaskActive("Closed"))) {
	include("CMN;AssignCapBlank");
	}
`^
WTUA;Permitting!Health!POWTS!TAM^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
var bSanStatusCorpCounsel = false;
var bSanStatusSysCompliance = false;
parentCapId = getParent();
var intDiff = 0;
if (parentCapId != false) {
	holdID = capId;
	capId = parentCapId;
	}

if (parentCapId != false && isTaskActive("Operational","PERPOWTS") && isTaskStatus("Operational","Referral to Corp Counsel","PERPOWTS")) {
	bSanStatusCorpCounsel = true;
	}

if (parentCapId != false) {
	capId = holdID;
	}

if (parentCapId != false) {
	var dtTAM = new Date(getAppSpecific("OFFICE USE ONLY.Date TAM Due",parentCapId));
	var dtWork = new Date(AInfo['INSPECTION RESULTS.Date Serviced']);
	var intDiff = Math.ceil(dtTAM.getTime() - dtWork.getTime())!86400000;
	comment(intDiff);
	}

if (parentCapId != false) {
	var sMonthWork = (dtWork.getMonth() + 1) + "";
	var sYearWork = (dtWork.getFullYear() + 3) + "";
	var sNewTAMDueWork = sMonthWork + "!1!" + sYearWork;
	}

if (parentCapId != false) {
	var sMonthTAM = (dtTAM.getMonth() + 1) + "";
	var sYearTAM = (dtTAM.getFullYear() + 3) + "";
	var sNewTAMDueOldTAM = sMonthTAM + "!1!" + sYearTAM;
	}

if (parentCapId != false && (wfTask == "Application Acceptance" && wfStatus == "Accepted") && (intDiff < -180 || intDiff > 180)) {
	editAppSpecific("OFFICE USE ONLY.Date TAM Due", sNewTAMDueWork, parentCapId);
	updateTask("Operational", "System in Compliance", "Updated via TAM WTUA", "", "PERPOWTS", parentCapId);
	updateAppStatus("System in Compliance", "", parentCapId);
	bSanStatusSysCompliance = true;
	}

if (parentCapId != false && (wfTask == "Application Acceptance" && wfStatus == "Accepted") && (intDiff >= -180 && intDiff <= 180)) {
	editAppSpecific("OFFICE USE ONLY.Date TAM Due", sNewTAMDueOldTAM, parentCapId);
	updateTask("Operational", "System in Compliance", "Updated via TAM WTUA", "", "PERPOWTS", parentCapId);
	updateAppStatus("System in Compliance", "", parentCapId);
	bSanStatusSysCompliance = true;
	}

if (wfTask == "Application Acceptance" && wfStatus == "Accepted") {
	closeTask("Closed","Closed","Closed via WTUA script","");
	updateAppStatus("Closed","Closed via WTUA script");
	}

if (bSanStatusCorpCounsel == true && bSanStatusSysCompliance == true) {
	include("EML;Permitting!Health!POWTS!TAM;NotifyCorpCounselToCompliance");
	}
`^
WTUA;Permitting!Health!Temp Food Establishment!Dane County Restaurant^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Review" && (wfStatus == "Approved" || wfStatus == "Approved - Email") && balanceDue == 0) {
	closeTask("Closed","Closed","Closed via script","");
	}

if (wfStatus == "Approved - Email") {
	include("EML;Permitting!Health!TempFoodIssued");
	}
`^
WTUA;Permitting!Health!TNC Well!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Sampling" && ( wfStatus == "Complete - NO3 Confirm" || wfStatus == "Complete - Routine")) {
	addFee("SAMPLE","HETNC","FINAL",1,"N");
	}

if (wfTask == "Inactive" && wfStatus == "Abandoned") {
	updateAppStatus("Abandoned","Closed via WTUA script");
	closeTask("Closed");
	}
`^
WTUA;Permitting!Health!Well!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (wfTask == "Review" && wfStatus == "Denied") {
	updateTask("Closed","Closed","","");
	updateAppStatus("Application Denied","Updated via WTUA script.");
	}

if (wfTask == "Review" && wfStatus == "Withdrawn") {
	updateTask("Closed","Closed","","");
	updateAppStatus("Application Withdrawn","Updated via WTUA script.");
	}

if (wfTask == "Inspection" && (wfStatus == "Complete" || wfStatus == "Not Inspected")) {
	updateTask("Operational","Active","","");
	}

if (wfTask == "Inspection" && wfStatus == "Expired") {
	updateTask("Closed","Closed","","");
	updateAppStatus("Permit Expired","Updated via WTUA script.");
	}

if (wfTask == "Operational" && wfStatus == "Abandoned") {
	updateTask("Closed","Closed","","");
	updateAppStatus("Abandoned","Updated via WTUA script.");
	}

if (wfTask == "Operational" && wfStatus == "Orders Issued") {
	reportName ="Unused Well Order";
	include("CMN;RUN_REPORT");
	}

if (wfTask == "Intake" && wfStatus == "Add'l Info Req'd") {
	include("EML;Permitting!Health!Well!NA;AdditionalInfo");
	}

if (wfTask == "Intake" &&  wfStatus == "Complete") {
	include("EML;Permitting!Health!Well!NA;Complete");
	}

if (wfTask == "Issuance" && wfStatus == "Issued") {
	var numWellsTBA = getAppSpecific("APPLICATION INFORMATION.Number of unsafe, unused or noncomplying wells to be abandoned");
	if (numWellsTBA > 0) reportName ="Unused Well Notice - New Well";
	if (numWellsTBA > 0) include("CMN;RUN_REPORT");
	}

if (wfTask == "Review" && wfStatus == "Approved") {
	include("EML;Permitting!Health!Well!NA;Approved");
	}

if (wfTask == "Review" && wfStatus == "Add'l Info Req'd") {
	include("EML;Permitting!Health!Well!NA;ReviewAdditionalInfo");
	}

if (wfTask == "Operational" && wfStatus == "Non-compliant") {
	reportName ="Unused Well Notice Misc Inspection";
	include("CMN;RUN_REPORT");
	}

if (wfTask == "Closed" || (wfTask == "Operational" && wfStatus == "Abandoned" )) {
	closeTask("Closed","Closed","Closed via WTUA script","");
	updateAppStatus("Closed","Closed via WTUA script");
	}

if ((isTaskActive("Operational") || isTaskActive("Closed") || isTaskStatus("Closed","Closed"))) {
	include("CMN;AssignCapBlank");
	}
`^
WTUA;Permitting!Land Management!Privilege In Streets!Privilege In Streets^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (wfProcess == "LMPRINST" && wfTask == "Letter to Applicant" && wfStatus == "Sent") {
	include("CMN;Permitting!LandManagement!Privilege In Streets!Privilege In Streets;NotifyEngineering");
	}
`^
WTUA;Permitting!Miscellaneous!Edible Landscape!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
reportFile = "";
reportName = "";
contactEmail = "";
if (wfStatus == "Additional Info Required") {
	emailSubject = "Additional Information Needed for Edible Landscape Permit Application";
	}

if (wfStatus == "Approved") {
	emailSubject = "Edible Landscape Permit Application Approved";
	}

include("EML;GetContactEmail");
contactFullName = contactFName + " " + contactLName;
emailText = "<html><body><p>Hello " + contactFullName + ",<!p>";
if (wfStatus == "Additional Info Required") {
	emailText += "Additional Information is required in order to continue processing your Edible Landscape Permit Application.<br><br>";
	}

if (wfStatus == "Approved") {
	reportName = "Edible Landscape Permit";
	emailText += "Your Edible Landscape Permit Application has been approved.<br><br>";
	}

if (reportName != "") {
	include("CMN;Vending_Store_Report_To_Disk");
	}

include("EML;AddressInformation");
if (wfComment != null) {
	emailText = emailText + "Comments; " + wfComment + "<br>";
	}

if (wfTask == "Parks Review") {
	emailText = emailText + "<br>Thank you. Please contact Kay Rutledge with any questions at; 266-4711 or <a href='mailto;krutledge@cityofmadison.com?subject='Edible Landscape Permit Application'''>krutledge@cityofmadison.com<!a>";
	}

if (wfTask == "City Engineering Review") {
	emailText = emailText + "<br>Thank you. Please contact Christy Bachmann with any questions at; 266-4095 or <a href='mailto;cbachmann@cityofmadison.com?subject='Edible Landscape Permit Application'''>cbachmann@cityofmadison.com<!a>";
	}

if (wfTask == "CDA Review") {
	emailText = emailText + "<br>Thank you. Please contact Natalie Erdman with any questions at; 267-1992 or <a href='mailto;krutledge@cityofmadison.com?subject='Edible Landscape Permit Application'''>krutledge@cityofmadison.com<!a>";
	}

if (wfTask == "Water Utility Review") {
	emailText = emailText + "<br>Thank you. Please contact Amy Barrilleaux with any questions at; 266-9129 or <a href='mailto;@abarrilleaux@cityofmadison.com?subject='Edible Landscape Permit Application'''>abarrilleaux@cityofmadison.com<!a>";
	}

if (wfTask == "Other Property Review") {
	emailText = emailText + "<br>Thank you. Please contact George Reistad with any questions at; 608-266-4611 or <a href='mailto;greistad@cityofmadison.com?subject='Edible Landscape Permit Application'''>GReistad@cityofmadison.com<!a>";
	}

if (contactEmail != "") {
	aa.sendEmail("noreplyDEV@cityofmadison.com", "elamsupport@cityofmadison.com", "", emailSubject, emailText, reportFile);
	}

if (reportName != "") {
	contactDetails = contactFullName + "<br>" + "Email; " + contactEmail;
	emailText = "";
	include("EML;AddressInformation");
	contactText = emailText;
	}

if (reportName != "") {
	include("EML;Permitting!Miscellaneous!Edible Landscape!NA;AlderPerson");
	}

if (proximityToAttribute("agis_madison","Planning Parcels",5,"feet","LU3_1_DESC","Residential")) {
	addAppCondition("LANDMARK SITE","APPLIED"," Landmark Site","This Property is a landmark","Notice");
	}
`^
WTUA;Permitting!Parking!Residential Parking!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
include("CMN;Permitting!Parking!Residential Parking!~;SetRenewalInfo");
`^
WTUA;Permitting!Parking!Residential Parking!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Issuance" && (wfStatus == "Temporary" || wfStatus == "Issued") && AInfo['Expiration Date'] != null  && AInfo['Expiration Date'] != "") {
	editAppSpecific("OFFICE USE ONLY.Permit Expiration Date", AInfo['Expiration Date']);
	}

if (wfTask == "Issuance" && (wfStatus == "Temporary" || wfStatus == "Issued") && AInfo['Permit Number Issued'] != null && AInfo['Permit Number Issued'] != "") {
	editAppSpecific("OFFICE USE ONLY.Permit Number Issued", AInfo['Permit Number Issued']);
	}

if (wfTask == "Issuance" && wfStatus == "Issued") {
	updateTask("License Status", "Active", "WTUA script", "");
	updateAppStatus("Active");
	licEditExpInfo("Active", getAppSpecific("OFFICE USE ONLY.Permit Expiration Date"));
	}

if (wfTask == "Issuance" && wfStatus == "Temporary") {
	updateTask("License Status", "Temporary Permit Active", "WTUA script", "");
	updateAppStatus("Temporary Permit Active");
	licEditExpInfo("Active", getAppSpecific("OFFICE USE ONLY.Permit Expiration Date"));
	}

if (cap.isCreatedByACA() && wfTask == "Intake" && (wfStatus == "Excluded Address" || wfStatus == "Ineligible Vehicle" || wfStatus == "Outstanding Tickets" || wfStatus == "Pending Sticker Return" || wfStatus == "Invalid Lease" || wfStatus == "Expired Vehicle Registration")) {
	include("EML;Permitting!Parking!Residential Parking!NA;ACA");
	}

if (cap.isCreatedByACA() && wfTask == "Issuance" && wfStatus == "Issued") {
	include("EML;Permitting!Parking!Residential Parking!NA;ACA");
	}

if (wfTask == "Issuance" && wfStatus == "Temporary") {
	reportName = "Temp Parking Permit";
	include("CMN;RUN_REPORT");
	showMessage = false;
	}

if (cap.isCreatedByACA() && wfTask == "Issuance" && wfStatus == "Temporary") {
	include("EML;Permitting!Parking!Residential Parking!NA;ACA");
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	licEditExpInfo("About to Expire", null);
	}
`^
WTUA;Permitting!Parking!Residential Parking!Renewal^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask =="Intake" && wfStatus == "Approved") {
	proj1 = aa.cap.getProjectByChildCapID(capId, "Renewal", "Review");
	projSuccess1 = proj1.getSuccess();
	}

if (wfTask =="Intake" && wfStatus == "Approved" && projSuccess1 == true) {
	proj1 = proj1.getOutput();
	parentCapId = proj1[0].getProjectID();
	}

if (wfTask =="Intake" && wfStatus == "Approved" && projSuccess1 == true) {
	proj1[0].setStatus("Complete");
	aa.cap.updateProject(proj1[0]);
	}

if (wfTask =="Intake" && wfStatus == "Approved" && projSuccess1 == true) {
	tempCapId = capId;
	capId = parentCapId;
	licEditExpInfo("Active", null);
	capId = tempCapId;
	}

if (cap.isCreatedByACA() && wfTask == "Intake" && (wfStatus == "Excluded Address" || wfStatus == "Ineligible Vehicle" || wfStatus == "Outstanding Tickets" || wfStatus == "Pending Sticker Return" || wfStatus == "Invalid Lease" || wfStatus == "Expired Vehicle Registration")) {
	include("EML;Permitting!Parking!Residential Parking!NA;ACA");
	}

if (wfTask == "Issuance" && (wfStatus == "Temporary" || wfStatus == "Issued") && AInfo['Expiration Date'] != null  && AInfo['Expiration Date'] != "") {
	editAppSpecific("OFFICE USE ONLY.Permit Expiration Date", AInfo['Expiration Date']);
	}

if (wfTask == "Issuance" && (wfStatus == "Temporary" || wfStatus == "Issued") && AInfo['Permit Number Issued'] != null && AInfo['Permit Number Issued'] != "") {
	editAppSpecific("OFFICE USE ONLY.Permit Number Issued", AInfo['Permit Number Issued']);
	}

if (wfTask == "Issuance" && wfStatus == "Temporary") {
	updateTask("License Status", "Temporary Permit Active", "WTUA script", "");
	updateAppStatus("Temporary Permit Active");
	licEditExpInfo("Active", getAppSpecific("OFFICE USE ONLY.Permit Expiration Date"));
	}

if (wfTask == "Issuance" && wfStatus == "Temporary") {
	reportName = "Temp Parking Permit";
	include("CMN;RUN_REPORT");
	showMessage = false;
	}

if (wfTask == "Issuance" && wfStatus == "Issued") {
	updateTask("License Status", "Active", "WTUA script", "");
	updateAppStatus("Active");
	licEditExpInfo("Active", getAppSpecific("OFFICE USE ONLY.Permit Expiration Date"));
	}

if (cap.isCreatedByACA() && wfTask == "Issuance" && wfStatus == "Temporary") {
	include("EML;Permitting!Parking!Residential Parking!NA;ACA");
	}

if (cap.isCreatedByACA() && wfTask == "Issuance" && wfStatus == "Issued") {
	include("EML;Permitting!Parking!Residential Parking!NA;ACA");
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	licEditExpInfo("About to Expire", null);
	}
`^
WTUA;Permitting!Parks!Block Party!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
reportName = aa.util.newHashtable();
var repParams = aa.util.newHashtable();
reportModule = "Permitting";
if (wfTask == "Issuance" && wfStatus == "Issued") {
	reportName.put(0, "Parks Permit");
	addParameter(repParams, "AltID", capIDString);
	}

var params  = aa.util.newHashtable();
getRecordParams4Notification(params);
ca = getContactArray();
getContactParams4Notification(params, ca[0]);
contactEmail = ca[0]["email"];
getWorkflowNoCommentParams4Notification(params);
if (wfTask == "Staff Review" && wfStatus == "Additional Info Required") {
	sendNotification("madisonevents@cityofmadison.com",  contactEmail, "", "PARKSADDITIONALINFO", params, reportName, repParams, reportModule);
	}

if (wfTask == "Staff Review" && wfStatus == "Denied") {
	sendNotification("madisonevents@cityofmadison.com",  contactEmail, "", "PARKSAPPDENIED", params, reportName, repParams, reportModule);
	}

if (wfTask == "Issuance" && wfStatus == "Issued") {
	sendNotification("madisonevents@cityofmadison.com", contactEmail, "", "PARKSISSUED", params, reportName, repParams, reportModule);
	}
`^
WTUA;Permitting!Parks!DiscGol!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (wfTask =="Issuance" && wfStatus =="Sent") {
	reportName ="Parks Receipt";
	include("CMN;RUN_REPORT");
	}
`^
WTUA;Permitting!Parks!DiscGolf!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (wfTask =="Issuance" && wfStatus =="Sent") {
	reportName ="Parks Receipt";
	include("CMN;RUN_REPORT");
	}
`^
WTUA;Permitting!Parks!DogPark!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask =="Issuance" && wfStatus =="Sent") {
	reportName ="Parks Receipt";
	include("CMN;RUN_REPORT");
	}
`^
WTUA;Permitting!Parks!Lake Access!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (wfTask =="Issuance" && wfStatus =="Sent") {
	reportName ="Parks Receipt";
	include("CMN;RUN_REPORT");
	}
`^
WTUA;Permitting!Parks!Public Amplification!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (wfTask =="Issuance" && wfStatus =="Issued") {
	reportName ="Public Amplification Permit";
	include("CMN;RUN_REPORT");
	}
`^
WTUA;Permitting!Parks!SDiscGolf!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (wfTask =="Issuance" && wfStatus =="Sent") {
	reportName ="Parks Receipt";
	include("CMN;RUN_REPORT");
	}
`^
WTUA;Permitting!Parks!SkiTrail!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (wfTask =="Issuance" && wfStatus =="Sent") {
	reportName ="Parks Receipt";
	include("CMN;RUN_REPORT");
	}
`^
WTUA;Permitting!Parks!Special Event!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
cName = "Parks Event";
reportName ="Street Use Permit";
tsiArr = aa.taskSpecificInfo.getTaskSpecificInfoByTask(capId, wfProcessID, wfStep);
sendEmail = "No";
if (tsiArr.getSuccess()) {
	tsiResults = tsiArr.getOutput();
	}

if (tsiResults[0] != undefined) {
	sendEmail = tsiResults[0].getChecklistComment();
	}

if (sendEmail == "Yes" && wfTask == "Parks Review" && wfStatus == "Additional Info Required") {
	include("EML;Permitting!Parks!Street Use!~;GreaseEmail");
	}

if (sendEmail == "Yes" && wfTask == "Issuance" && wfStatus == "Issued") {
	include("EML;Permitting!Parks!Street Use!~;Issued");
	}
`^
WTUA;Permitting!Parks!Street Use!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
reportName = aa.util.newHashtable();
repParams = aa.util.newHashtable();
reportModule = "Permitting";
params  = aa.util.newHashtable();
getRecordParams4Notification(params);
ca = getContactArray();
getContactParams4Notification(params, ca[0]);
getWorkflowNoCommentParams4Notification(params);
ca = getContactArray();
getContactParams4Notification(params, ca[0]);
contactEmail = ca[0]["email"];
addParameter(params, "$$EventName$$", AInfo['EVENT INFORMATION.Name of Event']);
addParameter(params, "$$MeetingDate$$", AInfo['Meeting Date']);
addParameter(params, "$$MeetingAppearance$$", AInfo['Meeting Appearance Time']);
addParameter(params, "$$MeetingLocation$$", AInfo['Meeting Location']);
addParameter(params, "$$Legistar$$", AInfo['Legistar Link']);
addParameter(params, "$$OrgSentDate$$", AInfo['Date Sent to Organizer']);
if (wfTask == "Parks Event Coord. Review" && wfStatus == "Additional Info Required") {
	getACARecordParam4Notification(params, "https;!!elam73dev.cityofmadison.com;444!citizenaccess!", "Edit");
	}

if (wfTask == "Parks Event Coord. Review" && wfStatus == "Additional Info Required") {
	sendNotification("madisonevents@cityofmadison.com", contactEmail, "elamsupport@cityofmadison.com", "PARKSADDITIONALINFO", params, reportName, repParams, reportModule);
	}

if (wfTask == "Parks Event Coord. Review" && wfStatus == "Street Use Meeting Attend") {
	sendNotification("madisonevents@cityofmadison.com", contactEmail,  "elamsupport@cityofmadison.com", "PARKSSTREETUSECOORDREVMEETINGATTEND", params, reportName, repParams, reportModule);
	}

if (wfTask == "Create Fees" && wfStatus == "Create Fees") {
	getACARecordParam4Notification(params, madisonACAUrl, "Pay");
	}

if (wfTask == "Create Fees" && wfStatus == "Create Fees") {
	include("CMN;Permitting!Parks!Street Use!NA;WFFee");
	}

if (wfTask == "Create Fees" && wfStatus == "Create Fees") {
	sendNotification("madisonevents@cityofmadison.com", contactEmail, "elamsupport@cityofmadison.com", "PARKSSTREETUSEPAYFEE", params, reportName, repParams, reportModule);
	}

if (wfTask ==  "Final Review" && wfStatus == "Notify Approved List") {
	reportName.put(0, "Parks Permit");
	addParameter(repParams, "AltID", capIDString);
	}

if (wfTask ==  "Final Review" && wfStatus == "Notify Approved List") {
	include("CMN;Permitting!Parks!Street Use!~_FindDocumentsToEmail");
	}

if (wfTask ==  "Final Review" && wfStatus == "Notify Approved List") {
	aa.document.sendEmailByTemplateName("cehagenNONE@cityofmadison.com", "jgoltz@cityofmadison.com", "cehagen@cityofmadison.com", "PARKSSTREETUSEAPPROVEDLIST", params, fileNames);
	}

if (wfTask == "Issuance" && wfStatus == "Issued") {
	reportName.put(0, "Parks Permit");
	addParameter(repParams, "AltID", capIDString);
	}

if (wfTask == "Issuance" && wfStatus == "Issued") {
	include("CMN;Permitting!Parks!Street Use!~_FindDocumentsToEmail");
	}

if (wfTask == "Issuance" && wfStatus == "Issued") {
	aa.document.sendEmailByTemplateName("cehagen@cityofmadison.com", "jgoltz@cityofmadison.com", "", "PARKSISSUED", params, fileNames);
	}

if (wfTask == "Inspection" && wfStatus == "Completed") {
	closeTask("Closed", "Closed", "This task was automatically closed because the Inspectionstatus determined to close workflow.", "", "PRKSTRUSE");
	}

if (wfTask == "Inspection" && wfStatus == "N!A") {
	closeTask("Closed", "Closed", "This task was automatically closed because the Inspectionstatus determined to close workflow.", "", "PRKSTRUSE");
	}
`^
WTUA;Permitting!Parks!Temporary Structure!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (wfTask =="Issuance" && wfStatus =="Sent") {
	reportName ="Temporary Structure Permit";
	include("CMN;RUN_REPORT");
	}
`^
WTUA;Permitting!Parks!Vending!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (wfTask =="Issuance" && wfStatus =="Sent") {
	reportName ="Special Event Vending Permit";
	include("CMN;RUN_REPORT");
	}
`^
WTUA;Permitting!Traffic Engineering!Bicycle Registration!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "License Status" && wfStatus =="Active") {
	licEditExpInfo("Active", null);
	}

if (wfTask =="License Status" && wfStatus == "Ready to Renew") {
	licEditExpInfo("About to Expire", null);
	}

if (wfTask =="License Status" && wfStatus == "About to Expire") {
	licEditExpInfo("About to Expire", null);
	}

r = aa.cap.getProjectByMasterID(capId, "Renewal", "Review").getOutput();
r[0].setStatus("Complete");
aa.cap.updateProject(r[0]);
`^
WTUA;Permitting!Traffic Engineering!Driveway!Commercial^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
reviewCount = 0;
checkForIssuance = true;
signingActive = false;
intakeComplete = false;
assignedSigning = false;
isElec = isTaskActive("Electrical Review");
if (isElec == undefined) {
	isElec = false;
	}

if (wfTask == "Intake") {
	intakeComplete = true;
	}

if (isElec) {
	reviewCount = reviewCount + 1;
	include("CMN;Permitting!Traffic Engineering!Driveway!Commercial;SetReviews");
	}

include("CMN;Permitting!Traffic Engineering!Driveway!Commercial;Fee");
isEngineerReview = isTaskActive("City Engineer Review");
if (isEngineerReview == undefined) {
	isEngineerReview = false;
	}

if (isEngineerReview && (isTaskStatus("City Engineer Review", "Approved") || isTaskStatus("City Engineer Review", "Rejected"))) {
	deactivateTask("City Engineer Review");
	}

if (isEngineerReview) {
	reviewCount = reviewCount + 1;
	}

if (wfTask == "Electrical Review" && wfStatus == "Approved") {
	excludeCode = "TEDRVSMK";
	onlyIncludeCode = "";
	include("CMN;invoiceAssessedFees");
	}

if (wfTask == "Signing and Marking" && wfStatus == "Completed" || wfStatus == "Not Used") {
	excludeCode = "";
	onlyIncludeCode = "TEDRVSMK";
	include("CMN;invoiceAssessedFees");
	deactivateTask("Signing and Marking");
	}

if (isTaskActive("Issuance") || isTaskActive("Closed")) {
	checkForIssuance = false;
	}

signingActive = isTaskActive("Signing and Marking");
if (signingActive == undefined) {
	signingActive = false;
	}

if (signingActive && isTaskStatus("Signing and Marking", "Assigned")) {
	reviewCount = reviewCount + 1;
	}

if (checkForIssuance && (reviewCount < 1)) {
	activateTask("Issuance");
	updateAppStatus("Payment Pending","Please Pay fees on application");
	}

if (wfTask == "Issuance" && wfStatus == "Issued") {
	include("EML;Permitting!Traffic Engineering!Driveway!Commercial;Issued");
	}
`^
WTUA;Permitting!Traffic Engineering!Street Occupancy!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
dumpsterOnly = false;
cbACA = true;
if (AInfo['OCCUPANCY INFORMATION.Dumpster'] == "CHECKED" && AInfo['OCCUPANCY INFORMATION.Trailer'] != "CHECKED" && AInfo['OCCUPANCY INFORMATION.Other'] != "CHECKED" && AInfo['OCCUPANCY INFORMATION.Crane'] != "CHECKED") {
	dumpsterOnly = true;
	}

if (cap.isCreatedByACA() == false) {
	cbACA = false;
	}

if (wfTask == "Intake" && wfStatus == "Application Accepted" && dumpsterOnly == true) {
	closeTask("Public Works Review");
	closeTask("Parking Utility Review");
	closeTask("Building Inspection Review");
	}

if (wfTask == "Traffic Engineering Review" && wfStatus == "Approved") {
	invoiceFees = "Y";
	include("CMN;Permitting!Traffic Engineering!Street Occupancy!NA;Fee");
	invoiceAssessedFeesMadison();
	}

if (wfTask == "Traffic Engineering Review" && wfStatus == "Approved" && cbACA == true) {
	include("EML;Permitting!Traffic Engineering!Street Occupancy!NA;Fees");
	updateAppStatus("Waiting For Payment");
	}
`^
WTUA;Permitting!Vending!Banner!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask =="Fee Review" && (wfStatus == "Create Fees No Email" || wfStatus =="Create Fees Email")) {
	include("CMN;Permitting!Vending!Banner!NA;Fee");
	}

if (wfTask =="Fee Review" && (wfStatus =="Email Only" || wfStatus =="Create Fees Email")) {
	include("EML;Permitting!Vending!Banner!NA;Fees");
	}

if (wfTask =="Insurance Review" && wfStatus =="Insurance Denied") {
	include("EML;Permitting!Vending!Banner!NA;InsDeclined");
	}

if (wfTask =="Insurance Review" && wfStatus =="Insurance Not Attached") {
	include("EML;Permitting!Vending!Banner!NA;InsNeeded");
	}

if (wfTask =="Insurance Review" && wfStatus =="Additional Info Required") {
	include("EML;Permitting!Vending!Banner!NA;InsInfo");
	}

if (wfTask =="Issuance" && wfStatus == "Scheduled") {
	include("EML;Permitting!Vending!Banner!NA;Issuance");
	}
`^
WTUA;Permitting!Vending!TEM!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask =="Fee Review" && (wfStatus =="Create Fees Email" || wfStatus == "Create Fees No Email")) {
	include("CMN;Permitting!Vending!TEM!NA;Fee");
	}

if (wfTask =="Intake" && wfStatus =="Submitted - No Conference") {
	closeTask("Applicant Conference","Submitted","No Conference Necessary");
	}

if (wfTask =="Permit Issuance" && wfStatus =="Issued - TEM") {
	reportName = "Vending Business Permit";
	include("CMN;RUN_REPORT_NO_MSG");
	}

if (wfTask =="Permit Issuance" && wfStatus =="Issued - TEM") {
	reportName = "Vending Business Permit";
	include("EML;Permitting!Vending!TEM!NA;LicenseIssued");
	}

if (wfTask =="Fee Review" && (wfStatus =="Create Fees Email" || wfStatus =="Email Only")) {
	include("EML;Permitting!Vending!TEM!NA;Fees");
	}
`^
WTUA;Permitting!Water!New Meter!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
if (wfProcess == "WTRNEWMTR" && wfTask == "Inspection" && wfStatus == "Complete") {
	include("CMN;Permitting!Water!New Meter!~;EmailWaterOps");
	}

if (wfProcess == "WTRNEWMTR" && wfTask == "Meter Setting" && wfStatus == "Completed") {
	include("CMN;Permitting!Water!New Meter!~;EmailBilling");
	}
`^
WTUA;Permitting!Zoning!Nonconforming!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Intake") {
	include("CMN;Permitting!Zoning!Nonconforming!NA;Fee");
	}
`^
WTUA;Permitting!Zoning!Sign!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
if (wfTask =="Issuance" && wfStatus == "Issued") {
	reportName ="Sign Permit EDMS";
	include("CMN;RUN_REPORT");
	}

if (wfTask == "Issuance" && wfStatus == "Issued") {
	include("CMN;AssignBldgSignInsp");
	scheduleInspectDateGroup("ZONSIGN", "Sign Inspection", nextWorkDay(dateAdd(wfDateMMDDYYYY,182)), inspecUserID);
	}
`^
WTUA;ServiceRequest!Engineering - Facility!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = true;
showMessage = false;
var tsiArr;
include("EML;ServiceRequest!Engineering - Facility!~!~");
if (ca[0] != null) {
	email(ca[0]["email"],"noreply@cityofmadisonDEV.com",emailSubject,emailText);
	}

if (wfTask == "Submitted" && wfStatus == "Rejected") {
	closeTask("Close","Closed","Closed by Script");
	}

if (wfTask == "Submitted" && wfStatus == "Accepted") {
	tsiArr = aa.taskSpecificInfo.getTaskSpecificInfoByTask(capId, wfProcessID, wfStep);
	}

if (wfTask == "Submitted" && wfStatus == "Accepted" && tsiArr != null && tsiArr.getSuccess()) {
	tsiResults = tsiArr.getOutput();
	}

if (wfTask == "Submitted" && wfStatus == "Accepted" && tsiArr != null && tsiArr.getSuccess() && tsiResults[0] != undefined) {
	if (tsiResults[0].getChecklistComment() == "Customer Request" || tsiResults[0].getChecklistComment() == "Repair - Scheduled" || tsiResults[0].getChecklistComment() == "Repair - Unscheduled" || tsiResults[0].getChecklistComment() == "New Installation" || tsiResults[0].getChecklistComment() == "Predictive Testing and Insp"|| tsiResults[0].getChecklistComment() == "Preventive Maintenance" || tsiResults[0].getChecklistComment() == "Programmed Maintenance"|| tsiResults[0].getChecklistComment() == "Trouble Call" || tsiResults[0].getChecklistComment() == "Upgrade or Retrofit") include("CMN;CREATE_ENGFAC_WO_CHILD");
	}

if (currentUserID != "ENKMS") {
	callType = "WTUA";
	include("EML;ServiceRequestReceived!Engineering!Facility!~;Update");
	}
`^
WTUA;ServiceRequest!Engineering Sanitary!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("EML;ServiceRequest!Engineering!~!~");
if (ca != null) {
	email(ca[0]["email"],"noreply@cityofmadisonDEV.com",emailSubject,emailText);
	}
`^
WTUA;ServiceRequest!Engineering Stormwater!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("EML;ServiceRequest!Engineering!~!~");
if (ca != null) {
	email(ca[0]["email"],"noreply@cityofmadisonDEV.com",emailSubject,emailText);
	}
`^
WTUA;ServiceRequest!Engineering!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("EML;ServiceRequest!Engineering!~!~");
if (ca != null) {
	email(ca[0]["email"],"noreply@cityofmadisonDEV.com",emailSubject,emailText);
	}
`^
WTUA;ServiceRequest!Information Technology!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
editTaskDueDate("~",dateAdd(null,5));
if (wfTask == "IT Action" || wfStatus =="Closed") {
	include("EML;ServiceRequest!~!~!~;UpdateAssignedBy");
	}
`^
WTUA;ServiceRequest!Information Technology!Accela Issue!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "IT Review"  && wfStatus != "Review in Progress") {
	include("EML;ServiceRequest!Information Technology!Accela Change Request!NA;ITReview");
	}

if (wfTask == "IT Review" && wfStatus == "Declined") {
	closeTask("Closed", "Closed", "Updated by WTUA script from IT Review - " + wfStatus,"");
	}

if (wfTask == "IT Action" && wfStatus != "Work in Progress") {
	include("EML;ServiceRequest!Information Technology!Accela Change Request!NA;ITAction");
	}

if (wfTask == "IT Action" && wfStatus == "IT Quality Assurance - Change") {
	aa.workflow.deleteAndAssignWorkflow(capId, "SERVICE REQUEST - IT CHANGE REQUEST", false);
	closeTask("Agency Review", "Accepted", "Updated by WTUA script reassigning workflow.  Check Workflow History for this Tasks events.","");
	closeTask("IT Review", "Accepted", "Updated by WTUA script reassigning workflow.  Check Workflow History for this Tasks events.","");
	updateTask("IT Action", "Work in Progress", "Updated by WTUA script reassigning workflow.  Check Workflow History for this Tasks events.","");
	}

if (wfTask == "IT Action") {
	assignTask("IT Quality Assurance", capDetail.getAsgnStaff(), "SERVICE REQUEST - IT ISSUE");
	}

if (wfTask == "Customer Test" && wfStatus != "Testing in Progress") {
	include("EML;ServiceRequest!Information Technology!Accela Change Request!NA;Test");
	}

if (wfTask == "IT Quality Assurance" && wfStatus != "QA In Progress") {
	include("EML;ServiceRequest!Information Technology!Accela Change Request!NA;ITQualityAssurance");
	}

if (wfTask == "Deployment"  && wfStatus != "Deployment in Progress") {
	include("EML;ServiceRequest!Information Technology!Accela Change Request!NA;Deployment");
	}

if (wfTask == "Deployment" && wfStatus == "Closed") {
	closeTask("Closed", "Closed", "Updated by WTUA script","");
	}
`^
WTUA;ServiceRequest!Streets - Graffiti!Graffiti!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
SRType = "";
var tsiArr;
if ((wfTask == "Submitted") && (wfStatus == "Accepted")) {
	SRType = "City";
	}

if ((wfTask == "Submitted") && (wfStatus == "Accepted") && AInfo['GRAFFITI DETAIL.Owner or Agency'] == "Private Other") {
	SRType = "Private";
	}

if ((wfTask == "Submitted") && (wfStatus == "Accepted") && SRType != "Private" && AInfo['GRAFFITI DETAIL.Action Taken'] == "Referred") {
	SRType = "Referral";
	}

if ((wfTask == "Submitted") && (wfStatus == "Accepted")) {
	tsiArr = aa.taskSpecificInfo.getTaskSpecificInfoByTask(capId, wfProcessID, wfStep);
	}

if ((wfTask == "Submitted") && (wfStatus == "Accepted") && tsiArr != null && tsiArr.getSuccess()) {
	tsiResults = tsiArr.getOutput();
	}

if (SRType == "City") {
	include("CMN;ServiceRequest!Streets - Graffiti!Graffiti!NA;City");
	}

if (SRType == "Private") {
	include("CMN;ServiceRequest!Streets - Graffiti!Graffiti!NA;Private");
	}

if (SRType == "Referral") {
	include("CMN;ServiceRequest!Streets - Graffiti!Graffiti!NA;Referral");
	}
`^
WTUA;ServiceRequest!Traffic Engineering!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfStatus == "Send Assigned To Email") {
	include("EML;ServiceRequest!TrafficEngineering!~!~;StudyCreated");
	include("CMN;ServiceRequest!Traffic Engineering;TrackTaskAssignments");
	}
`^
WTUA;ServiceRequest!Traffic Engineering!Request!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
tsiArr = null;
docList = null;
if ((wfTask == "Office Review" || wfTask == "Work Order Review") && (wfStatus == "Create Studies!Work Orders" || wfStatus =="Generate Work Orders from Docs")) {
	tsiArr = aa.taskSpecificInfo.getTaskSpecificInfoByTask(capId, wfProcessID, wfStep);
	}

if (wfTask == "Office Review" && (wfStatus == "Administrative Close" || wfStatus == "Work Order Review")) {
	include("EML;ServiceRequest!~!~!~;UpdateAssignedBy");
	}

if (tsiArr != null && tsiArr.getSuccess()) {
	tsiResults = tsiArr.getOutput();
	}

if (tsiArr != null && tsiArr.getSuccess() && tsiResults[0] != undefined) {
	for (study in tsiResults) if (tsiResults[study].getChecklistComment() == "CHECKED") include("CMN;CREATE_TE_SR_CHILD");
	}

if (wfTask == "Work Order Review" && wfStatus == "Generate Work Orders from Docs") {
	include("CreateChileTrafficElectricalWO");
	}

procComp = closeSubWorkflow(wfProcessID, "Completed", capId);
if (procComp == undefined) {
	closeTask("Closed", "Closed", "Auto Closed", "Service Request Complete", "TE_SR");
	}
`^
WTUA;ServiceRequest!Traffic Engineering!Study!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
hasParent = false;
incompCount = 0;
dispMessage = "";
userId = "";
assignEmail  = "";
requestEmail = "";
requestFirst = "";
requestLast = "";
requestCap = "";
if (wfTask =="Review" && wfStatus == "Complete") {
	p = aa.cap.getProjectByChildCapID(capId, "R", "");
	hasParent = p.getSuccess();
	}

if (wfTask == "Work Status" && wfStatus == "Complete") {
	include("EML;ServiceRequest!TrafficEngineering!~!~;StudyClosed");
	}

if (hasParent == true) {
	p = p.getOutput();
	parentCapId = p[0].getProjectID();
	proj = aa.cap.getProjectByMasterID(parentCapId, "R", "");
	proj = proj.getOutput();
	}

if (hasParent == true) {
	for (child in proj) include("CMN;ServiceRequest!TrafficEngineering!~!~;CheckChildComplete");
	}

if (hasParent == true) {
	cd = aa.cap.getCapDetail(capId).getOutput().getCapDetailModel();
	}

if (hasParent == true) {
	userId = cd.createBy;
	include("EML;GetUserIdEmail");
	requestCap = childAltId;
	requestEmail  = userEmail;
	requestFirst = userFirst;
	requestLast = userLast;
	}

if (userId && hasParent == true && wfStatus == "Closed") {
	include("EML;ServiceRequest!TrafficEngineering!~!~;RequestClosed");
	}

if (hasParent == true && incompCount < 1) {
	updateAppStatus("Studies Complete","",parentCapId );
	}

if (userId && wfTask =="Work Status" && wfStatus == "Complete") {
	cd = aa.cap.getCapDetail(capId).getOutput().getCapDetailModel();
	userId = cd.createBy;
	assignTask("Review", userId, "TE_SR_STUDY");
	}

if (wfTask =="Review" && wfStatus == "Complete") {
	include("EML;ServiceRequest!~!~!~;UpdateAssignedBy");
	}
`^
WTUA;WeightsMeasures!~!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
capClosed = false;
hasExpire = null;
if ((wfStatus == "Business Dissolved" || wfStatus == "Inactive" || wfStatus == "Closed")) {
	capClosed = true;
	}

include("CMN;CloseRecord");
if (currentUserID == "ITJBS") {
	showDebug = true;
	}
`^
WTUA;WeightsMeasures!Licensing!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (((wfTask == "Issuance" && wfStatus == "Issued") || (wfTask == "License Status" && wfStatus == "Active"))) {
	include("CMN;WeightsMeasuresLicenseIssueProcess");
	}

if (wfTask == "License Status" && (wfStatus == "About to Expire" || wfStatus == "Expired")) {
	licEditExpInfo(wfStatus, null);
	}

if (currentUserID == "ITJBS") {
	showDebug = true;
	}
`^
WTUB;AMS!Facility!Maintenance!AED^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
var strName = "";
AssetList = aa.asset.getAssetListByWorkOrder(capId,null);
expired = false;
if (AssetList.getSuccess()) {
	AssetList = AssetList.getOutput();
	}

if (AssetList) {
	for (x in AssetList) include("CMN;CheckAEDExpiration");
	}

if (expired) {
	message = "AED record has expired battery or pads. Please replace expired battery or pads and update the attached AED asset record.";
	showMessage = true;
	cancel = true;
	}
`^
WTUB;AMS!Water!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
`^
WTUB;Enforcement!Building Inspection!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Initial Inspection" && (wfStatus == "Posted No Occupancy" || wfStatus == "Issued Summary Abate" || wfStatus == "Issued Non-Summary Abate" || wfStatus == "Issued" || wfStatus == "Issued Abatment" || wfStatus == "Reinspection" || wfStatus == "Citation Issued") && AInfo['Updated.Due Date'] == "") {
	message = "Please enter a Due Date before submitting ";
	showMessage = true;
	cancel = true;
	}

if (wfTask == "Reinspection" && (wfStatus == "Posted No Occupancy" || wfStatus == "Extension Processed" || wfStatus == "Issued Abatment" || wfStatus == "Reinspection" || wfStatus == "Citation Issued") && AInfo['Updated.Reinspection Due Date'] == "") {
	message = "Please enter a Reinspection Due Date before submitting ";
	showMessage = true;
	cancel = true;
	}

if (wfTask == "Court" && (wfStatus == "Hi Low") && AInfo['Updated.Hi Low Date'] == "") {
	message = "Please enter a Hi Low Due Date before submitting ";
	showMessage = true;
	cancel = true;
	}

if ((wfStatus == "Citation Issued") && AInfo['Updated.Citation Number'] == "") {
	message = "Please enter a Citation Number before submitting ";
	showMessage = true;
	cancel = true;
	}
`^
WTUB;Licenses!Clerk!ClassABeerLiquor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (wfTask == "License Status" && wfStatus == "Audited") {
	message = "You must upload the Audited Renewal Paperwork to update the Audited status";
	showMessage = true;
	cancel = true;
	}
`^
WTUB;Licenses!Clerk!ClassBBeerLiquor!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (wfTask == "License Status" && wfStatus == "Audited") {
	message = "You must upload the Audited Renewal Paperwork to update the Audited status";
	showMessage = true;
	cancel = true;
	}
`^
WTUB;Licenses!Clerk!Operator!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = true;
logDebug("ALRC Appearance date = " + AInfo['Enter Date of ALRC Hearing']);
logDebug("Updated ALRC Appearance date = " + AInfo['Updated.Enter Date of ALRC Hearing']);
if (wfTask == "ALRC Review" && wfStatus == "ALRC Appearance Scheduled" && AInfo['Enter Date of ALRC Hearing'] == null && (AInfo['Updated.Enter Date of ALRC Hearing'] == null || AInfo['Updated.Enter Date of ALRC Hearing'] == "")) {
	message = "Please enter an ALRC Appearance Date before submitting.";
	showMessage = true;
	cancel = true;
	}
`^
WTUB;Permitting!Building!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = 3;
showMessage = false;
include("CMN;Permitting!~!~!~;Unpaid Balance");
include("CMN;ENG HOLDS");
include("CMN;PARK HOLDS");
if ((wfTask == "Certificate of Occupancy" && wfStatus == "Issued")) {
	showMessage = true;
	feesOwed = true;
	finalComplete = true;
	childA = getChildren("Permitting!~!~!~",capId);
	if(childA != null) for (x in childA) include("CMN;Permitting!Building!~!~;Workflow Checks Inspections and Balance");
	}
`^
WTUB;Permitting!Building!RepairReplace!Construction^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = 3;
showMessage = true;
if (wfStatus == "Issued" && checkCapForLicensedProfessionalType("GENERAL")) {
	include("CMN;!Permitting!Building!~!~_CheckForExpiredLicense");
	}

cancel = true;
`^
WTUB;Permitting!Building!Residential!Construction^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfStatus == "Issued" && checkCapForLicensedProfessionalType("GENERAL")) {
	include("CMN;!Permitting!Building!~!~_CheckForExpiredLicense");
	}

cancel = true;
`^
WTUB;Permitting!Engineering!~!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;Permitting!~!~!~;Unpaid Balance");
`^
WTUB;Permitting!Engineering!Sewer Addition Meter!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Intake" && wfStatus == "Application Accepted" && (balanceDue > 0 || feesInvoicedTotal == 0)) {
	message="Workflow Task Can't Be Updated Because fees due or have not been assessed";
	showMessage = true;
	cancel = true;
	}
`^
WTUB;Permitting!Engineering!Sewer Deduct Meter!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Intake" && wfStatus == "Application Accepted" && (balanceDue > 0 || feesInvoicedTotal == 0)) {
	message="Workflow Task Can't Be Updated Because fees due or have not been assessed";
	showMessage = true;
	cancel = true;
	}
`^
WTUB;Permitting!Health!POWTS!Old Sanitary^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
if (wfTask == "Operational" && wfStatus == "Citation Issued" && (AInfo['Updated.Court Date'] == "" || AInfo['Updated.Citation Number'] == "")) {
	message = "Please enter a Court Date and Citation Number before submitting ";
	showMessage = true;
	cancel = true;
	}
`^
WTUB;Permitting!Health!POWTS!Sanitary^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var bPaidInFull = false;
if (wfTask == "Operational" && wfStatus == "Citation Issued" && (AInfo['Updated.Court Date'] == "" || AInfo['Updated.Citation Number'] == "")) {
	message = "Please enter a Court Date and Citation Number before submitting ";
	showMessage = true;
	cancel = true;
	}

if (wfTask == "Permit Issuance" && wfStatus == "Issued" && (feesInvoicedTotal <= 0 || balanceDue > 0)) {
	cancel = true;
	showMessage = true;
	comment("There are either no fees assessed or the balance due is > 0, so the permit issuance process has been cancelled. If fees have been assessed, please pay the balance in full to issue and activate the permit.");
	}
`^
WTUB;Permitting!Health!Well!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
if (wfTask == "Operational" && wfStatus == "Citation Issued" && (AInfo['Updated.Court Date'] == "" || AInfo['Updated.Citation Number'] == "")) {
	message = "Please enter a Court Date and Citation Number before submitting ";
	showMessage = true;
	cancel = true;
	}
`^
WTUB;Permitting!Traffic Engineering!Driveway!Commercial^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
isCompleted = ((wfTask == "Signing and Marking") && (wfStatus == "Completed"));
hasFee = feeExists("TEDRVSMK");
if (hasFee == undefined) {
	hasFee = false;
	}

if (isCompleted && (hasFee == false)) {
	message = "You must add a Signing and Marking Deposit Fee before completing this task";
	showMessage = true;
	cancel = true;
	}
`^
WTUB;Permitting!Traffic Engineering!Street Occupancy!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
include("CMN;Permitting!~!~!~;Unpaid Balance");
`^
WTUB;ServiceRequest!Traffic Engineering!Request!~^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
dispMessage = "";
incompCount = 0;
projSuccess = false;
if (wfTask =="Office Review" && wfStatus != "Administrative Close" && wfStatus != "Create Studies!Work Orders" && wfStatus != "Send Assigned To Email") {
	proj = aa.cap.getProjectByMasterID(capId, "R", "");
	projSuccess = proj.getSuccess();
	}

if (projSuccess == true) {
	proj = proj.getOutput();
	for (child in proj) include("CMN;ServiceRequest!TrafficEngineering!~!~;CheckChildComplete");
	}

if (projSuccess == true) {
	dispMessage = "Associated studies and!or counts are not yet complete.<!br>"+dispMessage;
	}

if (incompCount > 0) {
	cancel = true;
	showMessage = true;
	comment(dispMessage);
	}
`^
WTUB;WeightsMeasures!Licensing!NA!NA^`
/*	Script conversion from EMSE [Stand Choice Name]
	Change Log
		[Name Date] - Initial conversion
*/
showDebug = false;
showMessage = false;
var bIsLicenseIssue = false;
var bPaidInFull = false;
if (((wfTask == "Issuance" && wfStatus == "Issued") || (wfTask == "License Status" && wfStatus == "Active"))) {
	bIsLicenseIssue = true;
	}

if (feesInvoicedTotal > 0 && balanceDue <= 0) {
	bPaidInFull = true;
	}

if (bIsLicenseIssue == true && bPaidInFull == false) {
	cancel = true;
	showMessage = true;
	comment("There are either no fees assessed or the balance due is > 0, so the license issuance process has been cancelled. If fees have been assessed, please pay the balance in full to issue and activate the license.");
	}
`^
